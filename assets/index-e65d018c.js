import{_ as Hn,c as ei,C as ti}from"./index-f6dc58d3.js";import{c as ni,g as ri,r as si}from"./___vite-browser-external_commonjs-proxy-0e49e858.js";import{h as Kt,i as Yn,a as Ir,b as Rr,c as Ar,d as Cr,e as Or}from"./trade-558ff608.js";import{t as zt}from"./toast-c468639c.js";import{T as vn}from"./toast-69cb867a.js";import{i as bn,b as Pn,r as Jt,a as wn,f as ii,c as ar,S as Nr}from"./isObject-9a74e966.js";let oi=s=>{let a={},E={},k={dispatch(V,n){if(V!=="@dispatch"&&k.dispatch("@dispatch",[V,n,a[V]]),a[V]){let I;a[V].forEach(e=>{let r=a[V].includes(e)&&e(E,n,k);r&&typeof r.then!="function"&&(E={...E,...r},I={...I,...r})}),I&&k.dispatch("@changed",I)}},get:()=>E,on(V,n){return(a[V]||(a[V]=[])).push(n),()=>{a[V]=a[V].filter(I=>I!==n)}}};return s.forEach(V=>{V&&V(k)}),k.dispatch("@init"),k};var zn={},ai={get exports(){return zn},set exports(s){zn=s}};/*! For license information please see solclient.js.LICENSE.txt */(function(s,a){(function(E,k){s.exports=k()})(ni,()=>(()=>{var E={6010:(n,I,e)=>{n.exports=e(3987)},840:(n,I,e)=>{const{Base64:r}=e(7791),{Bits:i}=e(1531),{Convert:t}=e(3087),{Hex:c}=e(8586),{Long:l}=e(559);n.exports.Base64=r,n.exports.Bits=i,n.exports.Convert=t,n.exports.Hex=c,n.exports.Long=l},7791:(n,I,e)=>{var r=e(8764).lW;const i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",t=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,99,-1,-1,99,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,99,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,64,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1];class c extends Error{}const l={base64_encode(T){let S="",C=0;do{const p=T.charCodeAt(C++),R=T.charCodeAt(C++),N=T.charCodeAt(C++),w=p>>2,y=(3&p)<<4|R>>4;let P=(15&R)<<2|N>>6,x=63&N;isNaN(R)?P=x=64:isNaN(N)&&(x=64),S+=i.charAt(w),S+=i.charAt(y),S+=i.charAt(P),S+=i.charAt(x)}while(C<T.length);return S},base64_decode(T){let S="",C=0;do{for(;t[T.charCodeAt(C)]>64;)C++;const p=t[T.charCodeAt(C++)],R=t[T.charCodeAt(C++)],N=t[T.charCodeAt(C++)],w=t[T.charCodeAt(C++)];if(p<0||R<0||N<0||w<0)throw new c("Invalid base64 character");const y=p<<2|R>>4,P=(15&R)<<4|N>>2,x=(3&N)<<6|w;S+=String.fromCharCode(y),N!==64&&(S+=String.fromCharCode(P)),w!==64&&(S+=String.fromCharCode(x))}while(C<T.length-3);return S}},u=typeof window>"u",o=typeof Blob<"u",f=r!==void 0&&(o||u)?{base64_encode:T=>r.from(T,"binary").toString("base64"),base64_decode:T=>r.from(T,"base64").toString("binary")}:{},g=typeof window<"u"?{base64_encode:window.btoa?T=>window.btoa(T):null,base64_decode:window.atob?T=>window.atob(T):null}:{},h={encode:g.base64_encode||f.base64_encode||l.base64_encode,decode:g.base64_decode||f.base64_decode||l.base64_decode};n.exports.Base64=h},1531:n=>{const I={get:(e,r,i)=>e>>>r&(1<<i)-1,set(e,r,i,t){const c=(1<<t)-1;return e&~(c<<i)|(r&c)<<i}};n.exports.Bits=I},3087:(n,I,e)=>{const r=e(1583),{ErrorSubcode:i,OperationError:t}=e(3870),c=e(8764).lW,l=String.fromCharCode(0,0),u=String.fromCharCode(0,0,0),o=String.fromCharCode(0,0,0,0),f=8192,g=32768;function h(p){const R=p.length,N=new ArrayBuffer(R),w=new Uint8Array(N,0,R);for(let y=0;y<R;y++)w[y]=p.charCodeAt(y);return w}function T(p){if(p===0)return o;if(p>0){if(p<256)return u+String.fromCharCode(p);if(p<65536)return l+String.fromCharCode(p>>8)+String.fromCharCode(255&p)}return String.fromCharCode(p>>24&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p)}function S(p){return 16777216*p.charCodeAt(0)+(p.charCodeAt(1)<<16)+(p.charCodeAt(2)<<8)+p.charCodeAt(3)}const C={arrayBufferToString:function(p){if(!p)return"";const R=p.byteLength,N=new Uint8Array(p);if(R<g)return String.fromCharCode.apply(null,N);let w=0,y="";for(;w<R;)y+=String.fromCharCode.apply(null,N.subarray(w,w+g)),w+=g;return y},stringToArrayBuffer:function(p){return h(p).buffer},stringToUint8Array:h,int8ToStr:function(p){return String.fromCharCode(255&p)},strToInt8:function(p){return 255&p.charCodeAt(0)},int16ToStr:function(p){return String.fromCharCode(p>>8&255)+String.fromCharCode(255&p)},strToInt16:function(p){return(p.charCodeAt(0)<<8)+p.charCodeAt(1)},int24ToStr:function(p){return String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p)},strToInt24:function(p){return(p.charCodeAt(0)<<16)+(p.charCodeAt(1)<<8)+p.charCodeAt(2)},int32ToStr:T,strToInt32:function(p){return(p.charCodeAt(0)<<24)+(p.charCodeAt(1)<<16)+(p.charCodeAt(2)<<8)+p.charCodeAt(3)},strToUInt32:S,int64ToStr:function(p){if(typeof p!="number")return T(p.high)+T(p.low);if(p>=0){if(p<256)return o+u+String.fromCharCode(p);if(p<65536)return o+l+String.fromCharCode(p>>8)+String.fromCharCode(255&p);if(p<4294967296)return o+(String.fromCharCode(p>>24&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p))}return String.fromCharCode(p>>56&255)+String.fromCharCode(p>>48&255)+String.fromCharCode(p>>40&255)+String.fromCharCode(p>>32&255)+String.fromCharCode(p>>24&255)+String.fromCharCode(p>>16&255)+String.fromCharCode(p>>8&255)+String.fromCharCode(255&p)},strToUInt64:function(p){return r.fromBits(S(p.substr(4,4)),S(p.substr(0,4)),!0)},byteArrayToStr:function(p){const R=p.length;if(R<f)return String.fromCharCode.apply(null,p);let N=0,w="";for(;N<R;)w+=String.fromCharCode.apply(null,p.slice(N,N+f)),N+=f;return w},strToByteArray:function(p){const R=[];let N;for(N=0;N<p.length;N++)R[N]=p.charCodeAt(N);return R},strToHexArray:function(p){return Array.prototype.map.call(p.split(""),function(R){return R.charCodeAt(0).toString(16)})},ucs2ToUtf8:function(p){return unescape(encodeURIComponent(p))},utf8ToUcs2:function(p){return decodeURIComponent(escape(p))},anythingToBuffer:function(p){if(c.isBuffer(p))return p;if(typeof p=="string")return c.from(p,"latin1");if(p instanceof ArrayBuffer)return c.from(p);if(p.buffer instanceof ArrayBuffer&&typeof p.byteLength=="number"&&typeof p.byteOffset=="number")return p.byteOffset===0&&p.byteLength===p.buffer.byteLength?c.from(p.buffer):c.from(p.buffer,p.byteOffset,p.byteLength);throw new t("Parameter value failed validation",i.PARAMETER_OUT_OF_RANGE,"Expecting Buffer/Uint8Array, also accepting string, ArrayBuffer, any TypedArray, or DataView.")}};n.exports.Convert=C},8586:n=>{function I(r){if(typeof r!="number")return"";const i=r.toString(16);return i.length<2?`0${i}`:i}const e={formatHexString:function(r){return typeof r=="number"?`0x${I(r)}`:typeof r=="object"&&Array.isArray(r)?r.map(I).join():typeof r=="string"?Array.prototype.map.call(r,(i,t)=>I(r.charCodeAt(t))).join(""):null}};n.exports.Hex=e},559:(n,I,e)=>{n.exports.Long=e(1583)},9850:(n,I,e)=>{const r=e(840),i=e(1880),t=e(3170),c=e(3870),l=e(9359),u=e(828),o=e(8535),f=e(390),g=e(4789),h=e(6780),T=e(7252),S=e(5594),C=e(7291),p=e(1843),R=e(5470),N=e(3147),w=e(7882),y=e(2201);n.exports={Convert:r,Debug:i,Destination:t,Error:c,ESKit:l,Factory:u,FSM:o,Log:f,Message:g,Publisher:h,SDT:T,Session:S,SMF:C,SolcacheSession:p,TestEnv:R,Transport:N,Util:w,Validate:y}},3987:(n,I,e)=>{const r=e(828),{SolclientFactory:i,SolclientFactoryProfiles:t,SolclientFactoryProperties:c}=r,{Long:l}=e(840),{Destination:u,DestinationType:o,Topic:f}=e(3170),{ErrorSubcode:g,NotImplementedError:h,OperationError:T,RequestError:S,RequestEventCode:C}=e(3870),{makeIterator:p}=e(9359),{ConsoleLogImpl:R,LogImpl:N,LogLevel:w}=e(390),{Message:y,MessageCacheStatus:P,MessageDeliveryModeType:x,MessageDumpFlag:B,MessageType:H,MessageUserCosType:L,ReplicationGroupMessageId:M}=e(4789),{MessageConsumer:G,MessageConsumerAcknowledgeMode:K,MessageConsumerEventName:F,MessageConsumerProperties:Y,QueueBrowser:_,QueueBrowserEventName:U,QueueBrowserProperties:A}=e(4858),{ReplayStartLocation:z,ReplayStartLocationBeginning:J}=e(2604),{MessagePublisherAcknowledgeMode:se,MessagePublisherProperties:Te}=e(6780),{AbstractQueueDescriptor:pe,QueueAccessType:ne,QueueDescriptor:oe,QueueDiscardBehavior:de,QueuePermissions:_e,QueueProperties:b,QueueType:X}=e(5754),{SDTField:ae,SDTFieldType:ie,SDTMapContainer:q,SDTStreamContainer:Pe,SDTUnsupportedValueError:ve,SDTValueErrorSubcode:Qe}=e(7252),{AuthenticationScheme:Z,CapabilityType:ee,MessageRxCBInfo:ge,MutableSessionProperty:d,Session:O,SessionEvent:D,SessionEventCBInfo:Q,SessionEventCode:re,SessionProperties:ce,SessionState:me,SslDowngrade:Ee}=e(5594),{CacheCBInfo:Ce,CacheLiveDataAction:Me,CacheRequestResult:Be,CacheReturnCode:He,CacheReturnSubcode:Ot,CacheSession:xt,CacheSessionProperties:gt}=e(1843),{StatType:Ae}=e(6818),{TransportError:ut,TransportProtocol:Ke}=e(3147),{Version:mt}=e(7882),Dt={AbstractQueueDescriptor:pe,AuthenticationScheme:Z,CacheCBInfo:Ce,CacheLiveDataAction:Me,CacheRequestResult:Be,CacheReturnCode:He,CacheReturnSubcode:Ot,CacheSession:xt,CacheSessionProperties:gt,CapabilityType:ee,ConsoleLogImpl:R,Destination:u,DestinationType:o,ErrorSubcode:g,LogImpl:N,LogLevel:w,Long:l,Message:y,MessageCacheStatus:P,MessageConsumer:G,MessageConsumerAcknowledgeMode:K,MessageConsumerEventName:F,MessageConsumerProperties:Y,MessageDeliveryModeType:x,MessageDumpFlag:B,MessagePublisherAcknowledgeMode:se,MessagePublisherProperties:Te,MessageRxCBInfo:ge,MessageType:H,MessageUserCosType:L,MutableSessionProperty:d,NotImplementedError:h,OperationError:T,QueueAccessType:ne,QueueBrowser:_,QueueBrowserEventName:U,QueueBrowserProperties:A,QueueDescriptor:oe,QueueDiscardBehavior:de,QueuePermissions:_e,QueueProperties:b,QueueType:X,ReplayStartLocation:z,ReplayStartLocationBeginning:J,ReplicationGroupMessageId:M,RequestError:S,RequestEventCode:C,SDTField:ae,SDTFieldType:ie,SDTMapContainer:q,SDTStreamContainer:Pe,SDTUnsupportedValueError:ve,SDTValueErrorSubcode:Qe,Session:O,SessionEvent:D,SessionEventCBInfo:Q,SessionEventCode:re,SessionProperties:ce,SessionState:me,SolclientFactory:i,SolclientFactoryProfiles:t,SolclientFactoryProperties:c,SslDowngrade:Ee,StatType:Ae,Topic:f,TransportError:ut,TransportProtocol:Ke,Version:mt,makeIterator:p,_internal:e(9850)};Object.assign(n.exports,Dt)},1880:(n,I,e)=>{const{Debug:r}=e(4092);n.exports.Debug=r},4092:(n,I,e)=>{const r=(()=>{const t=[];for(let c=0;c<256;++c)t[c]=c<33||c>126?".":String.fromCharCode(c);return t})(),i={formatDumpBytes:function(t,c,l){const{StringBuffer:u,StringUtils:o}=e(7882),{isEmpty:f,padLeft:g,padRight:h}=o;if(f(t))return null;const T=new u,S=new u,C=new u;let p=0;for(let R=0,N=t.length;R<N;++R){const w=t.charCodeAt(R);C.append(g(w.toString(16),2,"0")," "),S.append(r[w]||"."),p++,p===8&&C.append("   "),p!==16&&R!==t.length-1||(l>0&&T.append(h("",l," ")),T.append(h(C.toString(),54," ")),c&&T.append(S),T.append(`
`),C.clear(),S.clear(),p=0)}return T.toString()},parseSMFStream:function(t){const{Codec:{Decode:{decodeCompoundMessage:c}}}=e(7291),{LOG_WARN:l,LOG_ERROR:u}=e(390);if(t===null)return void u("data null in debugParseSmfStream");let o=0;for(l(`parseSMFStream(): Starting parse, length ${t.length}`);o<t.length;){const f=c(t,o),g=f?f.smfHeader:null;if(!f||!g)return l("parseSMFStream(): couldn't decode message."),void l(`Position: ${o} length: ${t.length}`);l(`>> Pos(${o}) Protocol ${g.smf_protocol}, Length: ${g.messageLength}`),o+=g.messageLength}}};n.exports.Debug=i},3170:(n,I,e)=>{const{Destination:r}=e(6798),{DestinationFromNetwork:i}=e(5527),{DestinationType:t}=e(7691),{DestinationUtil:c}=e(7493),{Parameter:l}=e(2201),{Queue:u}=e(2199),{SolclientFactory:o}=e(828),{Topic:f}=e(508);o.createTopicDestination=o.createFactory(g=>(l.isString("topicName",g),f.createFromName(g))),o.createTopic=o.createFactory(g=>new f(g)),o.createDurableQueueDestination=o.createFactory(g=>(l.isString("queueName",g),u.createFromLocalName(g))),n.exports.Destination=r,n.exports.DestinationFromNetwork=i,n.exports.DestinationType=t,n.exports.DestinationUtil=c,n.exports.Queue=u,n.exports.Topic=f},5527:(n,I,e)=>{const{DestinationType:r}=e(7691),{DestinationUtil:i}=e(7493),{Queue:t}=e(2199),{Topic:c}=e(508),l="#P2P/QUE/",u=l.length;function o(g,h){if(g===null||g.length===0)return null;const T={name:g,bytes:h||i.encodeBytes(g)};if(g[0]==="#"){if(g.startsWith(l)){const S=u;return T.name=g.substr(S),T.type=r.QUEUE,T.offset=S,new t(T)}if(g.startsWith("#P2P/QTMP/"))return T.name=g,T.type=r.TEMPORARY_QUEUE,T.offset=0,new t(T)}return new c(T)}const f={createDestinationFromBytes:function(g){return g===null||g.length===0?null:o(i.decodeBytes(g),g)},createDestinationFromName:o};n.exports.DestinationFromNetwork=f},7691:(n,I,e)=>{const{Enum:r}=e(9359),i={TOPIC:"topic",QUEUE:"queue",TEMPORARY_QUEUE:"temporary_queue"};n.exports.DestinationType=r.new(i),n.exports.DestinationType._setCanonical({TOPIC:i.TOPIC,QUEUE:i.QUEUE,TEMPORARY_QUEUE:i.TEMPORARY_QUEUE})},7493:(n,I,e)=>{const r=e(828),{Convert:i}=e(840),{DestinationType:t}=e(7691),{LOG_ERROR:c}=e(390),{SubscriptionInfo:l}=e(4133),{UUID:u,StringUtils:o}=e(7882),{ucs2ToUtf8:f,utf8ToUcs2:g}=i,{ProfileBinding:h}=r,{toSafeChars:T,stripNullTerminate:S}=o,{ErrorSubcode:C,OperationError:p}=e(3870),R={[t.QUEUE]:"#P2P/QUE/",[t.TEMPORARY_QUEUE]:"#P2P/QTMP/"};function N(H){return R[H]||""}function w(H,L){return new p(`Invalid ${H}: ${L}`,C.INVALID_TOPIC_SYNTAX)}function y(H,L,M,G=w.bind(null,H)){let K;const F=M.length;if(F<1)return K=G("Too short (must be >= 1 character)."),{error:K};const Y=L.length;if(Y>251)return K=G(`Too long (encoding must be <= 250 bytes); name is ${Y-1} bytes: '${M}'`),{error:K};let _=!1;M.charAt(F-1)===">"&&(_=!0);for(let U=0;U<F;++U)switch(M.charAt(U)){case"/":if(U===0||U===F-1||M.charAt(U-1)==="/")return K=G(`Empty level(s) in '${M}'@${U}.`),{error:K};break;case"*":if(U<F-1&&M.charAt(U+1)!=="/")return K=G(`Illegal wildcard(s) in '${M}'@${U}.`),{error:K};_=!0}return{isWildcarded:_}}function P(H){return h.value.topicUtf8Encode?`${f(H)}\0`:`${H}\0`}function x(H,L){const M=N(H),G=M.length,K=M+L;return{bytes:P(K),offset:G,networkName:K}}const B={createPrefix:N,createTemporaryName:function(H,L,M){const G=M||u.generateUUID();switch(H){case t.TOPIC:return`#P2P/TTMP/${L}/${G}`;case t.TEMPORARY_QUEUE:return`#P2P/QTMP/${L}/${G}`;default:c("Unknown/invalid destination type",t.describe(H))}},decodeBytes:function(H){return S(h.value.topicUtf8Encode?g(H):H)},encode:x,encodeBytes:P,legacyValidate:y,toSafeChars:T,validateAndEncode:function(H,L,M=w.bind(null,H)){const{bytes:G,offset:K}=x(H,L),{error:F,isWildcarded:Y}=y(H,G,L,M);let _=F,U={};if(U.isWildcarded=Y,_||Object.keys(R).some(A=>{const z=R[A];return!!L.startsWith(z)&&(_=M(`Reserved prefix '${z}' found at start of '${L}'`),!0)}),!_){const{error:A,subInfo:z}=l.parseFromName(L,H);_=A,U=z}return{bytes:G,offset:K,error:_,isWildcarded:Y,subscriptionInfo:U}}};n.exports.DestinationUtil=B},6798:(n,I,e)=>{var r=e(9489);const{DestinationType:i}=e(7691),{DestinationUtil:t}=e(7493);class c{constructor(u,o=i.TOPIC){if(typeof u=="object")this._name=u.name,this._type=u.type,this._bytes=u.bytes,this._offset=u.offset,u.isValidated?(this._isValidated=!0,this._isWildcarded=u.isWildcarded,this._subscriptionInfo=u.subscriptionInfo||{}):(this._isValidated=!1,this._subscriptionInfo={});else{this._name=u,this._type=o;const f=t.encode(o,u);this._bytes=f.bytes,this._offset=f.offset,this._isValidated=!1,this._subscriptionInfo={}}}getName(){return this._name}get name(){return this.getName()}getType(){return this._type}get type(){return this.getType()}getBytes(){return this._bytes}get bytes(){return this.getBytes()}getOffset(){return this._offset}get offset(){return this.getOffset()}validate(){if(this._isValidated){if(this._error)throw this._error;return}const{error:u,isWildcarded:o}=t.legacyValidate(this.type,this.bytes,this.name);if(this._isValidated=!0,u)throw this._error=u,u;this._isWildcarded=o}isWildcarded(){return this.validate(),this._isWildcarded}getSubscriptionInfo(){return this._subscriptionInfo||{}}toString(){return r(this)}equals(u){return u instanceof c&&this.toString().valueOf()===u.toString().valueOf()}}n.exports.Destination=c},2199:(n,I,e)=>{const r=e(7493),{assert:i}=e(9359),{Destination:t}=e(6798),{DestinationType:c}=e(7691);class l extends t{constructor(o){i(o.name,"Queue name not supplied"),i(o.type===c.QUEUE||o.type===c.TEMPORARY_QUEUE,"Queue spec.type is invalid"),i(o.bytes,"Queue spec missing bytes"),i(o.offset!==void 0,"Queue spec missing offset"),super(o)}getOffset(){return this._offset}get offset(){return this.getOffset()}inspect(){return`[Queue ${this.getName()}]`}static createFromLocalName(o){const f=r.DestinationUtil.validateAndEncode(c.QUEUE,o);if(f.error)throw f.error;return new l({name:o,type:c.QUEUE,isValidated:!0,bytes:f.bytes,offset:f.offset,isWildcarded:f.isWildcarded,subscriptionInfo:f.subscriptionInfo})}}n.exports.Queue=l},4133:(n,I,e)=>{var r=e(9489);const{DestinationType:i}=e(7691),{ErrorSubcode:t,OperationError:c}=e(3870),l={[i.TOPIC]:{_layers:[function(f,g,h,T,S){const C="#noexport/",p=C.length;let R=T;return g.length-R>p&&!S.isNoExport&&g.startsWith(C,R)?(R+=p,S.isNoExport=!0):S.isNoExport=!1,{error:void 0,index:R,result:S}},function(f,g,h,T,S,C){const p="#share/",R=p.length,N=1;let w,y,P=T,x=-1;return g.length-P>R&&!S.isShare&&g.startsWith(p,T)&&g.length-(P+R)>N+1?(P+=R,x=P,P=g.indexOf("/",x),P>0?(y=g.substring(x,P),P+=N,S.isShare=!0,S.shareGroup=y,S.dispatchTopicIndex=P):(w=C(`Illegal share Group in '${g}'@${x}.`),S.isShare=!0)):S.isShare=!1,{error:w,index:P,result:S}}],parse:function(f,g,h,T,S){const{error:C,result:p}=function(R,N,w,y,P,x){const B=R.length||0;let H,L=0,M=P||{};for(let G=0;G<B;++G){const{error:K,index:F,result:Y}=R[G](N,w,y,L,M,x);if(L=F,M=Y,H=K,H)break}return{error:H,result:M}}(this._layers,f,g,h,T,S);return{error:C,result:p}}}};function u(f,g){return new c(`Invalid ${f}: ${g}`,t.INVALID_TOPIC_SYNTAX)}class o{constructor(g){this._name=g,this._isShare=!1,this._isNoExport=!1,this._dispatchTopicIndex=-1,this._shareGroup=null}getName(){return this._name}get name(){return this.getName()}get isShare(){return this._isShare}set isShare(g){this._isShare=g}get isNoExport(){return this._isNoExport}set isNoExport(g){this._isNoExport=g}get dispatchTopicIndex(){return this._dispatchTopicIndex<0?0:this._dispatchTopicIndex}set dispatchTopicIndex(g){this._dispatchTopicIndex=g<0?-1:g}get shareGroup(){return this.isShare?this._shareGroup:null}set shareGroup(g){this.isShare&&(this._shareGroup=g)}toString(){return r(this)}static parseFromName(g,h=i.TOPIC){let T=new o(g),S=null;const C=l[h];if(C){const{error:p,result:R}=C.parse(h,g,null,T,u.bind(null,h));T=R,S=p}return{error:S,subInfo:T}}}n.exports.SubscriptionInfo=o},508:(n,I,e)=>{const r=e(7493),{Destination:i}=e(6798),{DestinationType:t}=e(7691);class c extends i{constructor(u){typeof u=="object"?super({type:t.TOPIC,name:u.name,bytes:u.bytes,offset:u.offset,isValidated:u.isValidated,isWildcarded:u.isWildcarded,subscriptionInfo:u.subscriptionInfo}):super(u,t.TOPIC)}inspect(){return`[Topic ${this.getName()}]`}static createFromName(u){const o=r.DestinationUtil.validateAndEncode(t.TOPIC,u);if(o.error)throw o.error;return new c({name:u,isValidated:!0,bytes:o.bytes,offset:o.offset,isWildcarded:o.isWildcarded,subscriptionInfo:o.subscriptionInfo})}}n.exports.Topic=c},5470:(n,I,e)=>{function r(i){throw new Error("Test environment will not override build environment")}r.target=()=>r(),n.exports=r},3870:(n,I,e)=>{const{ErrorResponseSubcodeMapper:r}=e(8976),{ErrorSubcode:i}=e(2662),{NotImplementedError:t}=e(2227),{OperationError:c}=e(6177),{RequestError:l}=e(7904),{RequestEventCode:u}=e(4170),{SolaceError:o}=e(4006);n.exports.ErrorResponseSubcodeMapper=r,n.exports.ErrorSubcode=i,n.exports.NotImplementedError=t,n.exports.OperationError=c,n.exports.RequestError=l,n.exports.RequestEventCode=u,n.exports.SolaceError=o},8976:(n,I,e)=>{const{ErrorSubcode:r}=e(2662),{makeMap:i}=e(9359),t=r,c=i(400,i("client name parse error",t.CLIENT_NAME_INVALID,"document is too large",t.MESSAGE_TOO_LARGE,"inactivity timeout",t.INACTIVITY_TIMEOUT,"max num subscriptions exceeded",t.SUBSCRIPTION_TOO_MANY,"message too long",t.MESSAGE_TOO_LARGE,"nolocal discard",t.NOLOCAL_DISCARD,"not enough space",t.OUT_OF_RESOURCES,"subscription already exists",t.SUBSCRIPTION_ALREADY_PRESENT,"subscription attributes conflict with existing subscription",t.SUBSCRIPTION_ATTRIBUTES_CONFLICT,"subscription not found",t.SUBSCRIPTION_NOT_FOUND,"subscription parse error",t.SUBSCRIPTION_INVALID,"topic parse error",t.INVALID_TOPIC_SYNTAX,"unknown transport session identifier",t.UNKNOWN_TRANSPORT_SESSION_ID,"xml parse error",t.XML_PARSE_ERROR,"unsupported ssl downgrade value",t.LOGIN_FAILURE),401,i("",t.LOGIN_FAILURE),403,i("basic authentication is shutdown",t.BASIC_AUTHENTICATION_IS_SHUTDOWN,"client certificate authentication is shutdown",t.CLIENT_CERTIFICATE_AUTHENTICATION_IS_SHUTDOWN,"client name already in use",t.CLIENT_NAME_ALREADY_IN_USE,"client username is shutdown",t.CLIENT_USERNAME_IS_SHUTDOWN,"dynamic clients not allowed",t.DYNAMIC_CLIENTS_NOT_ALLOWED,"invalid virtual router address",t.INVALID_VIRTUAL_ADDRESS,"forbidden",t.CLIENT_ACL_DENIED,"message vpn not allowed",t.MESSAGE_VPN_NOT_ALLOWED,"publish acl denied",t.PUBLISH_ACL_DENIED,"replication is standby",t.REPLICATION_IS_STANDBY,"selector does not match",t.SELECTOR_DOES_NOT_MATCH,"subscription acl denied",t.SUBSCRIPTION_ACL_DENIED,"subscription does not match",t.SUBSCRIPTION_DOES_NOT_MATCH,"compression is shutdown",t.LOGIN_FAILURE,"shared subscriptions not supported on topic endpoints",t.SHARED_SUBSCRIPTIONS_ENDPOINT_NOT_ALLOWED,"shared subscriptions not supported on queues",t.SHARED_SUBSCRIPTIONS_ENDPOINT_NOT_ALLOWED,"shared subscription permission denied",t.SHARED_SUBSCRIPTIONS_NOT_ALLOWED),404,i("",t.LOGIN_FAILURE),503,i("low priority msg congestion",t.LOW_PRIORITY_MSG_CONGESTION,"message vpn unavailable",t.MESSAGE_VPN_UNAVAILABLE,"replication is standby",t.REPLICATION_IS_STANDBY,"service unavailable",t.GM_UNAVAILABLE,"spool over quota",t.SPOOL_OVER_QUOTA,"subscriber delete in progress",t.CLIENT_DELETE_IN_PROGRESS,"too many clients",t.TOO_MANY_CLIENTS,"too many connections for vpn",t.TOO_MANY_CLIENTS,"max message usage exceeded",t.MAX_MESSAGE_USAGE_EXCEEDED),507,i("ad not ready",t.GM_NOT_READY)),l=i("PARENT",c,400,i("already bound",t.ALREADY_BOUND,"endpoint already exists",t.ENDPOINT_ALREADY_EXISTS,"subscription already exists",t.SUBSCRIPTION_ALREADY_PRESENT,"already exists",t.ENDPOINT_ALREADY_EXISTS,"endpoint property mismatch",t.ENDPOINT_PROPERTY_MISMATCH,"invalid durable topic endpoint name",t.INVALID_DTE_NAME,"invalid selector",t.INVALID_SELECTOR,"invalid topic name",t.INVALID_TOPIC_NAME_FOR_TOPIC_ENDPOINT,"queue not found",t.QUEUE_NOT_FOUND,"quota out of range",t.QUOTA_OUT_OF_RANGE,"unknown flow name",t.UNKNOWN_FLOW_NAME,"unsubscribe not allowed",t.UNSUBSCRIBE_NOT_ALLOWED_CLIENTS_BOUND),403,i("permission not allowed",t.PERMISSION_NOT_ALLOWED,"client initiated replay not allowed on non-exclusive topic endpoint",t.CLIENT_INITIATED_REPLAY_NON_EXCLUSIVE_NOT_ALLOWED,"client initiated replay not allowed on non-exclusive queue",t.CLIENT_INITIATED_REPLAY_NON_EXCLUSIVE_NOT_ALLOWED,"client initiated replay from inactive flow not allowed",t.CLIENT_INITIATED_REPLAY_INACTIVE_FLOW_NOT_ALLOWED,"client initiated replay from browser flow not allowed",t.CLIENT_INITIATED_REPLAY_BROWSER_FLOW_NOT_ALLOWED,"replay not supported on temporary topic endpoint",t.REPLAY_TEMPORARY_NOT_SUPPORTED,"replay not supported on temporary queue",t.REPLAY_TEMPORARY_NOT_SUPPORTED,"replay not supported on anonymous queue",t.REPLAY_ANONYMOUS_QUEUE_NOT_SUPPORTED,"unknown start location type",t.UNKNOWN_START_LOCATION_TYPE,"mismatched endpoint error id",t.MISMATCHED_ENDPOINT_ERROR_ID,"replay start message unavailable",t.REPLAY_START_MESSAGE_NOT_AVAILABLE),503,i("durable topic endpoint shutdown",t.TOPIC_ENDPOINT_SHUTDOWN,"endpoint shutdown",t.TOPIC_ENDPOINT_SHUTDOWN,"max clients exceeded for durable topic endpoint",t.MAX_CLIENTS_FOR_TE,"max clients exceeded for queue",t.MAX_CLIENTS_FOR_QUEUE,"no more non-durable queue or topic endpoint",t.NO_MORE_NON_DURABLE_QUEUE_OR_TOPIC_ENDPOINT,"no subscription match",t.NO_SUBSCRIPTION_MATCH,"queue shutdown",t.QUEUE_SHUTDOWN,"te shutdown",t.TOPIC_ENDPOINT_SHUTDOWN,"unknown durable topic endpoint",t.UNKNOWN_TOPIC_ENDPOINT_NAME,"unknown queue",t.UNKNOWN_QUEUE_NAME,"replay disabled",t.REPLAY_DISABLED,"replay cancelled",t.REPLAY_CANCELLED,"replay message unavailable",t.REPLAY_MESSAGE_UNAVAILABLE,"replay started",t.REPLAY_STARTED,"replayed message rejected by topic endpoint",t.REPLAY_MESSAGE_REJECTED,'replayed message rejected by queue"',t.REPLAY_MESSAGE_REJECTED,"replay log modified",t.REPLAY_LOG_MODIFIED,"mismatched endpoint error id",t.MISMATCHED_ENDPOINT_ERROR_ID,"out of replay resources",t.OUT_OF_REPLAY_RESOURCES,"topic or selector modified on durable topic endpoint",t.TOPIC_OR_SELECTOR_MODIFIED_ON_DURABLE_TOPIC_ENDPOINT,"replay failed",t.REPLAY_FAILED,"replay start time not available",t.REPLAY_START_TIME_NOT_AVAILABLE,"replay start message unavailable",t.REPLAY_START_MESSAGE_NOT_AVAILABLE));function u(g,h,T){if(h===200)return 0;const S=g[h]||{},C=(T||"").toLowerCase(),p=Object.keys(S).find(R=>R===C||C.indexOf(R)>=0);return p?S[p]:S[""]?S[""]:g.PARENT?u(g.PARENT,h,T):void 0}function o(g,h,T){const S=u(g,h,T);return S===void 0?t.UNKNOWN_ERROR:S}const f={getErrorSubcode:(g,h)=>o(c,g,h),getADErrorSubcode:(g,h)=>o(l,g,h)};n.exports.ErrorResponseSubcodeMapper=f},2662:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.ErrorSubcode=r.new({UNKNOWN_ERROR:4294967295,NO_ERROR:0,SESSION_NOT_CONNECTED:2,INVALID_SESSION_OPERATION:3,INVALID_OPERATION:3,TIMEOUT:4,MESSAGE_VPN_NOT_ALLOWED:5,MESSAGE_VPN_UNAVAILABLE:6,CLIENT_USERNAME_IS_SHUTDOWN:7,DYNAMIC_CLIENTS_NOT_ALLOWED:8,CLIENT_NAME_ALREADY_IN_USE:9,CLIENT_NAME_INVALID:10,CLIENT_DELETE_IN_PROGRESS:11,TOO_MANY_CLIENTS:12,LOGIN_FAILURE:13,INVALID_VIRTUAL_ADDRESS:14,CLIENT_ACL_DENIED:15,SUBSCRIPTION_ACL_DENIED:16,PUBLISH_ACL_DENIED:17,PARAMETER_OUT_OF_RANGE:18,PARAMETER_CONFLICT:19,PARAMETER_INVALID_TYPE:20,INTERNAL_ERROR:21,INSUFFICIENT_SPACE:22,OUT_OF_RESOURCES:23,PROTOCOL_ERROR:24,COMMUNICATION_ERROR:25,KEEP_ALIVE_FAILURE:26,TOPIC_MISSING:28,INVALID_TOPIC_SYNTAX:31,MESSAGE_TOO_LARGE:32,XML_PARSE_ERROR:33,SUBSCRIPTION_ALREADY_PRESENT:34,SUBSCRIPTION_NOT_FOUND:35,SUBSCRIPTION_INVALID:36,SUBSCRIPTION_ERROR_OTHER:37,SUBSCRIPTION_TOO_MANY:38,SUBSCRIPTION_ATTRIBUTES_CONFLICT:39,NO_LOCAL_NOT_SUPPORTED:40,DATA_ERROR_OTHER:42,CREATE_XHR_FAILED:43,CONNECTION_ERROR:44,DATA_DECODE_ERROR:45,INACTIVITY_TIMEOUT:46,UNKNOWN_TRANSPORT_SESSION_ID:47,AD_MESSAGING_NOT_SUPPORTED:48,CREATE_WEBSOCKET_FAILED:49,REPLICATION_IS_STANDBY:50,BASIC_AUTHENTICATION_IS_SHUTDOWN:51,CLIENT_CERTIFICATE_AUTHENTICATION_IS_SHUTDOWN:52,GM_UNAVAILABLE:100,UNKNOWN_FLOW_NAME:111,ALREADY_BOUND:112,INVALID_TOPIC_NAME_FOR_TOPIC_ENDPOINT:113,UNKNOWN_QUEUE_NAME:114,UNKNOWN_TOPIC_ENDPOINT_NAME:115,MAX_CLIENTS_FOR_QUEUE:116,MAX_CLIENTS_FOR_TE:117,UNEXPECTED_UNBIND:118,QUEUE_NOT_FOUND:119,SPOOL_OVER_QUOTA:120,QUEUE_SHUTDOWN:121,TOPIC_ENDPOINT_SHUTDOWN:122,NO_MORE_NON_DURABLE_QUEUE_OR_TOPIC_ENDPOINT:123,ENDPOINT_ALREADY_EXISTS:124,PERMISSION_NOT_ALLOWED:125,INVALID_SELECTOR:126,MAX_MESSAGE_USAGE_EXCEEDED:127,ENDPOINT_PROPERTY_MISMATCH:128,NO_SUBSCRIPTION_MATCH:129,MESSAGE_DELIVERY_MODE_MISMATCH:130,MESSAGE_ALREADY_ACKNOWLEDGED:131,SUBSCRIPTION_DOES_NOT_MATCH:133,SELECTOR_DOES_NOT_MATCH:134,INVALID_DTE_NAME:135,UNSUBSCRIBE_NOT_ALLOWED_CLIENTS_BOUND:136,CALLBACK_ERROR:137,NOLOCAL_DISCARD:138,GM_NOT_READY:140,LOW_PRIORITY_MSG_CONGESTION:141,QUOTA_OUT_OF_RANGE:142,FAILED_LOADING_TRUSTSTORE:143,FAILED_LOADING_CERTIFICATE_AND_KEY:144,UNRESOLVED_HOSTS:145,REPLAY_NOT_SUPPORTED:146,REPLAY_DISABLED:147,CLIENT_INITIATED_REPLAY_NON_EXCLUSIVE_NOT_ALLOWED:148,CLIENT_INITIATED_REPLAY_INACTIVE_FLOW_NOT_ALLOWED:149,CLIENT_INITIATED_REPLAY_BROWSER_FLOW_NOT_ALLOWED:150,REPLAY_TEMPORARY_NOT_SUPPORTED:151,UNKNOWN_START_LOCATION_TYPE:152,REPLAY_CANCELLED:153,REPLAY_MESSAGE_UNAVAILABLE:154,REPLAY_START_TIME_NOT_AVAILABLE:155,REPLAY_MESSAGE_REJECTED:156,REPLAY_LOG_MODIFIED:157,MISMATCHED_ENDPOINT_ERROR_ID:158,OUT_OF_REPLAY_RESOURCES:159,TOPIC_OR_SELECTOR_MODIFIED_ON_DURABLE_TOPIC_ENDPOINT:160,REPLAY_FAILED:161,REPLAY_STARTED:162,COMPRESSED_TLS_NOT_SUPPORTED:163,SHARED_SUBSCRIPTIONS_NOT_SUPPORTED:164,SHARED_SUBSCRIPTIONS_NOT_ALLOWED:165,SHARED_SUBSCRIPTIONS_ENDPOINT_NOT_ALLOWED:166,REPLAY_START_MESSAGE_NOT_AVAILABLE:167,MESSAGE_ID_NOT_COMPARABLE:168,REPLAY_ANONYMOUS_QUEUE_NOT_SUPPORTED:169})},2227:(n,I,e)=>{const{SolaceError:r}=e(4006);class i extends r{constructor(c){super("NotImplementedError",c||"",i)}}n.exports.NotImplementedError=i},6177:(n,I,e)=>{const{SolaceError:r}=e(4006);class i extends r{constructor(c,l,u){super("OperationError",c,i),this.subcode=l,this.reason=u}}n.exports.OperationError=i},7904:(n,I,e)=>{var r=e(9489);const{ErrorSubcode:i}=e(2662),{OperationError:t}=e(6177),{RequestEventCode:c}=e(4170),l={[c.REQUEST_ABORTED]:i.SESSION_NOT_CONNECTED,[c.REQUEST_TIMEOUT]:i.TIMEOUT};n.exports.RequestError=class extends t{constructor(u,o,f,g){super(u,l[o],g),this.name="RequestError",this._eventCode=o,this._correlationKey=f}get requestEventCode(){return this._requestEventCode}get errorSubcode(){return super.subcode}inspect(){const u=super.inspect?super.inspect():{};return Object.assign(u,{requestEventCode:c.describe(this.requestEventCode),infoStr:this.infoStr,correlationKey:this.correlationKey})}toString(){return r(this)}}},4170:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.RequestEventCode=r.new({REQUEST_ABORTED:8,REQUEST_TIMEOUT:9})},4006:n=>{class I extends Error{constructor(r,i,t){super(i||""),this.message=i,this.name=r,Error.captureStackTrace?Error.captureStackTrace(this,t):this.stack=new Error().stack}}n.exports.SolaceError=I},9359:(n,I,e)=>{const{ArrayOperations:r}=e(7727),{assert:i}=e(9729),{BidiMap:t}=e(2509),{Enum:c}=e(4427),{Iterator:l}=e(123),{Lazy:u}=e(809),{makeMap:o}=e(3925),{Mixin:f}=e(7597),{Resolver:g}=e(1207),{SetOperations:h}=e(6679);n.exports.assert=i,n.exports.ArrayOperations=r,n.exports.BidiMap=t,n.exports.Enum=c,n.exports.Iterator=l,n.exports.Lazy=u,n.exports.makeIterator=l.makeIterator,n.exports.makeMap=o,n.exports.Mixin=f,n.exports.mixin=f.mixin,n.exports.Resolver=g,n.exports.resolve=g.resolve,n.exports.SetOperations=h},7727:n=>{function I(e,r){const i=String(e),t=String(r);return i>t?1:i<t?-1:0}n.exports={ArrayOperations:{defaultComparator:I,insertOrdered:function(e,r,i=I){const t=[...e];return this.inplaceInsertOrdered(t,r,i)},inplaceInsertOrdered:function(e,r,i=I){let t=0,c=0,l=e.length;if(l>0)if(i(r,e[l-1])>0)t=l;else for(t=c+l>>1;l>c;)i(r,e[t])<0?l=t:c=t+1,t=c+l>>1;e.splice(t,0,r)}}}},9729:n=>{let I;I=()=>{},n.exports.assert=I},2509:n=>{n.exports.BidiMap=class{constructor(...I){this.forward=new Map,this.reverse=new Map,I.forEach(e=>{this.setValues(e[0],e[1])})}setValues(I,e){this.forward.set(I,e),this.reverse.set(e,I)}}},4427:n=>{function I(r,i,t){const c=i.filter(l=>r[l]===t);return c.length?c[0]:null}class e{constructor(i){Object.defineProperties(this,{_canonical:{value:null,enumerable:!1,writable:!0,configurable:!0}}),this._setCanonical(i)}_setCanonical(i,t=!1){this._canonical=Object.assign({},i),Object.keys(this).forEach(c=>{const l=Object.getOwnPropertyDescriptor(this,c);l.value!==void 0&&Object.defineProperty(this,c,{enumerable:!1,writable:!0,configurable:!0,value:l.value})}),Object.keys(i).forEach(c=>{Object.defineProperty(this,c,{enumerable:!0,writable:!t,configurable:!t,value:i[c]})})}describe(i,t="<none>",c="<unknown>"){if(i==null)return t;const l=I(this._canonical,Object.keys(this._canonical||{}),i)||c;return l===i?l:`${l} (${i})`}nameOf(i){return I(this._canonical,Object.keys(this._canonical||{}),i)}get names(){return Object.keys(this._canonical||{})}get values(){return i=this._canonical,t=Object.keys(this._canonical||{}),Array.from(new Set(t.map(c=>i[c])));var i,t}get isEnum(){return!0}static nameOf(i,t){return i.nameOf(t)}static values(i){return i.values()}static new(i){return new e(i)}static ofStrings(i){const t={};return i.forEach(c=>{t[c]=c}),e.new(t)}static ofNumbers(i){const t={};return i.forEach((c,l)=>{t[c]=l}),e.new(t)}}n.exports.Enum=e},123:n=>{class I{constructor(r,i=0,t=r.length){this._arr=r,this._index=i,this._end=t}deref(){return this._arr[this._index]}incr(){return++this._index}end(){return this._index>=this._end}static makeIterator(r,i=0,t=r.length){return new I(r,i,t)}}n.exports.Iterator=I},809:n=>{const I={enumerable:!0};function e(t,c,l,u=null){Object.defineProperty(t,c,Object.assign({value:l},I,u))}function r(t,c,l){return Object.defineProperty(t,c,Object.assign({configurable:!0,get:()=>{const u=l(t,c);return e(t,c,u),u},set:u=>{e(t,c,u)}},I)),t}const i={lazyProperties:function(t,c){return Object.keys(c).forEach(l=>{r(t,l,c[l])}),c},lazyProperty:r,lazyValue:function(t){return r({},"value",t)}};n.exports.Lazy=i},3925:n=>{n.exports.makeMap=function(...I){const e={};for(let r=0;r<I.length;r+=2)e[I[r]]=I[r+1];return e}},7597:n=>{const I={mixin:function(e,r){const i=e.prototype,t=r.prototype;return Object.getOwnPropertyNames(t).forEach(c=>{c!=="constructor"&&Object.defineProperty(i,c,Object.getOwnPropertyDescriptor(t,c))}),e}};n.exports.Mixin=I},1207:(n,I,e)=>{const{Lazy:r}=e(809),{lazyProperty:i}=r;class t{constructor(l,u){Object.keys(l).forEach(o=>{o.split(",").map(f=>f.trim()).forEach(f=>{const g=l[o],h=typeof g=="string"?g.split("."):g,T=(Array.isArray(h)?h:[h]).concat(f);i(this,f,()=>function(S,C,p){return p.reduce((R,N)=>typeof N=="string"?R[N]:N,C)}(0,this,T))})})}static resolve(l,u){return new t(l,u)}}n.exports.Resolver=t},6679:n=>{function I(e,r){return r.forEach(i=>{e.add(i)}),e}n.exports={SetOperations:{inplaceDifference:function(e,r){return r.forEach(i=>{e.delete(i)}),e},inplaceIntersection:function(e,r){return e.forEach(i=>{r.has(i)||e.delete(i)}),e},inplaceUnion:I,isSuperset:function(e,r){return Array.from(r).every(i=>e.has(i))},difference:function(e,r){return new Set(Array.from(e).filter(i=>!r.has(i)))},intersection:function(e,r){return new Set(Array.from(e).filter(i=>r.has(i)))},union:function(e,r){return I(new Set(e),r)}}}},7758:(n,I,e)=>{const{EventEmitter:r}=e(5571),{Timer:i}=e(1028);n.exports={EventEmitter:r,Timer:i}},5571:(n,I,e)=>{const r=e(4370).EventEmitter,{ArrayUtils:i}=e(7882),{ErrorSubcode:t,OperationError:c}=e(3870),{LOG_WARN:l}=e(390),{flatten:u,includes:o}=i,f=["error","newListener","removeListener"],g=["newListener","removeListener"],h={ignore(){},fail(){throw new Error("Emitter disabled")}};n.exports.EventEmitter=class extends r{constructor(T){super();const{direct:S,emits:C,unsafe:p,formatEventName:R}=T||{};this.formatEventName=R||(w=>w);const N=this.emit.bind(this);this._installDirectFilter(S,N),this._installErrorHandlers(p),this._installEmitVerifier(),this._listenerVerificationFilter=function(w){if(typeof w=="function")return x=>o(f,x)||w(x);if(!Array.isArray(w))return null;const y=new Set(u(w));f.forEach(x=>y.add(x));const P=Array.from(y);return x=>o(P,x)}(C),this._emits=C}_installDirectFilter(T,S){if(T){if(o(g,T))throw new c(`Cannot configure listener collection events [${g.join(", ")}] as direct`,t.INTERNAL_ERROR);this._defaultEmitDirect=(...C)=>S(T,...C),this.emitDirect=this._defaultEmitDirect,this._directEventName=T,this.on=(C,p)=>{this._verifyListenerEvent(C);const R=super.on(C,p);return this._setEmitDirect(C,!0,p),R},this.addListener=(C,p)=>this.on(C,p),this.once=(C,p)=>{this._verifyListenerEvent(C);const R=super.once(C,p);return this._setEmitDirect(C,!1),R},this.prependListener=(C,p)=>{this._verifyListenerEvent(C);const R=super.prependListener(C,p);return this._setEmitDirect(C,!0,p),R},this.prependOnceListener=(C,p)=>{this._verifyListenerEvent(C);const R=super.prependOnceListener(C,p);return this._setEmitDirect(C,!1),R},this.removeAllListeners=C=>{const p=super.removeAllListeners(C);return C!==this._directEventName&&C!==void 0||(this.emitDirect=this._defaultEmitDirect),p},this.removeListener=(C,p)=>{const R=super.removeListener(C,p);return C===this._directEventName&&this.listenerCount(C)===0&&(this.emitDirect=this._defaultEmitDirect),R},this.directListenerCount=()=>this.listenerCount(this._directEventName),this.setOnFirstDirectListener=C=>{this._onFirstDirectListener=C}}}_setEmitDirect(T,S,C){T===this._directEventName&&(S&&this.directListenerCount()===1?this.emitDirect=C:this.emitDirect=this._defaultEmitDirect,this.directListenerCount()===1&&this._onFirstDirectListener!==void 0&&this._onFirstDirectListener())}_verifyListenerEvent(T){this._listenerVerificationFilter&&(T==null&&this.throwInternal(new c(`Emitter rejects listener for no-name event: ${T}`,t.PARAMETER_OUT_OF_RANGE)),this._listenerVerificationFilter(T)||this.throwInternal(new c(`Emitter rejects listeners for ${T}, emits ${this._emits}`,t.PARAMETER_OUT_OF_RANGE)))}_installEmitVerifier(){}_installErrorHandlers(T){if(T)return void(this.throwInternal=C=>{throw C});const S=this.emit.bind(this);this.throwInternal=function(C){throw this._internalError=!0,C},this.emit=(C,...p)=>{try{S(C,...p)}catch(R){if(this._internalError)throw this._internalError=void 0,R;const N=this.formatErrorEvent(R,C,...p);try{l(`Listener for '${N.info.event.formattedName}' threw exception, dispatching to 'error'`),S("error",N)}catch(w){l("Listener for 'error' threw exception:",w,`
Original exception:`,R)}}}}get isDirect(){return this.emitDirect&&this.emitDirect!==this._defaultEmitDirect}formatErrorEvent(T,S,...C){const p=this.formatEventName(S);return Object.assign(new c(`Unhandled error in event handler for '${p}'`,t.CALLBACK_ERROR,`On event: ${[S,...C]} ${T}`),{stack:T.stack,info:{event:{name:S,formattedName:p,args:C},error:T}})}disableEmitter(){this._defaultEmitDirect=h.ignore,this.removeAllListeners(),this.emit=h.ignore,this.addListener("removeListener",h.fail),this.addListener("newListener",h.fail)}}},1028:n=>{class I{constructor(r){this.cancel=()=>{this.cancel=()=>{},r()}}static newInterval(r,i,...t){const c=setInterval(i,r,...t);return new I(()=>clearInterval(c))}static newTimeout(r,i,...t){const c=setTimeout(i,r,...t);return new I(()=>clearTimeout(c))}}n.exports.Timer=I},828:(n,I,e)=>{const{FactoryProfile:r,SolclientFactoryProfiles:i}=e(1777),{ProfileBinding:t}=e(3794),{SolclientFactory:c}=e(9016),{SolclientFactoryProperties:l}=e(3543);n.exports.FactoryProfile=r,n.exports.ProfileBinding=t,n.exports.SolclientFactoryProfiles=i,n.exports.SolclientFactoryProperties=l,n.exports.SolclientFactory=c},3794:(n,I,e)=>{const{OperationError:r}=e(3870);let i=null;const t={get value(){if(i===null)throw new r("Profile binding not initialized. Call solace.SolclientFactory.init");return i},set value(c){i=c}};n.exports.ProfileBinding=t},1777:(n,I,e)=>{var r=e(9489);class i{get guaranteedMessagingEnabled(){}get cometEnabled(){}get topicUtf8Encode(){}get byteArrayAsString(){}inspect(){return{guaranteedMessagingEnabled:this.guaranteedMessagingEnabled,cometEnabled:this.cometEnabled,topicUtf8Encode:this.topicUtf8Encode,byteArrayAsString:this.byteArrayAsString}}toString(){return r(this)}}const t=new class extends i{get guaranteedMessagingEnabled(){return!1}get cometEnabled(){return!0}get topicUtf8Encode(){return!1}get byteArrayAsString(){return!0}},c=new class extends i{get guaranteedMessagingEnabled(){return!0}get cometEnabled(){return!1}get topicUtf8Encode(){return!0}get byteArrayAsString(){return!0}},l=new class extends i{get guaranteedMessagingEnabled(){return!0}get cometEnabled(){return!1}get topicUtf8Encode(){return!0}get byteArrayAsString(){return!1}},u={_legacy:t,_v10:c,_forward:l,_default:t,version7:t,version10:c,version10_5:l,inspect(){return{version7:this.version7,version10:this.version10,version10_5:this.version10_5}},toString(){return r(this)}};n.exports.FactoryProfile=i,n.exports.SolclientFactoryProfiles=u},3543:(n,I,e)=>{var r=e(9489);const{APIProperties:i}=e(7882),{Check:t}=e(2201);function c(){const{LogLevel:l}=e(390);return l.INFO}n.exports.SolclientFactoryProperties=class extends i{constructor(l){super({logLevel:c(),logger:null},l)}get profile(){return this._profile}set profile(l){this._profile=l}get logLevel(){return t.number(this._logLevel)?this._logLevel:c()}set logLevel(l){this._logLevel=l}get logger(){return this._logger||null}set logger(l){this._logger=l}inspect(){const{LogLevel:l}=e(390);return{logLevel:l.describe(this._logLevel),profile:this._profile}}toString(){return r(this)}}},9016:(n,I,e)=>{const{ErrorSubcode:r,OperationError:i}=e(3870),{FactoryProfile:t,SolclientFactoryProfiles:c}=e(1777),{Parameter:l}=e(2201),{ProfileBinding:u}=e(3794),{SolclientFactoryProperties:o}=e(3543),f={initializeCount:0,initializers:[]},g={addInitializer(h){f.initializers.push(h)},createFactory:h=>function(...T){if(f.initializeCount===0)throw new i("SolclientFactory not initialized",r.INVALID_OPERATION);return h(...T)},init(h){if(f.initializeCount>0)return this;const T=new o(h),S=h&&h.profile||c.version7;return l.isInstanceOf("factoryProps.profile",S,t),u.value=S,f.initializers.forEach(C=>{C.call(this,T,f)}),++f.initializeCount,h!=null&&e(390),this},reset(){f.initializeCount=0},_getInitializeCount:()=>f.initializeCount,get profiles(){return c}};n.exports.SolclientFactory=g},5370:(n,I,e)=>{const{Flow:r}=e(4741),{FlowOperation:i}=e(620),{PrivateFlowEventName:t}=e(3801);n.exports.Flow=r,n.exports.FlowOperation=i,n.exports.PrivateFlowEventName=t},620:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.FlowOperation=r.new({CONNECT:"FlowOperation_CONNECT",DISCONNECT:"FlowOperation_DISCONNECT",START:"FlowOperation_START",STOP:"FlowOperation_STOP",DISPOSE:"FlowOperation_DESTROY",GET_STATS:"FlowOperation_GET_STATS",RESET_STATS:"FlowOperation_RESET_STATS",GET_PROPERTIES:"FlowOperation_GET_PROPERTIES",GET_DESTINATION:"FlowOperation_GET_DESTINATION"})},4741:(n,I,e)=>{const{ErrorSubcode:r,NotImplementedError:i,OperationError:t}=e(3870),{EventEmitter:c}=e(7758),{FlowOperation:l}=e(620),{LogFormatter:u}=e(390),{PrivateFlowEventName:o}=e(3801),{Stats:f}=e(6818),g=[l.DISPOSE,l.GET_STATS,l.GET_PROPERTIES,l.RESET_STATS];n.exports.Flow=class extends c{constructor(h,T,S){const C=Object.assign({},S);C.emits=(C.emits||[]).concat(o.values),super(C);const p=T(this),R=this;this.logger=new u((...N)=>[`[session=${p.sessionIdHex}]`,`[flow=${R.flowIdDec}]`,...N]),this.log=this.logger.wrap(this.log,this),this._disposing=!1,this._disposed=!1,this._userDisconnected=!0,this._properties=h,this._sessionInterface=p,this._stats=new f(p),this._privateEventEmitter=new c(C)}_emit(h,...T){this._privateEventEmitter.emit(h,...T),this.emit(h,...T)}_on(h,T){this._privateEventEmitter.on(h,T)}_once(h,T){this._privateEventEmitter.once(h,T)}_removeListener(h,T){this._privateEventEmitter.removeListener(h,T)}clearStats(){this.logger,this._operationCheck(l.RESET_STATS),this._stats.resetStats()}connect(){this.logger,this.userDisconnected=!1,this._operationCheck(l.CONNECT)}dispose(){if(this.logger,this._disposed||this._disposing)return;this._operationCheck(l.DISPOSE),this._disposing=!0;const h=()=>{this._disposed=!0,this._properties=null,this._userDisconnected=!0,this._emit(this.getDisposedEvent()),this.disableEmitter(),this._privateEventEmitter.disableEmitter()};if(this._fsm._midDispatch){const T=()=>{this._fsm.terminateFsm(),h()};setTimeout(()=>T(),0)}else h()}disconnect(){this._operationCheck(l.DISCONNECT),this.logger,this.userDisconnected=!0}_disconnectSession(){this._operationCheck(l.DISCONNECT)}getDisposedEvent(){throw new i("Abstract method")}getProperties(){return this._operationCheck(l.GET_PROPERTIES),this._properties.clone()}getStat(h){return this._operationCheck(l.GET_STATS),this._stats.getStat(h)}handleUncorrelatedControlMessage(h){throw new i("Guaranteed Message Connection does not implement a control message handler",h)}incStat(h,T){this._stats.incStat(h,T)}processFSMEvent(h){this._fsm.processEvent(h)}inspect(){return{flowId:this.flowIdDec}}toString(){return this.inspect()}get canAck(){return!this.disposed}get disposed(){return this._disposed}get flowIdDec(){return this.flowId||"(N/A)"}get flowId(){return new i("Flow does not implement ID accessor")}get session(){return this._session}get userDisconnected(){return this._userDisconnecte}set userDisconnected(h){this._userDisconnected=h}_operationCheck(h){if(this.logger,l.describe(h),this._disposed)throw new t("Operation is invalid for Message Consumer in disposed state",r.INVALID_OPERATION);if(g.some(T=>T===h))return!0;if(h===l.DISCONNECT&&this._isDisconnected())throw new t("Operation is invalid for Message Consumer in disconnected state",r.INVALID_OPERATION)}_isDisconnected(){throw new i("Flow#_isDisconnected not implemented")}}},3801:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.PrivateFlowEventName=r.new({BIND_WAITING:"PrivateFlowEventName_bindWaiting"})},8535:(n,I,e)=>{const{FsmEvent:r}=e(8562),{State:i}=e(9009),{StateMachine:t}=e(4831);n.exports.FsmEvent=r,n.exports.State=i,n.exports.StateMachine=t},1786:(n,I,e)=>{const r=e(9009),{FsmObject:i}=e(4072);n.exports.EntryPoint=class extends i{constructor(t){let c;super({name:t.entryPointName}),this.impl=this.impl||{},this.impl.outerState=new r.State({name:`${t.state.getName()} outerEntryPoint: ${t.entryPointName}`,parentContext:t.state.getParent()}).initial(()=>t.state.transitionTo(c)),c=new r.State({name:`${t.state.getName()} innerEntryPoint: ${t.entryPointName}`,parentContext:t.state}).initial(t.func)}getDestState(){return this.impl.outerState}}},8562:(n,I,e)=>{const{FsmObject:r}=e(4072);n.exports.FsmEvent=class extends r{}},3828:(n,I,e)=>{const r=e(9009),{FsmObject:i}=e(4072);n.exports.ExitPoint=class extends i{constructor(t){let c;super({name:t.exitPointName}),this.impl.innerState=new r.State({name:`${t.state.getName()} innerExitPoint: ${t.exitPointName}`,parentContext:t.state}).initial(()=>t.state.transitionTo(c)),c=new r.State({name:`${t.state.getName()} outerExitPoint: ${t.exitPointName}`,parentContext:t.state.getParent()}).initial(t.func)}getDestState(){return this.impl.innerState}}},4072:(n,I,e)=>{const{OperationError:r}=e(3870);n.exports.FsmObject=class{constructor(i){if(!i)throw new r("No spec provided");if(!i.name)throw new r("No name provided for spec");this.impl={name:i.name}}toString(){let i=this.getExtraStringInfo();return i.length>0&&(i=`; ${i}`),`{${this.constructor.name}: ${this.getName()}${i}}`}getExtraStringInfo(){return""}getName(){return this.impl.name}}},4927:(n,I,e)=>{const r=e(9009),{FsmObject:i}=e(4072),{Iterator:t}=e(9359);e(390);const{makeIterator:c}=t;class l extends i{constructor(o){super(o),this.impl=this.impl||{},this.impl.logPadding=""}getStateMachine(){return this.impl.ancestorList[0]}initial(o){return this.impl.initialReaction&&this.log(`Replacing ${this} initialReaction ${this.impl.initialReaction} with ${o}`),this.impl.initialReaction=o.bind(this),this}transitionTo(o,f){return new l.ReactionResult({caller:this,destState:o,action:f})}terminate(o){return new l.ReactionResult({caller:this,destState:this.getStateMachine().getFinalState(),action:o})}getAncestorList(){return this.impl.ancestorList}log(...o){this.impl.logPadding}onInitial(o){let f;if(this.impl.initialReaction){if(this.log(`Initial: for ${this}`),f=this.impl.initialReaction(o),f.external)throw new Error(`Initial reaction for ${this} returned external transitions`);return f}if(!(this instanceof r.State))throw new Error(`Missing initial reaction for ${this}`);return this.transitionTo(this)}processReactionResult(o,f){let g=this;if(!o.destState)return this;const h=this.lowestCommonAncestor(o);for(;g!==h.deref();)g.onExit(),g=g.getParent();for(o.action&&o.action(g,f),g.log(`Action: transition to ${o.destState} in context ${g}`),h.incr();!h.end();h.incr())g=h.deref(),g.onEntry();const T=g.onInitial(f);return T.destState!==g?g.processReactionResult(T,f):g}lowestCommonAncestor(o){const f=this.impl.ancestorList,g=o.destState.getAncestorList();let h;if(f[0]!==g[0])throw new Error(`No common ancestor between (${this} in ${f[0]}) and (${o.destState} in ${g[0]})`);if(this===o.destState)h=f.length,o.external&&--h;else{for(h=1;h<f.length&&f[h]===g[h];++h);h!==f.length&&h!==g.length||o.external&&--h}return c(g,h-1)}setLogPadding(o){this.impl.logPadding=o}}l.ReactionResult=class{constructor(u){if(!(u&&u.caller&&u.caller instanceof l))throw new Error("spec.caller is required to be a StateContext");if(!u.caller.getStateMachine().isRunning())throw new Error("ReactionResult objects can only be created while processing events");if(u.destState){if(!(u.destState instanceof r.State))throw new Error("destState must be a State object");if(u.action&&typeof u.action!="function")throw new Error("action must be a function");this.destState=u.destState,this.action=u.action,this.external=u.external}}},n.exports.StateContext=l},4831:(n,I,e)=>{const{LOG_ERROR:r}=e(390),{State:i}=e(9009),{StateContext:t}=e(4927);n.exports.StateMachine=class extends t{constructor(c){if(c.parentContext)throw new Error(`State machine cannot have parent state: ${c.parentContext}`);super(c),this.impl.ancestorList=[this],this.impl.eventQueue=[],this.impl.finalState=new i({name:"impl.final",parentContext:this}),this.impl.handleUncaughtException=(l,u)=>(r(`Uncaught exception in ${this} while processing ${l}: ${u.stack}`),this.terminate())}process(c){const{impl:l}=this,{eventQueue:u}=l;if(u.push(c),l.processingEvents)return!1;for(l.processingEvents=!0;u.length;)u.shift().apply(this);return l.processingEvents=!1,this._onEventCompletion(),!0}start(){if(this.getCurrentState())throw new Error(`Cannot start ${this.getName()}; it is already started.`);this.process(()=>{const c=this.onInitial();if(c.destState===void 0)throw new Error(`Missing destination state from initial transition for ${this}`);if(c.destState===this)throw new Error(`Destination state for initial transition for ${this} cannot be the FSM.`);const l=c.destState.getAncestorList();if(l[0]!==this)throw new Error(`Invalid destination state (${c.destState}) from initial transition for state machine (${this}); destState ancestor (${l[0]})`);this.impl.currentState=this.processReactionResult(c)})}isRunning(){return this.impl.processingEvents}processEvent(c){const{impl:l}=this;this.process(()=>{let u;if(this.log(`Processing event ${c}`),l.currentState)try{u=l.currentState.handleEvent(c),l.currentState=l.currentState.processReactionResult(u,c)}catch(o){this.log(`Caught exception ${o}, continuing`),u=l.handleUncaughtException.call(l.currentState,c,o),l.currentState=l.currentState.processReactionResult(u,c)}})||this.log(`Deferring event ${c}`)}terminateFsm(){const c=this.getCurrentState();if(c){if(this.impl.processingEvents)throw new Error("Cannot terminate state machine while FSM is processing events. To terminate the FSM from within a reaction, return State~terminate() from a reaction.");this.process(()=>{const l=c.terminate();this.impl.currentState=c.processReactionResult(l)})}}setPostEventAction(c){if(!this.impl.processingEvents)throw new Error("Cannot set post event hook unless FSM is processing events.");if(!c||typeof c!="function")throw new Error(`postEventAction must be a function; got (${c})`);this.impl.postEventAction=c.bind(this)}_onEventCompletion(){const c=this.impl.postEventAction;c&&(this.impl.postEventAction=void 0,this.log("Running post event action"),c.apply(this))}getCurrentState(){return this.impl.currentState}getActiveState(c){const l=this.impl.currentState.getAncestorList();for(let u=1;u<l.length;++u)if(l[u].getName()===c)return l[u]}isStateActive(c){return this.getActiveState(c)!==void 0}unhandledEventReaction(c){if(typeof c!="function")throw new Error(`In ${this}: unhandled event reaction must be a function; got ${c}`);return this.impl.handleUnhandledEvent=c.bind(this),this}uncaughtExceptionReaction(c){if(typeof c!="function")throw new Error(`In ${this}: Uncaught exception reaction must be a function; got ${c}`);return this.impl.handleUncaughtException=c,this}getFinalState(){return this.impl.finalState}}},9009:(n,I,e)=>{const{EntryPoint:r}=e(1786),{ExitPoint:i}=e(3828),{StateContext:t}=e(4927);n.exports.State=class extends t{constructor(c,l=null){super(c);const u=c.parentContext;Object.assign(this.impl,{parentContext:u,reactions:{},entryPoints:{},exitPoints:{},ancestorList:[...u.getAncestorList(),this],handleUnhandledEvent:o=>u.handleEvent?u.handleEvent(o):u.impl.handleUnhandledEvent(o)}),u&&(this.log=u.log.bind(this)),Object.keys(l||{}).forEach(o=>{const f=l[o];this[o]=typeof f=="function"?f.bind(this):f}),this.setLogPadding(" ".repeat(this.impl.ancestorList.length))}reaction(c,l){if(!c)throw new Error("No event name for reaction");if(!l)throw new Error(`No reaction function for reaction ${c}`);return this.log(`Adding reaction to ${this} for event ${c}`),this.impl.reactions[c]&&this.log(`Replacing reaction ${this.impl.reactions[c]} with ${l}`),this.impl.reactions[c]=l.bind(this),this}entryPoint(c,l){if(!c)throw new Error("No entry point name for entry point");if(!l)throw new Error(`No reaction function for entry point ${c}`);return this.log(`Adding entryPoint ${c} to ${this}`),this.impl.entryPoints[c]?(this.log(`EntryPoint ${c} already exists in ${this}`),this):(this.impl.entryPoints[c]=new r({state:this,entryPointName:c,func:l}),this)}exitPoint(c,l){if(!c)throw new Error("No exit point name for entry point");if(!l)throw new Error(`No reaction function for exit point ${c}`);return this.log(`Adding exitPoint ${c} to ${this}`),this.impl.exitPoints[c]?(this.log(`ExitPoint ${c} already exists in  ${this}`),this):(this.impl.exitPoints[c]=new i({state:this,exitPointName:c,func:l}),this)}getEntryPointDestState(c){return this.impl.entryPoints[c]===void 0?(this.log(`${this}: EntryPoint ${c} does not exist.`),this):this.impl.entryPoints[c].getDestState()}getExitPointDestState(c){return this.impl.exitPoints[c]===void 0?(this.log(`${this}: ExitPoint ${c} does not exist.`),this):this.impl.exitPoints[c].getDestState()}entry(c){return this.impl.appEntryFunc&&this.log(`Replacing entry function ${this.impl.appEntryFunc} with ${c}`),this.impl.appEntryFunc=c.bind(this),this}exit(c){return this.impl.appExitFunc&&this.log(`Replacing exit function ${this.impl.appExitFunc} with ${c}`),this.impl.appExitFunc=c.bind(this),this}externalTransitionTo(c,l){return new t.ReactionResult({caller:this,destState:c,action:l,external:!0})}transitionToEntryPoint(c,l,u){return new t.ReactionResult({caller:this,destState:c.getEntryPointDestState(l),action:u})}transitionToExitPoint(c,l,u){return new t.ReactionResult({caller:this,destState:c.getExitPointDestState(l),action:u})}eventUnhandled(){return new t.ReactionResult({caller:this})}internalTransition(c){return new t.ReactionResult({caller:this,destState:this.getStateMachine().getCurrentState(),action:c})}terminate(c){return new t.ReactionResult({caller:this,destState:this.getStateMachine().getFinalState(),action:c})}getParent(){return this.impl.parentContext}onEntry(){this.log(`Entering: ${this}`),this.impl.appEntryFunc&&this.impl.appEntryFunc()}onExit(){this.log(`Exiting: ${this}`),this.impl.appExitFunc&&this.impl.appExitFunc()}handleEvent(c){this.log(`Process: ${c}`);const l=this.impl.reactions[c.getName()];if(l){const u=l(c);if(u||this.log(`Reaction returned undefined: ${c} in ${this}`),u.destState)return this.log(`Handled: ${c}`),u;this.log(`Unhandled: ${c} in ${this}`)}else this.log(`No reaction: ${c} in ${this}`);return this.impl.handleUnhandledEvent(c)}}},390:(n,I,e)=>{const{ConsoleLogImpl:r}=e(3893),{GlobalBinding:i}=e(8942),{LogImpl:t}=e(1669),{LogLevel:c}=e(8220),{Parameter:l}=e(2201),{SolclientFactory:u}=e(828),{isEnumMember:o,isFunction:f}=l,{getImpl:g,getLogLevel:h,setImpl:T,setLogLevel:S}=i,C={};function p(R,N){Object.keys(C).forEach(w=>{N[`LOG_${w.toUpperCase()}`]=R[w]})}Object.assign(C,{trace(...R){const N=g();N&&N.trace&&h()>=c.TRACE&&N.trace.apply(null,["solclientjs: ",...R])},debug(...R){const N=g();N&&N.debug&&h()>=c.DEBUG&&N.debug.apply(null,["solclientjs: ",...R])},info(...R){const N=g();N&&N.info&&h()>=c.INFO&&N.info.apply(null,["solclientjs: ",...R])},warn(...R){const N=g();N&&N.warn&&h()>=c.WARN&&N.warn.apply(null,["solclientjs: ",...R])},error(...R){const N=g();N&&N.error&&h()>=c.ERROR&&N.error.apply(null,["solclientjs: ",...R])},fatal(...R){const N=g();N&&N.fatal&&N.fatal.apply(null,["solclientjs: ",...R])}}),u.getLogLevel=()=>h(),u.setLogLevel=R=>{o("logLevel",R,c),S(R)},u.addInitializer(R=>{S(R.logLevel);const N=R.logger||g()||new r;Object.keys(new t).forEach(w=>f(`logger.${w}`,N[w])),T(N)}),p(C,n.exports),n.exports.LogImpl=t,n.exports.LogLevel=c,n.exports.Binding=i,n.exports.ConsoleLogImpl=r,i.setImpl(new r),n.exports.LogFormatter=class{constructor(R){this._formatter=typeof R=="function"?R:typeof R=="string"?function(...w){return[R,...w]}:R||function(...w){return[...w]};const N=this;Object.keys(C).forEach(w=>{this[w]=function(...y){return C[w].apply(null,N._formatter(...y))}}),p(this,this)}get formatter(){return this._formatter}set formatter(R){this._formatter=R}wrap(R,N){const w=this;return function(...y){return R.apply(N,w._formatter(...y))}}}},3893:(n,I,e)=>{const{LogImpl:r}=e(1669),i=()=>{};function t(c){const l=new Date,u=" ".repeat(6-c.length);let o=String(l.getFullYear()),f=String(l.getMonth()+1),g=String(l.getDate()),h=String(l.getHours()),T=String(l.getMinutes()),S=String(l.getSeconds()),C=String(l.getMilliseconds());return o="0".repeat(4-o.length)+o,f=f.length<2?`0${f}`:f,g=g.length<2?`0${g}`:g,h=h.length<2?`0${h}`:h,T=T.length<2?`0${T}`:T,S=S.length<2?`0${S}`:S,C=C.length<3?`0${C}`:C,C=C.length<3?`0${C}`:C,[`${o}-${f}-${g} ${h}:${T}:${S}.${C}`,`${c}${u}`]}n.exports.ConsoleLogImpl=class extends r{constructor(c){let l=i,u=i,o=i,f=i,g=i,h=i;const T=c||(typeof window>"u"?e.g:window).console;T&&(T.log||T.warn)&&(T.log&&T.log!==void 0?(l=Function.prototype.bind.call(T.log,T),u=Function.prototype.bind.call(T.log,T)):T.debug&&typeof T.debug=="function"&&(l=Function.prototype.bind.call(T.debug,T),u=Function.prototype.bind.call(T.debug,T)),o=T.info&&T.info!==void 0?Function.prototype.bind.call(T.info,T):Function.prototype.bind.call(T.log,T),f=T.warn&&T.warn!==void 0?Function.prototype.bind.call(T.warn,T):Function.prototype.bind.call(T.log,T),T.error&&T.error!==void 0?(g=Function.prototype.bind.call(T.error,T),h=Function.prototype.bind.call(T.error,T)):(g=Function.prototype.bind.call(T.log,T),h=Function.prototype.bind.call(T.log,T))),super((...S)=>{l(...t("TRACE"),...S)},(...S)=>{u(...t("DEBUG"),...S)},(...S)=>{o(...t("INFO"),...S)},(...S)=>{f(...t("WARN"),...S)},(...S)=>{g(...t("ERROR"),...S)},(...S)=>{h(...t("FATAL"),...S)})}}},8942:(n,I,e)=>{const{LogLevel:r}=e(8220),i={impl:null,level:r.INFO},t={getImpl:function(){return i.impl},setImpl:function(c){i.impl=c},getLogLevel:function(){return i.level},setLogLevel:function(c){i.level=c}};n.exports.GlobalBinding=t},1669:n=>{n.exports.LogImpl=class{constructor(I,e,r,i,t,c){Object.assign(this,{trace:I,debug:e,info:r,warn:i,error:t,fatal:c})}trace(){}debug(){}info(){}warn(){}error(){}fatal(){}}},8220:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.LogLevel=r.new({FATAL:0,ERROR:1,WARN:2,INFO:3,DEBUG:4,TRACE:5})},4858:(n,I,e)=>{const{ConsumerFlows:r}=e(4697),{ConsumerFSMEvent:i}=e(3120),{ConsumerFSMEventNames:t}=e(8694),{MessageConsumer:c}=e(8692),{MessageConsumerAcknowledgeMode:l}=e(544),{MessageConsumerEvent:u}=e(6203),{MessageConsumerEventName:o}=e(2235),{MessageConsumerProperties:f}=e(6334),{QueueBrowser:g}=e(1690),{QueueBrowserEventName:h}=e(2603),{QueueBrowserProperties:T}=e(1883);n.exports.ConsumerFlows=r,n.exports.ConsumerFSMEvent=i,n.exports.ConsumerFSMEventNames=t,n.exports.MessageConsumer=c,n.exports.MessageConsumerEvent=u,n.exports.MessageConsumerAcknowledgeMode=l,n.exports.MessageConsumerEventName=o,n.exports.MessageConsumerProperties=f,n.exports.QueueBrowser=g,n.exports.QueueBrowserEventName=h,n.exports.QueueBrowserProperties=T},5639:(n,I,e)=>{const{Enum:r,assert:i}=e(9359),{LOG_DEBUG:t,LOG_ERROR:c}=e(390),l=r.new({UNACKED:"UNACKED",ACKED_NOT_SENT:"ACKED_NOT_SENT",ACKED_SENT:"ACKED_SENT"});class u{constructor(f,g){f?(this.exists=!0,this.id=f,this.key=f.toString(),this.state=g||l.UNACKED):this.exists=!1}set(f,g){this.exists=!0,this.id=f,this.key=f.toString(),this.state=g||l.UNACKED}clear(){this.exists=!1,this.id=null,this.key=null,this.state=null}}Object.assign(n.exports,{ApplicationAckState:l,ApplicationAck:u,ApplicationAckRingBuffer:class{constructor(o){i(o>=2),this._size=o,this._insertIndex=0,this._buffer=Array(o).fill(null).map(()=>new u),this._index=new Map}reset(){this._insertIndex=0,this._buffer.forEach(o=>{o.exists=!1}),this._index.clear()}insert(o,f){i(f),i(o);const g=this._size,h=this._buffer,T=this._index,S=this._insertIndex;i(!h[S].exists,"Invariant not enforced (before): insert index not empty");const C=h[S];C.set(o,l.UNACKED),T.has(C.key)&&c(`Duplicate ID: ${T.get(C.key)} insertIndex: ${S}`),T.set(C.key,S);const p=h[(S+1)%g];let R;try{R=f(p.exists?p:null)}finally{this._insertIndex=(S+1)%g,p.exists&&(T.delete(p.key),p.clear())}return i(!h[this._insertIndex].exists,"Invariant not enforced (after): insert index not empty"),R}get length(){return this._index.size}front(){if(this.length===0)return null;const o=this._buffer,f=this._insertIndex,g=this._size,h=(f+1)%g;if(o[h].exists)return o[h];for(let T=h,S=h+g-1;T<=S;++T){const C=o[T%g];if(C.exists)return C}return i(this._index.size===0,"#front() failed so buffer must be empty"),null}forEach(o){if(this.length===0)return;const f=this._buffer,g=this._size;let h=0;for(let T=this._insertIndex+1,S=this._insertIndex+g;T<=S;++T){const C=f[T%g];C.exists&&o(C,h++,this)}i(h>0,"Not empty but did not dispatch")}updateAckState(o,f){const g=o.toString();i(this._index.has(g),"Ack key not found");const h=this._buffer[this._index.get(g)];i(h,"Ack key has no entry"),h.state=f}has(o){const f=o.toString();return this._index.has(f)}}})},4697:(n,I,e)=>{const{assert:r}=e(9359),{MessageConsumer:i}=e(8692),{MessageConsumerEventName:t}=e(2235);n.exports.ConsumerFlows=class{constructor(){this._allFlows=new Set,this._reconnectingFlows=new Set,this._flowsById={}}add(c){if(r(c instanceof i,"Flow was not a consumer"),this._allFlows.has(c))return c;const l=()=>{this._flowsById[c.flowId]=c},u=()=>{const f=c.flowId;this._allFlows.delete(c),this._reconnectingFlows.delete(c),this._flowsById[f]===c&&delete this._flowsById[f]},o=()=>{this._reconnectingFlows.delete(c)};return c._on(t.UP,l),c._on(t.RECONNECTED,()=>{l(),this._allFlows.add(c),this._reconnectingFlows.delete(c)}),c._on(t.DISPOSED,u),c._on(t.RECONNECTING,()=>{u(),this._reconnectingFlows.add(c)}),c._on(t.DOWN,o),c._on(t.DOWN_ERROR,o),this._allFlows.add(c),c}get flows(){return Array.from(this._allFlows)}get reconnectingFlows(){return Array.from(this._reconnectingFlows)}getFlowById(c){return this._flowsById[c]}disposeAll(){this._allFlows.forEach(c=>c.dispose())}}},8694:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.ConsumerFSMEventNames=r.new({SESSION_UP:"SESSION_UP",SESSION_UP_NO_AD:"SESSION_UP_NO_AD",SESSION_DOWN:"SESSION_DOWN",SESSION_DISCONNECT:"SESSION_DISCONNECT",FLOW_FAILED:"FLOW_FAILED",FLOW_UP:"FLOW_UP",FLOW_ACTIVE_IND:"FLOW_ACTIVE_IND",FLOW_CLOSE:"FLOW_CLOSE",FLOW_OPEN:"FLOW_OPEN",FLOW_UNBOUND:"FLOW_UNBOUND",ACK:"ACK",ACK_TIMEOUT:"ACK_TIMEOUT",BIND_TIMEOUT:"BIND_TIMEOUT",CREATE_TIMEOUT:"CREATE_TIMEOUT",UNBIND_TIMEOUT:"UNBIND_TIMEOUT",CAN_SEND:"CAN_SEND",TRANSPORT_ERROR:"TRANSPORT_ERROR",DISPOSE:"DISPOSE",VIRTUALROUTER_NAME_CHANGED:"VIRTUALROUTER_NAME_CHANGED",RECONNECT_INTERVAL_TIMEOUT:"RECONNECT_INTERVAL_TIMEOUT",BIND_RESPONSE:"BIND_RESPONSE",CREATE_FAILED:"CREATE_FAILED",CREATE_SUCCESS:"CREATE_SUCCESS"})},3120:(n,I,e)=>{const{FsmEvent:r}=e(8535);n.exports.ConsumerFSMEvent=class extends r{constructor(i,t){super(i),this.details=t}}},3678:(n,I,e)=>{const r=e(7291),{ApplicationAck:i,ApplicationAckRingBuffer:t,ApplicationAckState:c}=e(5639),{assert:l}=e(9359),{CapabilityType:u}=e(5594),{ConsumerFSMEvent:o}=e(3120),{ConsumerFSMEventNames:f}=e(8694),{ConsumerStateNames:g}=e(5805),{DestinationFromNetwork:h,DestinationType:T,Queue:S,Topic:C}=e(3170),{ErrorResponseSubcodeMapper:p,ErrorSubcode:R,OperationError:N}=e(3870),{LogFormatter:w}=e(390),{Long:y}=e(840),{MessageConsumerAcknowledgeMode:P}=e(544),{MessageConsumerEventName:x}=e(2235),{MessageDispatcher:B}=e(1896),{PrivateFlowEventName:H}=e(5370),{QueueAccessType:L,QueueDescriptor:M,QueuePermissions:G,QueueProperties:K,QueueType:F}=e(5754),{RgmidFactory:Y}=e(4789),{State:_,StateMachine:U}=e(8535),{Stats:A}=e(6818),{StatType:z}=e(6818),{Timer:J}=e(7758),{TransportAcks:se,TransportAckResult:Te}=e(1019),pe=new i(y.UZERO,c.ACKED_SENT);n.exports.ConsumerFSM=class extends U{constructor({name:ne,consumer:oe,sessionInterface:de,properties:_e}={}){super({name:ne});const b=this,X=this.logger=new w(function(...Ee){return[`[session=${de.sessionIdHex}]`,`[message-consumer-fsm=${oe.flowIdDec}]`,...Ee]}),{LOG_TRACE:ae,LOG_DEBUG:ie,LOG_INFO:q,LOG_WARN:Pe,LOG_ERROR:ve}=X;this.log=X.wrap(this.log,this);const Qe=_e.acknowledgeMode===P.AUTO;this._consumer=oe,this._sessionInterface=de,this._acknowledgeTimeoutInMsecs=_e.acknowledgeTimeoutInMsecs,this._acknowledgeThreshold=_e.acknowledgeThreshold,this._localPreferredWindowSize=_e.windowSize,this._localMaxWindowSize=_e.windowSize,this._messageDispatch=new B({emitter:oe,autoAck:Qe,logger:X}),this._stats=new A,this._resetRemoteConnectionState(),this._resetLocalConnectionState(),this._midDispatch=!1,this._replayStartLocation=_e.replayStartLocation,this._errorCausingReconnect=null;const Z="EMIT",ee="DISPATCH",ge="NO_DISPATCH";let d=[];function O(Ee){const Ce={};d.forEach((Me,Be,He)=>{function Ot(xt,gt){if(Ce[xt]===void 0)return;const Ae=Ce[xt];Ce[xt]=void 0,He[Ae]=null,He[Be]=null}if(!(Be<Ee)&&Me)switch(Me.type){case Z:switch(Me.data){case x.UP:case x.ACTIVE:case x.RECONNECTED:Ce[Me.data]=Be;break;case x.DOWN:case x.DOWN_ERROR:Ot(x.UP,Me.data);break;case x.INACTIVE:Ot(x.ACTIVE,Me.data);break;default:ve(`Unexpected event in post-event action: ${Me.data}`)}break;case ee:Ce[Me.type]=Be;break;case ge:Ot(ee,Me.type)}})}function D(){let Ee,Ce=0;for(Ee=0;Ee<d.length;++Ee){Ce<d.length&&(O(Ee),Ce=d.length);const Me=d[Ee];if(Me)switch(Me.type){case Z:Me.error!==void 0?oe._emit(Me.data,Me.error):oe._emit(Me.data);break;case ge:break;case ee:this.requestStartDispatchFSM();break;default:ve(`Unhandled post event action type: ${Me.type}`)}}d=[]}function Q(Ee,Ce,Me){let Be;Be=Ce!==void 0?{type:Ee,data:Ce,error:Me}:{type:Ee},d.push(Be),d.length,d.length===1&&b.setPostEventAction(D)}function re(Ee){l(Ee instanceof N),oe._emit(x.CONNECT_FAILED_ERROR,Ee)}function ce(Ee){let Ce=null;return b._replayStartLocation===void 0||b._sessionInterface.isCapable(u.MESSAGE_REPLAY)?_e.topicEndpointSubscription&&(Ce=function(Me){let Be=null;if(Me){const He=Me.getSubscriptionInfo();He&&(He.isShare||He.isNoExport)&&!b._sessionInterface.isCapable(u.SHARED_SUBSCRIPTIONS)&&(Be=new N("Shared Subscriptions not Supported",R.SHARED_SUBSCRIPTIONS_NOT_SUPPORTED))}return Be}(_e.topicEndpointSubscription)):Ce=new N("Message Replay Not Supported",R.REPLAY_NOT_SUPPORTED),Ce?Ee.transitionTo(b.Unbound,()=>re(Ce)):_e.createIfMissing&&_e.queueDescriptor&&_e.queueDescriptor.durable?Ee.transitionTo(b.CreateSent):Ee.transitionTo(b.BindSent)}this._addEventToEmit=(Ee,Ce)=>{(_e.activeIndicationEnabled||Ee!==x.INACTIVE&&Ee!==x.ACTIVE)&&Q(Z,Ee,Ce)},this._requestStartDispatch=()=>{Q(ee)},this._requestStopDispatch=()=>{this.requestStopDispatchFSM(),Q(ge)},this.unhandledEventReaction(function(Ee){switch(Ee.getName()){case f.VIRTUALROUTER_NAME_CHANGED:return q("VirtualRouter name change: clearing all acknowledgement state"),b._resetRemoteConnectionState(),this;case f.FLOW_UNBOUND:return q("Received unsolicited unbind. Flow may be manually reconnected."),this.transitionToUnbound(x.DOWN_ERROR,Ee.details);case f.DISPOSE:return b._dispose(),b.getCurrentState().terminate();case f.BIND_RESPONSE:return function(Ce){const Me=de.getCorrelationTag(),Be=r.AdProtocolMessage.getCloseMessageConsumer(Ce.flowId,Me);de.sendControl(Be),de.enqueueRequest(Me,()=>this.handleAccidentalBind(Ce),_e.connectTimeoutInMsecs,null,null)}(Ee.details),this;default:return Ee.getName(),this.getCurrentState().getName(),this}}),this.initial(function(){return this.transitionTo(b.Unbound,Ee=>{q(`Starting ${Ee.getStateMachine().getName()}`)})}),this.Unbound=new _({name:g.UNBOUND,parentContext:b},{emitDisabledEvent(){oe._emit(x.GM_DISABLED)}}).reaction(f.FLOW_CLOSE,function(){return this.transitionTo(this)}).reaction(f.SESSION_DOWN,function(){return this.transitionTo(this)}).reaction(f.SESSION_DISCONNECT,function(){return this.transitionTo(this)}).reaction(f.FLOW_OPEN,function(){return this.transitionTo(b.Unbound.AwaitSessionUp)}).reaction(f.SESSION_UP,function(){return b._sessionInterface.isCapable(u.GUARANTEED_MESSAGE_CONSUME)?this.transitionTo(b.Unbound.AwaitFlowOpen):(Pe(`Consumer is not supported by router for this client on sessionId 0x${b._sessionInterface.sessionIdHex}`),this.internalTransition(()=>this.emitDisabledEvent()))}).reaction(f.SESSION_UP_NO_AD,function(){return this.internalTransition(()=>this.emitDisabledEvent())}).exit(()=>{b._connectAttempts=_e.connectAttempts}),this.Unbound.AwaitSessionUp=new _({name:g.UNBOUND_AWAIT_SESSION_UP,parentContext:this.Unbound},{emitBindWaiting(){oe._emit(H.BIND_WAITING)}}).entry(function(){this.emitBindWaiting()}).reaction(f.SESSION_DOWN,function(){return this.internalTransition()}).reaction(f.SESSION_DISCONNECT,function(){return this.internalTransition()}).reaction(f.SESSION_UP,function(){return ce(this)}),this.Unbound.AwaitFlowOpen=new _({name:g.UNBOUND_AWAIT_FLOWOPEN,parentContext:this.Unbound}).reaction(f.FLOW_OPEN,function(){return ce(this)}),this.BindSentExtensions={sendBindRequest(){const Ee=de.getCorrelationTag(),Ce=b._transportAcks;b._endpointEnsure();const Me=b._endpoint,Be=b._subscription,He=r.AdProtocolMessage.getOpenMessageConsumer(_e.queueDescriptor,_e.queueProperties,Me,Be,Ee,_e.windowSize,_e.noLocal,_e.activeIndicationEnabled,Ce.lastAcked,Ce.lastReceived,_e.browser,b._replayStartLocation,oe.endpointErrorId);de.sendControl(He),de.enqueueRequest(Ee,this.handleBindTimeout.bind(this),_e.connectTimeoutInMsecs,null,this.handleBindResponse.bind(this)),_e.queueDescriptor,_e.queueProperties,_e.windowSize,_e.noLocal,_e.activeIndicationEnabled,Ce.lastAcked,Ce.lastReceived,_e.browser,b._replayStartLocation,oe.endpointErrorId},cancelBindRequestTimer(){this.bindRequestTimer.cancel()},handleBindTimeout(){q("Bind timeout"),b.processEvent(new o({name:f.BIND_TIMEOUT}))},handleExpectedBind(Ee){const Ce={lastMsgIdAcked:Ee.getLastMsgIdAcked(),flowId:Ee.getFlowId(),accessType:(Me=Ee.getAccessType(),Me===void 0?L.EXCLUSIVE:Me),topicEndpointBytes:Ee.getTopicEndpointBytes(),grantedPermissions:Ee.getGrantedPermissions(),allOthersPermissions:Ee.getAllOthersPermissions(),respectsTTL:Ee.getRespectsTTL(),activeFlow:Ee.getActiveFlow(),wantFlowChangeNotify:Ee.getWantFlowChangeNotify(),discardBehavior:Ee.getQueueDiscardBehavior(),deliveryCountSent:Ee.getEndpointDeliveryCountSent(),endpointId:Ee.getEndpointId(),maxUnackedMessages:Ee.getMaxUnackedMessages(),endpointErrorId:Ee.getEndpointErrorId(),spoolerUniqueId:Ee.getSpoolerUniqueId(),quota:Ee.getQuota(),maxMsgSize:Ee.getMaxMsgSize(),maxRedelivery:Ee.getMaxRedelivery()};var Me;if(Object.assign(oe,{accessType:Ce.accessType,queueDiscardBehavior:Ce.discardBehavior,deliveryCountSent:Ce.deliveryCountSent,endpointId:Ce.endpointId,respectsTTL:Ce.respectsTTL,flowId:Ce.flowId,permissions:Ce.grantedPermissions,wantFlowChangeNotify:Ce.wantFlowChangeNotify,endpointErrorId:Ce.endpointErrorId,spoolerUniqueId:Ce.spoolerUniqueId}),b._sessionInterface.isCapable(u.BR_REPLAY_ERRORID)&&(oe.endpointErrorId=Ce.endpointErrorId),Ce.topicEndpointBytes&&Ce.topicEndpointBytes.length){Ce.endpoint=h.createDestinationFromBytes(Ce.topicEndpointBytes),b._endpoint,b._endpoint=Ce.endpoint;const He=b._consumer._properties;He.queueDescriptor=new M({name:Ce.endpoint.name,type:He.queueDescriptor.type,durable:He.queueDescriptor.durable})}const Be=b._consumer._properties;Be.queueProperties=new K({respectsTTL:Ce.respectsTTL,permissions:Ce.allOthersPermissions,quotaMB:Ce.quota,maxMessageSize:Ce.maxMsgSize,discardBehavior:Ce.discardBehavior,maxMessageRedelivery:Ce.maxRedelivery,accessType:Ce.accessType}),Be.queueProperties.permissions||(Be.queueProperties.permissions=G.NONE),Object.assign(b,{_active:Ce.activeFlow,_remoteWindowSize:Ce.maxUnackedMessages}),y.UZERO.eq(b._transportAcks.lastAcked)?b._transportAcks.lastAcked=Ce.lastMsgIdAcked||y.UZERO:b._transportAcks},handleBindResponse(Ee){if(Ee.msgType!==r.SMFAdProtocolMessageType.BIND)return q(`Unexpected message type in bind response: ${r.SMFAdProtocolMessageType.describe(Ee.msgType)}`),b.processEvent(new o({name:f.FLOW_FAILED},new N(`Unexpected bind response: ${r.SMFAdProtocolMessageType.describe(Ee.msgType)}`,R.PROTOTOCOL_ERROR)));const Ce=Ee.smfHeader,Me=Ce.pm_respcode;if(Me===null)return this._consumer.incStat(z.RX_DISCARD_SMF_UNKNOWN_ELEMENT),void this._sessionInterface.sessionIdHex;if(Me!==200){const He=Ce.pm_respstr,Ot=p.getADErrorSubcode(Me,He);return q("Flow failed (bind):",Me,He,R.describe(Ot)),b.processEvent(new o({name:f.FLOW_FAILED},new N(He,Ot,{responseCode:Me})))}const Be={name:f.BIND_RESPONSE};return b.processEvent(new o(Be,Ee))}},this.BindSent=new _({name:g.BIND_SENT,parentContext:b},this.BindSentExtensions).entry(function(){b._connectAttempts--,this.sendBindRequest(),this.bindRequestTimer=J.newTimeout(_e.connectTimeoutInMsecs,this.handleBindTimeout)}).reaction(f.SESSION_DOWN,function(){return this.transitionTo(b.Unbound.AwaitSessionUp)}).reaction(f.SESSION_DISCONNECT,function(){return this.transitionTo(b.Unbound.AwaitSessionUp,()=>b._addEventToEmit(x.DOWN))}).reaction(f.FLOW_CLOSE,function(){return this.transitionTo(b.UnbindSent)}).reaction(f.BIND_TIMEOUT,function(){return b._connectAttempts,b._connectAttempts>0?this.externalTransitionTo(b.BindSent):this.transitionTo(b.Unbound.AwaitFlowOpen,()=>re(new N("Bind failed due to timeout",R.TIMEOUT)))}).reaction(f.FLOW_FAILED,function(Ee){return this.transitionTo(b.Unbound.AwaitFlowOpen,()=>re(Ee.details))}).reaction(f.BIND_RESPONSE,function(Ee){return this.handleExpectedBind(Ee.details),this.transitionTo(b.FlowUp)}).reaction(f.FLOW_UP,function(){return this.transitionTo(b.FlowUp)}).exit(function(){this.cancelBindRequestTimer()}),this.Reconnecting=new _({name:g.RECONNECTING,parentContext:b}).entry(function(){this._errorCausingReconnect,b._errorCausingReconnect,oe._emit(x.RECONNECTING,b._errorCausingReconnect),b._connectAttempts=_e.connectAttempts,b.reconnectAttempts=_e.reconnectAttempts}).initial(function(){return this.transitionTo(b.Reconnecting.RBindSent)}).reaction(f.SESSION_DISCONNECT,function(){return this.transitionTo(b.Reconnecting.RAwaitSessionUp)}).reaction(f.SESSION_DOWN,function(){return this.transitionTo(b.Reconnecting.RAwaitSessionUp)}),this.Reconnecting.RAwaitSessionUp=new _({name:g.RECONNECTING_AWAIT_SESSION_UP,parentContext:this.Reconnecting}).reaction(f.SESSION_UP,function(){return b._connectAttempts=_e.connectAttempts,this.transitionTo(b.Reconnecting.RBindSent)}),this.Reconnecting.RBindSent=new _({name:g.RECONNECTING_BIND_SENT,parentContext:this.Reconnecting},this.BindSentExtensions).entry(function(){b._connectAttempts--,this.sendBindRequest(),this.bindRequestTimer=J.newTimeout(_e.connectTimeoutInMsecs,this.handleBindTimeout)}).reaction(f.FLOW_CLOSE,function(){return this.transitionTo(b.UnbindSent)}).reaction(f.BIND_TIMEOUT,function(){return b._connectAttempts,b._connectAttempts>0?this.externalTransitionTo(b.Reconnecting.RBindSent):this.transitionTo(b.Unbound.AwaitFlowOpen,()=>re(new N("Rebind failed due to timeout",R.TIMEOUT)))}).reaction(f.FLOW_FAILED,function(Ee){if(b.reconnectAttempts>0||b.reconnectAttempts===-1){if(Ee&&Ee.details&&Ee.details.subcode&&(Ee.details.subcode===R.QUEUE_SHUTDOWN||Ee.details.subcode===R.TOPIC_ENDPOINT_SHUTDOWN||Ee.details.subcode===R.GM_UNAVAILABLE))return b.reconnectAttempts,Ee.details.subcode,this.transitionTo(b.Reconnecting.RAwaitTimer)}else b.reconnectAttempts;return this.transitionTo(b.Unbound.AwaitFlowOpen,()=>{return Ce=Ee.details,l(Ce instanceof N),void oe._emit(x.DOWN_ERROR,Ce);var Ce})}).reaction(f.BIND_RESPONSE,function(Ee){return this.handleExpectedBind(Ee.details),this.transitionTo(b.FlowUp,()=>b._addEventToEmit(x.RECONNECTED))}).reaction(f.FLOW_UP,function(){return this.transitionTo(b.FlowUp,()=>b._addEventToEmit(x.RECONNECTED))}).exit(function(){this.cancelBindRequestTimer()}),this.Reconnecting.RAwaitTimer=new _({name:g.RECONNECTING_AWAIT_TIMER,parentContext:this.Reconnecting},{handleReconnectIntervalTimeout(){b.processEvent(new o({name:f.RECONNECT_INTERVAL_TIMEOUT}))},cancelReconnectIntervalTimer(){this.reconnectIntervalTimer.cancel()}}).entry(function(){b.reconnectAttempts>0&&--b.reconnectAttempts,_e.reconnectIntervalInMsecs,b.reconnectAttempts,this.reconnectIntervalTimer=J.newTimeout(_e.reconnectIntervalInMsecs,this.handleReconnectIntervalTimeout)}).exit(function(){this.cancelReconnectIntervalTimer()}).reaction(f.RECONNECT_INTERVAL_TIMEOUT,function(){return b._connectAttempts=_e.connectAttempts,this.transitionTo(b.Reconnecting.RBindSent)});const me=this.FlowUp=new _({name:g.FLOW_UP,parentContext:b}).initial(function(){return this.transitionTo(b._active===0?me.XferInactive:me.Xfer)}).entry(()=>{b._replayStartLocation=void 0,b._errorCausingReconnect?b._errorCausingReconnect=null:b._addEventToEmit(x.UP)}).reaction(f.SESSION_DOWN,function(){return this.transitionTo(b.Unbound.AwaitSessionUp)}).reaction(f.SESSION_DISCONNECT,function(){return this.transitionTo(b.Unbound.AwaitSessionUp,()=>b._addEventToEmit(x.DOWN))}).reaction(f.FLOW_CLOSE,function(){return this.transitionTo(b.UnbindSent)}).reaction(f.FLOW_UNBOUND,Ee=>b.transitionToUnboundFromUp(_e,x.DOWN_ERROR,Ee.details));me.Xfer=new _({name:g.FLOW_UP_XFER,parentContext:me}).entry(()=>{b._addEventToEmit(x.ACTIVE),b._sendAcks(!0),b._requestStartDispatch()}).exit(()=>{b._addEventToEmit(x.INACTIVE),b._requestStopDispatch()}).reaction(f.SESSION_DISCONNECT,function(){return b._sendAcks(!0),this.eventUnhandled()}),me.XferInactive=new _({name:g.FLOW_UP_XFER_INACTIVE,parentContext:me}).reaction(f.FLOW_ACTIVE_IND,function(){return this.transitionTo(me.Xfer)}),this.UnbindSent=new _({name:g.UNBIND_SENT,parentContext:b},{sendUnbindRequest(){b._endpointClear();try{const Ee=de.getCorrelationTag(),Ce=r.AdProtocolMessage.getCloseMessageConsumer(oe.flowId,Ee);de.sendControl(Ce),de.enqueueRequest(Ee,()=>this.handleUnbindTimeout(),_e.connectTimeoutInMsecs,null,Me=>this.handleUnbindResponse(Me)),q("Sent consumer unbind request with arguments",{flowId:oe.flowId,correlationTag:Ee})}catch(Ee){q(`Exception in sendUnbindRequest while trying to send unbind request: ${Ee}`),de.getCurrentStateName(),b.processEvent(new o({name:f.FLOW_UNBOUND}))}},handleUnbindTimeout:()=>(q("Unbind timeout"),b.processEvent(new o({name:f.UNBIND_TIMEOUT}))),handleUnbindResponse(Ee){Ee.msgType!==r.SMFAdProtocolMessageType.UNBIND&&q(`Unexpected message type in bind response: ${r.SMFAdProtocolMessageType.describe(Ee.msgType)}`);const Ce=Ee.smfHeader.pm_respcode,Me=Ee.smfHeader.pm_respstr,Be=p.getADErrorSubcode(Ce,Me);return oe.endpointErrorId=Ee.getEndpointErrorId(),q("Flow failed (unbind):",Ce,Me,R.describe(Be)),b.processEvent(new o({name:f.FLOW_UNBOUND},new N(Me,Be,Ce)))}}).entry(function(){this.sendUnbindRequest()}).reaction(f.UNBIND_TIMEOUT,function(){return this.externalTransitionTo(b.UnbindSent)}).reaction(f.FLOW_UNBOUND,()=>b.transitionToUnbound(x.DOWN)),this.CreateSent=new _({name:g.CREATE_SENT,parentContext:b},{sendCreateRequest(){const Ee=de.getCorrelationTag(),Ce=r.AdProtocolMessage.getCreate(_e.queueDescriptor,_e.queueProperties,Ee);de.sendControl(Ce),de.enqueueRequest(Ee,this.handleCreateTimeout.bind(this),_e.connectTimeoutInMsecs,null,this.handleCreateResponse.bind(this))},handleCreateTimeout(){q("Create timeout"),b.processEvent(new o({name:f.CREATE_TIMEOUT}))},handleCreateResponse(Ee){if(Ee.msgType!==r.SMFAdProtocolMessageType.CREATE)return q(`Unexpected message type in create response: ${r.SMFAdProtocolMessageType.describe(Ee.msgType)}`),b.processEvent(new o({name:f.CREATE_FAILED},new N(`Unexpected create response: ${r.SMFAdProtocolMessageType.describe(Ee.msgType)}`,R.PROTOTOCOL_ERROR)));const Ce=Ee.smfHeader,Me=Ce.pm_respcode;if(Me!==200){const He=Ce.pm_respstr,Ot=p.getADErrorSubcode(Me,He);if(q("Endpoint create failed:",Me,He,R.describe(Ot)),Ot===R.ENDPOINT_ALREADY_EXISTS){const xt={name:f.CREATE_SUCCESS};return b.processEvent(new o(xt,Ee))}return b.processEvent(new o({name:f.CREATE_FAILED},new N(He,Ot,{responseCode:Me})))}const Be={name:f.CREATE_SUCCESS};return b.processEvent(new o(Be,Ee))}}).entry(function(){this.sendCreateRequest()}).reaction(f.CREATE_TIMEOUT,function(){return this.externalTransitionTo(b.BindSent)}).reaction(f.CREATE_SUCCESS,function(){return this.externalTransitionTo(b.BindSent)}).reaction(f.CREATE_FAILED,function(Ee){return this.transitionTo(b.Unbound.AwaitFlowOpen,()=>re(Ee.details))})}acceptMessage(ne){this.logger;const oe=ne.getGuaranteedMessageId(),de=oe.toString(),_e=this._consumer;if(!this._fsmDispatch)return _e.incStat(z.RX_DISCARD_NO_MATCHING_CONSUMER),!1;_e.deliveryCountSent||ne.setDeliveryCount(-1);const b=ne._getSpoolerUniqueId();Y.INVALID_SUID.eq(b)?ne._setSpoolerUniqueId(_e.spoolerUniqueId):_e.spoolerUniqueId===void 0||Y.INVALID_SUID.eq(_e.spoolerUniqueId)?_e.spoolerUniqueId!==void 0&&!Y.INVALID_SUID.eq(_e.spoolerUniqueId)||Y.INVALID_SUID.eq(b)||ne._setSpoolerUniqueId(Y.INVALID_SUID):(_e.spoolerUniqueId.toString(),b.toString(),_e.spoolerUniqueId=b);const X=this._transportAcks,ae=X.tryReceive(oe,ne.getGuaranteedPreviousMessageId()),ie=X.acksPending>this.maxPendingAcks;switch(ae){case Te.OK:break;case Te.DUPLICATE:return _e.incStat(z.RX_DISCARD_DUPLICATE),this._applicationAcks.has(oe)||this._oldUnacked.has(de)?ie?this._sendAcks(ie):this._setTransportAckTimer():this._sendAck([[oe,oe]]),!1;case Te.OUT_OF_ORDER:return _e.incStat(z.RX_DISCARD_OUT_OF_ORDER),!1;default:return l(!1,"Unhandled transport ack result",ae),!1}return this._applicationAcks.insert(oe,q=>{let Pe=!1;if(q)switch(q.state){case c.UNACKED:this._oldUnacked.add(q.key);break;case c.ACKED_NOT_SENT:Pe=!0;break;case c.ACKED_SENT:break;default:l(!1,"Unhandled application ack state",c.describe(q.state))}return this._midDispatch=!0,this._messageDispatch.push(ne),this._midDispatch=!1,ie||Pe?this._sendAcks(ie):this._setTransportAckTimer(),!0})}applicationAck(ne){this.logger;const oe=ne.toString();this._consumer.incStat(z.RX_ACKED),this._oldUnacked.delete(oe)?this._sendAck([[ne,ne]]):(this._applicationAcks.updateAckState(ne,c.ACKED_NOT_SENT),this._setTransportAckTimer())}getDestination(){return this._endpointEnsure(),this._destination}isDisconnected(){return!this.getCurrentState()||this.getActiveState(g.UNBOUND)||this.getActiveState(g.UNBOUND_AWAITING_FLOWOPEN)}requestStartDispatchUser(){this._userDispatch=!0,this.applyStartDispatch()}requestStartDispatchFSM(){this._fsmDispatch=!0,this.applyStartDispatch()}applyStartDispatch(){this._userDispatch&&this._fsmDispatch?(this.log(`Starting message dispatch (fsm ${this._fsmDispatch}, user ${this._userDispatch})`),this._messageDispatch.start(),this._localMaxWindowSize=this._localPreferredWindowSize,this._sendAcks(!0)):this.log(`Not starting message dispatch (fsm ${this._fsmDispatch}, user ${this._userDispatch})`)}transitionToUnbound(ne,oe){const de=this._consumer;return this.logger,de.userDisconnected,this.transitionTo(this.Unbound.AwaitFlowOpen,()=>this._addEventToEmit(ne,oe))}transitionToUnboundFromUp(ne,oe,de){const _e=this._consumer;if(this.logger,de&&de instanceof N&&de.subcode&&de.subcode===R.REPLAY_STARTED&&(this._transportAcks.reset(),this._applicationAcks.reset()),_e.endpointErrorId&&this._sessionInterface.isCapable(u.MESSAGE_REPLAY)){_e.endpointErrorId;const b=r.AdProtocolMessage.getUnbindAck(_e._flowId,_e.endpointErrorId,this._transportAcks.lastAcked);this._sessionInterface.sendControl(b)}return(ne.reconnectAttempts===-1||ne.reconnectAttempts>0)&&de&&de instanceof N&&de.subcode&&(de.subcode===R.REPLAY_STARTED||de.subcode===R.GM_UNAVAILABLE)?(this._errorCausingReconnect=de,this.transitionTo(this.Reconnecting)):this.transitionTo(this.Unbound.AwaitFlowOpen,()=>this._addEventToEmit(oe,de))}requestStopDispatchUser(){this._userDispatch=!1,this.log(`Stop dispatch user (fsm ${this._fsmDispatch}, user ${this._userDispatch})`),this._messageDispatch.stop()}requestStopDispatchFSM(){this._fsmDispatch=!1,this.log(`Stop dispatch FSM (fsm ${this._fsmDispatch}, user ${this._userDispatch})`),this._sendAcks(!0)}_clearTransportAckTimer(){this._transportAckTimer&&(clearTimeout(this._transportAckTimer),this._transportAckTimer=null)}_dispose(){this._clearTransportAckTimer(),this._endpointClear(),this._destination=void 0,this._unacked=null,this._messageDispatch=null,this._transportAcks=null,this._consumer=null,this._sessionInterface=null}_endpointClear(){this._endpoint=void 0,this._subscription=void 0}_endpointEnsure(){if(this._endpoint)return;const ne=this._sessionInterface,oe=this._consumer._properties,{queueDescriptor:de}=oe;let _e,b,X;de.type===F.QUEUE?(_e=ne.createDestinationFromDescriptor(de),b=new S({name:_e.name,type:T.QUEUE,offset:0,bytes:_e.bytes.substr(_e.offset)}),X=void 0):(b=de.name?ne.createDestinationFromDescriptor(de):new C({name:"\0?",offset:0,bytes:"\0"}),X=oe.topicEndpointSubscription||ne.createTemporaryDestination(T.TOPIC),_e=X),Object.assign(this,{_destination:_e,_endpoint:b,_subscription:X}),oe.queueDescriptor=new M({name:b.name,type:de.type,durable:de.durable})}_resetLocalConnectionState(){Object.assign(this,{_remoteWindowSize:0,_active:void 0,_fsmDispatch:!1,_userDispatch:!0})}_resetRemoteConnectionState(){this.logger,this._transportAcks=new se,this._applicationAcks=new t(512),this._oldUnacked=new Set,this._consumer.endpointErrorId=void 0}_sendAck(ne){const oe=r.AdProtocolMessage.getAck(this._consumer.flowId,this._transportAcks.lastReceived,this.windowSize,ne);this._sessionInterface.sendControl(oe)}_addAckToRanges(ne,oe=null){const de=ne.currentRange,_e=ne.ackRanges;if(oe&&oe.state!==c.UNACKED)de.push(oe);else{if(de.length&&_e.push(de),oe===null||_e.length===r.AdProtocolMessage.MAX_CLIENT_ACK_RANGES){const b=_e.map(X=>[X[0].id,X[X.length-1].id]);(b.length||ne.forceTransportAck)&&(this.logger,this._sendAck(b),this._transportAcks.lastReceived,b.length&&b.map(X=>`[${X[0]}..${X[1]}]`),this._transportAcks.setAcked(),ne.forceTransportAck=!1),_e.forEach(X=>{X.forEach(ae=>{if(ae.state!==c.ACKED_SENT)try{this._applicationAcks.updateAckState(ae.id,c.ACKED_SENT)}catch(ie){const{LOG_ERROR:q}=this.logger;q(`Marking ack ${ae.id} as sent failed: ${ie}`)}})}),ne.ackRanges=[]}ne.currentRange=[]}}_sendAcks(ne=!1){this._clearTransportAckTimer();const oe=this._applicationAcks,de=this._transportAcks,_e={forceTransportAck:ne||de.acksPending>0,ackRanges:[],currentRange:[]},b=this._applicationAcks.front();this._oldUnacked.size===0&&b&&b.state!==c.UNACKED&&this._addAckToRanges(_e,pe),oe.forEach(X=>this._addAckToRanges(_e,X)),this._addAckToRanges(_e),l(_e.forceTransportAck===!1),l(_e.currentRange.length===0),l(_e.ackRanges.length===0)}_setTransportAckTimer(){this._transportAckTimer||this._consumer.disposed||(this._transportAckTimer=setTimeout(()=>this._sendAcks(!0),this._acknowledgeTimeoutInMsecs))}get maxWindowSize(){return Math.min(this._localMaxWindowSize,this._remoteWindowSize||Number.POSITIVE_INFINITY)}get windowSize(){return this.maxWindowSize-this._messageDispatch.length}get maxPendingAcks(){return this.windowSize*this._acknowledgeThreshold/100}}},5805:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.ConsumerStateNames=r.new({UNBOUND:"UNBOUND",UNBOUND_AWAIT_SESSION_UP:"UNBOUND_AWAIT_SESSION_UP",UNBOUND_AWAIT_FLOWOPEN:"UNBOUND_AWAIT_FLOWOPEN",UNBOUND_AWAIT_ANY:"UNBOUND_AWAIT_ANY",BIND_SENT:"BIND_SENT",FLOW_UP:"FLOW_UP",FLOW_UP_XFER:"FLOW_UP_XFER",FLOW_UP_XFER_INACTIVE:"FLOW_UP_XFER_INACTIVE",UNBIND_SENT:"UNBIND_SENT",RECONNECTING:"RECONNECTING",RECONNECTING_BIND_SENT:"RECONNECTING_BIND_SENT",RECONNECTING_AWAIT_SESSION_UP:"RECONNECTING_AWAIT_SESSION_UP",RECONNECTING_AWAIT_TIMER:"RECONNECTING_AWAIT_TIMER",CREATE_SENT:"CREATE_SENT"})},544:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageConsumerAcknowledgeMode=r.new({AUTO:"AUTO",CLIENT:"CLIENT"})},2235:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageConsumerEventName=r.new({UP:"MessageConsumerEventName_up",DOWN:"MessageConsumerEventName_down",ACTIVE:"MessageConsumerEventName_active",INACTIVE:"MessageConsumerEventName_inactive",DOWN_ERROR:"MessageConsumerEventName_downError",RECONNECTING:"MessageConsumerEventName_reconnecting",RECONNECTED:"MessageConsumerEventName_reconnected",CONNECT_FAILED_ERROR:"MessageConsumerEventName_connectFailedError",GM_DISABLED:"MessageConsumerEventName_GMDisabled",DISPOSED:"MessageConsumerEventName_disposed",MESSAGE:"MessageConsumerEventName_message",SUBSCRIPTION_OK:"MessageConsumerEventName_ok",SUBSCRIPTION_ERROR:"MessageConsumerEventName_error"})},6203:(n,I,e)=>{var r=e(9489);const{ErrorSubcode:i}=e(3870);n.exports.MessageConsumerEvent=class{constructor(t,c,l,u=0,o,f){this._messageConsumerEventName=t,this._infoStr=c,this._responseCode=l,this._errorSubcode=u,this._correlationKey=o,this._reason=f}get messageConsumerEventName(){return this._messageConsumerEventName}get name(){return this._messageConsumerEventName}get infoStr(){return this._infoStr}get responseCode(){return this._responseCode}get errorSubcode(){return this._errorSubcode}get subcode(){return this._errorSubcode}get correlationKey(){return this._correlationKey}get reason(){return this._reason}set reason(t){this._reason=t}get requestEventCode(){}inspect(){return{messageConsumerEventName:this.messageConsumerEventName,infoStr:this.infoStr,responseCode:this.responseCode,errorSubcode:i.describe(this.errorSubcode),correlationKey:this.correlationKey?this.correlationKey.toString():null,reason:this.reason?this.reason:null}}toString(){return r(this)}}},7903:(n,I,e)=>{const{AbstractQueueDescriptor:r,QueueDescriptor:i,QueueDescriptorValidator:t,QueueProperties:c,QueuePropertiesValidator:l,QueueType:u}=e(5754),{APIPropertiesValidators:o}=e(7882),{Check:f}=e(2201),{MessageConsumerAcknowledgeMode:g}=e(544),{OperationError:h,ErrorSubcode:T}=e(3870),{ReplayStartLocation:S}=e(2604),{validateInstance:C,valBoolean:p,valInstance:R,valIsMember:N,valNumber:w,valRange:y,valTopicStringOrEmpty:P}=o;function x(H,L){if(L.queueDescriptor.getType()===u.TOPIC_ENDPOINT){if(L.queueDescriptor.isDurable()&&!L.createIfMissing&&!L.topicEndpointSubscription)throw new h("topicEndpointSubscription must be set when queueDescriptor refers to a durable topic endpoint and not allowed to create.",T.PARAMETER_CONFLICT)}else if(L.topicEndpointSubscription)throw new h("topicEndpointSubscription is set, but queueDescriptor refers to a queue that is not of type QueueType.TOPIC_ENDPOINT",T.PARAMETER_CONFLICT)}const B={validate(H,L,M){if(Object.prototype.hasOwnProperty.call(M,"transportAcknowledgeTimeoutInMsecs")&&Object.prototype.hasOwnProperty.call(M,"acknowledgeTimeoutInMsecs"))throw new h(`${H} validation: transportAcknowledgeTimeoutInMsecs and acknowledgeTimeoutInMsecs are mutually exclusive`,T.PARAMETER_CONFLICT);if(Object.prototype.hasOwnProperty.call(M,"transportAcknowledgeThresholdPercentage")&&Object.prototype.hasOwnProperty.call(M,"acknowledgeThreshold"))throw new h(`${H} validation: transportAcknowledgeThresholdPercentage and acknowledgeThreshold are mutually exclusive`,T.PARAMETER_CONFLICT);const G=C.bind(null,H,L);if(!(L.queueDescriptor instanceof r||L.queueDescriptor instanceof i))throw new h(`${H} validation: queue descriptor must be an AbstractQueueDescriptor or a QueueDescriptor`,T.PARAMETER_INVALID_TYPE);if(t.validate(L.queueDescriptor),L.queueProperties){if(L.queueDescriptor.durable&&!L.createIfMissing)throw new h(`${H} validation: queueProperties cannot be set unless queueDescriptor refers to a temporary queue, or createIfMissing is set.`,T.PARAMETER_CONFLICT);if(G("queueProperties",[R,c,"QueueProperties"]),l.validate(L.queueProperties),!L.queueDescriptor.durable&&f.something(L.queueProperties.accessType))throw new h(`${H} validation: queueProperties cannot specify accessType in creation of a temporary queue`,T.PARAMETER_CONFLICT)}if(L.queueDescriptor.type===u.TOPIC_ENDPOINT){if(L.queueDescriptor.durable&&!L.createIfMissing&&!L.topicEndpointSubscription)throw new h(`${H} validation: topicEndpointSubscription must be set for durable topic endpoints unless creation is allowed.`,T.PARAMETER_CONFLICT)}else if(L.topicEndpointSubscription)throw new h(`${H} validation: topicEndpointSubscription cannot be set unless descriptor.type is TOPIC_ENDPOINT`,T.PARAMETER_CONFLICT);if(G("connectTimeoutInMsecs",[w],[y,50,Number.MAX_VALUE]),G("connectAttempts",[w],[y,1,Number.MAX_VALUE]),G("topicEndpointSubscription",[x],[P]),G("acknowledgeMode",[N,g,"MessageConsumerAcknowledgeMode"]),G("transportAcknowledgeTimeoutInMsecs",[w],[y,20,1500]),G("transportAcknowledgeThresholdPercentage",[w],[y,1,75]),G("activeIndicationEnabled",[p]),G("noLocal",[p]),G("windowSize",[w],[y,1,255]),G("reconnectIntervalInMsecs",[w],[y,50,Number.MAX_VALUE]),L.activeIndicationEnabled&&L.queueDescriptor.type!==u.QUEUE)throw new h(`${H} validation: activeIndicationEnabled may only be true for QUEUE destinations`,T.PARAMETER_CONFLICT);if(L.replayStartLocation&&!(L.replayStartLocation instanceof S))throw new h(`${H} validation: replayStartLocation must be an instance of ReplayStartLocation`,T.PARAMETER_INVALID_TYPE)}};n.exports.MessageConsumerPropertiesValidator=B},6334:(n,I,e)=>{const r=e(5754),{APIProperties:i}=e(7882),{Check:t}=e(2201),{MessageConsumerAcknowledgeMode:c}=e(544),{Topic:l}=e(3170),u={queueDescriptor:void 0,queueProperties:void 0,connectTimeoutInMsecs:1e4,connectAttempts:3,topicEndpointSubscription:void 0,acknowledgeMode:c.AUTO,transportAcknowledgeTimeoutInMsecs:1e3,transportAcknowledgeThresholdPercentage:60,activeIndicationEnabled:!1,noLocal:!1,windowSize:255,_browser:!1,replayStartLocation:void 0,reconnectAttempts:-1,reconnectIntervalInMsecs:3e3,createIfMissing:!1};n.exports.MessageConsumerProperties=class extends i{constructor(o){super(u,o)}get queueDescriptor(){return t.something(this._queueDescriptor)?this._queueDescriptor:u.queueDescriptor}set queueDescriptor(o){o instanceof r.AbstractQueueDescriptor?this._queueDescriptor=o:this._queueDescriptor=o&&(o.name?new r.QueueDescriptor(o):new r.AbstractQueueDescriptor(o))}get queueProperties(){return t.something(this._queueProperties)?this._queueProperties:u.queueProperties}set queueProperties(o){this._queueProperties=o&&new r.QueueProperties(o)}get connectTimeoutInMsecs(){return t.something(this._bindTimeoutInMsecs)?this._bindTimeoutInMsecs:u.connectTimeoutInMsecs}set connectTimeoutInMsecs(o){this._bindTimeoutInMsecs=o}get connectAttempts(){return t.something(this._connectAttempts)?this._connectAttempts:u.connectAttempts}set connectAttempts(o){this._connectAttempts=o}get topicEndpointSubscription(){return this._topicEndpointSubscription}set topicEndpointSubscription(o){this._topicEndpointSubscription=typeof o=="string"?l.createFromName(o):o}get acknowledgeMode(){return t.something(this._acknowledgeMode)?this._acknowledgeMode:u.acknowledgeMode}set acknowledgeMode(o){this._acknowledgeMode=o}get acknowledgeTimeoutInMsecs(){return t.something(this._transportAcknowledgeTimeoutInMsecs)?this._transportAcknowledgeTimeoutInMsecs:u.transportAcknowledgeTimeoutInMsecs}set acknowledgeTimeoutInMsecs(o){this._transportAcknowledgeTimeoutInMsecs=o}get acknowledgeThreshold(){return t.something(this._transportAcknowledgeThresholdPercentage)?this._transportAcknowledgeThresholdPercentage:u.transportAcknowledgeThresholdPercentage}set acknowledgeThreshold(o){this._transportAcknowledgeThresholdPercentage=o}get transportAcknowledgeTimeoutInMsecs(){return t.something(this._transportAcknowledgeTimeoutInMsecs)?this._transportAcknowledgeTimeoutInMsecs:u.transportAcknowledgeTimeoutInMsecs}set transportAcknowledgeTimeoutInMsecs(o){this._transportAcknowledgeTimeoutInMsecs=o}get transportAcknowledgeThresholdPercentage(){return t.something(this._transportAcknowledgeThresholdPercentage)?this._transportAcknowledgeThresholdPercentage:u.transportAcknowledgeThresholdPercentage}set transportAcknowledgeThresholdPercentage(o){this._transportAcknowledgeThresholdPercentage=o}get activeIndicationEnabled(){return t.something(this._activeIndicationEnabled)?this._activeIndicationEnabled:u.activeIndicationEnabled}set activeIndicationEnabled(o){this._activeIndicationEnabled=o}get noLocal(){return t.something(this._noLocal)?this._noLocal:u.noLocal}set noLocal(o){this._noLocal=o}get windowSize(){return t.something(this._windowSize)?this._windowSize:u.windowSize}set windowSize(o){this._windowSize=o}get browser(){return t.something(this._browser)?this._browser:u._browser}set browser(o){this._browser=o}get replayStartLocation(){return t.something(this._replayStartLocation)?this._replayStartLocation:u.replayStartLocation}set replayStartLocation(o){this._replayStartLocation=o}get reconnectAttempts(){return t.something(this._reconnectAttempts)?this._reconnectAttempts:u.reconnectAttempts}set reconnectAttempts(o){this._reconnectAttempts=o}get reconnectIntervalInMsecs(){return t.something(this._reconnectIntervalInMsecs)?this._reconnectIntervalInMsecs:u.reconnectIntervalInMsecs}set reconnectIntervalInMsecs(o){this._reconnectIntervalInMsecs=o}get createIfMissing(){return t.something(this._createIfMissing)?this._createIfMissing:u.createIfMissing}set createIfMissing(o){this._createIfMissing=o}}},8692:(n,I,e)=>{var r=e(9489);const i=e(7291),{CapabilityType:t}=e(5594),{ConsumerFSM:c}=e(3678),{ConsumerFSMEvent:l}=e(3120),{ConsumerFSMEventNames:u}=e(8694),{ErrorResponseSubcodeMapper:o,ErrorSubcode:f,OperationError:g}=e(3870),{Flow:h,FlowOperation:T}=e(5370),{MessageConsumerEvent:S}=e(6203),{MessageConsumerEventName:C}=e(2235),{MessageConsumerProperties:p}=e(6334),{MessageConsumerPropertiesValidator:R}=e(7903),{Queue:N,Topic:w}=e(3170),{QueueAccessType:y,QueuePermissions:P,QueueDiscardBehavior:x}=e(5754);function B(L){return`MessageConsumerEventName.${C.describe(L)}`}let H=0;n.exports.MessageConsumer=class extends h{constructor({properties:L,sessionInterfaceFactory:M}={}){const G=new p(L);R.validate(G.browser?"QueueBrowserProperties":"MessageConsumerProperties",G,L),super(G,M,{direct:C.MESSAGE,emits:C.values,formatEventName:B});const K=this.logger.formatter;this.logger.formatter=(...F)=>K("[message-consumer]",...F),this._active=void 0,this._fsm=this._makeFSM(),this.endpointErrorId=void 0,this._on(C.ACTIVE,()=>this._onFlowActive(!0)),this._on(C.INACTIVE,()=>this._onFlowActive(!1)),this._on(C.DOWN_ERROR,this._onFlowDisconnected.bind(this)),this._on(C.UP,this._onFlowUp.bind(this)),this._fsm.start()}_makeFSM(){const L=this._properties,M="ConsumerFSM "+H++;return new c({name:M,consumer:this,sessionInterface:this._sessionInterface,properties:L})}start(){this._operationCheck(T.START),this._fsm.requestStartDispatchUser()}stop(){this._operationCheck(T.STOP),this._fsm.requestStopDispatchUser()}connect(){if(this._sessionInterface.getCapability(t.GUARANTEED_MESSAGE_CONSUME)!==null&&!this._sessionInterface.isCapable(t.GUARANTEED_MESSAGE_CONSUME))throw new g("Consumer is not supported by router for this client",f.INVALID_OPERATION,null);super.connect(),this.processFSMEvent(new l({name:u.FLOW_OPEN}))}disconnect(){super.disconnect(),this.processFSMEvent(new l({name:u.FLOW_CLOSE}))}getDestination(){const L=this._fsm.getDestination();return L instanceof N?new N(L):new w(L)}_disconnectSession(){super._disconnectSession(),this.processFSMEvent(new l({name:u.SESSION_DISCONNECT}))}_operationCheck(L){if(super._operationCheck(L),L===T.GET_DESTINATION&&this._isDisconnected())throw new g("Cannot get destination of a disconnected flow",f.INVALID_OPERATION)}applicationAck(L){this.logger,this._fsm.applicationAck(L)}getDisposedEvent(){return C.DISPOSED}handleDataMessage(L){this.logger,L.setMessageConsumer(this),this._fsm.acceptMessage(L)}handleUncorrelatedControlMessage(L){const{LOG_INFO:M,LOG_DEBUG:G,LOG_TRACE:K}=this.logger;M("Handling uncorrelated control message");const F=L.msgType,{SMFAdProtocolMessageType:Y}=i;switch(F){case Y.UNBIND:{const _=L.smfHeader.pm_respcode,U=L.smfHeader.pm_respstr,A=o.getADErrorSubcode(_,U);L.getEndpointErrorId(),L.getEndpointErrorId()!==void 0&&(this.endpointErrorId=L.getEndpointErrorId()),this.processFSMEvent(new l({name:u.FLOW_UNBOUND},new g(U,A,_)))}break;case Y.FLOWCHANGEUPDATE:this.processFSMEvent(new l({name:u.FLOW_ACTIVE_IND},{active:L.getActiveFlow()}));break;default:Y.describe(F)}}getProperties(){return super.getProperties()}onVRNChanged(){this.processFSMEvent(new l({name:u.VIRTUALROUTER_NAME_CHANGED}))}get accessType(){return this._accessType}set accessType(L){this._accessType=L}get active(){return this._active}set active(L){L!==this._active&&this._emit(L?C.ACTIVE:C.INACTIVE),this._active=L}get queueDiscardBehavior(){return this._queueDiscardBehavior}set queueDiscardBehavior(L){this._queueDiscardBehavior=L}get respectsTTL(){return this._respectsTTL}set respectsTTL(L){this._respectsTTL=L}get flowId(){return this._flowId}set flowId(L){this._flowId=L}get permissions(){return this._permissions||0}set permissions(L){this._permissions=L}_onFlowActive(L){this.logger,this._flowId,this._active=L}_onFlowDisconnected(L){const{LOG_INFO:M}=this.logger;M(`${this} disconnected: ${L}.message`)}_disposeFSM(){const{LOG_INFO:L}=this.logger;L("Disposing FSM"),this.processFSMEvent(new l({name:u.DISPOSE}))}_onFlowUp(){const{LOG_INFO:L}=this.logger;L(`Flow is up: flowId = ${this._flowId}`)}inspect(){return Object.assign(super.inspect(),{destination:this._destination,accessType:y.describe(this.accessType),permissions:P.describe(this.permissions),respectsTTL:this.respectsTTL,active:this.wantFlowChangeNotify?this.active:"(indications disabled)",wantFlowChangeNotify:this.wantFlowChangeNotify,queueDiscardBehavior:x.describe(this.queueDiscardBehavior),maxWindowSize:this._fsm.maxWindowSize})}toString(){return r(this)}_isDisconnected(){return this._fsm.isDisconnected()}addSubscription(L,M,G){this._sessionInterface.updateQueueSubscription(L,this._fsm.getDestination(),!0,this,(K,F,Y,_)=>{if(K){const U=new S(C.SUBSCRIPTION_OK,_,Y,F,M,`Topic: ${L.getName()}`);this._emit(C.SUBSCRIPTION_OK,U)}else{const U=new S(C.SUBSCRIPTION_ERROR,_,Y,F,M,`Topic: ${L.getName()}`);this._emit(C.SUBSCRIPTION_ERROR,U)}},G)}removeSubscription(L,M,G){this._sessionInterface.updateQueueSubscription(L,this._fsm.getDestination(),!1,this,(K,F,Y,_)=>{if(K){const U=new S(C.SUBSCRIPTION_OK,_,Y,F,M,`Topic: ${L.getName()}`);this._emit(C.SUBSCRIPTION_OK,U)}else{const U=new S(C.SUBSCRIPTION_ERROR,_,Y,F,M,`Topic: ${L.getName()}`);this._emit(C.SUBSCRIPTION_ERROR,U)}},G)}}},1896:(n,I,e)=>{const{MessageConsumerEventName:r}=e(2235);function i(t){return`MessageConsumerEventName.${r.describe(t)}`}n.exports={MessageDispatcher:class{constructor({emitter:t,autoAck:c,logger:l}={}){Object.assign(this,{emitter:t,queue:[],dispatch:!0,formatEventName:i,logger:l}),this._dispatchOne=c?this._dispatchOneAutoAck:this._dispatchOneBare,this.emitter.setOnFirstDirectListener(this._onFirstMessageListener.bind(this)),this._availableListener=!0}start(){this.dispatch=!0,this._flush()}stop(){this.dispatch=!1}get length(){return this.queue.length}push(t){this.logger,this.queue.push(t),this.dispatch?this._flush():t.getGuaranteedMessageId()}_onFirstMessageListener(){this.logger,this._availableListener||(this.queue.length,this.dispatch,this._availableListener=!0),this._flush()}_flush(){for(this.logger;this.queue.length&&this.dispatch&&this.emitter.directListenerCount()>0;)this._dispatchOne(this.queue.shift());this.queue.length&&this.dispatch&&this.emitter.directListenerCount()===0&&this._availableListener&&(this._availableListener=!1)}_dispatchOneAutoAck(t){const{LOG_WARN:c}=this.logger;let l=null;if(l=this._dispatchOneBare(t),l)c(`Suppressing message acknowledgement for message ${t.getGuaranteedMessageId()} because client threw exception from listener`,l);else{if(t.isAcknowledged)return void c(`Consumer configured to auto-acknowledge messages, but message ${t.getGuaranteedMessageId()} was application acknowledged`);t.acknowledge()}}_dispatchOneBare(t){const{LOG_WARN:c}=this.logger;let l;this.listenerCount===0&&c(`No listeners to dispatch message ${t.getGuaranteedMessageId()}`);try{this.emitter.emitDirect(t)}catch(u){l=this.emitter.formatErrorEvent(u,r.MESSAGE,t),this.emitter.emit("error",l)}return l}}}},2603:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.QueueBrowserEventName=r.new({UP:"QueueBrowserEventName_up",DOWN:"QueueBrowserEventName_down",DOWN_ERROR:"QueueBrowserEventName_downError",CONNECT_FAILED_ERROR:"QueueBrowserEventName_connectFailedError",GM_DISABLED:"QueueBrowserEventName_GMDisabled",DISPOSED:"QueueBrowserEventName_disposed",MESSAGE:"QueueBrowserEventName_message"})},1883:(n,I,e)=>{const r=e(5754),{APIProperties:i}=e(7882),{Check:t}=e(2201),c={queueDescriptor:void 0,connectTimeoutInMsecs:1e4,connectAttempts:3,windowSize:255,transportAcknowledgeTimeoutInMsecs:1e3,transportAcknowledgeThresholdPercentage:60};n.exports.QueueBrowserProperties=class extends i{constructor(l){super(c,l)}get queueDescriptor(){return t.something(this._queueDescriptor)?this._queueDescriptor:c.queueDescriptor}set queueDescriptor(l){this._queueDescriptor=l&&new r.QueueDescriptor(l)}get connectTimeoutInMsecs(){return t.something(this._bindTimeoutInMsecs)?this._bindTimeoutInMsecs:c.connectTimeoutInMsecs}set connectTimeoutInMsecs(l){this._bindTimeoutInMsecs=l}get connectAttempts(){return t.something(this._connectAttempts)?this._connectAttempts:c.connectAttempts}set connectAttempts(l){this._connectAttempts=l}get windowSize(){return t.something(this._windowSize)?this._windowSize:c.windowSize}set windowSize(l){this._windowSize=l}get transportAcknowledgeTimeoutInMsecs(){return t.something(this._transportAcknowledgeTimeoutInMsecs)?this._transportAcknowledgeTimeoutInMsecs:c.transportAcknowledgeTimeoutInMsecs}set transportAcknowledgeTimeoutInMsecs(l){this._transportAcknowledgeTimeoutInMsecs=l}get transportAcknowledgeThresholdPercentage(){return t.something(this._transportAcknowledgeThresholdPercentage)?this._transportAcknowledgeThresholdPercentage:c.transportAcknowledgeThresholdPercentage}set transportAcknowledgeThresholdPercentage(l){this._transportAcknowledgeThresholdPercentage=l}}},1690:(n,I,e)=>{const{EventEmitter:r}=e(7758),{LogFormatter:i}=e(390),{MessageConsumerEventName:t}=e(2235),{QueueBrowserEventName:c}=e(2603);function l(u){return`QueueBrowserEventName.${c.describe(u)}`}n.exports.QueueBrowser=class extends r{constructor(u){super({direct:c.MESSAGE,emits:c.values,formatEventName:l}),this._messageConsumer=u,this.logger=new i((...o)=>["[queue-browser]",...o]),this._setupEventListers()}_setupEventListers(){this._messageConsumer.on(t.UP,this._onConsumerUp.bind(this)),this._messageConsumer.on(t.CONNECT_FAILED_ERROR,this._onConsumerConnectFailed.bind(this)),this._messageConsumer.on(t.DOWN,this._onConsumerDown.bind(this)),this._messageConsumer.on(t.DOWN_ERROR,this._onConsumerDownError.bind(this)),this._messageConsumer.on(t.MESSAGE,this._onConsumerMessage.bind(this)),this._messageConsumer.on(t.DISPOSED,this._onConsumerDisposed.bind(this)),this._messageConsumer.on(t.GM_DISABLED,this._onConsumerGMDisabled.bind(this))}_onConsumerMessage(u){this.emit(c.MESSAGE,u)}_onConsumerUp(u){this.emit(c.UP,u)}_onConsumerConnectFailed(u){this.emit(c.CONNECT_FAILED_ERROR,u)}_onConsumerDown(u){this.emit(c.DOWN,u)}_onConsumerDownError(u){this.emit(c.DOWN_ERROR,u)}_onConsumerDisposed(u){this.emit(c.DISPOSED,u)}_onConsumerGMDisabled(u){this.emit(c.GM_DISABLED,u)}connect(){const{LOG_DEBUG:u,LOG_ERROR:o}=this.logger;try{this._messageConsumer.connect()}catch(f){throw o(f.toString()),f}}disconnect(){const{LOG_DEBUG:u,LOG_ERROR:o}=this.logger;try{this._messageConsumer.disconnect()}catch(f){throw o(f.toString()),f}}start(){const{LOG_DEBUG:u,LOG_ERROR:o}=this.logger;try{this._messageConsumer.start()}catch(f){throw o(f.toString()),f}}stop(){const{LOG_DEBUG:u,LOG_ERROR:o}=this.logger;try{this._messageConsumer.stop()}catch(f){throw o(f.toString()),f}}removeMessageFromQueue(u){this._messageConsumer.applicationAck(u._guaranteedMsgId),u._acked=!0}}},1019:(n,I,e)=>{var r=e(9489);const{Enum:i}=e(9359);e(390);const{Long:t}=e(840),c=i.new({OK:0,DUPLICATE:1,OUT_OF_ORDER:2});n.exports={TransportAcks:class{constructor(l=0){const u=typeof l=="number"?t.fromNumber(l,!0):t.fromValue(l);this.lastAcked=u,this._acksPending=0}reset(){this._acksPending=0,this.lastAcked=t.ZERO}tryReceive(l,u){return this._lastReceived.lt(u)?(this._lastReceived,c.OUT_OF_ORDER):this._lastReceived.gte(l)?(this._lastReceived,this._acksPending++,c.DUPLICATE):(this._lastReceived=l,this._acksPending++,c.OK)}setAcked(){this._lastAcked=t.fromValue(this._lastReceived),this._acksPending=0}get acksPending(){return this._acksPending}get lastAcked(){return this._lastAcked}set lastAcked(l){l.toString(),Object.assign(this,{_lastAcked:t.fromValue(l),_lastReceived:t.fromValue(l)})}get lastReceived(){return this._lastReceived}toString(){return r(this)}},TransportAckResult:c}},6780:(n,I,e)=>{const{MessagePublisher:r}=e(9691),{MessagePublisherAcknowledgeMode:i}=e(142),{MessagePublisherEventName:t}=e(5290),{MessagePublisherProperties:c}=e(3762),{MessagePublisherPropertiesValidator:l}=e(6645),{PublisherFSMEvent:u}=e(9902),{PublisherFSMEventNames:o}=e(5166);n.exports.MessagePublisherAcknowledgeMode=i,n.exports.MessagePublisher=r,n.exports.MessagePublisherProperties=c,n.exports.PublisherFSMEvent=u,n.exports.PublisherFSMEventNames=o,n.exports.MessagePublisherPropertiesValidator=l,n.exports.MessagePublisherEventName=t},8809:(n,I,e)=>{var r=e(9489);const{Long:i}=e(840),t={_lastAcked:i.fromNumber(0,!0),_lastSent:i.fromNumber(0,!0),_next:i.fromNumber(1,!0)},c=l=>l.toString(10);n.exports.MessageIds=class{constructor(l){Object.assign(this,t,l)}get lastAcked(){return this._lastAcked}set lastAcked(l){this._lastAcked=i.fromValue(l)}get lastSent(){return this._lastSent}setLastSent(l){this._lastSent=i.fromValue(l),this._next=this._lastSent.add(1)}get next(){return this._next}inspect(){return{lastAcked:c(this.lastAcked),lastSent:c(this.lastSent),next:c(this.next)}}toString(){return r(this)}}},142:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessagePublisherAcknowledgeMode=r.new({PER_MESSAGE:"PER_MESSAGE",WINDOWED:"WINDOWED"})},5290:(n,I,e)=>{const{Enum:r}=e(9359),i=r.new({ACKNOWLEDGED_MESSAGE:"MessagePublisherEventName_acknowledgedMessage",CONNECT_FAILED_ERROR:"MessagePublisherEventName_connectFailedError",CAN_SEND:"MessagePublisherEventName_canSend",DISPOSED:"MessagePublisherEventName_disposed",DOWN:"MessagePublisherEventName_down",FLOW_NAME_CHANGED:"MessagePublisherEventName_flowNameChanged",GUARANTEED_MESSAGING_DOWN:"MessagePublisherEventName_guaranteedMessagingDown",REJECTED_MESSAGE:"MessagePublisherEventName_rejectedMessage",DISCONNECT_FAILED_ERROR:"MessagePublisherEventName_disconnectFailedError",UP:"MessagePublisherEventName_up",TRANSPORT_FULL:"MessagePublisherEventName_transportFull"});n.exports.MessagePublisherEventName=i},6645:(n,I,e)=>{const{APIPropertiesValidators:r}=e(7882),{MessagePublisherAcknowledgeMode:i}=e(142),{validateInstance:t,valBoolean:c,valIsMember:l,valNumber:u,valRange:o}=r,f={validate(g){const h=t.bind(null,"MessagePublisherProperties",g);h("enabled",[c]),h("windowSize",[u],[o,1,255]),h("acknowledgeTimeoutInMsecs",[u],[o,20,6e4]),h("acknowledgeMode",[l,i,"MessagePublisherAcknowledgeMode"]),h("connectRetryCount",[u],[o,0,Number.MAX_VALUE]),h("connectTimeoutInMsecs",[u],[o,50,Number.MAX_VALUE])}};n.exports.MessagePublisherPropertiesValidator=f},3762:(n,I,e)=>{const r=e(828),{APIProperties:i}=e(7882),{Check:t}=e(2201),{MessagePublisherAcknowledgeMode:c}=e(142),{TransportCapabilities:l}=e(3147);function u(){const{ProfileBinding:f}=r,g=f.value.guaranteedMessagingEnabled,h=l.web.webSocket();return g&&h}function o(){return{enabled:u(),windowSize:50,acknowledgeTimeoutInMsecs:2e3,acknowledgeMode:c.PER_MESSAGE,connectRetryCount:3,connectTimeoutInMsecs:5e3}}n.exports.MessagePublisherProperties=class extends i{constructor(f){super(o(),f||{})}get enabled(){return this._enabled}set enabled(f){this._enabled=f}get windowSize(){return t.defined(this._windowSize)?this._windowSize:o().windowSize}set windowSize(f){this._windowSize=f}get acknowledgeTimeoutInMsecs(){return t.defined(this._acknowledgeTimeoutInMsecs)?this._acknowledgeTimeoutInMsecs:o().acknowledgeTimeoutInMsecs}set acknowledgeTimeoutInMsecs(f){this._acknowledgeTimeoutInMsecs=f}get acknowledgeMode(){return this._acknowledgeMode||c.PER_MESSAGE}set acknowledgeMode(f){this._acknowledgeMode=f}get connectRetryCount(){return t.defined(this._connectRetryCount)?this._connectRetryCount:o().connectRetryCount}set connectRetryCount(f){this._connectRetryCount=f}get connectTimeoutInMsecs(){return t.defined(this._connectTimeoutInMsecs)?this._connectTimeoutInMsecs:o().connectTimeoutInMsecs}set connectTimeoutInMsecs(f){this._connectTimeoutInMsecs=f}inspect(){return{enabled:this.enabled,windowSize:this.windowSize,acknowledgeTimeoutInMsecs:this.acknowledgeTimeoutInMsecs,acknowledgeMode:c.describe(this.acknowledgeMode),connectRetryCount:this.connectRetryCount,connectTimeoutInMsecs:this.connectTimeoutInMsecs}}}},9691:(n,I,e)=>{var r=e(9489);const i=e(7291),{Flow:t,PrivateFlowEventName:c}=e(5370),{LogFormatter:l}=e(390),{MessagePublisherEventName:u}=e(5290),{MessagePublisherProperties:o}=e(3762),{PublisherFSM:f}=e(4343),{PublisherFSMEvent:g}=e(9902),{PublisherFSMEventNames:h}=e(5166),{LOG_WARN:T}=new l;n.exports.MessagePublisher=class extends t{constructor({properties:S,sessionInterfaceFactory:C}={}){super(new o(S),C,{direct:u.ACKNOWLEDGED_MESSAGE,emits:u.values}),this._fsm=this._makeFSM();const p=new l;p.formatter=function(...R){return["[message-publisher]",...R]},this.log=p.wrap(this.log,this),this._bindWaiting=!0,this.on(c.BIND_WAITING,this._onBindWaiting.bind(this)),this.on(u.CONNECT_FAILED_ERROR,this._onBindFailed.bind(this)),this.on(u.DOWN,this._onDown.bind(this)),this.on(u.UP,this._onUp.bind(this))}_onBindFailed(){this._bindWaiting=!1}_onBindWaiting(){this._bindWaiting=!0}_onDown(){this._bindWaiting=!1}_onUp(){this._bindWaiting=!1}_makeFSM(){return new f({publisher:this,name:"PublisherFSM",sessionInterface:this._sessionInterface,properties:this._properties})}get flowId(){return this._flowId}set flowId(S){this._flowId=S}get name(){return this._flowName}set name(S){this._flowName=S}get publisherId(){return this._publisherId}set publisherId(S){this._publisherId=S}get properties(){return this._properties.clone()}connect(){super.connect(),this._fsm.getCurrentState()||this._fsm.start()}_disconnectSession(){super._disconnectSession(),this.processFSMEvent(new g({name:h.FLOW_CLOSE}))}getDisposedEvent(){return u.DISPOSED}handleAck(S){this.processFSMEvent(new g({name:h.ACK},{ack:S}))}handleNack(S,C){this.processFSMEvent(new g({name:h.ACK},{nack:S,ctrlMessage:C}))}handleUncorrelatedControlMessage(S){const C=S.msgType,{SMFAdProtocolMessageType:p}=i;switch(C){case p.CLIENTACK:{const R=S.getLastMsgIdAcked();S.smfHeader.pm_respcode>299?this.handleNack(R,S):this.handleAck(R);break}case p.CLIENTNACK:{const R=S.getLastMsgIdAcked();this.handleNack(R,S);break}case p.CLOSEPUBFLOW:this.processFSMEvent(new g({name:h.FLOW_UNBOUND}));break;default:T(`Dropping unhandled AD control message for ${this}`,p.describe(C))}}prepareAdMessageAndSend(S){return this._fsm.prepareAdMessageAndSend(S)}isBindWaiting(){return this._bindWaiting}inspect(){return Object.assign(super.inspect(),{name:this.name,publisherId:this.publisherId})}toString(){return r(this)}_disposeFSM(){this.processFSMEvent(new g({name:h.DISPOSE}))}_isDisconnected(){return this._fsm.isDisconnected()}}},5166:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.PublisherFSMEventNames=r.new({SESSION_UP:"PublisherSessionUp",SESSION_UP_NO_AD:"PublisherSessionUpNoAD",SESSION_DOWN:"PublisherSessionDown",FLOW_FAILED:"MessagePublisherFailed",FLOW_UP:"MessagePublisherUp",FLOW_CLOSE:"MessagePublisherClose",FLOW_UNBOUND:"MessagePublisherUnbound",TRANSPORT_FULL:"PublisherTransportFull",ACK:"PublisherAck",ACK_TIMEOUT:"PublisherAckTimeout",BIND_TIMEOUT:"PublisherBindTimeout",UNBIND_TIMEOUT:"PublisherUnbindTimeout",CAN_SEND:"PublisherCanSend",TRANSPORT_ERROR:"PublisherTransportError",RESEND_COMPLETE:"PublisherResendComplete",DISPOSE:"PublisherDispose"})},9902:(n,I,e)=>{const{FsmEvent:r}=e(8535);n.exports.PublisherFSMEvent=class extends r{constructor(i,t,c){super(i),Object.assign(this,t),Object.assign(this,c)}getEventText(){return this._eventText}}},4343:(n,I,e)=>{const r=e(7291),i=e(5594),{ErrorResponseSubcodeMapper:t,ErrorSubcode:c,OperationError:l}=e(3870),{LogFormatter:u}=e(390),{Long:o}=e(840),{MessageIds:f}=e(8809),{MessagePublisherAcknowledgeMode:g}=e(142),{MessagePublisherEventName:h}=e(5290),{PrivateFlowEventName:T}=e(5370),{PublisherFSMEvent:S}=e(9902),{PublisherFSMEventNames:C}=e(5166),{PublisherStateNames:p}=e(6955),{State:R,StateMachine:N}=e(8535),{StatType:w}=e(6818),{TransportReturnCode:y}=e(3147);n.exports.PublisherFSM=class extends N{constructor({publisher:P,name:x,sessionInterface:B,properties:H}={}){super({name:x});const L=this,M=()=>{const _=L.getCurrentState();return _?_.getName():"<not running>"};this.logger=new u((..._)=>[`[session=${B.sessionIdHex}]`,`[message-publisher-fsm=${P.flowIdDec}]`,`[${M()}]`,..._]),this.log=this.logger.wrap(this.log,this);const{LOG_TRACE:G,LOG_DEBUG:K,LOG_INFO:F,LOG_WARN:Y}=this.logger;Object.assign(this,{_publisher:P,_acknowledgeMode:H.acknowledgeMode,_acknowledgeTimeoutInMsecs:H.acknowledgeTimeoutInMsecs,_sessionInterface:B,_windowSize:H.windowSize,_stateEvents:[]}),this._guaranteedEnabled=H.enabled,this._sendWindow=H.windowSize,this._resetConnectedInfo(),this._notifiedWindowClosed=!1,this._transportFlowControlled=!0,this.initial(function(){return this.transitionTo(L.PublisherUnbound,_=>{_.getStateMachine().getName()})}),L.unhandledEventReaction(function(_){switch(_.getName()){case C.FLOW_UNBOUND:return this._guaranteedEnabled=!1,this._publisher.emit(h.GUARANTEED_MESSAGING_DOWN),this.transitionTo(L.PublisherUnbound,U=>{U.getStateMachine().getName()});case C.DISPOSE:case C.TRANSPORT_FULL:case C.CAN_SEND:break;default:_.getName()}return this}),L.PublisherUnbound=new R({name:p.UNBOUND,parentContext:L},{emitDownAndBindWaiting(){P.emit(h.DOWN),P.emit(T.BIND_WAITING)}}).entry(function(){this.emitDownAndBindWaiting(),L._connectRetryCount=H.connectRetryCount}).reaction(C.FLOW_UNBOUND,function(){return this.internalTransition()}).reaction(C.SESSION_UP,function(){return this.transitionTo(L.PublisherOpenFlowSent)}),L.PublisherOpenFlowSent=new R({name:p.OPENFLOWSENT,parentContext:L},{emitOpenFlowFailedError(_){P.emit(h.CONNECT_FAILED_ERROR,_)},handleOpenFlowResponse(_){const U=_.smfHeader,A=U.pm_respcode;if(_.msgType!==r.SMFAdProtocolMessageType.OPENPUBFLOW)return L.processEvent(new S({name:C.FLOW_FAILED},{returnCode:A,description:`Unexpected response: ${r.SMFAdProtocolMessageType.describe(_.msgType)}`}));if(A===null)return P.incStat(w.RX_DISCARD_SMF_UNKNOWN_ELEMENT),B.sessionIdHex,null;if(A!==200){const oe=U.pm_respstr,de=t.getADErrorSubcode(A,oe);return L.processEvent(new S({name:C.FLOW_FAILED},{subcode:de,returnCode:A,description:oe}))}const z=_.getLastMsgIdAcked(),J=_.getWindow(),se=_.getFlowId(),Te=_.getFlowName(),pe=_.getPublisherId();if(L._messageIds,J===void 0)return L.processEvent(new S({name:C.FLOW_FAILED},{description:"Window parameter not found"}));if(J>this._windowSize)return L.processEvent(new S({name:C.FLOW_FAILED},{description:"Invalid window negotiation"}));L._sendWindow=J-L._unackedList.length,L._sendWindow<0&&(L._sendWindow=0),Object.assign(L._publisher,{name:Te,flowId:se,publisherId:pe}),L._guaranteedEnabled=!0,L._connectReason===0||L._connectReason===2?(L._messageIds.setLastSent(z),L._messageIds,L._connectReason,L._connectReason===2&&P.emit(h.FLOW_NAME_CHANGED,{messages:[...L._unackedList],count:L._unackedList.length}),L._connectReason=1,L._unackedList.forEach(oe=>{oe.getGuaranteedMessageId(),L._renumber(oe),oe.getGuaranteedMessageId(),L._messageIds.setLastSent(oe.getGuaranteedMessageId())})):L._unackedList.forEach(oe=>{oe.setFlowId(se),oe.setPublisherId(P.publisherId),oe.getGuaranteedMessageId()});const ne=L._sessionInterface.getCapability(i.CapabilityType.MAX_GUARANTEED_MSG_SIZE).getValue();return L._unackedList.forEach(oe=>{ne<oe._memoized_payload.length&&Y(`Message size ${oe._memoized_payload.length} above broker limit ${ne}`)}),L._unackedList.length?(L._handleAck(z,!1,_,!0),L._firstUnackedToSend=L._unackedList[0]):L._messageIds.lastAcked=o.fromValue(z),L._messageIds,L.processEvent(new S({name:C.FLOW_UP}))},handleOpenFlowTimeout:()=>(F("Open publisher connection timeout"),L.processEvent(new S({name:C.BIND_TIMEOUT}))),handleUnknownFlowName(){return F("Flow name unknown, republish required"),L._resetConnectedInfo(!0),this.externalTransitionTo(L.PublisherOpenFlowSent)},sendOpenFlow(){const _=B.getCorrelationTag(),U=r.AdProtocolMessage.getOpenMessagePublisher(L._messageIds.lastAcked,L._messageIds.lastSent,H.windowSize,L._publisher._flowName,_);L._messageIds.lastAcked,L._messageIds.lastSent,H.windowSize,L._publisher._flowName,B.sendControl(U),B.enqueueRequest(_,()=>this.handleOpenFlowTimeout(),H.connectTimeoutInMsecs,null,A=>this.handleOpenFlowResponse(A))}}).entry(function(){try{this.sendOpenFlow()}catch(_){Y(`Exception during bind attempt: ${_}`),L.processEvent(new S({name:C.SESSION_DOWN}))}}).reaction(C.FLOW_CLOSE,function(){return this.transitionTo(L.PublisherCloseFlowSent)}).reaction(C.FLOW_UP,function(){return this.transitionTo(L.PublisherUp)}).reaction(C.SESSION_DOWN,function(){return this.transitionTo(L.PublisherUnbound)}).reaction(C.BIND_TIMEOUT,function(){return L._connectRetryCount>0?(L._connectRetryCount--,this.externalTransitionTo(L.PublisherOpenFlowSent)):(this.emitOpenFlowFailedError({subcode:c.TIMEOUT,description:"Open publisher connection failed due to timeout"}),this.transitionTo(L.PublisherUnbound))}).reaction(C.FLOW_FAILED,function(_){const{subcode:U,returnCode:A,description:z}=_;return _.subcode===c.UNKNOWN_FLOW_NAME?this.handleUnknownFlowName():(this.emitOpenFlowFailedError({event:_,subcode:U,returnCode:A,description:z}),L._resetConnectedInfo(),this.transitionTo(L.PublisherUnbound))}),L.PublisherCloseFlowSent=new R({name:p.CLOSEFLOWSENT,parentContext:L},{handleCloseFlowResponse(_){const U=_.smfHeader,A=U.pm_respcode;return _.msgType!==r.SMFAdProtocolMessageType.CLOSEPUBFLOW?L.processEvent(new S({name:C.FLOW_FAILED},{returnCode:A,description:`Unexpected response: ${r.SMFAdProtocolMessageType.describe(_.msgType)}`})):A===null?(P.incStat(w.RX_DISCARD_SMF_UNKNOWN_ELEMENT),B.sessionIdHex,null):(A!==200&&L.processEvent(new S({name:C.FLOW_FAILED},{returnCode:A,description:U.pm_respstr})),L.processEvent(new S({name:C.FLOW_UNBOUND})))},handleCloseFlowTimeout:()=>(F("Close publisher connection timeout."),L.processEvent(new S({name:C.UNBIND_TIMEOUT}))),sendCloseFlow(){const _=B.getCorrelationTag(),U=r.AdProtocolMessage.getCloseMessagePublisher(L._publisher.flowId,_);B.sendControl(U),B.enqueueRequest(_,()=>this.handleCloseFlowTimeout(),H.connectTimeoutInMsecs,null,A=>this.handleCloseFlowResponse(A))}}).entry(function(){return this.sendCloseFlow(),this}).reaction(C.ACK,function(_){return L._handleAckEvent(_),this.internalTransition()}).reaction(C.FLOW_UNBOUND,function(){return this.transitionTo(L.PublisherUnbound)}).reaction(C.FLOW_FAILED,function(){this.transitionTo(L.PublisherUnbound)}).reaction(C.UNBIND_TIMEOUT,function(){return this.transitionTo(L.PublisherCloseFlowSent)}),L.PublisherUp=new R({name:p.UP,parentContext:L},{emitFlowUp(){P.emit(h.UP)}}).initial(function(){return this.transitionTo(L._unackedList.length?L.PublisherRetransmitting:L.PublisherDataXfer)}).entry(function(){return L._scheduleStateEvents(L.PublisherUp,()=>this.emitFlowUp()),this}).reaction(C.ACK,function(_){return L._handleAckEvent(_),this.internalTransition()}).reaction(C.ACK_TIMEOUT,function(){return L._firstUnackedToSend=L._unackedList[0],this.transitionTo(L.PublisherRetransmitting)}).reaction(C.FLOW_CLOSE,function(){return this.transitionTo(L.PublisherCloseFlowSent)}).reaction(C.SESSION_DOWN,function(){return this.transitionTo(L.PublisherUnbound)}).reaction(C.TRANSPORT_FULL,function(){return this.internalTransition()}),L.PublisherDataXfer=new R({name:p.DATA_XFER,parentContext:L.PublisherUp}).entry(()=>{L._transportFlowControlled=!1,L._scheduleStateEvents(L.PublisherDataXfer,()=>L._maybeEmitCanSend())}).reaction(C.TRANSPORT_FULL,function(){return this.transitionTo(L.PublisherFlowControlled)}).exit(()=>{L._transportFlowControlled=!0}),L.PublisherFlowControlled=new R({name:p.FLOW_CONTROLLED,parentContext:L.PublisherUp}).reaction(C.TRANSPORT_FULL,function(){return F("Attempt to send while flow controlled"),this.internalTransition()}).reaction(C.CAN_SEND,function(){return this.transitionTo(L.PublisherRetransmitting)}),L.PublisherRetransmitting=new R({name:p.RETRANSMITTING,parentContext:L.PublisherUp},{retransmit(){try{L._resendFromUnacked()}catch(_){_ instanceof l&&_.subcode===c.INSUFFICIENT_SPACE?L.processEvent(new S({name:C.TRANSPORT_FULL})):(F(`Publisher resendFromUnacked failed: ${_}`),L.processEvent(new S({name:C.FLOW_FAILED})))}}}).entry(function(){this.retransmit()}).reaction(C.RESEND_COMPLETE,function(){return this.transitionTo(L.PublisherDataXfer)}).reaction(C.TRANSPORT_FULL,function(){return L._unackedList.length,this.transitionTo(L.PublisherFlowControlled)})}isDisconnected(){return!this.getCurrentState()||!!this.getActiveState(p.UNBOUND)}prepareAdMessageAndSend(P){if(!this._guaranteedEnabled)throw new l("Session does not provide Guaranteed Message Publish capability",c.GM_UNAVAILABLE,"close flow received from message-router");if(this._sendWindow<=0)throw this._publisher.incStat(w.TX_WINDOW_CLOSED),this._notifiedWindowClosed=!0,new l("Guaranteed Message Window Closed",c.INSUFFICIENT_SPACE);const x=this._unackedList,{LOG_TRACE:B,LOG_DEBUG:H,LOG_INFO:L,LOG_WARN:M}=this.logger;P._payload_is_memoized&&(P._payload_is_memoized=!1,P._memoized_csumm=void 0,P._memoized_payload=void 0);const G=P.clone(),K=r.Codec.Encode.adaptMessageToSmf_payloadMemoize(G);var F=0;try{F=this._sessionInterface.getCapability(i.CapabilityType.MAX_GUARANTEED_MSG_SIZE).getValue()}catch(U){L("Can't pre-check payload size, broker not connected yet?"),U.stack}if(0<F&&K>F)throw new l(`Encoded payload size (${K}) exceeds broker size limit (MAX_GUARANTEED_MSG_SIZE, ${F})`,c.MESSAGE_TOO_LARGE);--this._sendWindow,this._renumber(G),this._cloneNumbers(G,P),x.push(G);const Y=G.getGuaranteedMessageId();if(this._messageIds.setLastSent(Y),x.length,this._sendWindow,this._transportFlowControlled)return this._firstUnackedToSend===void 0&&(this._firstUnackedToSend=G),y.OK;let _;try{_=this._sessionInterface.sendToTransport(G),_!==y.OK?_===y.NO_SPACE&&(_=y.OK,this._firstUnackedToSend=G,this.processEvent(new S({name:C.TRANSPORT_FULL}))):G.setRedelivered(!0),this._startAckTimer()}catch(U){throw U instanceof l?(c.describe(U.subcode),U.message,x.pop(),this._messageIds.setLastSent(G.getGuaranteedPreviousMessageId()),++this._sendWindow,U):(U.message,U)}return y.OK}_handleAckEvent(P){this._publisher.incStat(w.TX_ACKS_RXED),this._handleAck(P.ack||P.nack,!!P.nack,P.ctrlMessage)}_handleAck(P,x,B,H=!1){const{_messageIds:L,_unackedList:M}=this,{LOG_DEBUG:G,LOG_INFO:K}=this.logger;if(L.lastAcked.gte(P))return void(H?this._messageIds:K(`Dropping ack: remote ack for ${P}, local ids ${this._messageIds}`));const F=[];for(;M.length&&P.gte(M[0].getGuaranteedMessageId());)F.push(M.shift());M.indexOf(this._firstUnackedToSend)===-1&&(this._firstUnackedToSend=M[0]),this._sendWindow+=F.length,this._sendWindow,L.lastAcked=P;const Y=x?F.pop():null,_=F.length;if(_)if(this._acknowledgeMode===g.PER_MESSAGE){M.length;for(let U=0;U<_;++U)this._publisher.emit(h.ACKNOWLEDGED_MESSAGE,F[U])}else{const U=F[_-1];U.getGuaranteedMessageId(),this._publisher.emit(h.ACKNOWLEDGED_MESSAGE,U)}Y&&(Y.getGuaranteedMessageId(),this._publisher.emit(h.REJECTED_MESSAGE,Y,B)),M.length,M.length?this._resetAckTimer():this._clearAckTimer(),this._maybeEmitCanSend()}_maybeEmitCanSend(){this.logger,this._notifiedWindowClosed&&this._sendWindow!==0&&(this._notifiedWindowClosed=!1,this._publisher.emit(h.CAN_SEND))}_resendFromUnacked(){const{LOG_ERROR:P,LOG_INFO:x,LOG_DEBUG:B}=this.logger,H=this._unackedList;let L=H.indexOf(this._firstUnackedToSend);if(L===-1)return this._firstUnackedToSend&&P(`Could not find first Unacked Messages in unacked message list: msgId = ${this._firstUnackedToSend.getGuaranteedMessageId}`),void(H.length===0&&(this._messageIds.toString(),this.processEvent(new S({name:C.RESEND_COMPLETE}))));for(H.length,H.map(M=>M.getGuaranteedMessageId().toString());L<H.length;){H[L].getPublisherId()!==this._publisher.publisherId&&P(`Resending on invalid publisherId '${H[L].getPublisherId()}'when it should be '${this._publisher.publisherId}'`);const M=this._sessionInterface.sendData(H[L]);if(M===y.NO_SPACE)return this._firstUnackedToSend=H[L],x("Publisher sendMessage blocked due to insufficient space, wait for CAN_SEND"),void this.processEvent(new S({name:C.TRANSPORT_FULL}));if(M!==y.OK)return;H[L].setRedelivered(!0),L++,this._startAckTimer()}this._messageIds.toString(),this.processEvent(new S({name:C.RESEND_COMPLETE}))}_resetConnectedInfo(P=!1){this.logger,this._ackTimer&&this._clearAckTimer(),Object.assign(this,{_messageIds:new f}),Object.assign(this._publisher,{publisherId:void 0,flowId:void 0,flowName:null}),P?this._connectReason=2:(this._unackedList=[],this._connectReason=0)}_clearAckTimer(){this.logger,this._ackTimer&&this._ackTimer,this._ackTimer&&(clearTimeout(this._ackTimer),this._ackTimer=null)}_emitStateEvents(){for(this.logger;this._stateEvents.length;){const P=this._stateEvents.shift(),x=P[0],B=P[1];this.getActiveState(x.getName())&&B.apply(x)}}_handleAckTimeout(){this.logger,this._ackTimer=null,this._publisher.incStat(w.TX_ACK_TIMEOUT),this.processEvent(new S({name:C.ACK_TIMEOUT}))}_renumber(P){const x=this._messageIds,B=x.next;P.setGuaranteedPreviousMessageId(x.lastSent),P.setGuaranteedMessageId(B);const H=this._publisher;P.setFlowId(H.flowId),P.setPublisherId(H.publisherId)}_cloneNumbers(P,x){x.setGuaranteedPreviousMessageId(P.getGuaranteedPreviousMessageId()),x.setGuaranteedMessageId(P.getGuaranteedMessageId()),x.setFlowId(P.getFlowId()),x.setPublisherId(P.getPublisherId())}_resetAckTimer(){this._clearAckTimer(),this._startAckTimer()}_scheduleStateEvents(P,x){this._stateEvents.push([P,x]),this._setPostEventAction(()=>this._emitStateEvents(),"Emit state events")}_setPostEventAction(P,x="No action"){const{LOG_DEBUG:B,LOG_WARN:H}=this.logger;this._postEventAction&&this._postEventAction.desc===x||(this._postEventAction&&this._postEventAction.desc&&H(`Replacing post event action ${this._postEventAction.desc} with ${x}`),this._postEventAction={action:P||(()=>{}),desc:x},this.setPostEventAction(()=>{this._postEventAction.action(),this._postEventAction=null}))}_startAckTimer(){this._ackTimer||(this._ackTimer=setTimeout(()=>this._handleAckTimeout(),this._acknowledgeTimeoutInMsecs))}}},6955:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.PublisherStateNames=r.new({UNBOUND:"PublisherUnbound",OPENFLOWSENT:"PublisherOpenFlowSent",UP:"PublisherUp",FAILED:"PublisherFailed",CLOSEFLOWSENT:"PublisherCloseFlowSent",DATA_XFER:"PublisherDataXfer",FLOW_CONTROLLED:"MessagePublisherFlowControlled",RETRANSMITTING:"PublisherRetransmitting"})},4789:(n,I,e)=>{const{ReplicationGroupMessageId:r,RgmidFactory:i}=e(4097),{Message:t}=e(337),{MessageCacheStatus:c}=e(2615),{MessageDeliveryModeType:l}=e(969),{MessageDumpFlag:u}=e(1012),{MessageDumpStandardProvider:o}=e(1983),{MessageDumpUtil:f}=e(8292),{MessageType:g}=e(165),{MessageUserCosType:h}=e(95),{SolclientFactory:T}=e(828);T.createMessage=T.createFactory(()=>new t),T.createReplicationGroupMessageId=T.createFactory(S=>i.fromString(S)),n.exports.Message=t,n.exports.MessageCacheStatus=c,n.exports.MessageDeliveryModeType=l,n.exports.MessageDumpFlag=u,n.exports.MessageDumpStandardProvider=o,n.exports.MessageDumpUtil=f,n.exports.MessageType=g,n.exports.MessageUserCosType=h,n.exports.ReplicationGroupMessageId=r,n.exports.RgmidFactory=i},2615:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageCacheStatus=r.new({LIVE:0,CACHED:1,SUSPECT:2})},969:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageDeliveryModeType=r.new({DIRECT:0,PERSISTENT:1,NON_PERSISTENT:2})},1012:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageDumpFlag=r.new({MSGDUMP_BRIEF:0,MSGDUMP_FULL:1})},1983:(n,I,e)=>{const r=e(1880),i=e(8292),{Destination:t}=e(3170),{LOG_ERROR:c}=e(390),{Long:l}=e(840),{MessageCacheStatus:u}=e(2615),{MessageDeliveryModeType:o}=e(969),{MessageDumpFlag:f}=e(1012),{MessageUserCosType:g}=e(95),{SDTMapContainer:h,SDTFieldType:T}=e(7252),{StringUtils:S}=e(7882),C={fpDestination(p){const R=p.getDestination();return R!==null&&R instanceof t?["Destination",!0,R.toString(),null]:["Destination",!1,"",null]},fpSenderId:p=>["SenderId",p.getSenderId()!==void 0&&p.getSenderId()!==null,p.getSenderId(),null],fpAppmsgType:p=>["AppMessageType",p.getApplicationMessageType()!==void 0&&p.getApplicationMessageType()!==null,p.getApplicationMessageType(),null],fpAppMsgId:p=>["AppMessageID",p.getApplicationMessageId()!==void 0&&p.getApplicationMessageId()!==null,p.getApplicationMessageId(),null],fpSequenceNumber(p){const R=p.getSequenceNumber();return typeof R=="number"?["SequenceNumber",!0,R,null]:["SequenceNumber",!1,"",null]},fpTopicSequenceNumber(p){const R=p.getTopicSequenceNumber();return l.isLong(R)?["TopicSequenceNumber",!0,R.toString(),null]:["TopicequenceNumber",!1,"",null]},fpCorrelationId:p=>["CorrelationId",p.getCorrelationId()!==void 0&&p.getCorrelationId()!==null,p.getCorrelationId(),null],fpHttpContentType:()=>["HTTP Content Type",!1,void 0,null],fpHttpContentEncoding:()=>["HTTP Content Encoding",!1,void 0,null],fpSendTimestamp(p){const R=p.getSenderTimestamp();return typeof R=="number"?["SendTimestamp",!0,`${R} (${i.MessageDumpUtil.formatDate(R)})`,null]:["SendTimestamp",!1,"",null]},fpRcvTimestamp(p){const R=p.getReceiverTimestamp();return typeof R=="number"?["RcvTimestamp",!0,`${R} (${i.MessageDumpUtil.formatDate(R)})`,null]:["RcvTimestamp",!1,"",null]},fpClassOfService:p=>typeof p.getUserCos()=="number"?["Class Of Service",!0,g.nameOf(p.getUserCos()),null]:["Class Of Service",!1,"",null],fpDeliveryMode:p=>typeof p.getDeliveryMode()=="number"?["DeliveryMode",!0,o.nameOf(p.getDeliveryMode()),null]:["DeliveryMode",!1,"",null],fpGuaranteedMsgId(p){const R=p.getGuaranteedMessageId();return l.isLong(R)?["Message Id",!0,R.toString(10),null]:["Message Id",!1,"",null]},fpReplicationGroupMessageId(p){const R=p.getReplicationGroupMessageId();return R===void 0?["Replication Group Message Id",!1,"",null]:["Replication Group Message Id",!0,R.toString(),null]},fpTimeToLive(p){const R=p.getTimeToLive();if(typeof R=="number"){const N=i.MessageDumpUtil,w=new Date;return["TimeToLive",!0,`${R} (${N.formatDate(w.getTime()+R)})`,null]}return["TimeToLive",!1,"",null]},fpExpiration(p){const R=p.getGMExpiration();return typeof R=="number"?["Expiration",!0,`${R} (${i.MessageDumpUtil.formatDate(R)})`,null]:["Expiration",!1,"",null]},fpMessageDMQEligible:p=>["DMQ Eligible",p.isDMQEligible(),"",null],fpMessageRedelivered:p=>["Message Re-delivered",p.isRedelivered(),"",null],fpMessageDeliveryCount(p){try{return["Message Delivery Count",!0,p.getDeliveryCount(),null]}catch{return["Message Delivery Count",!1,"",null]}},fpDiscardIndication:p=>["Discard Indication",p.isDiscardIndication(),"",null],fpAckImmediately:p=>["ACK Immediately",p.isAcknowledgeImmediately(),"",null],fpElidingEligible:p=>["Eliding Eligible",p.isElidingEligible(),"",null],fpReplyMessage:p=>["Reply Message",p.isReplyMessage(),"",null],fpReplyTo(p){const R=p.getReplyTo();return R!==null&&R instanceof t?["ReplyTo",!0,R.toString(),null]:["ReplyTo",!1,"",null]},fpDeliverToOne:p=>["Deliver To One",p.isDeliverToOne(),"",null],fpCacheMessage:p=>["Message from cache",p.getCacheStatus()!==u.LIVE,"",null],fpCacheRequestId(p){const R=p.getCacheRequestId();return l.isLong(R)?["Cache Request Id",!0,R.toString,null]:["Cache Request Id",!1,"",null]},fpUserPropertyMap(p,R){const N=p.getUserPropertyMap();if(N!==null&&N instanceof h){const w=`${N.getKeys().length} entries`;let y=null;if(R===f.MSGDUMP_FULL)try{y=i.MessageDumpUtil.printMap(N,2)}catch(P){c(P.message,P.stack),y="Error"}return["User Property Map",!0,w,y]}return["User Property Map",!1,"",null]},fpCorrelationTag(p){const R=p.getCorrelationKey();return["Correlation Tag Pointer",R!=null,R,null]},fpUserData:p=>S.notEmpty(p.getUserData())?["User Data",!0,`len=${p.getUserData().length}`,r.Debug.formatDumpBytes(p.getUserData(),!0,2)]:["User Data",!1,"",null],fpSdtStream(p,R){const N=p.getSdtContainer();if(N!==null&&N.getType()===T.STREAM){const w=i.MessageDumpUtil,y=`${w.countItems(N.getValue())} entries`;let P=null;if(R===f.MSGDUMP_FULL)try{P=w.printStream(N.getValue(),2)}catch(x){c(x.message,x.stack),P="Error"}return["SDT Stream",!0,y,P]}return["SDT Stream",!1,"",null]},fpSdtMap(p,R){const N=p.getSdtContainer();if(N!==null&&N.getType()===T.MAP){const w=`${N.getValue().getKeys().length} entries`;let y=null;if(R===f.MSGDUMP_FULL)try{y=i.MessageDumpUtil.printMap(N.getValue(),2)}catch(P){c(P.message,P.stack),y="Error"}return["SDT Map",!0,w,y]}return["SDT Map",!1,"",null]},fpBinaryAttachment(p,R){if(!p._binaryAttachment||p._binaryAttachment.length<1)return["Binary Attachment",!1,"",null];const N=p._binaryAttachment.toString("latin1"),w=`len=${N.length}`;let y=null;return R===f.MSGDUMP_FULL&&(y=r.Debug.formatDumpBytes(N,!0,2)),["Binary Attachment",!0,w,y]},fpXmlContent(p,R){const N=p.getXmlContent();if(S.notEmpty(N)){const w=`len=${N.length}`;let y=null;return R===f.MSGDUMP_FULL&&(y=r.Debug.formatDumpBytes(N,!0,2)),["XML",!0,w,y]}return["XML",!1,"",null]},fpXmlMetadata(p,R){const N=p.getXmlMetadata();if(S.notEmpty(N)){const w=`len=${N.length}`;let y=null;return R===f.MSGDUMP_FULL&&(y=r.Debug.formatDumpBytes(N,!0,2)),["XML Metadata",!0,w,y]}return["XML Metadata",!1,"",null]}};n.exports.MessageDumpStandardProvider=C},8292:(n,I,e)=>{const r=e(1880),i=e(1983),{SDTFieldType:t,SDTMapContainer:c,SDTStreamContainer:l,SDTUnsupportedValueError:u,SDTValueErrorSubcode:o}=e(7252),{Check:f}=e(2201),{ErrorSubcode:g,OperationError:h}=e(3870),{MessageDumpFlag:T}=e(1012),{StringBuffer:S,StringUtils:C}=e(7882),p={get dumpProviders(){const N=i.MessageDumpStandardProvider;return Object.keys(N).map(w=>N[w])}},R={getOutOfRangeValue:N=>typeof N=="string"?`<out of range>
${r.Debug.formatDumpBytes(N)}`:`<out of range>
${r.Debug.formatDumpBytes(N.toString("latin1"))}`,getValue(N){let w=null;try{return w=N.getValue(),w}catch(y){if(y instanceof u){if(y.getSubcode()===o.VALUE_OUTSIDE_SUPPORTED_RANGE)return this.getOutOfRangeValue(y.getSourceData())}else if(y instanceof h&&y.subcode===g.PARAMETER_INVALID_TYPE)return"<invalid type>";throw y}},printMap(N,w){if(f.nothing(N)||!(N instanceof c))return null;const y=[],P=C.padRight("",w," ");return N.getKeys().sort().forEach(x=>{const B=N.getField(x),H=B.getType(),L=this.getValue(B);let M;switch(H){case t.MAP:M=`
${this.printMap(L,w+2)}`;break;case t.STREAM:M=`
${this.printStream(L,w+2)}`;break;case t.BYTEARRAY:M=r.Debug.formatDumpBytes(L.toString("latin1"),!1,0),M!==null&&M.substr(-1)===`
`&&(M=M.substring(0,M.length-1));break;default:M=L!==null?L.toString():null}y.push(`${P}Key '${x}' (${t.nameOf(H)}): ${M}`)}),y.join(`
`)},printStream(N,w){if(f.nothing(N)||!(N instanceof l))return null;N.rewind();const y=[],P=C.padRight("",w," ");for(;N.hasNext();){const x=N.getNext(),B=x.getType(),H=this.getValue(x);let L;switch(B){case t.MAP:L=`
${this.printMap(H,w+2)}`;break;case t.STREAM:L=`
${this.printStream(H,w+2)}`;break;case t.BYTEARRAY:L=r.Debug.formatDumpBytes(H.toString("latin1"),!1,0),L!==null&&L.substr(-1)===`
`&&(L=L.substring(0,L.length-1));break;case t.DESTINATION:L=H.toString();break;default:L=H!==null?H.toString():null}y.push(`${P}(${t.nameOf(B)}): ${L}`)}return N.rewind(),y.join(`
`)},countItems(N){if(f.nothing(N)||!(N instanceof l))return 0;N.rewind();let w=0;for(;N.hasNext();)N.getNext(),w++;return N.rewind(),w},formatDate:N=>new Date(N).toString(),dump(N,w,y,P){const x=new S;let B=`
`,H=!1,L=40;return y!=null&&typeof y=="string"&&(B=y),P!=null&&typeof P=="number"&&(L=P),p.dumpProviders.forEach((M,G)=>{const[K,F,Y,_]=M(N,w);F&&(H&&x.append(B),Y===null||Y.length===0?x.append(K):(x.append(C.padRight(`${K}:`,L," ")),x.append(Y)),_!==null&&w&T.MSGDUMP_FULL&&(x.append(`
`),_.indexOf("  ")!==0&&x.append("  "),x.append(_),_.substr(-1)!==`
`&&G<p.dumpProviders.length-1&&x.append(`
`)),H=!0)}),x.toString()}};n.exports.MessageDumpUtil=R},165:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageType=r.new({BINARY:0,MAP:1,STREAM:2,TEXT:3})},95:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MessageUserCosType=r.new({COS1:0,COS2:1,COS3:2})},337:(n,I,e)=>{const r=e(6313),i=e(828),{Codec:t}=e(7252),{Convert:c}=e(840),{Destination:l}=e(3170),{ErrorSubcode:u,OperationError:o}=e(3870);e(390);const{MessageCacheStatus:f}=e(2615),{MessageDeliveryModeType:g}=e(969),{MessageDumpFlag:h}=e(1012),{MessageDumpUtil:T}=e(8292),{MessageType:S}=e(165),{MessageUserCosType:C}=e(95),{Parameter:p}=e(2201),{RgmidFactory:R}=e(4097),{SDTField:N,SDTFieldType:w,SDTMapContainer:y,SDTUnsupportedValueError:P}=e(7252),{ProfileBinding:x}=i,{utf8ToUcs2:B,anythingToBuffer:H}=c,{isBoolean:L,isEnumMember:M,isInstanceOf:G,isInstanceOfOrNothing:K,isNumberOrNothing:F,isStringOrNothing:Y}=p,_={circular:!1,includeNonEnumerable:!1};function U(A){A._deliveryMode=g.DIRECT,A._userCos=C.COS1,A._cacheStatus=f.LIVE,A._spoolerUniqueId=void 0,A._priority=void 0,A._deliveryCount=-1}n.exports.Message=class{constructor(){U(this)}getType(){return this._messageType||S.BINARY}setApplicationMessageId(A){this._applicationMessageId=Y("applicationMessageId",A)}getApplicationMessageId(){return this._applicationMessageId}setApplicationMessageType(A){this._applicationMessageType=Y("applicationMessageType",A)}getApplicationMessageType(){return this._applicationMessageType}getBinaryAttachment(){return this._binaryAttachment&&x.value.byteArrayAsString?this._binaryAttachment.toString("latin1"):this._binaryAttachment}setBinaryAttachment(A){A&&(this._messageType=S.BINARY),this._setBinaryAttachment(H(A))}_setBinaryAttachment(A){this._binaryAttachment=A}getCacheRequestId(){return this._cacheRequestId}_setCacheRequestID(A){this._cacheRequestId=A}getCorrelationId(){return this._correlationId}setCorrelationId(A){this._correlationId=Y("correlationId",A)}getCorrelationKey(){return this._correlationKey||null}setCorrelationKey(A){this._correlationKey=A}isDeliverToOne(){return this._deliverToOne||!1}setDeliverToOne(A){this._setDeliverToOne(this._deliverToOne=L("deliverToOne",A))}_setDeliverToOne(A){this._deliverToOne=A}getDeliveryMode(){return this._deliveryMode}setDeliveryMode(A){this._setDeliveryMode(M("deliveryMode",A,g))}_setDeliveryMode(A){this._deliveryMode=A}getDestination(){return this._destination}setDestination(A){this._setDestination(G("destination",A,l))}_setDestination(A){this._destination=A}isDiscardIndication(){return this._discardIndication||!1}setDiscardIndication(A){this._setDiscardIndication(L("discardIndication",A))}_setDiscardIndication(A){this._discardIndication=A}isElidingEligible(){return this._elidingEligible||!1}setElidingEligible(A){this._setElidingEligible(L("setElidingEligible",A))}_setElidingEligible(A){this._elidingEligible=A}getPublisherId(){return this._publisherId}setPublisherId(A){this._publisherId=A}getPublisherMessageId(){return this._publisherMsgId}setPublisherMessageId(A){this._publisherMsgId=A}getTimeToLive(){return this._timeToLive}setTimeToLive(A){if(A!=null){if(typeof A!="number"||isNaN(A))throw new o("Invalid type for time to live",u.PARAMETER_INVALID_TYPE);if(A<0||A>31536e7)throw new o("Invalid time to live value",u.PARAMETER_OUT_OF_RANGE);this._timeToLive=A}else this._timeToLive=A}getGMExpiration(){return this._expiration}setGMExpiration(A){this._expiration=F("GMExpiration",A)}isDMQEligible(){return this._dmqEligible||!1}setDMQEligible(A){this._setDMQEligible(L("DMQEligible",A))}_setDMQEligible(A){this._dmqEligible=A}getFlowId(){return this._flowId}setFlowId(A){this._flowId=A}getGuaranteedPreviousMessageId(){return this._guaranteedPrevMsgId}setGuaranteedPreviousMessageId(A){this._guaranteedPrevMsgId=A}_setSpoolerUniqueId(A){this._spoolerUniqueId=A}_getSpoolerUniqueId(){return this._spoolerUniqueId===void 0?R.INVALID_SUID:this._spoolerUniqueId}getMessageConsumer(){return this._consumer}setMessageConsumer(A){this._consumer=A}getGuaranteedMessageId(){return this._guaranteedMsgId}setGuaranteedMessageId(A){this._guaranteedMsgId=A}_setSpoolerMessageId(A){this._spoolerMessageId=A}getReplicationGroupMessageId(){if(this._spoolerUniqueId===void 0||R.INVALID_SUID.eq(this._spoolerUniqueId))return;const A=this._spoolerMessageId||this._guaranteedMsgId;return R.from({suid:this._spoolerUniqueId,msgid:A})}getTopicSequenceNumber(){return this._topicSequenceNumber}setTopicSequenceNumber(A){this._topicSequenceNumber=A}getDeliveryCount(){if(this._deliveryCount===-1)throw new o("Endpoint does not report delivery count.",u.INVALID_OPERATION);return this._deliveryCount}setDeliveryCount(A){this._deliveryCount=A}acknowledge(){if(this._consumer.getProperties().browser)throw new o("Messages delivered to a Queue Browser can only be deleted by calling QueueBrowser.removeMessageFromQueue()",u.INVALID_OPERATION);if(this._acked)throw new o("Message can only be acknowledged once",u.MESSAGE_ALREADY_ACKNOWLEDGED);if(this._deliveryMode===g.DIRECT)throw new o("Cannot acknowledge a DIRECT message",u.MESSAGE_DELIVERY_MODE_MISMATCH);if(!this._consumer)throw new o("Cannot acknowledge a locally-created message",u.MESSAGE_DELIVERY_MODE_MISMATCH);if(!this._consumer._sessionInterface.canAck)throw new o("Cannot acknowledge using associated session",u.SESSION_NOT_CONNECTED);if(!this._consumer.canAck)throw new o("Cannot acknowledge using associated Message Consumer",u.INVALID_OPERATION);this._consumer.applicationAck(this._guaranteedMsgId),this._acked=!0}get isAcknowledged(){return this._acked||!1}isAcknowledgeImmediately(){return this._ackImmediately||!1}setAcknowledgeImmediately(A){this._setAcknowledgeImmediately(L("acknowledgeImmediately",A))}_setAcknowledgeImmediately(A){this._ackImmediately=A}getCacheStatus(){return this._cacheStatus}_setCacheStatus(A){this._cacheStatus=A}isReplyMessage(){return this._replyMessage||!1}isRedelivered(){return this._redelivered||!1}setRedelivered(A){this._redelivered=A}setAsReplyMessage(A){this._replyMessage=L("asReplyMessage",A)}getReceiverTimestamp(){return this._receiverTimestamp}getReplyTo(){return this._replyTo}setReplyTo(A){this._replyTo=K("replyTo",A,l)}getSenderId(){return this._senderId}setSenderId(A){this._senderId=Y("senderId",A)}getSenderTimestamp(){return this._senderTimestamp}setSenderTimestamp(A){this._senderTimestamp=F("senderTimestamp",A)}getSequenceNumber(){if(this._sequenceNumberError)throw this._sequenceNumberError;return this._sequenceNumber}setSequenceNumber(A){A instanceof P?this._sequenceNumberError=A:(this._sequenceNumber=F("sequenceNumber",A),this._sequenceNumberError=void 0,this._autoSequenceNumber=!1)}getUserCos(){return this._userCos}getPriority(){return this._priority}setUserCos(A){this._setUserCos(M("userCos",A,C))}_setUserCos(A){this._userCos=A}setPriority(A){if(A!=null){if(typeof A!="number"||isNaN(A))throw new o("Invalid type for message priority",u.PARAMETER_INVALID_TYPE);if(A<0||A>255)throw new o("Invalid priority value",u.PARAMETER_OUT_OF_RANGE);this._setPriority(A)}else this._setPriority(void 0)}_setPriority(A){this._priority=A}getUserData(){return this._userData}setUserData(A){this._setUserData(Y("userData",A))}_setUserData(A){this._userData=A}getXmlContent(){return this._xmlContent}getXmlContentDecoded(){return this._xmlContent?B(this._xmlContent):this._xmlContent}setXmlContent(A){const z=Y("xmlContent",A);this._xmlContent=z&&unescape(encodeURIComponent(z))}_setXmlContentInternal(A){this._xmlContent=Y("xmlContentInternal",A)}setXmlMetadata(A){this._setXmlMetadata(Y("xmlMetadata",A))}_setXmlMetadata(A){this._xmlMetadata=A}getXmlMetadata(){return this._xmlMetadata}get binaryMetadataChunk(){return this._binaryMetaChunk||null}set binaryMetadataChunk(A){this._binaryMetaChunk=A}get smfHeader(){return this._smfHeader}set smfHeader(A){this._smfHeader=A}get hasAutoSequenceNumber(){return this._autoSequenceNumber||!1}set hasAutoSequenceNumber(A){this._autoSequenceNumber=A}get hasAutoSenderTimestamp(){return this._autoSenderTimestamp||!1}set hasAutoSenderTimestamp(A){this._autoSenderTimestamp=A}getUserPropertyMap(){return this._userPropertyMap}setUserPropertyMap(A){this._userPropertyMap=K("userPropertyMap",A,y)}setSdtContainer(A){const z=K("sdtContainer",A,N);if(z==null)return this._structuredContainer=null,void this.setBinaryAttachment(null);switch(this._setBinaryAttachment(null),z.getType()){case w.MAP:this._messageType=S.MAP;break;case w.STREAM:this._messageType=S.STREAM;break;case w.STRING:this._messageType=S.TEXT;break;default:throw new o("Invalid parameter: expected SDTField Type of MAP, STREAM, or STRING.",u.PARAMETER_INVALID_TYPE)}this._structuredContainer=z}getSdtContainer(){const A=this.getType(),z=this._binaryAttachment,J=z?z.length:0;return A===S.BINARY?null:(this._structuredContainer!==void 0||(this._structuredContainer=J===0?null:t.parseSingleElement(z,0)),this._structuredContainer)}dump(A=h.MSGDUMP_FULL){const z=M("flags",A,h);return T.dump(this,z)}clone(){return r(this,_)}reset(){var A;A=this,Object.keys(A).forEach(z=>delete A[z]),U(this)}}},4097:(n,I,e)=>{const{ErrorSubcode:r,OperationError:i}=e(3870),{Long:t}=e(840),{Parameter:c}=e(2201),{ReplayStartLocation:l,ReplayStartType:u}=e(2604),o=e(8764).lW,f="rmid1:",g=f.length+3+32,h=/^[0-9a-fA-F]{32}$/g,T=t.UZERO,{isString:S,isValue:C,isInstanceOf:p}=c;class R extends l{constructor(P,x){super({_replayStartValue:{suid:P,messageId:x},_type:u.RGMID}),this._suid=P,this._messageId=x}compare(P){p("otherReplicationGroupMessageId",P,R);const x=P;if(!this._suid.equals(x._suid)){const B="Unable to compare Replication Group Message ID from different origins";throw new i(`Parameter otherReplicationGroupMessageId[${x.toString()}] failed validation`,r.MESSAGE_ID_NOT_COMPARABLE,B)}return this._messageId.gt(x._messageId)?1:this._messageId.lt(x._messageId)?-1:0}inspect(){return`[Replication Group Message Id: ${this.toString()}]`}toString(){const P=o.from(this._suid.toBytesBE().concat(this._messageId.toBytesBE())).toString("hex");return`${f}${P.substring(0,5)}-${P.substring(5,16)}-${P.substring(16,24)}-${P.substring(24,32)}`}}function N(y){return new R(y.suid,y.msgid)}const w={fromString:function(y){if(S("id",y),C("id",y.length,g,r.PARAMETER_OUT_OF_RANGE,`length expected: ${g} but is ${y.length}`),!y.startsWith(f))throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, does not start with ${f}`);const P=y.substring(f.length).split("-");if(P.length!==4||P[0].length!==5||P[1].length!==11||P[2].length!==8||P[3].length!==8)throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, does not have valid separation of components`);const x=P.join("").trim();if(h.test(""),!h.test(x))throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, invalid data string value`);let B;try{B=o.from(x,"hex")}catch(M){throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, failed to read data, cause: ${M.message}`)}const H=B?B.length:0;if(H!==16)throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, failed to read data from id expected length of 16 got ${H}`);const L=t.fromBits(B.readUInt32BE(4),B.readUInt32BE(0),!0);if(L.eq(T))throw new i("Parameter id has invalid Replication Group Message ID format",r.PARAMETER_OUT_OF_RANGE,`id: ${y}, has invalid origin`);return N({suid:L,msgid:t.fromBits(B.readUInt32BE(12),B.readUInt32BE(8),!0)})}};w.from=N,w.INVALID_SUID=T,n.exports.ReplicationGroupMessageId=R,n.exports.RgmidFactory=w},5754:(n,I,e)=>{const{AbstractQueueDescriptor:r}=e(1018),{QueueAccessType:i}=e(7914),{QueueDescriptor:t}=e(8122),{QueueDescriptorValidator:c}=e(5847),{QueueDiscardBehavior:l}=e(9388),{QueuePermissions:u}=e(5240),{QueueProperties:o}=e(4623),{QueuePropertiesValidator:f}=e(2815),{QueueType:g}=e(1239);n.exports.AbstractQueueDescriptor=r,n.exports.QueueAccessType=i,n.exports.QueueDescriptor=t,n.exports.QueueDescriptorValidator=c,n.exports.QueueDiscardBehavior=l,n.exports.QueuePermissions=u,n.exports.QueueProperties=o,n.exports.QueuePropertiesValidator=f,n.exports.QueueType=g},1018:(n,I,e)=>{const{APIProperties:r}=e(7882),{DestinationType:i}=e(3170),{OperationError:t,ErrorSubcode:c}=e(3870),{QueueType:l}=e(1239),u={durable:!0,type:void 0},o={[l.QUEUE]:"queue",[l.TOPIC_ENDPOINT]:"topic endpoint"},f={[i.TOPIC]:null,[i.QUEUE]:l.QUEUE,[i.TEMPORARY_QUEUE]:l.QUEUE};n.exports.AbstractQueueDescriptor=class extends r{constructor(g){super(u,function(h){if(h&&h.name&&h.type&&i.values.includes(h.type)){if(!f[h.type])throw new t(`Cannot create a descriptor from a ${i.describe(h.type)} destination`,c.PARAMETER_CONFLICT);return{name:h.name,type:l.QUEUE,durable:h.type!==i.TEMPORARY_QUEUE}}return h}(g))}getType(){return this._type}get type(){return this.getType()}set type(g){this._type=g}isDurable(){return this._durable}get durable(){return this.isDurable()}set durable(g){this._durable=g}inspect(){return{type:this.type,durable:this.durable}}toString(){return(this.isDurable()?"":"non")+`-durable ${o[this.getType()]}`}}},7914:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.QueueAccessType=r.new({EXCLUSIVE:"EXCLUSIVE",NONEXCLUSIVE:"NONEXCLUSIVE"})},5847:(n,I,e)=>{const{APIPropertiesValidators:r}=e(7882),{QueueDescriptor:i}=e(8122),{QueueType:t}=e(1239),{validateInstance:c,valBoolean:l,valIsMember:u,valTopicString:o}=r,f={validate(g){const h=c.bind(null,"QueueDescriptor",g);g instanceof i&&h("name",[o]),h("type",[u,t,"QueueType"]),h("durable",[l])}};n.exports.QueueDescriptorValidator=f},8122:(n,I,e)=>{const{AbstractQueueDescriptor:r}=e(1018),{Destination:i}=e(3170),t={name:void 0,durable:!0};class c extends r{constructor(u){super(u instanceof i?{name:u.name,type:u.type}:Object.assign({},t,u))}getName(){return this._name}get name(){return this.getName()}set name(u){this._name=u}inspect(){return{name:this.name,type:this.type,durable:this.durable}}toString(){return`${super.toString()} '${this.getName()}'`}static createFromSpec(u){return u.name?new c(u):r(u)}}n.exports.QueueDescriptor=c},9388:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.QueueDiscardBehavior=r.new({NOTIFY_SENDER_ON:"NOTIFY_SENDER_ON",NOTIFY_SENDER_OFF:"NOTIFY_SENDER_OFF"})},5240:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.QueuePermissions=r.new({NONE:"NONE",READ_ONLY:"READ_ONLY",CONSUME:"CONSUME",MODIFY_TOPIC:"MODIFY_TOPIC",DELETE:"DELETE"})},2815:(n,I,e)=>{const{APIPropertiesValidators:r}=e(7882),{QueueAccessType:i}=e(7914),{QueueDiscardBehavior:t}=e(9388),{QueuePermissions:c}=e(5240),{validateInstance:l,valBoolean:u,valIsMember:o,valNumber:f,valRange:g}=r,h={validate(T){const S=l.bind(null,"QueueProperties",T);T.permissions!==void 0&&T.permissions!==null&&S("permissions",[o,c,"QueuePermissions"]),T.accessType!==void 0&&T.accessType!==null&&S("accessType",[o,i,"QueueAccessType"]),T.quotaMB!==void 0&&T.quotaMB!==null&&S("quotaMB",[f],[g,0,Number.POSITIVE_INFINITY]),T.maxMessageSize!==void 0&&T.maxMessageSize!==null&&S("maxMessageSize",[f],[g,0,Number.POSITIVE_INFINITY]),T.respectsTTL!==void 0&&T.respectsTTL!==null&&S("respectsTTL",[u]),T.discardBehavior!==void 0&&T.discardBehavior!==null&&S("discardBehavior",[o,t,"QueueDiscardBehavior"]),T.maxMessageRedelivery!==void 0&&T.maxMessageRedelivery!==null&&S("maxMessageRedelivery",[f],[g,0,255])}};n.exports.QueuePropertiesValidator=h},4623:(n,I,e)=>{var r=e(9489);const{APIProperties:i}=e(7882),{QueueAccessType:t}=e(7914),{QueueDiscardBehavior:c}=e(9388),{QueuePermissions:l}=e(5240),u={permissions:void 0,accessType:void 0,quotaMB:void 0,maxMessageSize:void 0,respectsTTL:void 0,discardBehavior:void 0,maxMessageRedelivery:void 0};n.exports.QueueProperties=class extends i{constructor(o){super(u,o)}get permissions(){return this._permissions}set permissions(o){this._permissions=o}get accessType(){return this._accessType||u.accessType}set accessType(o){this._accessType=o}get quotaMB(){return this._quotaMB}set quotaMB(o){this._quotaMB=o}get maxMessageSize(){return this._maxMessageSize}set maxMessageSize(o){this._maxMessageSize=o}get respectsTTL(){return this._respectsTTL}set respectsTTL(o){this._respectsTTL=o}get discardBehavior(){return this._discardBehavior}set discardBehavior(o){this._discardBehavior=o}get maxMessageRedelivery(){return this._maxMessageRedelivery}set maxMessageRedelivery(o){this._maxMessageRedelivery=o}inspect(){return{permissions:l.describe(this.permissions),accessType:t.describe(this.accessType),quotaMB:this.quotaMB,maxMessageSize:this.maxMessageSize,respectsTTL:this.respectsTTL,discardBehavior:this.discardBehavior?c.describe(this.discardBehavior):"undefined",maxMessageRedelivery:this.maxMessageRedelivery}}toString(){return r(this)}}},1239:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.QueueType=r.new({QUEUE:"QUEUE",TOPIC_ENDPOINT:"TOPIC_ENDPOINT"})},2604:(n,I,e)=>{const{Parameter:r}=e(2201),{ReplayStartLocation:i,ReplayStartType:t}=e(7517),{ReplayStartLocationBeginning:c}=e(5017),{ReplayStartLocationDate:l}=e(4994),{SolclientFactory:u}=e(828);n.exports.ReplayStartLocation=i,n.exports.ReplayStartLocationBeginning=c,n.exports.ReplayStartLocationDate=l,n.exports.ReplayStartType=t,u.createReplayStartLocationBeginning=u.createFactory(()=>new c),u.createReplayStartLocationDate=u.createFactory(o=>l.createReplayStartLocationDate(r.isInstanceOf("date",o,Date)))},7517:(n,I,e)=>{var r=e(9489);const{Enum:i}=e(9359),t=i.new({BEGINNING:0,DATE:1,RGMID:2});n.exports.ReplayStartLocation=class{constructor(c){Object.assign(this,c),this._type===void 0&&(this._type=t.BEGINNING)}toString(){return r(this)}},n.exports.ReplayStartType=t},5017:(n,I,e)=>{const{ReplayStartLocation:r,ReplayStartType:i}=e(7517);n.exports.ReplayStartLocationBeginning=class extends r{constructor(){super({_type:i.BEGINNING})}static inspect(){return"BEGINNING"}}},4994:(n,I,e)=>{const{ReplayStartLocation:r,ReplayStartType:i}=e(7517);class t extends r{constructor(l){super({_replayStartValue:l.getTime(),_type:i.DATE})}inspect(){return`[Epoch Time: ${this._replayStartValue}]`}static createReplayStartLocationDate(l){return new t(l)}}n.exports.ReplayStartLocationDate=t},7252:(n,I,e)=>{const{Codec:r}=e(6646),{SDTDestType:i}=e(9080),{SDTField:t}=e(3971),{SDTFieldType:c}=e(6387),{SDTMapContainer:l}=e(1287),{SDTStreamContainer:u}=e(5341),{SDTUnsupportedValueError:o}=e(7598),{SDTValueErrorSubcode:f}=e(7014);n.exports.Codec=r,n.exports.SDTDestType=i,n.exports.SDTField=t,n.exports.SDTFieldType=c,n.exports.SDTMapContainer=l,n.exports.SDTStreamContainer=u,n.exports.SDTUnsupportedValueError=o,n.exports.SDTValueErrorSubcode=f},6646:(n,I,e)=>{const{EncodeSingleElement:r}=e(2529),{IEEE754LIB:i}=e(1454),{ParseSingleElement:t,StringToBuffer:c}=e(3967),{encodeSingleElement:l}=r,{parseSingleElement:u}=t,{stringToBuffer:o}=c,f={encodeSingleElement:l,parseSingleElement:u,stringToBuffer:o,IEEE754LIB:i};n.exports.Codec=f},8992:(n,I,e)=>{const{Convert:r}=e(840),{SDTDataTypes:i}=e(7155),t={encodeHeader:function(c,l){let u=c<<2&255,o=null;return c===i.Map||c===i.Stream?(o=r.int32ToStr(l+5),u|=3):l+2<=255?(o=r.int8ToStr(l+2),u|=0):l+3<=65535?(o=r.int16ToStr(l+3),u|=1):(o=r.int32ToStr(l+5),u|=3),r.int8ToStr(u)+o}};n.exports.EncodeHeader=t},2214:n=>{const I={int48ToStr:function(e){let r=e;const i=[];for(let t=0;t<6;t++){const c=r%256;r=Math.floor(r/256),i.push(String.fromCharCode(c))}return i.reverse(),i.join("")}};n.exports.EncodeInteger=I},7187:(n,I,e)=>{const r=e(2529),i=e(7882),{EncodeHeader:t}=e(8992),{SDTDataTypes:c}=e(7155),{SDTMapContainer:l}=e(1287),{encodeHeader:u}=t,o={encodeMap(f){const g=[];if(!(f instanceof l))return null;const h=f.getKeys();let T,S=null,C=null,p=null;for(T=0;T<h.length;T++)S=f.getField(h[T]),S&&(p=i.StringUtils.nullTerminate(h[T]),C=u(c.String,p.length),C+=p,g.push(C),r.EncodeSingleElement.encodeSingleElementToBuf(S,g));return g.join("")}};n.exports.EncodeMap=o},2529:(n,I,e)=>{const r=e(3170),{Convert:i}=e(840),{EncodeHeader:t}=e(8992),{EncodeInteger:c}=e(2214),{EncodeMap:l}=e(7187),{EncodeStream:u}=e(7678),{IEEE754LIB:o}=e(1454),{SDTDataTypes:f}=e(7155),{SDTDestType:g}=e(9080),{SDTField:h}=e(3971),{SDTFieldType:T}=e(6387),{StringUtils:S}=e(7882),{encodeHeader:C}=t,{int48ToStr:p}=c,{encodeMap:R}=l,{encodeStream:N}=u,{nullTerminate:w}=S,y=Math.pow(2,48);function P(B,H){if(!(B instanceof h))return!1;const L=B.getValue();let M=null,G=0;switch(B.getType()){case T.BOOL:G=f.Boolean,M=i.int8ToStr(L?1:0);break;case T.UINT8:G=f.UnsignedInteger,M=i.int8ToStr(L);break;case T.INT8:G=f.Integer,M=i.int8ToStr(L);break;case T.UINT16:G=f.UnsignedInteger,M=i.int16ToStr(L);break;case T.INT16:G=f.Integer,M=i.int16ToStr(L);break;case T.UINT32:G=f.UnsignedInteger,M=i.int32ToStr(L);break;case T.INT32:G=f.Integer,M=i.int32ToStr(L);break;case T.UINT64:G=f.UnsignedInteger,M=String.fromCharCode(0)+String.fromCharCode(0)+p(L);break;case T.INT64:G=f.Integer,M=L>=0?String.fromCharCode(0)+String.fromCharCode(0)+p(L):String.fromCharCode(255)+String.fromCharCode(255)+p(y+L);break;case T.WCHAR:G=f.Char,M=i.int16ToStr(L.charCodeAt(0));break;case T.STRING:G=f.String,M=w(unescape(encodeURIComponent(L)));break;case T.BYTEARRAY:G=f.ByteArray,M=L.toString("latin1");break;case T.FLOATTYPE:G=f.Float,M=o.toIEEE754Single(L);break;case T.DOUBLETYPE:G=f.Float,M=o.toIEEE754Double(L);break;case T.MAP:G=f.Map,M=R(L);break;case T.STREAM:G=f.Stream,M=N(L);break;case T.DESTINATION:G=f.Destination,L instanceof r.Destination&&(M=i.int8ToStr(g[L.getType()])+L.getBytes());break;case T.NULLTYPE:G=f.Null,M="";break;case T.UNKNOWN:M=null}if(M!==null){const K=C(G,M.length);return H.push(K),H.push(M),!0}return!1}const x={encodeSingleElement:function(B){const H=[];return P(B,H),H.join("")},encodeSingleElementToBuf:P};n.exports.EncodeSingleElement=x},7678:(n,I,e)=>{const r=e(2529),{SDTStreamContainer:i}=e(5341),t={encodeStream:function(c){const l=[];if(!(c instanceof i))return null;let u=null;for(;c.hasNext();)u=c.getNext(),u&&r.EncodeSingleElement.encodeSingleElementToBuf(u,l);return l.join("")}};n.exports.EncodeStream=t},1454:n=>{const I={toIEEE754(e,r,i){let t=e;const c=(1<<r-1)-1;let l,u,o;if(isNaN(t))u=(1<<c)-1,o=1,l=0;else if(t===1/0||t===-1/0)u=(1<<c)-1,o=0,l=t<0?1:0;else if(t===0)u=0,o=0,l=1/t==-1/0?1:0;else if(l=t<0,t=Math.abs(t),t>=Math.pow(2,1-c)){const T=Math.min(Math.floor(Math.log(t)/Math.LN2),c);u=T+c,o=t*Math.pow(2,i-T)-Math.pow(2,i)}else u=0,o=t/Math.pow(2,1-c-i);const f=[];for(let T=i;T;T-=1)f.push(o%2?1:0),o=Math.floor(o/2);for(let T=r;T;T-=1)f.push(u%2?1:0),u=Math.floor(u/2);f.push(l?1:0),f.reverse();let g=f.join("");const h=[];for(;g.length;)h.push(parseInt(g.substring(0,8),2)),g=g.substring(8);return h},fromIEEE754(e,r,i){const t=[];for(let g=e.length;g;g-=1){let h=e[g-1];for(let T=8;T;T-=1)t.push(h%2?1:0),h>>=1}t.reverse();const c=t.join(""),l=(1<<r-1)-1,u=parseInt(c.substring(0,1),2)?-1:1,o=parseInt(c.substring(1,1+r),2),f=parseInt(c.substring(1+r),2);return o===(1<<r)-1?f!==0?NaN:u*(1/0):o>0?u*Math.pow(2,o-l)*(1+f/Math.pow(2,i)):f!==0?u*Math.pow(2,-(l-1))*(f/Math.pow(2,i)):0},strToByteArr(e){const r=[];for(let i=0;i<e.length;i++)r.push(255&e.charCodeAt(i));return r},byteArrToStr(e){const r=[];for(let i=0;i<e.length;i++)r.push(String.fromCharCode(255&e[i]));return r.join("")},fromIEEE754Double(e){return this.fromIEEE754(this.strToByteArr(e),11,52)},toIEEE754Double(e){return this.byteArrToStr(this.toIEEE754(e,11,52))},fromIEEE754Single(e){return this.fromIEEE754(this.strToByteArr(e),8,23)},toIEEE754Single(e){return this.byteArrToStr(this.toIEEE754(e,8,23))}};n.exports.IEEE754LIB=I},1425:(n,I,e)=>{const{DestinationFromNetwork:r,DestinationType:i,Queue:t}=e(3170),{LOG_DEBUG:c,LOG_INFO:l}=e(390),{SDTDestType:u}=e(9080),{SDTField:o}=e(3971),{SDTFieldType:f}=e(6387),{Topic:g}=e(3170),h={parseDestination:function(T,S,C){const p=T.readUInt8(S),R=T.toString("latin1",S+1,S+C);let N=r.createDestinationFromBytes(R);if(u[N.type]!==p)if(u[i.QUEUE]===p)N=t.createFromLocalName(R);else{if(u[i.TOPIC]!==p)return l(`Drop SDT field with invalid destination type ${p} when decoding ${R} to ${N.type}`),null;N.type,N=new g(R)}return o.create(f.DESTINATION,N)}};n.exports.ParseDestination=h},198:(n,I,e)=>{const{ParseInteger:r}=e(7267),{autoDecodeVarLengthNumber:i}=r,t={parseFieldHeader:function(c,l){let u=l;const o=c.readUInt8(u),f=(252&o)>>2,g=1+(3&o);u++;const h=i(c,u,g);return u+=g,[f,h,h-(1+g),u-l]}};n.exports.ParseFieldHeader=t},6612:(n,I,e)=>{const{SDTField:r}=e(3971),{SDTFieldType:i}=e(6387),t={parseFloatField:function(c,l,u){switch(u){case 4:return r.create(i.FLOATTYPE,c.readFloatBE(l));case 8:return r.create(i.DOUBLETYPE,c.readDoubleBE(l));default:return r.create(i.UNKNOWN,c.toString("latin1",l,l+u))}}};n.exports.ParseFloat=t},7267:(n,I,e)=>{const r=e(1583),{SDTField:i}=e(3971),{SDTFieldType:t}=e(6387),{SDTUnsupportedValueError:c}=e(7598),{SDTValueErrorSubcode:l}=e(7014),{create:u}=i,o={autoDecodeVarLengthNumber:function(f,g,h){return!![1,2,3,4].includes(h)&&f.readUIntBE(g,h)},parseIntegerField:function(f,g,h,T){let S=0;switch(T){case 1:return f?(S=g.readInt8(h),u(t.INT8,S)):(S=g.readUInt8(h),u(t.UINT8,S));case 2:return f?(S=g.readInt16BE(h),u(t.INT16,S)):(S=g.readUInt16BE(h),u(t.UINT16,S));case 4:return f?(S=g.readInt32BE(h),u(t.INT32,S)):(S=g.readUInt32BE(h),u(t.UINT32,S));case 8:{let C=null;const p=r.fromBits(g.readUInt32BE(h+4),g.readUInt32BE(h),!f);p.getNumBitsAbs()>48&&(C=new c("Value is not supported",l.VALUE_OUTSIDE_SUPPORTED_RANGE,g.toString("latin1",h,T))),S=p.toNumber();const R=u(f?t.INT64:t.UINT64,S);return C&&R.setError(C),R}default:return null}}};n.exports.ParseInteger=o},6403:(n,I,e)=>{const r=e(3967),{LOG_ERROR:i}=e(390),{ParseFieldHeader:t}=e(198),{SDTDataTypes:c}=e(7155),{SDTField:l}=e(3971),{SDTFieldType:u}=e(6387),{SDTMapContainer:o}=e(1287),f={parseMapAt:function(g,h,T){const S=new o;let C=h;for(;C<h+T;){const p=t.parseFieldHeader(g,C);if(C+=p[3],p[0]!==c.String)return i("Error parsing SDTMAP, expected to find a string field as map key, and didn't"),i(`Type of key: ${p[0]}`),l.create(u.MAP,null);const R=g.toString("latin1",C,C+p[2]-1);C+=p[2];const N=t.parseFieldHeader(g,C),w=r.ParseSingleElement.parseSingleElement(g,C);C+=N[1],w&&S.addField(R,w)}return l.create(u.MAP,S)}};n.exports.ParseMap=f},3967:(n,I,e)=>{const{Convert:r}=e(840);e(390);const{ParseDestination:i}=e(1425),{ParseFieldHeader:t}=e(198),{ParseFloat:c}=e(6612),{ParseInteger:l}=e(7267),{ParseMap:u}=e(6403),{ParseStream:o}=e(116),{SDTDataTypes:f}=e(7155),{SDTField:g}=e(3971),{SDTFieldType:h}=e(6387),{utf8ToUcs2:T}=r,{parseFieldHeader:S}=t,{parseFloatField:C}=c,{parseIntegerField:p}=l,{parseMapAt:R}=u,{parseStreamAt:N}=o,{parseDestination:w}=i,y={parseSingleElement(x,B){const H=S(x,B);if(!H)return null;const L=B+H[3],M=H[2];switch(H[0]){case f.Null:return g.create(h.NULLTYPE,null);case f.Boolean:return g.create(h.BOOL,x.readUInt8(L)!==0);case f.Integer:return p(!0,x,L,M);case f.UnsignedInteger:return p(!1,x,L,M);case f.Float:return C(x,L,M);case f.Char:return g.create(h.WCHAR,String.fromCharCode(x.readUInt16BE(L)));case f.ByteArray:return g.create(h.BYTEARRAY,x.slice(L,L+M));case f.String:return g.create(h.STRING,T(x.toString("latin1",L,L+M-1)));case f.Destination:return w(x,L,M);case f.SMFMessage:return g.create(h.SMF_MESSAGE,x.slice(L,L+M));case f.Map:return R(x,L,M);case f.Stream:return N(x,L,M);default:return g.create(h.UNKNOWN,x.toString("latin1",L,L+M))}}},P={stringToBuffer:x=>e(8764).lW.from(x,"latin1")};n.exports.ParseSingleElement=y,n.exports.StringToBuffer=P},116:(n,I,e)=>{const r=e(3967),{ParseFieldHeader:i}=e(198),{SDTField:t}=e(3971),{SDTFieldType:c}=e(6387),{SDTStreamContainer:l}=e(5341),u={parseStreamAt:function(o,f,g){const h=new l;let T=f;for(;T<f+g;){const S=i.parseFieldHeader(o,T),C=r.ParseSingleElement.parseSingleElement(o,T);T+=S[1],C&&h.addField(C)}return t.create(c.STREAM,h)}};n.exports.ParseStream=u},7155:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SDTDataTypes=r.new({Null:0,Boolean:1,Integer:2,UnsignedInteger:3,Float:4,Char:5,ByteArray:6,String:7,Destination:8,SMFMessage:9,Map:10,Stream:11})},9080:(n,I,e)=>{const{DestinationType:r}=e(3170),{Enum:i}=e(9359),t={[r.TOPIC]:0,[r.QUEUE]:1,[r.TEMPORARY_QUEUE]:1};n.exports.SDTDestType=i.new(t)},6387:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SDTFieldType=r.new({BOOL:0,UINT8:1,INT8:2,UINT16:3,INT16:4,UINT32:5,INT32:6,UINT64:7,INT64:8,WCHAR:9,STRING:10,BYTEARRAY:11,FLOATTYPE:12,DOUBLETYPE:13,MAP:14,STREAM:15,DESTINATION:16,NULLTYPE:17,UNKNOWN:18,SMF_MESSAGE:19})},3971:(n,I,e)=>{const r=e(828),{Convert:i}=e(840),{SDTFieldType:t}=e(6387),{validateSdtField:c}=e(2234),{anythingToBuffer:l}=i,{ProfileBinding:u}=r;class o{constructor(g=t.NULLTYPE,h=null){const T=c(g,h);if(T!==null)throw T;this._type=g,g===t.BYTEARRAY?this._value=l(h):this._value=h,this._error=void 0}getType(){return this._type}getValue(){if(this._error!==void 0)throw this._error;return this.getValueNoThrow()}getValueNoThrow(){return this._error!==void 0?this._error:this._type===t.BYTEARRAY&&u.value.byteArrayAsString?this._value.toString("latin1"):this._value}setError(g){this._error=g}toString(){return`[SDTField type:${this._type} value:${this._value}]`}static create(g,h){return new o(g,h)}}n.exports.SDTField=o},1287:(n,I,e)=>{const{ErrorSubcode:r,OperationError:i}=e(3870),{SDTField:t}=e(3971);n.exports.SDTMapContainer=class{constructor(){this._map=[]}getKeys(){return Object.keys(this._map)}getField(c){return this._map[c]}deleteField(c){delete this._map[c]}addField(c,l,u){if(l instanceof t)this._map[c]=l;else{if(u===void 0)throw new i("Invalid parameters to addField: expected SDTField, or type and value",r.PARAMETER_CONFLICT);this._map[c]=t.create(l,u)}}}},5341:(n,I,e)=>{const r=e(3971),{ErrorSubcode:i,OperationError:t}=e(3870);n.exports.SDTStreamContainer=class{constructor(){this._stream=[],this._writable=!0,this._readPt=0}hasNext(){return this._stream.length>this._readPt}getNext(){return this._readPt<this._stream.length?this._stream[this._readPt++]:void 0}rewind(){this._readPt=0}addField(c,l){if(this._writable)if(c instanceof r.SDTField)this._stream.push(c);else{if(l===void 0)throw new t("Invalid parameters to addField: expected SDTField, or type and value",i.PARAMETER_CONFLICT);this._stream.push(r.SDTField.create(c,l))}}}},7598:(n,I,e)=>{const r=e(1880),{SolaceError:i}=e(3870);n.exports.SDTUnsupportedValueError=class extends i{constructor(t,c,l){super("SDTUnsupportedValue",t),this.subcode=c,this.sourceData=l||""}inspect(){return super.inspect({subcode:null,sourceData:t=>r.Debug.formatDumpBytes(t,!1,0)})}getSubcode(){return this.subcode}getSourceData(){return this.sourceData}}},7014:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SDTValueErrorSubcode=r.new({VALUE_OUTSIDE_SUPPORTED_RANGE:1})},2234:(n,I,e)=>{const r=e(3170),i=e(1287),t=e(5341),c=e(2201),{ErrorSubcode:l,OperationError:u}=e(3870),{SDTFieldType:o}=e(6387),f=(()=>{const h=[];return h[o.BOOL]="boolean",h[o.UINT8]="number",h[o.INT8]="number",h[o.UINT16]="number",h[o.INT16]="number",h[o.UINT32]="number",h[o.INT32]="number",h[o.UINT64]="number",h[o.INT64]="number",h[o.WCHAR]="string",h[o.STRING]="string",h[o.BYTEARRAY]="object",h[o.FLOATTYPE]="number",h[o.DOUBLETYPE]="number",h})();function g(h){return new u(`Invalid SDT type:value combination, expected value type ${h}`,l.PARAMETER_INVALID_TYPE)}n.exports.validateSdtField=function(h,T){return f[h]&&(f[h]==="boolean"&&typeof T!="boolean"||f[h]==="number"&&typeof T!="number"||f[h]==="string"&&typeof T!="string")?g(f[h]):h!==o.MAP||c.Check.instanceOf(T,i.SDTMapContainer)?h!==o.STREAM||c.Check.instanceOf(T,t.SDTStreamContainer)?h!==o.DESTINATION||c.Check.instanceOf(T,r.Destination)?null:g("Destination"):g("SDTStreamContainer"):g("SDTMapContainer")}},5594:(n,I,e)=>{const{AuthenticationScheme:r}=e(3278),{CapabilityType:i,ClientCapabilityType:t}=e(2753),{MessageRxCBInfo:c}=e(806),{MutableSessionProperty:l}=e(8075),{Session:u}=e(3401),{SessionEvent:o}=e(5874),{SessionEventCBInfo:f}=e(3397),{SessionEventCode:g}=e(5332),{SessionEventName:h}=e(2495),{SessionProperties:T}=e(2975),{SessionState:S}=e(109),{SolclientFactory:C}=e(828),{SslDowngrade:p}=e(5153);C.createSession=C.createFactory((R,N,w)=>new u(R,N,w)),n.exports.AuthenticationScheme=r,n.exports.CapabilityType=i,n.exports.ClientCapabilityType=t,n.exports.MessageRxCBInfo=c,n.exports.MutableSessionProperty=l,n.exports.Session=u,n.exports.SessionEventCBInfo=f,n.exports.SessionEventCode=g,n.exports.SessionEvent=o,n.exports.SessionEventName=h,n.exports.SessionProperties=T,n.exports.SessionState=S,n.exports.SslDowngrade=p},3278:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.AuthenticationScheme=r.new({BASIC:"AuthenticationScheme_basic",CLIENT_CERTIFICATE:"AuthenticationScheme_clientCertificate",AUTHENTICATION_SCHEME_BASIC:"AuthenticationScheme_basic",AUTHENTICATION_SCHEME_CLIENT_CERTIFICATE:"AuthenticationScheme_clientCertificate",OAUTH2:"AuthenticationScheme_oauth2"})},2753:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CapabilityType=r.new({PEER_SOFTWARE_VERSION:0,PEER_SOFTWARE_DATE:1,PEER_PLATFORM:2,PEER_PORT_SPEED:3,PEER_PORT_TYPE:4,MAX_DIRECT_MSG_SIZE:5,PEER_ROUTER_NAME:6,MESSAGE_ELIDING:7,NO_LOCAL:8,GUARANTEED_MESSAGE_CONSUME:9,TEMPORARY_ENDPOINT:10,GUARANTEED_MESSAGE_PUBLISH:11,GUARANTEED_MESSAGE_BROWSE:12,ENDPOINT_MGMT:13,SELECTOR:14,MAX_GUARANTEED_MSG_SIZE:15,ACTIVE_CONSUMER_INDICATION:16,COMPRESSION:17,CUT_THROUGH:18,ENDPOINT_DISCARD_BEHAVIOR:19,ENDPOINT_MESSAGE_TTL:20,JNDI:21,PER_TOPIC_SEQUENCE_NUMBERING:22,QUEUE_SUBSCRIPTIONS:23,SUBSCRIPTION_MANAGER:24,TRANSACTED_SESSION:25,MESSAGE_REPLAY:26,COMPRESSED_SSL:27,SHARED_SUBSCRIPTIONS:28,BR_REPLAY_ERRORID:29}),n.exports.ClientCapabilityType=r.new({UNBIND_ACK:0,BR_ERRORID:1})},4664:n=>{n.exports.CorrelatedRequest=class{constructor(I,e,r,i){this.correlationTag=I,this.timer=e,this.correlationKey=r,this.respRecvdCallback=i}}},1188:(n,I,e)=>{const{CapabilityType:r}=e(2753);n.exports.DefaultCapabilities={createDefaultCapabilities:i=>({[r.GUARANTEED_MESSAGE_CONSUME]:!0,[r.GUARANTEED_MESSAGE_PUBLISH]:!0,[r.SHARED_SUBSCRIPTIONS]:!0,[r.MAX_GUARANTEED_MSG_SIZE]:i.assumedMaxAdSize})}},8484:(n,I,e)=>{const{Process:r}=e(7882),i=Math.pow(2,32);function t(l,u){return u>l.length?"0".repeat(u-l.length)+l:l}const c={sessionCounter:0,idCounter:0,RandId:t((Math.random()*i).toFixed(0).toString(),10),NextSessionCounter(){return t((++this.sessionCounter).toString(),4)},NextId(){return++this.idCounter},GenerateClientName(){const{product:l,platform:u}=r;return`${l}/${u}/${this.RandId}/${this.NextSessionCounter()}`},GenerateUserIdentification(){const{product:l,platform:u}=r;return`${l}/${u}/${this.RandId}`},GenerateClientDescription:()=>`solclientjs/${r.description}`.substring(0,254)};n.exports.GlobalContext=c},2583:(n,I,e)=>{e(390);const{parseURL:r}=e(7882);let i;i=(t,c)=>setTimeout(()=>{try{const l=t.map(u=>{const o=r(u).host;return{url:u,host:o,address:o,resolved:!1}});return c(null,l)}catch(l){return c(l)}},0),n.exports.hostListDNSFilter=i},1113:(n,I,e)=>{const{assert:r}=e(9359),{hostListDNSFilter:i}=e(2583),{LogFormatter:t}=e(390),{parseURL:c}=e(7882);function l(o){return Array.isArray(o)?o.map(f=>c(f)):l(o.split(/[,;]/))}class u{constructor(f={url:null,waitTime:0}){Object.assign(this,f)}}n.exports.HostList=class{constructor({url:o,connectRetries:f,reconnectRetries:g,connectRetriesPerHost:h,reconnectRetryWaitInMsecs:T}={}){Object.assign(this,{hosts:l(o).map(S=>S.href),connectTryCount:f===-1?Number.POSITIVE_INFINITY:f+1,reconnectTryCount:g===-1?Number.POSITIVE_INFINITY:g,connectTryCountPerHost:h===-1?Number.POSITIVE_INFINITY:h+1,reconnectRetryWaitInMsecs:T,_mutableState:{},logger:new t("[host-list]")}),r(this.hosts.length>=1),r(this.connectTryCount>=1),r(this.reconnectTryCount>=0),r(this.connectTryCountPerHost>=1)}resolveHosts(o){const{LOG_TRACE:f,LOG_WARN:g}=this.logger;i(this.hosts,(h,T)=>{if(h)return o(h);r(T.length===this.hosts.length,"Resolve did not return a result for all hosts");let S=0;return T.forEach(C=>{C.address&&++S,C.resolved&&(C.address?(C.address,C.url):g("DNS resolve FAILED:",C.error.code,`${C.error.syscall}('${C.error.hostname}')`,"for",C.url))}),o(S===0?"All hosts failed DNS resolution":null)})}reset(o={wasConnected:!1,disconnected:!1}){Object.assign(this._mutableState,{wasConnected:o.wasConnected,disconnected:o.disconnected,hostPointer:0,hostTries:0,listTries:1,exhausted:!1,lastHostInfo:new u})}getNextHost(){this.logger;const o=this._mutableState,f=o.wasConnected,g=o.lastHostInfo;r(g,"Next host request with no prior host info -- did you call reset()?");try{if(o.disconnected)return null;r(!o.exhausted,"Next host request after host list exhausted");const h=Object.assign({hosts:this.hosts,hostTriesMax:this.connectTryCountPerHost,listTriesMax:f?this.reconnectTryCount:this.connectTryCount});if(++o.hostTries,o.hostTries>h.hostTriesMax?(o.hostTries,g.url,++o.hostPointer,o.hostPointer>=h.hosts.length?(++o.listTries,o.listTries>h.listTriesMax?(h.listTriesMax,o.exhausted=!0):(o.listTries,h.listTriesMax,o.hostPointer=0,o.hostTries=1)):o.hostTries=1):(o.hostTries,h.hostTriesMax),o.exhausted)return null;const T=h.hosts[o.hostPointer];r(T,`No host at the host pointer! ${h.hosts}[${o.hostPointer}]`);const S=g.url===null,C=g.url!==T,p=g.url!==T&&o.hostPointer===0,R=S||C&&!p?0:this.reconnectRetryWaitInMsecs,N=new u({url:T,waitTime:R});return o.lastHostInfo=N,N.url}finally{}}get connectWaitTimeInMsecs(){return r(this._mutableState.lastHostInfo.url,"Getting connectWaitTimeInMsecs having never called getNextHostInfo"),this._mutableState.lastHostInfo.waitTime}currentHostToString(){const o=this._mutableState,f=o.wasConnected,g=Object.assign({hosts:this.hosts,hostTriesMax:this.connectTryCountPerHost,listTriesMax:f?this.reconnectTryCount:this.connectTryCount}),h=o.hostPointer+1;return`host '${o.lastHostInfo.url}' (host ${h} of ${g.hosts.length})(host connection attempt ${o.hostTries} of ${g.hostTriesMax})(total ${f?"reconnection":"connection"} attempt ${o.listTries} of ${g.listTriesMax})`}}},806:n=>{n.exports.MessageRxCBInfo=class{constructor(I,e){this.messageRxCBFunction=I,this.userObject=e}}},8075:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.MutableSessionProperty=r.new({CLIENT_NAME:1,CLIENT_DESCRIPTION:2})},2779:n=>{n.exports.OutstandingDataRequest=class{constructor(I,e,r,i,t){this.correlationId=I,this.timer=e,this.replyReceivedCBFunction=r,this.reqFailedCBFunction=i,this.userObject=t}}},4876:n=>{n.exports.P2PUtil={getP2PInboxTopic:I=>`${I}/_`,getP2PTopicSubscription:I=>`${I}/>`}},3397:n=>{n.exports.SessionEventCBInfo=class{constructor(I,e){this.userObject=e,this.sessionEventCBFunction=I}}},5332:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionEventCode=r.new({UP_NOTICE:0,DOWN_ERROR:1,CONNECT_FAILED_ERROR:2,REJECTED_MESSAGE_ERROR:4,SUBSCRIPTION_ERROR:5,SUBSCRIPTION_OK:6,VIRTUALROUTER_NAME_CHANGED:7,REQUEST_ABORTED:8,REQUEST_TIMEOUT:9,PROPERTY_UPDATE_OK:10,PROPERTY_UPDATE_ERROR:11,CAN_ACCEPT_DATA:13,DISCONNECTED:14,RECONNECTING_NOTICE:22,RECONNECTED_NOTICE:23,REPUBLISHING_UNACKED_MESSAGES:24,ACKNOWLEDGED_MESSAGE:25,UNSUBSCRIBE_TE_TOPIC_OK:26,UNSUBSCRIBE_TE_TOPIC_ERROR:27,MESSAGE:28,GUARANTEED_MESSAGE_PUBLISHER_DOWN:29})},2495:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionEventName=r.new({CONNECT:"SessionConnect",DISCONNECT:"SessionDisconnect",DISPOSE:"SessionDispose",CONNECT_TIMEOUT:"SessionConnectTimeout",CONNECT_WAIT_TIMEOUT:"SessionConnectWaitTimeout",DOWNGRADE_TIMEOUT:"SessionDowngradeTimeout",TRANSPORT_UP:"SessionTransportUp",TRANSPORT_DESTROYED:"SessionTransportDestroyed",TRANSPORT_CAN_ACCEPT_DATA:"SessionTransportCanAcceptData",TRANSPORT_PARSE_ERROR:"SessionTransportParseError",TRANSPORT_PROTOCOL_SMP:"SessionSMPMessage",TRANSPORT_PROTOCOL_CLIENTCTRL:"SessionClientCtrlMessage",EXCEPTION:"SessionException",SUBSCRIBE_TIMEOUT:"SessionSubscribeTimeout",CREATE_SUBSCRIBER:"SessionCreateSubscriber",FLOW_UP:"SessionFlowUp",FLOW_FAILED:"SessionFlowFailed",SEND_ERROR:"SessionSendError",FLOWS_DISCONNECTED:"SessionFlowsDisconnected",TRANSPORT_FLUSHED:"SessionTransportFlushed",DNS_RESOLUTION_COMPLETE:"SessionDNSResolutionComplete",TRANSPORT_CHANGE_DONE:"SessionTransportChangeDone"})},5874:(n,I,e)=>{var r=e(9489);const{ErrorSubcode:i,OperationError:t,RequestError:c,RequestEventCode:l}=e(3870),{SessionEventCode:u}=e(5332);function o(S){return class extends S{constructor(C,p,R,N,w=0,y,P){super(...C),this._sessionEventCode=p,this._infoStr=R,this._responseCode=N,this._errorSubcode=w,this._correlationKey=y,this._reason=P}get sessionEventCode(){return this._sessionEventCode}get infoStr(){return this._infoStr}get responseCode(){return this._responseCode}get errorSubcode(){return this.subcode||this._errorSubcode}get errorSubCode(){return this.errorSubcode}get correlationKey(){return this._correlationKey}get reason(){return this._reason}set reason(C){this._reason=C}inspect(){return Object.assign(super.inspect||{},{sessionEventCode:u.describe(this.sessionEventCode),infoStr:this.infoStr,responseCode:this.responseCode,errorSubcode:i.describe(this.errorSubcode),correlationKey:this.correlationKey?this.correlationKey.toString():null,reason:this.reason?this.reason:null})}toString(){return r(this)}}}const f={[u.CONNECT_FAILED_ERROR]:t,[u.DOWN_ERROR]:t,[u.GUARANTEED_MESSAGE_PUBLISHER_DOWN]:t,[u.PROPERTY_UPDATE_ERROR]:c,[u.REJECTED_MESSAGE_ERROR]:c,[u.SUBSCRIPTION_ERROR]:c,[u.UNSUBSCRIBE_TE_TOPIC_ERROR]:t,[l.REQUEST_ABORTED]:c,[l.REQUEST_TIMEOUT]:c},g=new Map().set(Object,()=>[]).set(t,(S,C,p,R,N,w)=>[C,R,w]).set(c,(S,C,p,R,N,w)=>[C,S,N,w]),h=new Map,T=o(Object);T.build=function(S,C,p,R=0,N,w){const y=f[S]||Object;return new((()=>{let P=h.get(y);return P||(P=o(y),h.set(y,P),P)})())((g.get(y)||(()=>[]))(S,C,p,R,N,w),S,C,p,R,N,w)},n.exports.SessionEvent=T},9191:(n,I,e)=>{var r=e(9489);const{ErrorSubcode:i}=e(3870),{FsmEvent:t}=e(8535),{Hex:c}=e(840),{formatHexString:l}=c;n.exports.SessionFSMEvent=class extends t{constructor(u,o){super(u),this.eventText=null,this.errorSubcode=null,this.eventReason=null,this.smfMsg=null,this.sessionId=null,this.guaranteedFlowObject=null,Object.assign(this,o)}inspect(){return{eventText:this.eventText,eventReason:this.eventReason,errorSubcode:i.describe(this.errorSubcode),sessionId:this.sessionId&&l(this.sessionId)||"N/A"}}getExtraStringInfo(){return r(this)}}},8837:(n,I,e)=>{const r=e(4858),i=e(6780),t=e(7291),c=e(828),l=e(3147),{assert:u}=e(9359),{CapabilityType:o}=e(2753),{Check:f}=e(2201),{CorrelatedRequest:g}=e(4664),{Destination:h}=e(3170),{ErrorResponseSubcodeMapper:T,ErrorSubcode:S,OperationError:C}=e(3870),{FsmEvent:p,State:R,StateMachine:N}=e(8535),{Hex:w}=e(840),{LogFormatter:y}=e(390),{Message:P,MessageDeliveryModeType:x}=e(4789),{P2PUtil:B}=e(4876),{SessionEvent:H}=e(5874),{SessionEventCode:L}=e(5332),{SessionEventName:M}=e(2495),{SessionFSMEvent:G}=e(9191),{SessionRequestType:K}=e(9988),{SessionStateName:F}=e(156),{SslDowngrade:Y}=e(5153),{StatType:_,StatsByMode:U}=e(6818),{StringUtils:A}=e(7882),{SubscriptionUpdateTimeoutMessages:z}=e(1726),{formatHexString:J}=w,{stripNullTerminate:se}=A,{STAT_TX_BYMODE_BYTES:Te,STAT_TX_BYMODE_MSGS:pe,STAT_RX_BYMODE_BYTES:ne,STAT_RX_BYMODE_MSGS:oe,STAT_TX_BYMODE_REDELIVERED:de,STAT_TX_BYMODE_BYTES_REDELIVERED:_e}=U;n.exports.SessionFSM=class extends N{constructor(b,X,ae,ie){super({name:"SessionFSM"});const q=this,Pe=this.logger=new y(function(...ee){return[`[session-fsm=${q.sessionIdHex||"(N/A)"}]`,`[${q.getCurrentStateName()}]`,...ee]}),{LOG_TRACE:ve,LOG_DEBUG:Qe,LOG_INFO:Z}=Pe;this.log=Pe.wrap(this.log,this),this._sessionProperties=b,this._session=X,this._sessionStatistics=ae,this._hosts=ie,this._consumers=new r.ConsumerFlows,this._flowInterfaceFactory=ee=>({getCorrelationTag:this.getCorrelationTag.bind(this),incStat:this.incStat.bind(this),sendData:ge=>this.send(ge,ee,!1),sendToTransport:ge=>this.sendToTransport(ge,ee,!1),sendControl:ge=>this.send(ge,ee,!0),enqueueRequest:this.enqueueOutstandingCorrelatedReq.bind(this),createDestinationFromDescriptor:X.createDestinationFromDescriptor.bind(X),createTemporaryDestination:X.createTemporaryDestination.bind(X),isCapable:X.isCapable.bind(X),getCapability:X.getCapability.bind(X),getCurrentStateName:this.getCurrentStateName.bind(this),updateQueueSubscription:X.updateQueueSubscription.bind(X),get sessionIdHex(){return q.sessionIdHex},get canAck(){return X.canAck}}),this._userBackpressured=!1,this.clearCurrentError(),this.initial(function(){return this.transitionTo(q.SessionDisconnected,ee=>ee.getStateMachine().reset())}),this.unhandledEventReaction(function(ee){const ge=q.getCurrentState();switch(ee.getName()){case M.CREATE_SUBSCRIBER:return u(q._consumers,"collection has lifetime of FSM instance"),q._consumers.add(ee.guaranteedFlowObject),this;case M.DISPOSE:return ge.terminate(()=>q.disposeInternal());case M.FLOW_UP:return ee.guaranteedFlowObject,this;default:return ee.getName(),q.getCurrentStateName(),this}}),this.SessionConnecting=new R({name:F.CONNECTING,parentContext:q},{handleTransportDestroyed(){if(q.clearConnectTimer(),q._currentHost=q._hosts.getNextHost(),q._currentHost===null)return this.transitionToExitPoint(q.SessionConnecting,"ErrorExit");const{connectWaitTimeInMsecs:ee}=q._hosts;return ee>0&&!q._connectWaitTimer?(q._connectWaitTimer=setTimeout(()=>{q._connectWaitTimer=null,q.processEvent(new G({name:M.CONNECT_WAIT_TIMEOUT}))},ee),this.transitionTo(q.WaitingForInterConnectTimeout)):this.transitionTo(q.WaitingForTransport)}}).entry(()=>{q.setConnectTimer()}).entryPoint("DisconnectTransport",function(){return q._hosts.reset({wasConnected:void 0,disconnected:!0}),q._connectFailEvent=L.DISCONNECTED,q._connectSuccessEvent=L.DISCONNECTED,this.transitionTo(q.DestroyingTransport)}).entryPoint("ReconnectTransport",function(){q._connectFailEvent=L.DOWN_ERROR,q._connectSuccessEvent=L.RECONNECTED_NOTICE;const ee=q._sessionProperties._reconnectRetries===0;if(q._hosts.reset({wasConnected:!0,disconnected:ee}),!ee){const ge=q._currentError||{},d=[ge.eventText,ge.responseCode,ge.errorSubcode,void 0,ge.eventReason];q.setPostEventAction(()=>{q.setConnectTimer(),q.emitSessionEvent(H.build(L.RECONNECTING_NOTICE,...d))})}return this.transitionTo(q.DestroyingTransport)}).initial(()=>(q.clearCurrentError(),q._connectFailEvent=L.CONNECT_FAILED_ERROR,q._connectSuccessEvent=L.UP_NOTICE,q._hosts.resolveHosts(ee=>q._hosts?ee?(q.setCurrentError({errorSubcode:S.UNRESOLVED_HOSTS,eventText:ee}),q._hosts.reset({disconnected:!0}),this.processEvent(new G({name:M.EXCEPTION}))):(q._hosts.reset({wasConnected:!1}),q._currentHost=q._hosts.getNextHost(),this.processEvent(new G({name:M.DNS_RESOLUTION_COMPLETE}))):null),this.transitionTo(q.WaitingForDNS))).reaction(M.DNS_RESOLUTION_COMPLETE,function(){return this.transitionTo(q.WaitingForTransport)}).reaction(M.DISCONNECT,function(){return this.transitionToEntryPoint(q.SessionConnecting,"DisconnectTransport")}).reaction(M.CONNECT_TIMEOUT,function(){return q.setCurrentError({errorSubcode:S.TIMEOUT,eventText:"Connect timeout"}),this.transitionTo(q.DestroyingTransport)}).reaction(M.SEND_ERROR,function(ee){return Z(`SEND_ERROR reached SessionConnecting. ${ee}`),q.setCurrentError(ee),this.transitionTo(q.DestroyingTransport)}).reaction(M.EXCEPTION,function(ee){return q.setCurrentError(ee),this.transitionTo(q.DestroyingTransport)}).reaction(M.TRANSPORT_DESTROYED,function(ee){return q.setCurrentError(ee),Z("TRANSPORT_DESTROYED event"),this.transitionTo(q.DestroyingTransport)}).exit(()=>{q.clearConnectTimer(),q._connectWaitTimer&&(clearTimeout(q._connectWaitTimer),q._connectWaitTimer=null)}).exitPoint("ConnectedExit",()=>(q.setPostEventAction(()=>{if(q.emitSessionEvent(H.build(q._connectSuccessEvent,`'${q._hosts.currentHostToString()}'`,200,0,null,null)),q._userBackpressured){const ee=H.build(L.CAN_ACCEPT_DATA,"",null,0,null,"");q.emitSessionEvent(ee),q._userBackpressured=!1}}),q.clearCurrentError(),this.transitionTo(q.SessionTransportUp))).exitPoint("ErrorExit",function(){return q.setPostEventAction(()=>{const ee=q._currentError||{},ge=[ee.eventText,ee.responseCode,ee.errorSubcode,void 0,ee.eventReason];q.emitSessionEvent(H.build(q._connectFailEvent,...ge))}),this.transitionTo(q.SessionDisconnected)}),this.WaitingForDNS=new R({name:F.WAITING_FOR_DNS,parentContext:q.SessionConnecting}),this.DestroyingTransport=new R({name:F.DESTROYING_TRANSPORT,parentContext:q.SessionConnecting}).entry(()=>{Z("Connecting, disposing transport"),q.clearConnectTimer(),q.destroyTransportSession("Disconnecting session",0)}).reaction(M.TRANSPORT_DESTROYED,function(ee){return q.setCurrentError(ee),q.SessionConnecting.handleTransportDestroyed.call(this)}),this.WaitingForInterConnectTimeout=new R({name:F.WAITING_FOR_INTERCONNECT_TIMEOUT,parentContext:q.SessionConnecting}).reaction(M.CONNECT_WAIT_TIMEOUT,function(){return this.transitionTo(q.WaitingForTransport)}),this.WaitingForTransport=new R({name:F.WAITING_FOR_TRANSPORT,parentContext:q.SessionConnecting}).initial(()=>{const ee="Cannot establish transport session: creation failed";q.setConnectTimer(),q.clearCurrentError();try{q.initTransport()}catch(ge){return this.setCurrentError({eventText:ge.message===ee?ee:`${ee}: ${ge.message}`,errorSubcode:ge.subcode||S.INTERNAL_ERROR,eventReason:ge}),q.SessionConnecting.handleTransportDestroyed.call(this)}return this.transitionTo(q.WaitingForTransportUp)}),this.WaitingForTransportUp=new R({name:F.WAITING_FOR_TRANSPORT_UP,parentContext:this.WaitingForTransport}).entry(()=>{this._justEntered=!0}).initial(()=>{if(!this._justEntered)return this;this._justEntered=!1;const ee="Cannot establish transport session: connection failed";try{const ge=q._transport.connect();if(ge!==l.TransportReturnCode.OK)throw new C(ee,S.CONNECTION_ERROR,l.TransportReturnCode.describe(ge));Z(`Attempting to connect session '${q.sessionId}' to ${q._hosts.currentHostToString()}`)}catch(ge){return this.setCurrentError({eventText:ge.message===ee?ee:`${ee}: ${ge.message}`,errorSubcode:ge.subcode||S.INTERNAL_ERROR,eventReason:ge}),q.SessionConnecting.handleTransportDestroyed.call(this)}return this}).reaction(M.SEND_ERROR,function(ee){return Z(`SEND_ERROR while waiting for transport up, doing nothing. ${ee}`),this.internalTransition(null)}).reaction(M.TRANSPORT_UP,function(ee){if(q.sessionId=ee.sessionId||"",q.sendClientCtrlLogin()===l.TransportReturnCode.OK)return this.transitionTo(q.WaitingForLogin);const ge={eventText:"Failed to send Client Control Login",errorSubcode:S.LOGIN_FAILURE,responseCode:400};return q.setCurrentError(ge),this.transitionTo(q.DestroyingTransport)}),this.WaitingForLogin=new R({name:F.WAITING_FOR_LOGIN,parentContext:q.SessionConnecting}).entry(()=>{q.setClientCtrlTimer()}).reaction(M.TRANSPORT_PROTOCOL_CLIENTCTRL,function(ee){const ge=ee.smfMsg,d=ge.getResponse(),O=d.responseCode,D={responseCode:O};if(q._responseCode=O,O===200)if(q.checkNoLocal(ge)){if(q.checkCompressedSsl(ge))return q.updateReadonlySessionProps(ge),this.transitionTo(q.WaitForTransportChange);Object.assign(D,{eventText:"Compressed TLS is not supported by the Solace Message Router",errorSubcode:S.COMPRESSED_TLS_NOT_SUPPORTED})}else Object.assign(D,{eventText:"No Local is not supported by the Solace Message Router",errorSubcode:S.NO_LOCAL_NOT_SUPPORTED});else{const Q=T.getErrorSubcode(O,d.responseString),re=Q===S.UNKNOWN_ERROR?S.LOGIN_FAILURE:Q;Z(`Login failed. Subcode: ${re} respCode: ${O} respString: ${d.responseString}`),Object.assign(D,{eventText:d.responseString,errorSubcode:re})}return q.setCurrentError(D),this.transitionTo(q.DestroyingTransport)}).reaction(M.DOWNGRADE_TIMEOUT,function(){return q._transport.requestDowngrade&&q._transport.requestDowngrade("ClientCtrl timeout",S.TIMEOUT)!==!1?this.transitionTo(q.WaitingForTransportUp):(q.setCurrentError({eventText:"ClientCtrl timeout",errorSubcode:S.TIMEOUT}),this.transitionTo(q.DestroyingTransport))}).exit(()=>{q.clearClientCtrlTimer()}),this.WaitForTransportChange=new R({name:F.WAITING_FOR_TRANSPORT_CHANGE,parentContext:q.SessionConnecting}).initial(function(){const ee=q.updateTransportCompression(function(ge){this._transport=ge,this.processEvent(new G({name:M.TRANSPORT_CHANGE_DONE}))}.bind(q));return ee===null?this:(q._transport=ee,this.transitionTo(q.ReapplyingSubscriptions))}).reaction(M.TRANSPORT_CHANGE_DONE,function(){return this.transitionTo(q.ReapplyingSubscriptions)}),this.ReapplyingSubscriptions=new R({name:F.REAPPLYING_SUBSCRIPTIONS,parentContext:q.SessionConnecting}).entry(()=>{Z("ReapplyingSubscriptions: entry"),q.copySubscriptionCacheKeys()}).initial(function(){return q.reapplySubscriptions()===!0?this.transitionTo(q.WaitForSubConfirm):this.transitionTo(q.WaitForCanAcceptData)}).reaction(M.SUBSCRIBE_TIMEOUT,function(){const ee=S.TIMEOUT;return q.setCurrentError({eventText:"Subscription timeout while reapplying",errorSubcode:ee}),this.transitionTo(q.DestroyingTransport)}).exit(function(){return q.clearSubscriptionCacheKeys(),this}),this.WaitForSubConfirm=new R({name:F.WAITING_FOR_SUBCONFIRM,parentContext:q.ReapplyingSubscriptions}).reaction(M.TRANSPORT_PROTOCOL_SMP,function(ee){const ge=ee.smfMsg.smfHeader,d=se(ee.smfMsg.encodedUtf8Subscription),O=ge.pm_respcode,D=ge.pm_respstr;if(O!==200){const Q=T.getErrorSubcode(O,D);return Z(`Waiting for subscription confirmation, got ${O} (${Q}) '${D}' on subscription ${d}`),q.setCurrentError({eventText:D,responseCode:O,errorSubcode:Q}),this.transitionTo(q.DestroyTransport)}return q._session.canConnectPublisher&&q._defaultPublisher&&q._defaultPublisher.isBindWaiting()?this.transitionTo(q.WaitingForMessagePublisher):this.transitionToExitPoint(q.SessionConnecting,"ConnectedExit")}),this.WaitForCanAcceptData=new R({name:F.WAITING_FOR_CAN_ACCEPT_DATA,parentContext:q.ReapplyingSubscriptions}).reaction(M.TRANSPORT_PROTOCOL_SMP,function(ee){const ge=ee.smfMsg.smfHeader,d=se(ee.smfMsg.encodedUtf8Subscription),O=ge.pm_respcode,D=ge.pm_respstr;if(O!==200){const Q=T.getErrorSubcode(O,D);return q.setCurrentError({eventText:D,responseCode:O,errorSubcode:Q}),this.transitionTo(q.DestroyingTransport)}return Z(`Unexpected 200 OK response to subscription add for ${d}`),this.internalTransition(null)}).reaction(M.TRANSPORT_CAN_ACCEPT_DATA,function(){return q.reapplySubscriptions()===!0?this.transitionTo(q.WaitForSubConfirm):this.internalTransition(null)}),this.WaitingForMessagePublisher=new R({name:F.WAITING_FOR_PUBFLOW,parentContext:q.SessionConnecting}).entry(()=>{q._defaultPublisher.connect(),q.sendPublisherSessionUpEvent(q._defaultPublisher)}).reaction(M.FLOW_UP,function(){return q._defaultPublisher.isBindWaiting()?this.internalTransition(null):this.transitionToExitPoint(q.SessionConnecting,"ConnectedExit")}).reaction(M.FLOW_FAILED,function(ee){return q.setCurrentError({eventText:`Guaranteed Message Publisher Failed: ${ee.eventText}`,errorSubcode:S.LOGIN_FAILURE}),this.transitionTo(q.DestroyingTransport)}),this.SessionTransportUp=new R({name:F.TRANSPORT_UP,parentContext:q}).entry(function(){return q.clearConnectTimer(),this}).initial(function(){return q._session.canConnectConsumer&&(q._consumers.flows.forEach(ee=>q.sendConsumerSessionUpEvent(ee)),q._consumers.reconnectingFlows.forEach(ee=>q.sendConsumerSessionUpEvent(ee))),this.transitionTo(q.FullyConnected)}).reaction(M.DISCONNECT,function(){return this.transitionTo(q.SessionDisconnecting)}).reaction(M.EXCEPTION,function(ee){return q.setCurrentError(ee),q.cleanupSession(),this.transitionToEntryPoint(q.SessionConnecting,"ReconnectTransport")}).reaction(M.SEND_ERROR,function(ee){return q.setCurrentError(ee),q.cleanupSession(),this.transitionToEntryPoint(q.SessionConnecting,"ReconnectTransport")}).reaction(M.TRANSPORT_DESTROYED,function(ee){return q.setCurrentError(ee),Z("Received unsolicited TRANSPORT_DESTROYED event while transport is up"),q.cleanupSession(),this.transitionToEntryPoint(q.SessionConnecting,"ReconnectTransport")}).reaction(M.TRANSPORT_PROTOCOL_SMP,function(ee){const ge=ee.smfMsg.smfHeader,d=se(ee.smfMsg.encodedUtf8Subscription),O=ge.pm_respcode,D=ge.pm_respstr;return q.handleSubscriptionUpdateError(O,D,d,void 0,!1),this.internalTransition(null)}).reaction(M.TRANSPORT_CAN_ACCEPT_DATA,function(ee){const ge=H.build(L.CAN_ACCEPT_DATA,"",null,0,null,ee.toString());return q.emitSessionEvent(ge),q._userBackpressured=!1,this.internalTransition(null)}).reaction(M.CREATE_SUBSCRIBER,function(ee){const ge=q._consumers.add(ee.guaranteedFlowObject);return q.sendConsumerSessionUpEvent(ge),this}).exit(function(){return q.clearKeepAlive(),this}),this.FullyConnected=new R({name:F.FULLY_CONNECTED,parentContext:q.SessionTransportUp}).entry(()=>{q._connectFailEvent=L.DOWN_ERROR,q.scheduleKeepAlive()}),this.SessionDisconnected=new R({name:F.DISCONNECTED,parentContext:q}).reaction(M.DISCONNECT,function(){return q.setPostEventAction(()=>{q.emitSessionEvent(H.build(L.DISCONNECTED))}),this.internalTransition(null)}).reaction(M.CONNECT,function(){return this.transitionTo(q.SessionConnecting)}).reaction(M.EXCEPTION,function(){return this.internalTransition(null)}),this.SessionDisconnecting=new R({name:F.DISCONNECTING,parentContext:q}).initial(()=>(Z(`Disconnecting session ${q}`),this.transitionTo(q.DisconnectingFlows))).reaction(M.DISCONNECT,function(){return this.internalTransition(null)}).reaction(M.EXCEPTION,function(ee){return q.setCurrentError({errEvent:ee}),q.cleanupSession(),this.transitionToEntryPoint(q.SessionConnecting,"DisconnectTransport")}).reaction(M.TRANSPORT_DESTROYED,function(){return Z("Received unsolicited TRANSPORT_DESTROYED while disconnecting transport"),q.cleanupSession(),this.transitionToEntryPoint(q.SessionConnecting,"DisconnectTransport")}),this.DisconnectingFlows=new R({name:F.DISCONNECTING_FLOWS,parentContext:q.SessionDisconnecting},{gatherPendingFlows(){const{MessageConsumerEventName:ee}=r;u(!this.isGathering),this.isGathering=!0;const ge=(d,O,D)=>{if(u(d,"Trying to listen to undefined flow"),this.known.has(d))return;this.known.add(d),this.pending.add(d);const Q=()=>{D.forEach(re=>d._removeListener(re,Q)),this.pending.delete(d),this.isGathering||this.checkPendingFlows()};D.forEach(re=>O.call(d,re,Q));try{d._disconnectSession()}catch{Q()}};q._consumers&&q._consumers.flows.forEach(d=>{ge(d,d._once,[ee.DOWN,ee.DOWN_ERROR])}),this.isGathering=!1},checkPendingFlows(){this.pending,this.pending.size===0&&(this.gatherPendingFlows(),this.pending.size===0&&this.proceed())},proceed(){this.known=null,this.pending=null,Z("All flows disconnected"),q.processEvent(new p({name:M.FLOWS_DISCONNECTED}))}}).entry(function(){this.known=new Set,this.pending=new Set,this.checkPendingFlows()}).reaction(M.FLOWS_DISCONNECTED,function(){return this.transitionTo(q.FlushingTransport)}),this.FlushingTransport=new R({name:F.FLUSHING_TRANSPORT,parentContext:q.SessionDisconnecting},{flushTransport(){q.cleanupSession(),q.flushTransportSession(()=>this.onTransportFlushed()),this.sessionId=null},onTransportFlushed(){q.processEvent(new p({name:M.TRANSPORT_FLUSHED}))}}).entry(function(){Z("Flushing transport"),this.flushTransport()}).reaction(M.TRANSPORT_FLUSHED,function(){return Z("Handle Transport Flushed"),this.transitionToEntryPoint(q.SessionConnecting,"DisconnectTransport")})}addToSubscriptionCache(b){if(f.nothing(b)||!this._subscriptionCache)return;this.logger;const X=b.name;this._subscriptionCache[X]===null||this._subscriptionCache[X]===void 0?(this._subscriptionCache[X]=b,this._subscriptionCacheCount++):this._subscriptionCache[X]=b}cancelOutstandingCorrelatedReq(b){if(f.nothing(b)||!this._correlatedReqs)return null;const X=this._correlatedReqs[b];if(X==null)return null;const{LOG_DEBUG:ae,LOG_ERROR:ie}=this.logger;X.timer&&(clearTimeout(X.timer),X.timer=null);try{delete this._correlatedReqs[b]||ie(`Cannot delete ctrl request ${b}`)}catch(q){ie(`Cannot delete ctrl request ${b}`,q)}return X}cleanupSession(){const{LOG_INFO:b}=this.logger;b("Clean up session");const{ConsumerFSMEvent:X,ConsumerFSMEventNames:ae}=r;this._correlatedReqs&&Object.keys(this._correlatedReqs).forEach(ie=>this.cancelOutstandingCorrelatedReq(ie)),this.clearConnectTimer(),this.clearClientCtrlTimer(),this.clearKeepAlive(),this._consumers.flows.forEach(ie=>{ie.processFSMEvent(new X({name:ae.SESSION_DOWN}))}),this._consumers.reconnectingFlows.forEach(ie=>{ie.processFSMEvent(new X({name:ae.SESSION_DOWN}))}),this._defaultPublisher&&this._defaultPublisher.processFSMEvent(new i.PublisherFSMEvent({name:i.PublisherFSMEventNames.SESSION_DOWN})),this._session.cleanupSession()}clearClientCtrlTimer(){this._clientCtrlTimer&&(clearTimeout(this._clientCtrlTimer),this._clientCtrlTimer=null)}clearConnectTimer(){this._connectTimer&&(clearTimeout(this._connectTimer),this._connectTimer=void 0)}clearKeepAlive(){const{LOG_INFO:b}=this.logger;this._keepAliveTimer&&(b("Cancel keepalive timer"),clearInterval(this._keepAliveTimer),this._keepAliveTimer=null),this.resetKeepAliveCounter()}checkNoLocal(b){let X=!0;if(this._sessionProperties.noLocal===!0){const ae=b.getRouterCapabilities();X=!!ae&&typeof ae[o.NO_LOCAL]=="boolean"&&ae[o.NO_LOCAL]}return X}checkCompressedSsl(b){if(this.logger,this._compressedTLS){const X=b.getRouterCapabilities();return!(!X||typeof X[o.COMPRESSED_SSL]!="boolean")&&X[o.COMPRESSED_SSL]===!0}return!0}checkSessionDestinationCapability(b){let X=null;return b&&b.getType()&&b.getSubscriptionInfo()&&(b.getSubscriptionInfo().isShare||b.getSubscriptionInfo().isNoExport)&&!this._session.isCapable(o.SHARED_SUBSCRIPTIONS)&&(X=new C("Shared subscriptions are not allowed by router for this client",S.SHARED_SUBSCRIPTIONS_NOT_SUPPORTED,null)),X}clearCurrentError(){this._currentError=null}clearSubscriptionCacheKeys(){this._subscriptionCacheKeys=null}copySubscriptionCacheKeys(){this.clearSubscriptionCacheKeys(),this._subscriptionCacheKeys=Object.keys(this._subscriptionCache||{});const b=B.getP2PTopicSubscription(this._sessionProperties.p2pInboxBase);this._subscriptionCacheKeys.push(b)}createMessagePublisher(){if(this.logger,!this._sessionProperties.publisherProperties.enabled)return;const{MessagePublisher:b,MessagePublisherEventName:X}=i,ae=new b({properties:this._sessionProperties.publisherProperties,sessionInterfaceFactory:this._flowInterfaceFactory});ae.on(X.UP,()=>this.processEvent(new G({name:M.FLOW_UP},{guaranteedFlowObject:ae}))),ae.on(X.CONNECT_FAILED_ERROR,ie=>this.processEvent(new G({name:M.FLOW_FAILED},{guaranteedFlowObject:ae,event:ie,eventText:ie.description}))),ae.on(X.REJECTED_MESSAGE,(ie,q)=>{const Pe=q.smfHeader,ve=Pe.pm_respcode,Qe=Pe.pm_respstr,Z=T.getADErrorSubcode(ve,Qe),ee=H.build(L.REJECTED_MESSAGE_ERROR,Qe,ve,Z,ie.getCorrelationKey());ee.message=ie,this.emitSessionEvent(ee)}),ae.on(X.ACKNOWLEDGED_MESSAGE,ie=>{const q=H.build(L.ACKNOWLEDGED_MESSAGE,"Message(s) acknowledged",void 0,0,ie.getCorrelationKey());q.message=ie,this.emitSessionEvent(q)}),ae.on(X.FLOW_NAME_CHANGED,ie=>{const{messages:q,count:Pe}=ie;if(Pe>0){const ve=H.build(L.REPUBLISHING_UNACKED_MESSAGES,`Republishing ${Pe} messages due to Guaranteed Message Publisher failed to reconnect`);ve.messages=q,ve.count=Pe,this.emitSessionEvent(ve)}}),ae.on(X.CAN_SEND,()=>{this.emitSessionEvent(H.build(L.CAN_ACCEPT_DATA,`${ae} window is now open and can send`))}),ae.on(X.GUARANTEED_MESSAGING_DOWN,()=>{this.emitSessionEvent(H.build(L.GUARANTEED_MESSAGE_PUBLISHER_DOWN,"Guaranteed Message Publishing shut down"))}),this._defaultPublisher=ae}sendConsumerSessionUpEvent(b){const{ConsumerFSMEvent:X,ConsumerFSMEventNames:ae}=r,ie=new X({name:this._session.canConnectConsumer?ae.SESSION_UP:ae.SESSION_UP_NO_AD});ie.guaranteedFlowObject=b,b.processFSMEvent(ie)}sendPublisherSessionUpEvent(b){const X=this._session.canConnectPublisher,ae=new i.PublisherFSMEvent({name:X?i.PublisherFSMEventNames.SESSION_UP:i.PublisherFSMEventNames.SESSION_UP_NO_AD});ae.guaranteedFlowObject=b,b.processFSMEvent(ae)}createMessageConsumer(b){const{MessageConsumer:X}=r,ae=new X({properties:b,sessionInterfaceFactory:this._flowInterfaceFactory}),ie=ae.getProperties();if(ie.topicEndpointSubscription){const Pe=this.checkSessionDestinationCapability(ie.topicEndpointSubscription);if(Pe)throw Pe}const q={guaranteedFlowObject:ae};return this.processEvent(new G({name:M.CREATE_SUBSCRIBER},q)),ae}createQueueBrowser(b){const{MessageConsumerAcknowledgeMode:X,QueueBrowser:ae}=r;this.logger;const ie={};return ie.queueDescriptor=b.queueDescriptor,ie.acknowledgeMode=X.CLIENT,ie.browser=!0,Object.prototype.hasOwnProperty.call(b,"connectTimeoutInMsecs")&&(ie.connectTimeoutInMsecs=b.connectTimeoutInMsecs),Object.prototype.hasOwnProperty.call(b,"connectAttempts")&&(ie.connectAttempts=b.connectAttempts),Object.prototype.hasOwnProperty.call(b,"windowSize")&&(ie.windowSize=b.windowSize),Object.prototype.hasOwnProperty.call(b,"transportAcknowledgeTimeoutInMsecs")&&(ie.transportAcknowledgeTimeoutInMsecs=b.transportAcknowledgeTimeoutInMsecs),Object.prototype.hasOwnProperty.call(b,"transportAcknowledgeThresholdPercentage")&&(ie.transportAcknowledgeThresholdPercentage=b.transportAcknowledgeThresholdPercentage),new ae(this.createMessageConsumer(ie))}destroyTransportSession(b,X){if(f.nothing(this._transport))return void this.processEvent(new G({name:M.TRANSPORT_DESTROYED}));const{LOG_INFO:ae,LOG_ERROR:ie}=this.logger;ae("Destroy transport session");const q=this._transport.destroy(b,X);this._smfClient=null,q!==l.TransportReturnCode.OK&&ie(`Failed to destroy transport session, return code: ${l.TransportReturnCode.describe(q)}`)}disposeInternal(){if(this._disposed)return;const b={transport:()=>{this.destroyTransportSession("Disposing",0),this._transport=null,this._smfClient=null},session:()=>{this.cleanupSession(),this._session=null,this._sessionProperties=null,this._correlatedReqs=null,this._flowInterfaceFactory=null},statistics:()=>{this._sessionStatistics&&(this._sessionStatistics.resetStats(),this._sessionStatistics=null),this._kaStats=null},"subscription cache":()=>{this._subscriptionCache&&(Object.keys(this._subscriptionCache).forEach(X=>this.removeFromSubscriptionCache(X)),this._subscriptionCache=null),this.clearSubscriptionCacheKeys(),this._subscriptionCacheCount=0},MessagePublishers:()=>{this._defaultPublisher&&(this._defaultPublisher.dispose(),this._defaultPublisher=null)},MessageConsumers:()=>{this._consumers.disposeAll(),this._consumers=null},"host list":()=>{this._currentHost=null,this._hosts=null}};Object.keys(b).forEach(X=>{const{LOG_TRACE:ae,LOG_INFO:ie}=this.logger,q=b[X];try{q()}catch(Pe){ie(`Dispose: ${X} failed:`,Pe,"...continuing")}}),this._disposed=!0}emitSessionEvent(b){this._session.sendEvent(b)}enqueueOutstandingCorrelatedReq(b,X,ae,ie,q){if(f.nothing(b))return;const{LOG_INFO:Pe}=this.logger;Pe(`Enqueue outstanding ctrl request correlationTag=${b}`);let ve=null;X&&(ve=setTimeout(X,ae||this._sessionProperties.readTimeoutInMsecs));const Qe=new g(b,ve,ie,q);this._correlatedReqs[b]=Qe}errorInFsm(b,X,ae=null){const{LOG_INFO:ie}=this.logger,q=new G({name:M.EXCEPTION});return ie(`Handling error in FSM: ${b} ${ae&&ae.stack}`),this.setCurrentError({eventText:b,errorSubcode:X,eventReason:ae}),this.processEvent(q)}flushTransportSession(b){this._transport?this._transport.flush(b):b()}getCorrelationTag(){return this._smfClient.nextCorrelationTag()}getCurrentStateName(){const b=this.getCurrentState();return b?b===this.getFinalState()?F.DISPOSED:this.getCurrentState().getName():null}getStat(b){if(this._sessionStatistics!==void 0)return b===_.TX_TOTAL_DATA_MSGS?this._sessionStatistics.getStat(_.TX_DIRECT_MSGS)+this._sessionStatistics.getStat(_.TX_PERSISTENT_MSGS)+this._sessionStatistics.getStat(_.TX_NONPERSISTENT_MSGS):b===_.TX_TOTAL_DATA_BYTES?this._sessionStatistics.getStat(_.TX_DIRECT_BYTES)+this._sessionStatistics.getStat(_.TX_PERSISTENT_BYTES)+this._sessionStatistics.getStat(_.TX_NONPERSISTENT_BYTES):this._sessionStatistics.getStat(b)}getTransportInfo(){return f.nothing(this._transport)?"Not connected.":this._transport.getInfoStr()}handleADCtrlMessage(b,X){const ae=b.getFlowId(),ie=X.pm_respstr,q=X.pm_corrtag,{LOG_INFO:Pe,LOG_DEBUG:ve,LOG_WARN:Qe}=this.logger;if(q){this.updateRxStats(b),Pe(`Handle SMF response for correlationTag ${q}`);const D=this.cancelOutstandingCorrelatedReq(q);return f.nothing(D)?this.errorInFsm(`Cannot find matching request for response: ${ie}`,S.INTERNAL_ERROR):D.respRecvdCallback?(D.respRecvdCallback(b,D),this):(this.incStat(_.RX_REPLY_MSG_DISCARD),this)}let Z;const ee=b.msgType,{SMFAdProtocolMessageType:ge}=t;switch(ee){case ge.CLIENTACK:case ge.CLIENTNACK:case ge.CLOSEPUBFLOW:this._defaultPublisher.flowId===ae&&(Z=this._defaultPublisher);break;default:Z=this._consumers.getFlowById(ae)}if(Z&&!Z.disposed)return this.updateRxStats(b,Z),Z.handleUncorrelatedControlMessage(b),this;const d=b.getResponse(),O=d?`"${d.responseCode} ${d.responseString}" `:"";return Qe(`Dropping ADCTRL.${t.SMFAdProtocolMessageType.describe(b.msgType)} ${O}for unknown flow ${ae}`),this.incStat(_.RX_DISCARD_NO_MATCHING_CONSUMER),this}handleADTrMessage(b,X){this.logger;const ae=X.pm_ad_flowid,ie=this._consumers.getFlowById(ae);return!ie||ie.disposed?(this.updateRxStats(b,this._sessionStatistics),this.incStat(_.RX_DISCARD_NO_MATCHING_CONSUMER),null):(this.updateRxStats(b,ie),ie.handleDataMessage(b),ie)}handleApiSubscriptionTimeout(b,X){if(this._correlatedReqs[b]===void 0||this._correlatedReqs[b]===null)return;const{LOG_INFO:ae,LOG_ERROR:ie}=this.logger;ae(`${X||"Subscription timeout"} for correlationTag=${b}`);try{delete this._correlatedReqs[b]||ie(`Cannot delete ctrl request ${b}`)}catch(q){ie(`Cannot delete ctrl request ${b}, exception: ${q.message}`)}}handleClientCtrlMessage(b,X){let ae;const{LOG_INFO:ie}=this.logger;this.updateRxStats(b),b.msgType===t.SMFClientCtrlMessageType.LOGIN?(ae=l.SMFClient.SMF_CLIENTCTRL_LOGIN_FAKE_CORRELATIONTAG,ie("Handle SMF response for ClientCTRL Login")):(ae=X.pm_corrtag,ie(`Handle SMF response for correlationTag ${ae}`));const q=this.cancelOutstandingCorrelatedReq(ae);if(f.nothing(q)){const Pe=X.pm_respstr;return this.errorInFsm(`Cannot find matching request for response: ${Pe}`,S.INTERNAL_ERROR)}return q.respRecvdCallback?q.respRecvdCallback(b):(ie(`Dropping ClientCtrl message due to mismatched correlation tag ${ae}`),this.incStat(_.RX_REPLY_MSG_DISCARD))}handleClientCtrlResponse(b){const X=new G({name:M.TRANSPORT_PROTOCOL_CLIENTCTRL});X.smfMsg=b,this.processEvent(X)}handleClientCtrlTimeout(){const{LOG_INFO:b}=this.logger;b("ClientCtrl timeout for session");const X=new G({name:M.DOWNGRADE_TIMEOUT});this.processEvent(X)}handleConnectTimeout(){const{LOG_INFO:b}=this.logger;b("Connection timeout. Disconnecting");const X=new G({name:M.CONNECT_TIMEOUT});this.processEvent(X)}handleUpdatePropertyTimeout(b,X){const{LOG_ERROR:ae}=this.logger;try{delete this._correlatedReqs[b]||ae(`Cannot delete ctrl request ${b}`)}catch(q){ae(`Cannot delete ctrl request ${b}, exception: ${q.message}`)}const ie=H.build(L.PROPERTY_UPDATE_ERROR,X,null,S.TIMEOUT,null,null);this.sendEvent(ie)}handleRejectedTrMessage(b){const X=b.pm_respcode,ae=b.pm_tr_topicname_bytes,ie=ae?ae.replace(/\0/g,""):"",q=b.pm_respstr,Pe=T.getErrorSubcode(X,q);this.emitSessionEvent(H.build(L.REJECTED_MESSAGE_ERROR,q,X,Pe,null,`Topic: ${ie}`))}handleSMFMessage(b){try{const X=b.smfHeader;if(X.discardMessage)return this._sessionStatistics&&this._sessionStatistics.incStat(_.RX_DISCARD_SMF_UNKNOWN_ELEMENT),null;switch(X.smf_protocol){case t.SMFProtocol.TRMSG:return X.smf_adf?this.handleADTrMessage(b,X):(this.updateRxStats(b,this._sessionStatistics),X.pm_respcode===0?this._session.handleDataMessage(b):this.handleRejectedTrMessage(X));case t.SMFProtocol.ADCTRL:return this.handleADCtrlMessage(b,X);case t.SMFProtocol.CLIENTCTRL:return this.handleClientCtrlMessage(b,X);case t.SMFProtocol.SMP:return this.handleSMPMessage(b,X);case t.SMFProtocol.KEEPALIVE:case t.SMFProtocol.KEEPALIVEV2:return null;default:return this.handleUnknownProtocolMessage(b,X)}}catch(X){const{LOG_ERROR:ae}=this.logger;return ae(`Exception in handleSMFMessage, exception: ${X.stack}`),this.errorInFsm(`Exception in handleSMFMessage: ${X.message}`,X.subcode||S.INTERNAL_ERROR,X)}}handleSMFParseError(b){return this.errorInFsm(b,S.PROTOCOL_ERROR)}handleSMPMessage(b,X){this.updateRxStats(b);const ae=this.cancelOutstandingCorrelatedReq(X.pm_corrtag||"");if(f.nothing(ae)||f.nothing(ae.respRecvdCallback)){const ie=new G({name:M.TRANSPORT_PROTOCOL_SMP});return ie.smfMsg=b,this.processEvent(ie)}return ae.respRecvdCallback(b,ae)}handleSubscriptionUpdateError(b,X,ae,ie,q){const Pe=T.getErrorSubcode(b,X);Pe!==S.SUBSCRIPTION_ALREADY_PRESENT&&Pe!==S.SUBSCRIPTION_NOT_FOUND&&this.removeFromSubscriptionCache(ae),this._session.handleSubscriptionUpdateError(b,X,ae,ie,q)}handleSubscriptionTimeout(b){const{LOG_ERROR:X}=this.logger;try{delete this._correlatedReqs[b]||X(`Cannot delete ctrl request ${b}`)}catch(ie){X(`Cannot delete ctrl request ${b}`,ie)}const ae=new G({name:M.SUBSCRIBE_TIMEOUT});this.processEvent(ae)}handleTransportEvent(b){const{LOG_INFO:X,LOG_WARN:ae}=this.logger,ie=b.getInfoStr()||"";let q;switch(X(`Receive transport event: ${b}`),b.getTransportEventCode()){case l.TransportSessionEventCode.UP_NOTICE:q=new G({name:M.TRANSPORT_UP}),q.sessionId=b.getSessionId(),this.processEvent(q);break;case l.TransportSessionEventCode.DESTROYED_NOTICE:q=new G({name:M.TRANSPORT_DESTROYED}),q.sessionId=b.getSessionId(),q.eventText=ie,q.errorSubcode=b.getSubcode(),q.eventReason=b,this._smfClient=null,this._transport=null,this.processEvent(q);break;case l.TransportSessionEventCode.CAN_ACCEPT_DATA:this.GuaranteedFlowControlledRelief(),q=new G({name:M.TRANSPORT_CAN_ACCEPT_DATA}),q.sessionId=b.getSessionId(),this.processEvent(q);break;case l.TransportSessionEventCode.SEND_ERROR:q=new G({name:M.SEND_ERROR}),q.sessionId=b.getSessionId(),q.eventText=b.getInfoStr(),q.errorSubcode=b.getSubcode(),q.eventReason=b,this.processEvent(q);break;case l.TransportSessionEventCode.DATA_DECODE_ERROR:case l.TransportSessionEventCode.PARSE_FAILURE:return this.errorInFsm(b.getInfoStr(),b.getSubcode());default:ae("Received unknown transport session event",b)}return!0}handleUnknownProtocolMessage(b,X){const{LOG_INFO:ae,LOG_ERROR:ie}=this.logger;return this.updateRxStats(b),X&&X.smf_protocol===t.SMFProtocol.TSESSION?(ie(`Received transport session message instead of SMF message, protocol 0x${J(X.smf_protocol)}`),ie(`Transport MessageType=${b.messageType}, target sessionId=${J(b.sessionId)}`),this.errorInFsm("Received message with unknown protocol",S.PARSE_FAILURE)):(this._sessionStatistics&&this._sessionStatistics.incStat(_.RX_DISCARD_SMF_UNKNOWN_ELEMENT),ae(`Drop message with unknown protocol 0x${J(X.smf_protocol)}`),null)}incStat(b,X){return this._sessionStatistics?this._sessionStatistics.incStat(b,X):void 0}initTransport(){const{LOG_INFO:b}=this.logger,X=this._currentHost;b(`Creating transport session ${X}`),this._kaStats={lastMsgWritten:0,lastBytesWritten:0},this._smfClient=new l.SMFClient(ae=>this.handleSMFMessage(ae),ae=>this.handleSMFParseError(ae),this),this._transport=l.TransportFactory.createTransport(X,ae=>this.handleTransportEvent(ae),this._smfClient,this._sessionProperties.clone(),()=>this.sessionIdHex),this.injectTransportInterceptor(this._transportInterceptor)}injectTransportInterceptor(b){this._transportInterceptor=b,this._transport&&this._transport.setInterceptor(b)}keepAliveTimeout(){const{LOG_TRACE:b,LOG_DEBUG:X,LOG_INFO:ae}=this.logger;if(this._keepAliveCounter>=this._sessionProperties.keepAliveIntervalsLimit)return ae(`Exceed maximum keep alive intervals limit ${this._sessionProperties.keepAliveIntervalsLimit}`),this._keepAliveTimer&&clearInterval(this._keepAliveTimer),this.errorInFsm("Exceed maximum keep alive intervals limit",S.KEEP_ALIVE_FAILURE);const ie=this._transport.getClientStats(),q=ie.msgWritten,Pe=ie.bytesWritten,ve=new t.KeepAliveMessage;return this.send(ve,null,!0)!==l.TransportReturnCode.OK?this.errorInFsm("Cannot send keep alive message",S.KEEP_ALIVE_FAILURE):(this._kaStats.lastMsgWritten===q&&this._kaStats.lastBytesWritten<Pe||(this._keepAliveCounter++,this._kaStats.lastMsgWritten,this._kaStats.lastBytesWritten),this._keepAliveCounter,this._kaStats.lastBytesWritten=ie.bytesWritten,this._kaStats.lastMsgWritten=ie.msgWritten,!0)}prepareAndSendMessage(b){if(b instanceof P){let X;const ae=b.getDeliveryMode();switch(ae){case x.DIRECT:if(!this._transport)return;b._payload_is_memoized=!1,b._memoized_csumm=null,b._memoized_payload=null,X=this.sendToTransport(b);break;case x.PERSISTENT:case x.NON_PERSISTENT:if(!this._defaultPublisher){const ie=this._session.adLocallyDisabled?"locally disabled":"remotely unsupported";throw new C("Session does not provide Guaranteed Message Publish capability",S.GM_UNAVAILABLE,ie)}this._gmSendDisallowed&&this._gmSendDisallowed(),X=this._defaultPublisher.prepareAdMessageAndSend(b);break;default:{const{LOG_ERROR:ie}=this.logger;ie("Unhandled message delivery mode",x.describe(ae))}}if(X!==l.TransportReturnCode.OK){if(X===l.TransportReturnCode.NO_SPACE)throw this._userBackpressured=!0,new C("Cannot send message - no space in transport",S.INSUFFICIENT_SPACE,l.TransportReturnCode.describe(X));this.setCurrentError(new C("Cannot send message",S.INVALID_OPERATION,l.TransportReturnCode.describe(X))),this.processEvent(new G({name:M.EXCEPTION}))}}}GuaranteedFlowControlledRelief(){this._defaultPublisher&&this._defaultPublisher.processFSMEvent(new i.PublisherFSMEvent({name:i.PublisherFSMEventNames.CAN_SEND}))}reapplySubscriptions(){const{LOG_INFO:b,LOG_DEBUG:X}=this.logger,{SolclientFactory:{createTopicDestination:ae}}=c;if(b(`Reapplying subscriptions, count=${this._subscriptionCacheKeys.length}`),!this._subscriptionCacheKeys)return!0;try{for(;this._subscriptionCacheKeys.length;){const ie=this._subscriptionCacheKeys.shift(),q=this._subscriptionCacheKeys.length===0,Pe=ae(ie),ve=this.sendSubscribe(Pe,q,null,this._sessionProperties.readTimeoutInMsecs,null);ve!==l.TransportReturnCode.OK&&this.errorInFsm(`Error occurred sending subscription: ${l.TransportReturnCode.describe(ve)}`,S.INTERNAL_ERROR)}}catch(ie){if(ie instanceof C&&ie.subcode===S.INSUFFICIENT_SPACE)return!1;this.errorInFsm(`Unexpected expection occurred while reapplying subscriptions: ${ie}`,ie.subcode||S.INTERNAL_ERROR,ie)}return!0}removeFromSubscriptionCache(b){if(f.nothing(b)||!this._subscriptionCache)return null;const{LOG_DEBUG:X,LOG_ERROR:ae}=this.logger,ie=b instanceof h?b.name:b,q=this._subscriptionCache[ie];if(q==null)return null;try{delete this._subscriptionCache[ie]?this._subscriptionCacheCount--:ae(`Cannot remove subscription ${ie}`)}catch(Pe){ae(`Cannot remove subscription ${ie}`,Pe)}return q}reset(){this.resetStats(),this.sessionId=null,this._keepAliveTimer=null,this.resetKeepAliveCounter(),this._correlatedReqs={},this._disposed=!1,this._smfClient=null,this._kaStats={lastMsgWritten:0,lastBytesWritten:0},this._subscriptionCache=null,this._subscriptionCacheKeys=null,this._subscriptionCacheCount=0,this._sessionProperties.reapplySubscriptions&&(this._subscriptionCache={}),this._eventCode=null,this._responseCode=null,this.eventText=null,this.errorSubcode=null,this.eventReason=null}resetKeepAliveCounter(){this._keepAliveCounter=0}resetStats(){return this._sessionStatistics?this._sessionStatistics.resetStats():void 0}scheduleKeepAlive(){const{LOG_DEBUG:b,LOG_ERROR:X}=this.logger,{keepAliveIntervalInMsecs:ae}=this._sessionProperties;ae!==0&&(this._keepAliveTimer&&clearInterval(this._keepAliveTimer),this._keepAliveTimer=setInterval(()=>{try{this.keepAliveTimeout()}catch(ie){X("Error occurred in keepAliveTimeout",ie)}},ae))}send(b,X=this._sessionStatistics,ae=!1){try{return this.sendToTransport(b,X,ae)}catch(ie){this.logger,ie.message,ie.stack,this.errorInFsm(`Send operation failed: ${ie.message}`,ie.subcode||S.CONNECTION_ERROR)}return l.TransportReturnCode.CONNECTION_ERROR}sendToTransport(b,X=this._sessionStatistics,ae=!1){let ie=l.TransportReturnCode.CONNECTION_ERROR;if(!this._transport)throw new C("Transport has been destroyed",S.INTERNAL_ERROR);const q=t.Codec.Encode.encodeCompoundMessage(b);switch(ie=this._transport.send(q,ae),ie){case l.TransportReturnCode.OK:this.updateTxStats(b,X);break;case l.TransportReturnCode.NO_SPACE:if(!ae)break;default:throw new C(`Transport returned ${l.TransportReturnCode.describe(ie)}`,S.INTERNAL_ERROR)}return ie}sendClientCtrlLogin(){const{LOG_INFO:b,LOG_DEBUG:X,LOG_TRACE:ae}=this.logger;this._compressedTLS=this._sessionProperties.compressionLevel>0&&this._currentHost.match(/tcps:/i)!==null,this._plaintextTLS=this._currentHost.match(/tcps:/i)!==null&&this._sessionProperties.sslConnectionDowngradeTo===Y.PLAINTEXT,this._plaintextTLS,this._compressedTLS;const ie=t.ClientCtrlMessage.getLogin(this._sessionProperties,this._compressedTLS,this._plaintextTLS),q=this.send(ie);if(q!==l.TransportReturnCode.OK)this._responseCode=null,this.eventReason=null,q===l.TransportReturnCode.NO_SPACE?(this.eventText="Cannot send client control - no space in transport",this.errorSubcode=S.INSUFFICIENT_SPACE):(b(`Cannot send client ctrl, return code
          ${l.TransportReturnCode.describe(q)}`),this.eventText="Cannot send client ctrl",this.errorSubcode=S.INVALID_OPERATION);else{const Pe=l.SMFClient.SMF_CLIENTCTRL_LOGIN_FAKE_CORRELATIONTAG;b(`Using internally correlationTag=${Pe} for tracking ClientCTRL Login`),this.enqueueOutstandingCorrelatedReq(Pe,null,null,null,ve=>this.handleClientCtrlResponse(ve))}return q}sendSubscribe(b,X,ae,ie,q){const{LOG_INFO:Pe,LOG_DEBUG:ve}=this.logger;u(b instanceof h,"sendSubscribe requires a Destination, not a string");const Qe=this.getCorrelationTag(),Z=t.SMPMessage.getSubscriptionMessage(Qe,b,!0,X);u(Z.encodedUtf8Subscription,"Encoded SMP message was invalid");const ee=this.send(Z);return ee!==l.TransportReturnCode.OK?(Pe("Subscribe failed",l.TransportReturnCode.describe(ee)),ee):(X&&this.enqueueOutstandingCorrelatedReq(Qe,()=>this.handleSubscriptionTimeout(Qe),ie||this._sessionProperties.readTimeoutInMsecs,ae,q),ee)}sendUpdateProperty(b,X,ae,ie,q){const Pe=this._smfClient.nextCorrelationTag(),ve=t.ClientCtrlMessage.getUpdate(b,X,Pe),Qe=this.send(ve);return Qe!==l.TransportReturnCode.OK||this.enqueueOutstandingCorrelatedReq(Pe,()=>this.handleUpdatePropertyTimeout(Pe),ie||this._sessionProperties.readTimeoutInMsecs,ae,q),Qe}setClientCtrlTimer(){this.clearClientCtrlTimer(),this._clientCtrlTimer=setTimeout(()=>this.handleClientCtrlTimeout(),this._sessionProperties.transportDowngradeTimeoutInMsecs)}setConnectTimer(){this.clearConnectTimer(),this._connectTimer=setTimeout(()=>this.handleConnectTimeout(),this._sessionProperties.connectTimeoutInMsecs)}setCurrentError(b){const X=this._currentError||{};this.logger,Object.keys(b).forEach(ae=>b[ae]!==null&&b[ae]!==void 0&&(X[ae]!==null&&X[ae]!==void 0?(X[ae],b[ae],!1):(X[ae]=b[ae],!0))),this._currentError=X}subscriptionUpdate(b,X,ae,ie,q,Pe){const ve=this.checkSessionDestinationCapability(b);if(ve)throw ve;const Qe=z[q]||z.default,Z=q!==K.REMOVE_DTE_SUBSCRIPTION,ee=q===K.ADD_SUBSCRIPTION||q===K.ADD_P2PINBOX,ge=this.getCorrelationTag(),d=(Z?t.SMPMessage.getSubscriptionMessage:t.AdProtocolMessage.getDTEUnsubscribeMessage)(ge,b,ee,X),O=this.send(d);return O!==l.TransportReturnCode.OK||(X&&this.enqueueOutstandingCorrelatedReq(ge,()=>this.handleApiSubscriptionTimeout(ge,Qe),ie||this._sessionProperties.readTimeoutInMsecs,ae,Pe),q===K.ADD_SUBSCRIPTION&&this._sessionProperties.reapplySubscriptions?this.addToSubscriptionCache(b):q===K.REMOVE_SUBSCRIPTION&&this._sessionProperties.reapplySubscriptions&&this.removeFromSubscriptionCache(b)),O}queueSubscriptionUpdate(b,X,ae,ie,q){const Pe=ie?z[K.ADD_SUBSCRIPTION]:z[K.REMOVE_SUBSCRIPTION],ve=this.getCorrelationTag(),Qe=t.SMPMessage.getQueueSubscriptionMessage(ve,b,X,ie),Z=this.send(Qe);return Z!==l.TransportReturnCode.OK||this.enqueueOutstandingCorrelatedReq(ve,()=>{const ee=this._correlatedReqs[ve];this.handleApiSubscriptionTimeout(ve,Pe),q(null,ee)},ae||this._sessionProperties.readTimeoutInMsecs,null,q),Z}updateRxStats(b,X=this._sessionStatistics){if(!X)return;const ae=b.smfHeader;if(!ae)return;const ie=ae.pm_deliverymode||0,q=oe[ie],Pe=ne[ie],ve=ae.messageLength;switch(ae.smf_protocol){case t.SMFProtocol.TRMSG:ae.pm_respcode===0&&(X.incStat(_.RX_TOTAL_DATA_MSGS),X.incStat(q),X.incStat(_.RX_TOTAL_DATA_BYTES,ve),X.incStat(Pe,ve),ae.smf_di&&X.incStat(_.RX_DISCARD_MSG_INDICATION));break;case t.SMFProtocol.CLIENTCTRL:case t.SMFProtocol.SMP:case t.SMFProtocol.KEEPALIVE:case t.SMFProtocol.KEEPALIVEV2:case t.SMFProtocol.ADCTRL:X.incStat(_.RX_CONTROL_MSGS),X.incStat(_.RX_CONTROL_BYTES,ve)}}updateTxStats(b,X=this._sessionStatistics){if(!X)return;b.getReplyTo!==void 0&&b.getReplyTo()&&X.incStat(_.TX_REQUEST_SENT);const ae=b.smfHeader;if(!ae)return;const ie=ae.pm_deliverymode||0;let q=pe[ie],Pe=Te[ie];ie!==x.DIRECT&&b.isRedelivered()&&(q=de[ie],Pe=_e[ie]);const ve=ae.messageLength;switch(ae.smf_protocol){case t.SMFProtocol.TRMSG:X.incStat(q),X.incStat(Pe,ve);break;case t.SMFProtocol.CLIENTCTRL:case t.SMFProtocol.SMP:case t.SMFProtocol.KEEPALIVE:case t.SMFProtocol.KEEPALIVEV2:case t.SMFProtocol.ADCTRL:X.incStat(_.TX_CONTROL_MSGS),X.incStat(_.TX_CONTROL_BYTES,ve)}}updateReadonlySessionProps(b){const X=this._sessionProperties;X._setVpnNameInUse(b.getVpnNameInUseValue()||"");const ae=X.virtualRouterName,ie=b.getVridInUseValue()||"";X._setVirtualRouterName(ie),ae!==""&&ae!==ie&&this.handleVirtualRouterNameChange(ae,ie),X._setP2pInboxBase(b.getP2PTopicValue()||""),X._setP2pInboxInUse(B.getP2PInboxTopic(X.p2pInboxBase)),this._session.updateCapabilities(b.getRouterCapabilities());const q=this._session._getCapability(o.GUARANTEED_MESSAGE_PUBLISH);this._gmSendDisallowed=typeof q!="boolean"||q?null:()=>{throw new C("Sending guaranteed message is not allowed by router for this client",S.INVALID_OPERATION,null)}}handleVirtualRouterNameChange(b,X){this._consumers&&(this._consumers.flows.forEach(ae=>ae.onVRNChanged()),this._consumers.reconnectingFlows.forEach(ae=>ae.onVRNChanged())),this.emitSessionEvent(H.build(L.VIRTUALROUTER_NAME_CHANGED,`Virtual router name is changed from ${b} to ${X}`,null,0,null,null))}get sessionIdHex(){return this.sessionId&&J(this.sessionId)||"N/A"}updateTransportCompression(b){return this.logger,this._plaintextTLS,this._compressedTLS,this._plaintextTLS?(l.TransportFactory.severTls(this._transport,this._compressedTLS,b),null):this._compressedTLS?l.TransportFactory.startCompression(this._transport):this._transport}}},413:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionOperation=r.new({CONNECT:"CONNECT",DISCONNECT:"DISCONNECT",CTRL:"CTRL",SEND:"SEND",QUERY_OPERATION:"QUERY_OPERATION"})},928:(n,I,e)=>{const r=e(6780),i=(e(2975),e(7291)),{APIPropertiesValidators:t,parseURL:c}=e(7882),{AuthenticationScheme:l}=e(3278),{Check:u}=e(2201),{ErrorSubcode:o,OperationError:f}=e(3870),{LOG_WARN:g,LOG_INFO:h}=e(390);e(5153);const{TransportProtocol:T}=e(3147),{validateInstance:S,valArrayIsMember:C,valArrayOfString:p,valBoolean:R,valLength:N,valNotEmpty:w,valNumber:y,valRange:P,valString:x,valStringOrArray:B}=t,H=["http:","https:","ws:","wss:","tcp:","tcps:"];function L(Y,_,U){const A=i.ClientCtrlMessage.validateClientName(_[U],z=>new f(`${Y} validation: Property '${U}': ${z}`,o.PARAMETER_OUT_OF_RANGE));if(A)throw A}function M(Y,_,U,A,z,J){const se=_[U];if(!(J&&se===null||se===void 0||A.values.some(Te=>Te===se)))throw new f(`${Y} validation: Property '${U}' must be a member of ${z}`,o.PARAMETER_INVALID_TYPE)}function G(Y,_,U){const A=_[U],z=typeof A=="string"?A.split(","):A;if(!u.array(z))throw new f(`${Y} validation: Property '${U}' not an array or comma-delimited string`,o.PARAMETER_INVALID_TYPE);z.forEach(J=>{let se=null;try{se=c(J)}catch{throw new f(`${Y} validation: Property '${U}' contained an invalid URL: ${J}`,o.PARAMETER_OUT_OF_RANGE)}if(!u.included(se.protocol,H))throw new f(`${Y} validation: Property '${U}' contained a URL'${se.href}' with an invalid protocol: '${se.protocol}'`,o.PARAMETER_OUT_OF_RANGE)})}function K(Y,_,U){return function(A,z,J,se){const Te=A[z];if(Te instanceof Array){const pe=Te.length;for(let ne=0;ne<pe;ne++){const oe=Te[ne];if(se){if(se&&(!u.string(oe)||!oe.match(J)))return!1}else if(u.string(oe)&&oe.match(J))return!0}if(!se)return!1;if(se)return!0}return u.string(Te)&&Te.match(J)}(Y,_,/^(https|wss|tcps):/i,U)}const F={validate(Y){const _=S.bind(null,"SessionProperties",Y);if(_("url",[w],[B],[G]),_("userName",[x],[N,189]),_("password",[x],[N,128]),_("clientName",[x],[N,160],[L]),_("applicationDescription",[x],[N,254]),_("vpnName",[x],[N,32]),_("connectTimeoutInMsecs",[y],[P,1,Number.MAX_VALUE]),_("connectRetriesPerHost",[y],[P,-1,Number.MAX_VALUE]),_("connectRetries",[y],[P,-1,Number.MAX_VALUE]),_("reconnectRetries",[y],[P,-1,Number.MAX_VALUE]),_("reconnectRetryWaitInMsecs",[y],[P,0,6e4]),_("readTimeoutInMsecs",[y],[P,1,Number.MAX_VALUE]),_("sendBufferMaxSize",[y],[P,1,Number.MAX_VALUE]),_("maxWebPayload",[y],[P,100,Number.MAX_VALUE]),_("bufferedAmountQueryIntervalInMsecs",[y],[P,4,Number.MAX_VALUE]),_("generateSendTimestamps",[R]),_("generateReceiveTimestamps",[R]),_("includeSenderId",[R]),_("keepAliveIntervalInMsecs",[y],[P,0,Number.MAX_VALUE]),_("keepAliveIntervalsLimit",[y],[P,3,Number.MAX_VALUE]),_("generateSequenceNumber",[R]),_("subscriberLocalPriority",[y],[P,1,4]),_("subscriberNetworkPriority",[y],[P,1,4]),_("ignoreDuplicateSubscriptionError",[R]),_("ignoreSubscriptionNotFoundError",[R]),_("reapplySubscriptions",[R]),_("noLocal",[R]),_("transportDowngradeTimeoutInMsecs",[y],[P,1,Number.MAX_VALUE]),_("idToken",[x]),_("accessToken",[x]),Y.transportProtocol&&Y.webTransportProtocolList)throw new f("SessionProperties validation: Property 'transportProtocol' and 'webTransportProtocolList' cannot be set at the same time",o.PARAMETER_OUT_OF_RANGE);if(Y.webTransportProtocolList!==null&&Y.webTransportProtocolList!==void 0){if(!Array.isArray(Y.webTransportProtocolList))throw new f("Property 'webTransportProtocolList' must be an array if set",o.PARAMETER_INVALID_TYPE);if(Y.webTransportProtocolList.length===0)throw new f("Property 'webTransportProtocolList' must be non-empty if set",o.PARAMETER_OUT_OF_RANGE)}_("authenticationScheme",[M,l,"AuthenticationScheme",!1]);const U=Y.authenticationScheme===l.CLIENT_CERTIFICATE;if(!K(Y,"url",!0)&&U)throw new f("SessionProperties validation: Property 'authenticationScheme' cannot be set to client certificate for unsecured sessions",o.PARAMETER_OUT_OF_RANGE);if(u.equal(Y.authenticationScheme,l.OAUTH2)){if(!K(Y,"url",!0))throw new f(`SessionProperties validation: Property 'authenticationScheme' cannot be set to '${l.OAUTH2}' unless the session property 'url' is written to use a secure communication protocol like tcps or https.`,o.PARAMETER_CONFLICT);if(u.empty(Y.idToken)&&u.empty(Y.accessToken))throw new f(`SessionProperties validation: Property 'authenticationScheme' can be set to '${l.OAUTH2}' only if there is an accompanying token set as a session property. The token types that are supported for OAuth authentication are OAuth2.0 Access Tokens and OpenID Connect ID Tokens. To set an access token you can use the accessToken session property. To set an id you can use the idToken session property.`,o.PARAMETER_CONFLICT)}else u.empty(Y.idToken)&&u.empty(Y.accessToken)||h(`SessionProperties validation: Property 'authenticationScheme' must be set to '${l.OAUTH2}'in order to use either  an OAUTH2 access token or an OpenID Connect ID token.`);_("transportProtocol",[M,T,"TransportProtocol",!0]),_("webTransportProtocolList",[C,T,"TransportProtocol",!0,!1,!1]),function(J,se){if(se.length>0&&function(Te){return Te&&(Te===T.HTTP_BINARY_STREAMING||Te===T.HTTP_BINARY||Te===T.HTTP_BASE64)}(J)){const Te=se.length<=5?se:se.slice(0,5);throw new f(`SessionProperties validation: properties that are not supported by transport protocol ${J} have been set: ${Te}`,o.PARAMETER_OUT_OF_RANGE)}}(Y.transportProtocol,Y.nonHTTPTransportPropsSet),Y.publisherProperties&&r.MessagePublisherPropertiesValidator.validate(Y.publisherProperties);const A=Y.defaultConnectTimeoutInMsecs,z=Y.connectTimeoutInMsecs;(Y.webTransportProtocolList?Y.webTransportProtocolList.length:1)>1&&z<A&&g(`Connect timeout of ${z} msecs is less than default and recommended minimum of ${A} msecs for current transport selection. Transport downgrades may not complete.`)}};n.exports.SessionPropertiesValidator=F},2975:(n,I,e)=>{e(2545);const r=e(6780),{APIProperties:i}=e(7882),{AuthenticationScheme:t}=e(3278),{Check:c}=e(2201),{LOG_WARN:l}=e(390);e(5153);const u=class extends i{get transportProtocol(){return c.nothing(this._tpProtocol)?null:this._tpProtocol}set transportProtocol(o){this._tpProtocol=o}get transportDowngradeTimeoutInMsecs(){return c.nothing(this._tpDowngradeTimeout)?3e3:this._tpDowngradeTimeout}set transportDowngradeTimeoutInMsecs(o){this._tpDowngradeTimeout=o}get webTransportProtocolList(){return c.nothing(this._transportProtocolList)?null:this._transportProtocolList}set webTransportProtocolList(o){this._transportProtocolList=o}get bufferedAmountQueryIntervalInMsecs(){return c.nothing(this._bufferedAmountQueryInterval)?100:this._bufferedAmountQueryInterval}set bufferedAmountQueryIntervalInMsecs(o){this._bufferedAmountQueryInterval=o}get transportProtocolInUse(){return this._tpProtocolInUse||null}_setTransportProtocolInUse(o){this._tpProtocolInUse=o}get webTransportProtocolInUse(){return this._tpProtocolInUse||null}_setWebTransportProtocolInUse(o){this._tpProtocolInUse=o}get transportContentType(){return this._tpContentType||"text/plain"}set transportContentType(o){this._tpContentType=o}_lendsInspect(){return{bufferedAmountQueryIntervalInMsecs:this.bufferedAmountQueryIntervalInMsecs,transportContentType:this.transportContentType,transportDowngradeTimeoutInMsecs:this.transportDowngradeTimeoutInMsecs,transportProtocol:this.transportProtocol,transportProtocolInUse:this.transportProtocolInUse,webTransportProtocolList:this.webTransportProtocolList}}};n.exports.SessionProperties=class extends u{constructor(o){super(function(){const{MessagePublisherProperties:f}=r;return{_vpnNameInUse:"",_virtualRouterName:"",_p2pInboxInUse:"",_p2pInboxBase:"",_userIdentification:"",_tpProtocolInUse:null,_tpContentType:"text/plain",_publisherProperties:new f}}(),o)}get authenticationScheme(){return c.nothing(this._authScheme)?t.BASIC:this._authScheme}set authenticationScheme(o){this._authScheme=o}get accessToken(){return c.empty(this._accessToken)?"":this._accessToken}set accessToken(o){this._accessToken=o}get idToken(){return c.empty(this._idToken)?"":this._idToken}set idToken(o){this._idToken=o}get issuerIdentifier(){return c.empty(this._issuerIdentifier)?"":this._issuerIdentifier}set issuerIdentifier(o){c.type(o,"string")?c.empty(o)?l("Failed to set the issuer identifier because the passed string was empty or null. The passed issuer identifier must not be empty or null. Setting issuer identifier to default value empty string."):this._issuerIdentifier=o:(l("Failed to set issuer identifier because the pased value was not of type String. The passed issuer identifier must be of type String. Setting issuer identifier to default value empty string."),this._issuerIdentifier="")}get url(){return c.nothing(this._url)?"":this._url}set url(o){this._url=o}get password(){return c.nothing(this._password)?"":this._password}set password(o){this._password=o}get userName(){return c.nothing(this._userName)?"":this._userName}set userName(o){this._userName=o}get clientName(){return c.nothing(this._clientName)?"":this._clientName}set clientName(o){this._clientName=o}get applicationDescription(){return c.nothing(this._appDesc)?"":this._appDesc}set applicationDescription(o){this._appDesc=o}get vpnName(){return c.nothing(this._vpnName)?"":this._vpnName}set vpnName(o){this._vpnName=o}get vpnNameInUse(){return c.nothing(this._vpnNameInUse)?"":this._vpnNameInUse}_setVpnNameInUse(o){this._vpnNameInUse=o}get virtualRouterName(){return c.nothing(this._virtualRouterName)?"":this._virtualRouterName}_setVirtualRouterName(o){this._virtualRouterName=o}get connectTimeoutInMsecs(){return c.nothing(this._connectTimeout)?this.defaultConnectTimeoutInMsecs:this._connectTimeout}set connectTimeoutInMsecs(o){this._connectTimeout=o}get defaultConnectTimeoutInMsecs(){const{webTransportProtocolList:o,transportDowngradeTimeoutInMsecs:f}=this,g=o?o.length:1,h=g*f+(g>1?1e3:0);return Math.max(8e3,h)}get connectRetries(){return c.nothing(this._connectRetries)?20:this._connectRetries}set connectRetries(o){this._connectRetries=o}get connectRetriesPerHost(){return c.nothing(this._connectRetriesPerHost)?0:this._connectRetriesPerHost}set connectRetriesPerHost(o){this._connectRetriesPerHost=o}get reconnectRetryWaitInMsecs(){return c.nothing(this._reconnectRetryWaitInMsecs)?3e3:this._reconnectRetryWaitInMsecs}set reconnectRetryWaitInMsecs(o){this._reconnectRetryWaitInMsecs=o}get reconnectRetries(){return c.nothing(this._reconnectRetries)?20:this._reconnectRetries}set reconnectRetries(o){this._reconnectRetries=o}get generateSendTimestamps(){return!c.nothing(this._genSendTimestamps)&&this._genSendTimestamps}set generateSendTimestamps(o){this._genSendTimestamps=o}get generateReceiveTimestamps(){return!c.nothing(this._genReceiveTimestamps)&&this._genReceiveTimestamps}set generateReceiveTimestamps(o){this._genReceiveTimestamps=o}get includeSenderId(){return!c.nothing(this._includeSenderId)&&this._includeSenderId}set includeSenderId(o){this._includeSenderId=o}get generateSequenceNumber(){return!c.nothing(this._genSequenceNumber)&&this._genSequenceNumber}set generateSequenceNumber(o){this._genSequenceNumber=o}get keepAliveIntervalInMsecs(){return c.nothing(this._kaInterval)?3e3:this._kaInterval}set keepAliveIntervalInMsecs(o){this._kaInterval=o}get keepAliveIntervalsLimit(){return c.nothing(this._kaIntervalsLimit)?3:this._kaIntervalsLimit}set keepAliveIntervalsLimit(o){this._kaIntervalsLimit=o}get p2pInboxInUse(){return c.nothing(this._p2pInboxInUse)?"":this._p2pInboxInUse}_setP2pInboxInUse(o){this._p2pInboxInUse=o}get p2pInboxBase(){return c.nothing(this._p2pInboxBase)?"":this._p2pInboxBase}_setP2pInboxBase(o){this._p2pInboxBase=o}get userIdentification(){return c.nothing(this._userIdentification)?"":this._userIdentification}_setUserIdentification(o){this._userIdentification=o}get subscriberLocalPriority(){return c.nothing(this._subLocalPriority)?1:this._subLocalPriority}set subscriberLocalPriority(o){this._subLocalPriority=o}get subscriberNetworkPriority(){return c.nothing(this._subNetworkPriority)?1:this._subNetworkPriority}set subscriberNetworkPriority(o){this._subNetworkPriority=o}get ignoreDuplicateSubscriptionError(){return!!c.nothing(this._ignoreDupSubError)||this._ignoreDupSubError}set ignoreDuplicateSubscriptionError(o){this._ignoreDupSubError=o}get ignoreSubscriptionNotFoundError(){return!!c.nothing(this._ignoreSubNotFoundError)||this._ignoreSubNotFoundError}set ignoreSubscriptionNotFoundError(o){this._ignoreSubNotFoundError=o}get reapplySubscriptions(){return!c.nothing(this._reapplySubcriptions)&&this._reapplySubcriptions}set reapplySubscriptions(o){this._reapplySubcriptions=o}get publisherProperties(){return this._publisherProperties}set publisherProperties(o){const{MessagePublisherProperties:f}=r;this._publisherProperties=o instanceof f?o:new f(o)}get noLocal(){return!c.nothing(this._noLocal)&&this._noLocal}set noLocal(o){this._noLocal=o}get readTimeoutInMsecs(){return c.nothing(this._readTimeout)?1e4:this._readTimeout}set readTimeoutInMsecs(o){this._readTimeout=o}get sendBufferMaxSize(){return c.nothing(this._sendBufferMaxSize)?65536:this._sendBufferMaxSize}set sendBufferMaxSize(o){this._sendBufferMaxSize=o}get assumedMaxAdSize(){return c.nothing(this._assumedMaxAdSize)?3e7:this._assumedMaxAdSize}set assumedMaxAdSize(o){this._assumedMaxAdSize=o}get maxWebPayload(){return c.nothing(this._maxWebPayload)?1048576:this._maxWebPayload}set maxWebPayload(o){this._maxWebPayload=o}get nonHTTPTransportPropsSet(){return[].filter(o=>c.something(this[o]))}inspect(){return Object.assign(this._lendsInspect(),{authenticationScheme:t.describe(this.authenticationScheme),accessToken:this.accessToken?"*****":"Not Set",idToken:this.idToken?"*****":"Not Set",issuerIdentifier:this.issuerIdentifier?"*****":"Not Set",url:this.url,password:this.password?"*****":this.password,userName:this.userName,clientName:this.clientName,applicationDescription:this.applicationDescription,vpnName:this.vpnName,vpnNameInUse:this.vpnNameInUse,virtualRouterName:this.virtualRouterName,connectTimeoutInMsecs:this.connectTimeoutInMsecs,connectRetries:this.connectRetries,connectRetriesPerHost:this.connectRetriesPerHost,reconnectRetryWaitInMsecs:this.reconnectRetryWaitInMsecs,reconnectRetries:this.reconnectRetries,generateSendTimestamps:this.generateSendTimestamps,generateReceiveTimestamps:this.generateReceiveTimestamps,includeSenderId:this.includeSenderId,generateSequenceNumber:this.generateSequenceNumber,keepAliveIntervalInMsecs:this.keepAliveIntervalInMsecs,keepAliveIntervalsLimit:this.keepAliveIntervalsLimit,p2pInboxInUse:this.p2pInboxInUse,p2pInboxBase:this.p2pInboxBase,userIdentification:this.userIdentification,subscriberLocalPriority:this.subscriberLocalPriority,subscriberNetworkPriority:this.subscriberNetworkPriority,ignoreDuplicateSubscriptionError:this.ignoreDuplicateSubscriptionError,reapplySubscriptions:this.reapplySubscriptions,publisherProperties:this.publisherProperties,noLocal:this.noLocal,readTimeoutInMsecs:this.readTimeoutInMsecs,sendBufferMaxSize:this.sendBufferMaxSize,maxWebPayload:this.maxWebPayload})}toString(){return super.toString()}}},9988:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionRequestType=r.new({ADD_SUBSCRIPTION:0,REMOVE_SUBSCRIPTION:1,ADD_P2PINBOX:2,REMOVE_P2PINBOX:3,REMOVE_DTE_SUBSCRIPTION:100})},156:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionStateName=r.new({DISCONNECTED:"SessionDisconnected",CONNECTING:"SessionConnecting",WAITING_FOR_TRANSPORT:"WaitingForTransport",WAITING_FOR_TRANSPORT_UP:"WaitingForTransportUp",WAITING_FOR_LOGIN:"WaitingForLogin",TRANSPORT_UP:"SessionTransportUp",FULLY_CONNECTED:"SessionFullyConnected",SESSION_ERROR:"SessionError",DISCONNECTING:"SessionDisconnecting",REAPPLYING_SUBSCRIPTIONS:"ReapplyingSubscriptions",WAITING_FOR_PUBFLOW:"WaitingForMessagePublisher",DISPOSED:"SessionDisposed",WAITING_FOR_SUBCONFIRM:"WaitForSubConfirm",WAITING_FOR_CAN_ACCEPT_DATA:"WaitForCanAcceptData",DISCONNECTING_FLOWS:"DisconnectingFlows",FLUSHING_TRANSPORT:"FlushingTransport",DESTROYING_TRANSPORT:"DestroyingTransport",RECONNECTING:"Reconnecting",TRANSPORT_FAIL:"TransportFail",WAITING_FOR_INTERCONNECT_TIMEOUT:"WaitingForInterconnectTimeout",WAITING_FOR_DNS:"WaitingForDNS",WAITING_FOR_TRANSPORT_CHANGE:"WaitingForTransportChange"})},109:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SessionState=r.new({CONNECTING:1,CONNECTED:2,SESSION_ERROR:3,DISCONNECTING:4,DISCONNECTED:5})},3401:(n,I,e)=>{var r=e(9489);const i=e(3170),t=e(4789),c=e(828),{assert:l}=e(9359),{CacheSession:u,CACHE_REQUEST_PREFIX:o}=e(1843),{CapabilityType:f}=e(2753),{Check:g,Parameter:h}=e(2201),{DefaultCapabilities:T}=e(1188),{ErrorResponseSubcodeMapper:S,ErrorSubcode:C,OperationError:p,RequestEventCode:R}=e(3870),{EventEmitter:N}=e(7758),{GlobalContext:w}=e(8484),{HostList:y}=e(1113),{LogFormatter:P}=e(390),{MessageRxCBInfo:x}=e(806),{MutableSessionProperty:B}=e(8075),{OutstandingDataRequest:H}=e(2779),{P2PUtil:L}=e(4876),{QueueDescriptor:M,QueueType:G}=e(5754),{SDTField:K,SDTFieldType:F}=e(7252),{SessionEvent:Y}=e(5874),{SessionEventCBInfo:_}=e(3397),{SessionEventCode:U}=e(5332),{SessionEventName:A}=e(2495),{SessionFSM:z}=e(8837),{SessionFSMEvent:J}=e(9191),{SessionOperation:se}=e(413),{SessionProperties:Te}=e(2975),{SessionPropertiesValidator:pe}=e(928),{SessionRequestType:ne}=e(9988),{SessionState:oe}=e(109),{SessionStateName:de}=e(156),{Stats:_e,StatType:b}=e(6818),{StringUtils:X}=e(7882),{TransportCapabilities:ae,TransportProtocol:ie,TransportReturnCode:q}=e(3147);function Pe(Z){return Z&&Z!==ie.HTTP_BINARY_STREAMING&&Z!==ie.HTTP_BINARY&&Z!==ie.HTTP_BASE64}function ve(Z){return`SessionEventCode.${U.describe(Z)}`}const Qe="#REQ";n.exports.Session=class extends N{constructor(Z,ee,ge){super({emits:U.values,direct:U.MESSAGE,formatEventName:ve});const d=this;this.logger=new P,this.logger.formatter=function(...D){return[`[session=${d._sessionFSM?d._sessionFSM.sessionIdHex:"(N/A)"}]`,...D]},this.logger,Z!=null&&this.logger,this.on("error",D=>{const{LOG_ERROR:Q}=d.logger;Q(D.info.error)});const O=new Te(Z);if(this.logger,this._messageCallbackInfo=this.wrapMessageCallback(ee),this._eventCallbackInfo=this.wrapEventCallback(ge),g.empty(O.clientName)&&(O.clientName=w.GenerateClientName()),O._setUserIdentification(w.GenerateUserIdentification()),g.empty(O.applicationDescription)&&(O.applicationDescription=w.GenerateClientDescription()),pe.validate(O),g.nothing(O.webTransportProtocolList)){const D=O.transportProtocol,Q=function(){const{ProfileBinding:me}=c,Ee=[];return ae.web.webSocket()&&Ee.push(ie.WS_BINARY),me.value.cometEnabled&&(ae.web.xhrBinary()&&(ae.web.streaming()&&Ee.push(ie.HTTP_BINARY_STREAMING),Ee.push(ie.HTTP_BINARY)),Ee.push(ie.HTTP_BASE64)),Ee}(),re=D?Q.indexOf(D):0;if(re<0)throw new p(`Selected transport protocol ${ie.describe(D)} is disabled or invalid for this platform`,C.PARAMETER_CONFLICT);if(O.webTransportProtocolList=Q.slice(re),O.webTransportProtocolList.length===0)throw new p(`No usable transport protocol or fallback from ${ie.describe(D)}`,C.PARAMETER_CONFLICT);const ce=O.webTransportProtocolList.filter(me=>Pe(me));if(ce.length===0&&(this._adDisabledReason=`Guaranteed messaging not compatible with any available transport protocol: ${O.webTransportProtocolList.map(me=>ie.describe(me)).join(", ")}`),O.publisherProperties.enabled){if(this._adDisabledReason)throw new p("Invalid transport protocol(s) for session with Guaranteed Messaging Publisher",C.PARAMETER_CONFLICT,this._adDisabledReason);O.webTransportProtocolList=ce}}else{const D=O.webTransportProtocolList;if(!D.every(Pe)){const Q=D.filter(re=>!Pe(re));if(this._adDisabledReason=`Guaranteed messaging incompatible with selected transport protocols: ${Q.map(re=>ie.describe(re)).join(", ")}`,O.publisherProperties.enabled)throw new p("Invalid transport protocol(s) for session with Guaranteed Messaging Publisher",C.PARAMETER_CONFLICT,this._adDisabledReason)}}this._sessionProperties=O,this._sessionStats=new _e,this._hosts=new y(O),this._sessionFSM=new z(this._sessionProperties,this,this._sessionStats,this._hosts),this._sessionFSM.start(),this._sessionFSM.createMessagePublisher(),this._outstandingDataReqs={},this._capabilities=T.createDefaultCapabilities(O),this._seqNum=1}connect(){this.logger;const Z=this.allowOperation(se.CONNECT);if(Z)throw new p(Z,C.INVALID_OPERATION,null);const ee=new J({name:A.CONNECT});this._sessionFSM.processEvent(ee)}get canAck(){return[de.CONNECTING,de.TRANSPORT_UP,de.DISCONNECTING].some(Z=>!!this._sessionFSM.getActiveState(Z))}disconnect(){this.logger;const Z=this.allowOperation(se.DISCONNECT);if(Z)throw new p(Z,C.INVALID_OPERATION,null);const ee=new J({name:A.DISCONNECT});this._sessionFSM.processEvent(ee)}dispose(){this.logger,this._disposed||setTimeout(()=>{this._sessionFSM.processEvent(new J({name:A.DISPOSE})),this._sessionFSM.terminateFsm(),this.disableEmitter(),this._disposed=!0},0)}subscribe(Z,ee,ge,d){this.logger,Z&&Z.toString&&Z.toString();const O=this.allowOperation(se.CTRL);if(O)throw new p(O,C.INVALID_OPERATION,null);if(h.isInstanceOf("topic",Z,i.Destination),Z.validate(),Z.getType()!==i.DestinationType.TOPIC)throw new p(`Topic is required for subscribe; ${i.DestinationType.describe(Z.getType())}`,C.INVALID_TOPIC_SYNTAX);h.isBooleanOrNothing("requestConfirmation",ee),h.isNumberOrNothing("requestTimeout",d),h.isRangeCompareOrNothing("requestTimeout",d,">",0),this._sessionFSM.subscriptionUpdate(Z,!!ee,ge,d,ne.ADD_SUBSCRIPTION,(D,Q)=>this.handleSubscriptionUpdateResponse(D,Q,ee))}updateQueueSubscription(Z,ee,ge,d,O,D){this.logger,Z&&Z.toString&&Z.toString(),ee&&ee.toString&&ee.toString();const Q=this.allowOperation(se.CTRL);if(Q)throw new p(Q,C.INVALID_OPERATION,null);if(h.isInstanceOf("topic",Z,i.Destination),Z.validate(),Z.getType()!==i.DestinationType.TOPIC)throw new p(`Topic is required for queue subscribe; ${i.DestinationType.describe(Z.getType())}`,C.INVALID_TOPIC_SYNTAX);if(h.isInstanceOf("queue",ee,i.Destination),ee.validate(),ee.getType()!==i.DestinationType.QUEUE&&ee.getType()!==i.DestinationType.TEMPORARY_QUEUE)throw new p(`Queue is required for queue subscribe; ${i.DestinationType.describe(ee.getType())}`,C.PARAMETER_INVALID_TYPE);h.isNumberOrNothing("requestTimeout",D),h.isRangeCompareOrNothing("requestTimeout",D,">",0),this._sessionFSM.queueSubscriptionUpdate(Z,ee,D,ge,(re,ce)=>this.handleQueueSubscriptionUpdateResponse(re,ce,O))}unsubscribe(Z,ee,ge,d){this.logger,Z&&Z.toString&&Z.toString();const O=this.allowOperation(se.CTRL);if(O)throw new p(O,C.INVALID_OPERATION,null);if(h.isInstanceOf("topic",Z,i.Destination),Z.validate(),Z.getType()!==i.DestinationType.TOPIC)throw new p(`Topic is required for unsubscribe; ${i.DestinationType.describe(Z.getType())}`,C.INVALID_TOPIC_SYNTAX);h.isBooleanOrNothing("requestConfirmation",ee),h.isNumberOrNothing("requestTimeout",d),h.isRangeCompareOrNothing("requestTimeout",d,">",0),this._sessionFSM.subscriptionUpdate(Z,!!ee,ge,d,ne.REMOVE_SUBSCRIPTION,(D,Q)=>this.handleSubscriptionUpdateResponse(D,Q,ee))}unsubscribeDurableTopicEndpoint(Z){this.logger,Z&&Z.toString&&Z.toString();const ee=this.allowOperation(se.CTRL);if(ee)throw new p(ee,C.INVALID_OPERATION,null);const ge=this.createDestinationFromDescriptor(M.createFromSpec(Z));this._sessionFSM.subscriptionUpdate(ge,!0,void 0,void 0,ne.REMOVE_DTE_SUBSCRIPTION,(d,O)=>this.handleDTEUnsubscribeResponse(d,O))}updateProperty(Z,ee,ge,d){this.logger;const O=this.allowOperation(se.CTRL);if(O)throw new p(O,C.INVALID_OPERATION,null);const{Topic:D}=i;let Q;h.isEnumMember("mutableSessionProperty",Z,B),h.isNumberOrNothing("requestTimeout",ge),h.isRangeCompareOrNothing("requestTimeout",ge,">",0);const re=this._sessionFSM.sendUpdateProperty(Z,ee,d,ge,ce=>{const me=ce.getResponse();if(me.responseCode===200){if(Z===B.CLIENT_DESCRIPTION)this._sessionProperties.applicationDescription=ee,Q=Y.build(U.PROPERTY_UPDATE_OK,me.responseString,me.responseCode,0,d,null),this.sendEvent(Q);else if(Z===B.CLIENT_NAME){const Ee=L.getP2PTopicSubscription(this._sessionProperties.p2pInboxBase),Ce=D.createFromName(Ee),Me=L.getP2PTopicSubscription(ce.getP2PTopicValue()),Be=D.createFromName(Me),He=xt=>{const gt=xt.getResponse();if(gt.responseCode===200)this._sessionProperties._setP2pInboxBase(ce.getP2PTopicValue()||""),this._sessionProperties._setP2pInboxInUse(L.getP2PInboxTopic(this._sessionProperties.p2pInboxBase)),this._sessionProperties.clientName=ee,Q=Y.build(U.PROPERTY_UPDATE_OK,gt.responseString,gt.responseCode,0,d,null),this.sendEvent(Q);else{const Ae=S.getErrorSubcode(gt.responseCode,gt.responseString);Ae===C.SUBSCRIPTION_ALREADY_PRESENT&&this._sessionProperties.ignoreDuplicateSubscriptionError?(Q=Y.build(U.PROPERTY_UPDATE_OK,gt.responseString,gt.responseCode,0,d,null),this.sendEvent(Q)):Ae===C.SUBSCRIPTION_ALREADY_PRESENT||Ae===C.SUBSCRIPTION_ATTRIBUTES_CONFLICT||Ae===C.SUBSCRIPTION_INVALID||Ae===C.SUBSCRIPTION_ACL_DENIED||Ae===C.SUBSCRIPTION_TOO_MANY?(Q=Y.build(U.PROPERTY_UPDATE_ERROR,gt.responseString,gt.responseCode,Ae,d,null),this.sendEvent(Q)):(Q=Y.build(U.PROPERTY_UPDATE_ERROR,gt.responseString,gt.responseCode,C.SUBSCRIPTION_ERROR_OTHER,d,null),this.sendEvent(Q))}},Ot=xt=>{const gt=xt.getResponse();if(gt.responseCode===200)this._sessionFSM.subscriptionUpdate(Be,!0,d,this._sessionProperties.readTimeoutInMsecs,ne.ADD_P2PINBOX,He);else{const Ae=S.getErrorSubcode(gt.responseCode,gt.responseString);Ae===C.SUBSCRIPTION_NOT_FOUND&&this._sessionProperties.ignoreSubscriptionNotFoundError?this._sessionFSM.subscriptionUpdate(Be,!0,d,this._sessionProperties.readTimeoutInMsecs,ne.ADD_P2PINBOX,He):Ae===C.SUBSCRIPTION_ATTRIBUTES_CONFLICT||Ae===C.SUBSCRIPTION_INVALID||Ae===C.SUBSCRIPTION_NOT_FOUND||Ae===C.SUBSCRIPTION_ACL_DENIED?(Q=Y.build(U.PROPERTY_UPDATE_ERROR,gt.responseString,gt.responseCode,Ae,null,null),this.sendEvent(Q)):(Q=Y.build(U.PROPERTY_UPDATE_ERROR,gt.responseString,gt.responseCode,C.SUBSCRIPTION_ERROR_OTHER,null,null),this.sendEvent(Q))}};this._sessionFSM.subscriptionUpdate(Ce,!0,d,this._sessionProperties.readTimeoutInMsecs,ne.REMOVE_P2PINBOX,Ot)}}else{const Ee=S.getErrorSubcode(me.responseCode,me.responseString);Q=Y.build(U.PROPERTY_UPDATE_ERROR,me.responseString,me.responseCode,Ee,d,null),this.sendEvent(Q)}});re!==q.OK&&(Q=re===q.NO_SPACE?Y.build(U.PROPERTY_UPDATE_ERROR,"Property update failed - no space in transport",null,C.INSUFFICIENT_SPACE,null,null):Y.build(U.PROPERTY_UPDATE_ERROR,"Property update failed",null,C.INVALID_OPERATION,null,null),this.sendEvent(Q))}updateAuthenticationOnReconnect(Z){this.logger;const ee=["accessToken","idToken"],ge=this.allowOperation(se.QUERY_OPERATION);if(ge)throw new p(ge,C.INVALID_OPERATION,null);if(!Z||typeof Z!="object")throw new p("updateAuthenticationOnReconnect parameter must be a non-empty object.",C.PARAMETER_INVALID_TYPE,null);var d;for(d in Z)if(!ee.includes(d))throw new p("Invalid property in updateAuthenticationOnReconnect parameter.",C.PARAMETER_CONFLICT,null);const O=this.getSessionProperties();Object.assign(O,Z),pe.validate(O),this._sessionProperties=O,Object.assign(this._sessionFSM._sessionProperties,Z)}send(Z){this.logger;const ee=this.allowOperation(se.SEND,Z);if(ee)throw new p(ee,C.INVALID_OPERATION,null);h.isInstanceOf("message",Z,t.Message),this.validateAndSendMessage(Z)}sendRequest(Z,ee,ge,d,O){this.logger;const D=this.allowOperation(se.SEND,Z);if(D)throw new p(D,C.INVALID_OPERATION,null);if(h.isInstanceOf("message",Z,t.Message),h.isNumberOrNothing("timeout",ee),h.isRangeCompareOrNothing("timeout",ee,">=",100),h.isFunctionOrNothing("replyReceivedCBFunction",ge),h.isFunctionOrNothing("requestFailedCBFunction",d),Z.getCorrelationId()==null&&Z.setCorrelationId(Qe+w.NextId()),Z.getReplyTo()==null){const Q=i.Topic.createFromName(this._sessionProperties.p2pInboxInUse);Z.setReplyTo(Q)}this.validateAndSendMessage(Z),this.enqueueOutstandingDataReq(Z.getCorrelationId(),d,ee,ge,O)}sendReply(Z,ee){this.logger;const ge=this.allowOperation(se.SEND,ee);if(ge)throw new p(ge,C.INVALID_OPERATION,null);if(h.isInstanceOfOrNothing("messageToReplyTo",Z,t.Message),h.isInstanceOf("replyMessage",ee,t.Message),ee.setAsReplyMessage(!0),Z){if(ee.setCorrelationId(Z.getCorrelationId()),Z.getReplyTo()==null)throw new p("ReplyTo destination may not be null.",C.PARAMETER_OUT_OF_RANGE);ee.setDestination(Z.getReplyTo())}this.validateAndSendMessage(ee)}getStat(Z){this.logger;const ee=this.allowOperation(se.QUERY_OPERATION);if(ee)throw new p(ee,C.INVALID_OPERATION,null);return h.isEnumMember("statType",Z,b),this._sessionFSM.getStat(Z)}resetStats(){this.logger;const Z=this.allowOperation(se.QUERY_OPERATION);if(Z)throw new p(Z,C.INVALID_OPERATION,null);this._sessionFSM.resetStats()}getSessionProperties(){this.logger;const Z=this.allowOperation(se.QUERY_OPERATION);if(Z)throw new p(Z,C.INVALID_OPERATION,null);const ee=this._sessionProperties.clone();return this.getSessionState()!==de.DISCONNECTED&&this._sessionFSM._transport&&ee._setWebTransportProtocolInUse(this._sessionFSM._transport.getTransportProtocol()),ee}isCapable(Z){this.logger;const ee=this.allowOperation(se.QUERY_OPERATION);if(ee)throw new p(ee,C.INVALID_OPERATION,null);h.isNumber("capabilityType",Z);const ge=this._capabilities;return!!ge&&typeof ge[Z]=="boolean"&&ge[Z]}getCapability(Z){this.logger;const ee=this.allowOperation(se.QUERY_OPERATION);if(ee)throw new p(ee,C.INVALID_OPERATION,null);h.isNumber("capabilityType",Z);const ge=this._getCapability(Z);return typeof ge=="boolean"?K.create(F.BOOL,ge):typeof ge=="number"?K.create(F.INT64,ge):typeof ge=="string"?K.create(F.STRING,ge):null}_getCapability(Z){const ee=this._capabilities;if(!ee)return null;const ge=ee[Z];return ge===void 0?null:ge}getSessionState(){this.logger;const Z=this.allowOperation(se.QUERY_OPERATION);if(Z)throw new p(Z,C.INVALID_OPERATION,null);const ee=this.getFSMState();switch(ee){case de.FULLY_CONNECTED:return oe.CONNECTED;case de.DISCONNECTING:return oe.DISCONNECTING;case de.DISCONNECTED:return oe.DISCONNECTED;case de.SESSION_ERROR:return oe.SESSION_ERROR;case de.CONNECTING:case de.WAITING_FOR_INTERCONNECT_TIMEOUT:case de.WAITING_FOR_DNS:case de.WAITING_FOR_TRANSPORT_UP:case de.WAITING_FOR_SESSION_UP:case de.WAITING_FOR_LOGIN:case de.WAITING_FOR_P2PINBOX_REG:case de.WAITING_FOR_PUBFLOW:case de.REAPPLYING_SUBSCRIPTIONS:return oe.CONNECTING;default:{const{LOG_INFO:ge}=this.logger;return ge(`Unmapped session state ${de.describe(ee)}`),null}}}getFSMState(){return this._sessionFSM.getCurrentStateName()}createCacheSession(Z){return this.logger,new u(Z,this,{incStat:this._sessionFSM.incStat.bind(this._sessionFSM)})}createMessageConsumer(Z){if(this.logger,this._adDisabledReason)throw new p("Session does not provide MessageConsumer capability",C.GM_UNAVAILABLE,this._adDisabledReason);return Z!=null&&this.logger,this._sessionFSM.createMessageConsumer(Z)}createQueueBrowser(Z){if(this.logger,this._adDisabledReason)throw new p("Session does not provide QueueBrowser capability",C.GM_UNAVAILABLE,this._adDisabledReason);return Z!=null&&this.logger,this._sessionFSM.createQueueBrowser(Z)}createDestinationFromDescriptor(Z){const{DestinationType:ee,Queue:ge,Topic:d}=i;let O=ee.TOPIC;Z.type===G.QUEUE&&(O=Z.durable?ee.QUEUE:ee.TEMPORARY_QUEUE);const D=Z.name||null;return Z.durable?(l(D,"Durable endpoint with generated name is not a valid configuration"),(Z.getType()===G.QUEUE?ge.createFromLocalName:d.createFromName)(D)):this.createTemporaryDestination(O,D)}createTemporaryDestination(Z,ee){this.logger;const{DestinationFromNetwork:ge,DestinationUtil:d}=i,O=this.getSessionProperties().virtualRouterName;if(!this.isCapable(f.TEMPORARY_ENDPOINT)||O==null||O.length===0)throw new p("Attempt to generate temporary destination or endpoint without suitable session",C.INVALID_OPERATION);const D=ee&&ee.startsWith("#P2P")?ee:d.createTemporaryName(Z,O,ee);return ge.createDestinationFromName(D)}sendEvent(Z){Z&&(this._disposed||(this.logger,this._eventCallbackInfo.sessionEventCBFunction(this,Z,this._eventCallbackInfo.userObject)))}getTransportInfo(){return this.logger,this._sessionFSM.getTransportInfo()}injectTransportInterceptor(Z){this._sessionFSM.injectTransportInterceptor(Z)}allowOperation(Z,ee){if(!this._sessionFSM)return!1;let ge=!0;const d=this._sessionFSM.getCurrentStateName();if(d===de.DISPOSED)ge=!1;else if(g.anything(Z))switch(Z){case se.CONNECT:d!==de.NEW&&d!==de.DISCONNECTED&&(ge=!1);break;case se.DISCONNECT:d===de.NEW&&(ge=!1);break;case se.SEND:case se.CTRL:ge=d===de.FULLY_CONNECTED||ee&&ee.getDeliveryMode()!==t.MessageDeliveryModeType.DIRECT;break;case se.QUERY_OPERATION:ge=!0;break;default:ge=!1}else ge=!1;return ge?null:`Cannot perform operation ${Z} while in state ${d}`}updateCapabilities(Z){this._capabilities=Z}validateAndSendMessage(Z){const ee=Z.getDestination();if(g.nothing(ee)||g.empty(ee.getName()))throw new p("Message must have a valid Destination",C.TOPIC_MISSING);const ge=Z.getSenderTimestamp()==null;if(this._sessionProperties.generateSendTimestamps&&(ge||Z.hasAutoSenderTimestamp)){const D=new Date;Z.setSenderTimestamp(D.getTime()),Z.hasAutoSenderTimestamp=!0}const d=Z.getSequenceNumber()==null;this._sessionProperties.generateSequenceNumber&&(d||Z.hasAutoSequenceNumber)&&(Z.setSequenceNumber(this._seqNum++),Z.hasAutoSequenceNumber=!0);const O=Z.getSenderId()==null;this._sessionProperties.includeSenderId&&O&&Z.setSenderId(this._sessionProperties.clientName),this._sessionFSM.prepareAndSendMessage(Z)}enqueueOutstandingDataReq(Z,ee,ge,d,O){if(g.none(Z))return;const{LOG_TRACE:D,LOG_ERROR:Q}=this.logger,re=setTimeout(()=>{this._sessionFSM.incStat(b.TX_REQUEST_TIMEOUT);try{delete this._outstandingDataReqs[Z]||Q(`Cannot delete data request ${Z}`)}catch(me){Q(`Cannot delete data request ${Z}`,me)}if(g.anything(ee)){const me=Y.build(R.REQUEST_TIMEOUT,"Request timeout",Z);ee(this,me,O)}},ge||this._sessionProperties.readTimeoutInMsecs),ce=new H(Z,re,d,ee,O);this._outstandingDataReqs[Z]=ce}cancelOutstandingDataReq(Z){const{LOG_TRACE:ee,LOG_ERROR:ge}=this.logger;if(g.none(Z)||!this._outstandingDataReqs)return null;const d=this._outstandingDataReqs[Z];if(d==null)return null;d.timer&&(clearTimeout(d.timer),d.timer=null);try{delete this._outstandingDataReqs[Z]||ge(`Cannot delete data request ${Z}`)}catch(O){ge(`Cannot delete data request ${Z}`,O)}return d}cleanupSession(){this.logger,this._outstandingDataReqs&&Object.keys(this._outstandingDataReqs).forEach(Z=>{const ee=this.cancelOutstandingDataReq(Z);if(ee&&ee.reqFailedCBFunction){const ge=Y.build(R.REQUEST_ABORTED,"Request aborted",Z);ee.reqFailedCBFunction(this,ge,ee.userObject)}})}handleDataMessage(Z){const{LOG_TRACE:ee,LOG_INFO:ge}=this.logger,d=Z;if(this._sessionProperties.generateReceiveTimestamps){const O=new Date;d._receiverTimestamp=O.getTime()}if(d.isReplyMessage()){const O=d.getCorrelationId();if(g.anything(O)){const D=this.cancelOutstandingDataReq(O);if(D!==null)return this._sessionFSM.incStat(b.RX_REPLY_MSG_RECVED),void D.replyReceivedCBFunction(this,d,D.userObject);if(O.startsWith(Qe))return ge("DROP: Discard reply message due to missing outstanding request"),void this._sessionFSM.incStat(b.RX_REPLY_MSG_DISCARD);if(O.startsWith(o)&&!(u&&this._messageCallbackInfo.userObject instanceof u))return ge("DROP: Discard cache reply due to no cache session active"),void this._sessionFSM.incStat(b.RX_REPLY_MSG_DISCARD)}}this._messageCallbackInfo.messageRxCBFunction(this,d,this._messageCallbackInfo.userObject)}handleSubscriptionUpdateResponse(Z,ee,ge){const d=Z.getResponse(),{responseCode:O,responseString:D}=d,{correlationKey:Q}=ee;if(O===200){const re=Y.build(U.SUBSCRIPTION_OK,D,O,0,Q,null);this.sendEvent(re)}else{const re=X.stripNullTerminate(Z.encodedUtf8Subscription);this._sessionFSM.handleSubscriptionUpdateError(O,D,re,Q,ge)}}handleQueueSubscriptionUpdateResponse(Z,ee,ge){if(this.logger,!Z)return void ge(!1,C.TIMEOUT,0,"Timeout");const d=Z.getResponse(),{responseCode:O,responseString:D}=d,Q=S.getADErrorSubcode(O,D);O===200||Q===C.SUBSCRIPTION_ALREADY_PRESENT||Q===C.SUBSCRIPTION_NOT_FOUND?ge(!0,0,O,D):ge(!1,Q,O,D)}handleDTEUnsubscribeResponse(Z,ee){const ge=Z.getResponse(),{responseCode:d,responseString:O}=ge,{correlationKey:D}=ee,Q=d===200?U.UNSUBSCRIBE_TE_TOPIC_OK:U.UNSUBSCRIBE_TE_TOPIC_ERROR,re=d===200?0:S.getADErrorSubcode(d,O);this.sendEvent(Y.build(Q,O,d,re,D))}handleSubscriptionUpdateError(Z,ee,ge,d,O){const D=S.getErrorSubcode(Z,ee);if(D===C.SUBSCRIPTION_ALREADY_PRESENT&&this._sessionProperties.ignoreDuplicateSubscriptionError||D===C.SUBSCRIPTION_NOT_FOUND&&this._sessionProperties.ignoreSubscriptionNotFoundError){if(O){const Q=Y.build(U.SUBSCRIPTION_OK,ee,Z,0,d,null);this.sendEvent(Q)}}else{const Q=Y.build(U.SUBSCRIPTION_ERROR,ee,Z,D,d,`Topic: ${ge}`);this.sendEvent(Q)}}getEventCBInfo(){return this._eventCallbackInfo}setEventCBInfo(Z){this._eventCallbackInfo=Z}getMessageCBInfo(){return this._messageCallbackInfo}setMessageCBInfo(Z){this._messageCallbackInfo=Z}getCorrelationTag(){return this._sessionFSM.getCorrelationTag()}wrapEventCallback(Z){const{LOG_WARN:ee}=this.logger,ge=Z?Z.sessionEventCBFunction?Z:new _(Z):null;return new _((d,O,D,Q)=>{const{sessionEventCode:re}=O;if(ge)try{ge.sessionEventCBFunction(d,O,D,Q)}catch(ce){const me=Object.assign(new p(`Unhandled error in SessionEventRxCBInfo callback on sessionEventCode ${U.describe(re)}`,C.CALLBACK_ERROR,`On event: ${[re,O,D,Q]} ${ce}`),{stack:ce.stack,info:{event:{name:re,formattedName:`SessionEventCode.${U.describe(re)}`,args:[O,D,Q]},error:ce}});ee(me.toString(),me.info)}this.emit(re,O)})}wrapMessageCallback(Z){const{LOG_WARN:ee}=this.logger,ge=Z?Z.messageRxCBFunction?Z:new x(Z):null,d=`SessionEventCode.${U.describe(U.MESSAGE)}`,O=(D,Q,re)=>Object.assign(new p(`Unhandled error in MessageRxCBInfo callback/handler for ${d}`,C.CALLBACK_ERROR),{stack:D.stack,info:{event:{name:U.MESSAGE,formattedName:d,args:[Q,re]},error:D}});return new x((D,Q,re)=>{if(ge)try{ge.messageRxCBFunction(D,Q,re)}catch(ce){const me=O(ce,Q,re).toString();ee(me,me.info,ce)}try{this.emitDirect(Q)}catch(ce){this.emit("error",O(ce,Q,re))}})}get adLocallyDisabled(){return!!this._adDisabledReason}get canConnectConsumer(){return!this.adLocallyDisabled&&(this._capabilities?this.isCapable(f.GUARANTEED_MESSAGE_CONSUME):void 0)}get canConnectPublisher(){return!this.adLocallyDisabled&&(this._capabilities?this.isCapable(f.GUARANTEED_MESSAGE_PUBLISH):void 0)}get disposed(){return this._disposed}inspect(){return{sessionId:this._sessionFSM&&this._sessionFSM.sessionIdHex||"(N/A)",transport:this.getTransportInfo(),state:oe.describe(this.getSessionState())}}toString(){return r(this)}}},5153:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SslDowngrade=r.new({NONE:"NONE",PLAINTEXT:"PLAIN_TEXT"})},1726:(n,I,e)=>{const{SessionRequestType:r}=e(9988);n.exports={SubscriptionUpdateTimeoutMessages:{[r.ADD_SUBSCRIPTION]:"Add subscription request timeout",[r.REMOVE_SUBSCRIPTION]:"Remove subscription request timeout",[r.ADD_P2PINBOX]:"Add P2P inbox subscription timeout",[r.REMOVE_P2PINBOX]:"Remove P2P inbox subscription timeout",[r.REMOVE_DTE_SUBSCRIPTION]:"Remove endpoint topic subscription",default:"Request timeout"}}},7291:(n,I,e)=>{const r=e(7283),{AdProtocolMessage:i,BinaryMetaBlock:t,ClientCtrlMessage:c,KeepAliveMessage:l,SMPMessage:u}=e(2981),{SMFAdProtocolMessageType:o}=e(948),{SMFAdProtocolParam:f}=e(4786),{SMFClientCtrlMessageType:g}=e(9947),{SMFClientCtrlParam:h}=e(1200),{SMFParameterType:T,SMFExtendedParameterType:S}=e(2095),{SMFProtocol:C}=e(8958),{SMFSMPMessageType:p}=e(6874),{SMFSMPMessageTypeFlags:R}=e(8488),{SMFTransportSessionMessageType:N}=e(5752);n.exports.AdProtocolMessage=i,n.exports.BinaryMetaBlock=t,n.exports.ClientCtrlMessage=c,n.exports.Codec=r,n.exports.KeepAliveMessage=l,n.exports.SMFAdProtocolMessageType=o,n.exports.SMFAdProtocolParam=f,n.exports.SMFClientCtrlMessageType=g,n.exports.SMFClientCtrlParam=h,n.exports.SMFParameterType=T,n.exports.SMFProtocol=C,n.exports.SMFSMPMessageTypeFlags=R,n.exports.SMFSMPMessageType=p,n.exports.SMFTransportSessionMessageType=N,n.exports.SMPMessage=u,n.exports.SMFExtendedParameterType=S},2228:(n,I,e)=>{const r=e(7291),{AdProtocolMessage:i,SMFParameter:t}=e(2981),{Bits:c,Convert:l}=e(840),{LOG_DEBUG:u,LOG_INFO:o,LOG_ERROR:f}=e(390),{ReplayStartType:g}=e(2604),{get:h,set:T}=c,{int8ToStr:S,int16ToStr:C,int24ToStr:p,int32ToStr:R}=l;function N(G,K){const F=[];let Y=0;return Y=c.set(Y,G,6,2),Y=c.set(Y,K,0,6),F.push(l.int8ToStr(Y)),F.push(l.int8ToStr(2)),F.join("")}function w(G,K,F){const Y=[];let _=0;return _=c.set(_,G,6,2),_=c.set(_,K,0,6),Y.push(l.int8ToStr(_)),Y.push(l.int8ToStr(3)),Y.push(l.int8ToStr(F)),Y.join("")}function y(G,K,F){const Y=[];let _=0;return _=c.set(_,G,6,2),_=c.set(_,K,0,6),Y.push(l.int8ToStr(_)),Y.push(l.int8ToStr(4)),Y.push(l.int16ToStr(F)),Y.join("")}function P(G,K,F){const Y=[];let _=0;return _=c.set(_,G,6,2),_=c.set(_,K,0,6),Y.push(l.int8ToStr(_)),Y.push(l.int8ToStr(6)),Y.push(l.int32ToStr(F)),Y.join("")}function x(G,K,F){const Y=[];let _=0;return _=c.set(_,G,6,2),_=c.set(_,K,0,6),Y.push(l.int8ToStr(_)),Y.push(l.int8ToStr(10)),Y.push(l.int64ToStr(F)),Y.join("")}const B={};function H(G,K,F){const Y=[],_=F.type,U=F.value;let A=0;switch(A=c.set(A,G,6,2),A=c.set(A,K,0,6),Y.push(l.int8ToStr(A)),Y.push(l.int8ToStr(B[_])),Y.push(l.int8ToStr(_)),_){case g.DATE:Y.push(l.int64ToStr(U));break;case g.RGMID:Y.push(l.int64ToStr(U.suid)),Y.push(l.int64ToStr(U.messageId));case g.BEGINNING:}return Y.join("")}function L(G,K,F,Y){const _=[];let U=0;return U=c.set(U,G,6,2),U=c.set(U,K,0,6),_.push(l.int8ToStr(U)),_.push(l.int8ToStr(18)),_.push(l.int64ToStr(F)),_.push(l.int64ToStr(Y)),_.join("")}function M(G,K,F){const Y=[];let _=0;_=c.set(_,G,6,2),_=c.set(_,K,0,6),Y.push(l.int8ToStr(_));let U=0;return F.length<=253?(U=F.length+2,Y.push(l.int8ToStr(U))):(U=0,Y.push(l.int8ToStr(U)),Y.push(l.int32ToStr(F.length+5))),Y.push(F),Y.join("")}B[g.BEGINNING]=3,B[g.DATE]=11,B[g.RGMID]=19,n.exports.parseAdpAt=function(G,K){if(K+3>G.length)return!1;let F=K,Y=G.readUInt8(F);F++;const _=h(Y,0,6);let U,A;if(_<3){const J=G.readUInt16BE(F);F+=2,A=h(J,12,4),U=h(J,0,12),U<<=2}else{if(_!==3)return f("Found unsupported ADP Version",_),!1;Y=G.readUInt8(F),F++,A=h(Y,0,8),U=G.readUInt32BE(F),F+=4}if(K+U>G.length)return f(`Invalid Asssured Control Protocol length=${U} exceeds remaining message buffer = ${G.length-K}`),!1;const z=new i(A,_);for(;F<K+U;){Y=G.readUInt8(F),F++;const J=h(Y,6,2),se=h(Y,0,6);if(se===0)continue;if(F>=K+U)return f(`Invalid Asssured Control Protocol parameter=${se} at position =${F}`),!1;let Te,pe=G.readUInt8(F);if(F++,pe===0){if(F+5>K+U)return f(`Invalid Asssured Control Protocol parameter=${se} at position =${F}`),!1;pe=G.readUInt32BE(F),F+=4,Te=pe-5}else Te=pe-2;if(pe<=0)return!1;if(F+Te>K+U)return f(`Invalid Asssured Control Protocol parameter=${se} length =${Te} invalid at position =${F}`),!1;const ne=new t(J,se,null,G,F,F+Te);z.addParameter(ne),F+=Te}return z},n.exports.encAdp=function(G){const K=[],F=G.getParameterArray();let Y;for(Y=0;Y<F.length;Y++){const A=F[Y];if(A!==void 0)switch(A.getType()){case r.SMFAdProtocolParam.WINDOW:case r.SMFAdProtocolParam.EP_DURABLE:case r.SMFAdProtocolParam.ACCESSTYPE:case r.SMFAdProtocolParam.FLOWTYPE:case r.SMFAdProtocolParam.EP_RESPECTS_TTL:case r.SMFAdProtocolParam.TRANSACTION_CTRL_MESSAGE_TYPE:case r.SMFAdProtocolParam.TRANSACTED_SESSION_STATE:case r.SMFAdProtocolParam.ACTIVE_FLOW_INDICATION:case r.SMFAdProtocolParam.WANT_FLOW_CHANGE_NOTIFY:case r.SMFAdProtocolParam.MAX_REDELIVERY:K.push(w(A.getUh(),A.getType(),A.getValue()));break;case r.SMFAdProtocolParam.EP_BEHAVIOUR:K.push(y(A.getUh(),A.getType(),A.getValue()));break;case r.SMFAdProtocolParam.FLOWID:case r.SMFAdProtocolParam.TRANSPORT_WINDOW:case r.SMFAdProtocolParam.EP_ALLOTHER_PERMISSION:case r.SMFAdProtocolParam.EP_QUOTA:case r.SMFAdProtocolParam.EP_MAX_MSGSIZE:case r.SMFAdProtocolParam.GRANTED_PERMISSION:case r.SMFAdProtocolParam.TRANSACTED_SESSION_ID:case r.SMFAdProtocolParam.PUBLISHER_ID:K.push(P(A.getUh(),A.getType(),A.getValue()));break;case r.SMFAdProtocolParam.LASTMSGIDSENT:case r.SMFAdProtocolParam.LASTMSGIDACKED:case r.SMFAdProtocolParam.LASTMSGIDRECEIVED:case r.SMFAdProtocolParam.TRANSACTION_ID:case r.SMFAdProtocolParam.ENDPOINT_ERROR_ID:K.push(x(A.getUh(),A.getType(),A.getValue()));break;case r.SMFAdProtocolParam.REPLAY_START_LOCATION:{const z=A.getValue();z.value===void 0?K.push(w(A.getUh(),A.getType(),z.type)):K.push(H(A.getUh(),A.getType(),z));break}case r.SMFAdProtocolParam.APPLICATION_ACK:{const z=A.getValue(),J=A.getUh(),se=A.getType();for(let Te=0;Te<z.length;++Te){const pe=z[Te];K.push(L(J,se,pe[0],pe[1]))}break}case r.SMFAdProtocolParam.QUEUENAME:case r.SMFAdProtocolParam.DTENAME:case r.SMFAdProtocolParam.TOPICNAME:case r.SMFAdProtocolParam.FLOWNAME:case r.SMFAdProtocolParam.SELECTOR:case r.SMFAdProtocolParam.TRANSACTED_SESSION_NAME:K.push(M(A.getUh(),A.getType(),A.getValue()));break;case r.SMFAdProtocolParam.TRANSACTION_FLOW_DESCRIPTOR_PUB_NOTIFY:case r.SMFAdProtocolParam.TRANSACTION_FLOW_DESCRIPTOR_PUB_ACK:case r.SMFAdProtocolParam.TRANSACTION_FLOW_DESCRIPTOR_SUB_ACK:break;case r.SMFAdProtocolParam.NOLOCAL:case r.SMFAdProtocolParam.CUT_THROUGH:K.push(N(A.getUh(),A.getType()));break;case r.SMFAdProtocolParam.APPLICATION_PUB_ACK:break;default:o("Unrecognized ADProtocol Parameter in Message")}}const _=K.join(""),U=[];if(G.version===2){let A=0;A=T(A,0,22,2),A=T(A,G.version,16,6),A=T(A,G.msgType,12,4);let z=4-(3+_.length&3);const J=3+_.length+z>>2;for(A=T(A,J,0,12),U.push(p(A)),U.push(_),z===4&&(z=0);z>0;)U.push(S(0)),z--}else if(G.version===3){let A=0;A=T(A,0,14,2),A=T(A,G.version,8,6),A=T(A,G.msgType,0,8),U.push(C(A)),U.push(R(6+_.length)),U.push(_)}else f(`Invalid Version ${G.version} found while encoding`);return U.join("")}},7283:(n,I,e)=>{const{ContentSummaryType:r}=e(507),{Decode:i}=e(3486),{Encode:t}=e(5479),{ParamParse:c}=e(633),{ParseSMF:l}=e(1125),{Transport:u}=e(6624);n.exports.ContentSummaryType=r,n.exports.Encode=t,n.exports.Decode=i,n.exports.ParamParse=c,n.exports.ParseSMF=l,n.exports.Transport=u},9179:(n,I,e)=>{const{Bits:r,Convert:i}=e(840),{ClientCtrlMessage:t,SMFParameter:c}=e(2981),{LOG_ERROR:l}=e(390),{get:u,set:o}=r,{int8ToStr:f,int16ToStr:g,int32ToStr:h}=i;n.exports.parseCCAt=function(T,S,C){const p=new t;if(C<6||S+6>T.length)return p;let R=S;const N=T.readUInt16BE(R);R+=2;const w=u(N,8,3),y=u(N,0,8),P=T.readUInt32BE(R);if(R+=4,w!==1)return l(`Unsupported ClientCtrl version ${w}`),!1;if(P<=0||S+P>T.length)return!1;for(p.msgType=y,p.version=w;R<S+P;){const x=T.readUInt8(R);R++;const B=u(x,7,1),H=u(x,0,7),L=T.readUInt32BE(R);if(L<=0)return!1;R+=4;const M=L-5,G=new c(B,H,null,T,R,R+M);p.addParameter(G),R+=M}return p},n.exports.encCC=function(T){const S=[],C=T.getParameterArray();for(let w=0,y=C.length;w<y;++w){const P=C[w];if(P===void 0)continue;let x=0;x=o(x,P.getUh(),7,1),x=o(x,P.getType(),0,7),S.push(f(x)),S.push(h(P.getValue().length+5)),S.push(P.getValue())}const p=S.join("");let R=0;R=o(R,0,15,1),R=o(R,0,11,4),R=o(R,1,8,3),R=o(R,T.msgType,0,8);const N=[];return N.push(g(R)),N.push(h(6+p.length)),N.push(p),N.join("")}},7347:n=>{n.exports.ContentSummaryElement=class{constructor(I=null,e=0,r=0){this.type=I,this.position=e,this.length=r}}},507:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.ContentSummaryType=r.new({XML_META:0,XML_PAYLOAD:1,BINARY_ATTACHMENT:2,CID_LIST:3,BINARY_METADATA:4})},3486:(n,I,e)=>{const r=e(1880),i=e(3170),t=e(4789),c=e(7252),{BinaryMetaBlock:l,KeepAliveMessage:u}=e(2981),{ContentSummaryType:o}=e(507),{Hex:f,Long:g}=e(840),{Lazy:h}=e(9359),{LogFormatter:T}=e(390),{parseAdpAt:S}=e(2228),{parseCCAt:C}=e(9179),{ParseSMF:p}=e(1125),{PriorityUserCosMap:R}=e(2224),{SMFProtocol:N}=e(8958),{SMP:w}=e(7025),{Transport:y}=e(6624),{formatHexString:P}=f,{lazyValue:x}=h,{parseSMFAt:B}=p,{parseSMPAt:H}=w,{parseTsSmfMsgAt:L}=y,M=new T("[smf-decode]"),{LOG_DEBUG:G,LOG_ERROR:K}=M,F=x(()=>new R().reverse),Y={10:t.MessageType.MAP,11:t.MessageType.STREAM,7:t.MessageType.TEXT};function _(A,z){const J=z,se=c.Codec.parseSingleElement(A.payload,0);if(!se||se.getType()!==c.SDTFieldType.STREAM)return;const Te=se.getValue();let pe=Te.getNext();if(pe&&pe.getType()===c.SDTFieldType.BYTEARRAY&&pe._value&&pe._value.length>0){const ne=pe._value.readUInt8(0);if(!(128&ne)&&(J._messageType=Y[15&ne]||t.MessageType.BINARY),pe._value.length>1){const oe=pe._value.readUInt8(1);J.setAsReplyMessage((128&oe)!=0)}}if(pe=Te.getNext(),pe&&pe.getType()===c.SDTFieldType.MAP){const ne=pe.getValue(),oe=ne.getField("p"),de=ne.getField("h");if(oe&&J.setUserPropertyMap(oe.getValue()),de){const _e=de.getValue(),b=_e.getField("ci"),X=_e.getField("mi"),ae=_e.getField("mt"),ie=_e.getField("rt"),q=_e.getField("si"),Pe=_e.getField("sn"),ve=_e.getField("ts"),Qe=_e.getField("ex");b&&J.setCorrelationId(b.getValue()),X&&J.setApplicationMessageId(X.getValue()),ae&&J.setApplicationMessageType(ae.getValue()),ie&&J.setReplyTo(ie.getValue()),q&&J.setSenderId(q.getValue()),Pe&&J.setSequenceNumber(Pe.getValueNoThrow()),ve&&J.setSenderTimestamp(ve.getValue()),Qe&&J.setGMExpiration(Qe.getValue())}}}const U={decodeCompoundMessage:function(A,z){const J=B(A,z);if(!J)return null;const se=z+J.headerLength,Te=J.payloadLength;let pe;switch(J.smf_protocol){case N.TSESSION:if(pe=L(A,se,J),!pe)break;return pe.smfHeader=J,pe;case N.TRMSG:return pe=new t.Message,pe._smfHeader=J,function(ne,oe,de,_e){const b=oe;b._setDeliverToOne(!!ne.smf_dto),b._setDeliveryMode(ne.pm_deliverymode||t.MessageDeliveryModeType.DIRECT),ne.pm_tr_topicname_bytes!==null&&b._setDestination(i.DestinationFromNetwork.createDestinationFromBytes(ne.pm_tr_topicname_bytes)),b._setDiscardIndication(!!ne.smf_di),b._setElidingEligible(!!ne.smf_elidingEligible),b._setDMQEligible(!!ne.smf_deadMessageQueueEligible),b._setUserCos(F.value.get(ne.smf_priority)),b._setPriority(ne.pm_msg_priority),ne.pm_userdata&&b._setUserData(ne.pm_userdata),b.setRedelivered(!!ne.pm_ad_redelflag||!!ne.pm_ad_flowredelflag),b.setFlowId(ne.pm_ad_flowid),b.setGuaranteedMessageId(ne.pm_ad_msgid),b.setGuaranteedPreviousMessageId(ne.pm_ad_prevmsgid),b.setPublisherId(ne.pm_ad_publisherid),b.setPublisherMessageId(ne.pm_ad_publishermsgid),b.setTopicSequenceNumber(ne.pm_ad_topicSequenceNumber),b.getDeliveryMode()===t.MessageDeliveryModeType.DIRECT?b.setDeliveryCount(-1):ne.pm_ad_redeliveryCount?b.setDeliveryCount(ne.pm_ad_redeliveryCount+1):b.setDeliveryCount(1),ne.pm_ad_spooler_unique_id&&b._setSpoolerUniqueId(ne.pm_ad_spooler_unique_id),ne.pm_ad_replication_mate_ack_message_id?b._setSpoolerMessageId(ne.pm_ad_replication_mate_ack_message_id):ne.pm_ad_local_spooler_message_id&&b._setSpoolerMessageId(ne.pm_ad_local_spooler_message_id),g.isLong(ne.pm_ad_ttl)?b.setTimeToLive(ne.pm_ad_ttl.toNumber()):b.setTimeToLive(ne.pm_ad_ttl);const X=_e+ne.headerLength,ae=ne.pm_content_summary;if(ae&&ae.length)for(let ie=0,q=ae.length;ie<q;++ie){const Pe=ae[ie],ve=X+Pe.position,Qe=X+Pe.position+Pe.length;switch(Pe.type){case o.BINARY_ATTACHMENT:b._setBinaryAttachment(de.slice(ve,Qe));break;case o.BINARY_METADATA:{const Z=l.fromEncodedSmf(de,ve);b.binaryMetadataChunk=Z,Z.type===0&&_(Z,b);break}case o.XML_META:b._setXmlMetadata(de.toString("latin1",ve,Qe));break;case o.XML_PAYLOAD:b._setXmlContentInternal(de.toString("latin1",ve,Qe));break;default:K(`Unhandled ContentSummaryType: ${o.describe(Pe.type)}`)}}else b._setBinaryAttachment(ne.payloadLength>0?de.slice(X,X+ne.payloadLength):void 0)}(J,pe,A,z),pe;case N.ADCTRL:return pe=S(A,se,Te),pe.smfHeader=J,pe;case N.CLIENTCTRL:if(pe=C(A,se,Te),!pe)break;return pe.smfHeader=J,pe;case N.SMP:if(pe=H(A,se),!pe)break;return pe.smfHeader=J,pe;case N.KEEPALIVE:case N.KEEPALIVEV2:return pe=new u,pe.smfHeader=J,pe;default:K(`Unknown protocol: 0x${P(J.smf_protocol)}, dump message content: 
${r.Debug.formatDumpBytes(A.slice(z,z+J.messageLength).toString("latin1"),!0,0)}`)}return null}};n.exports.Decode=U},5479:(n,I,e)=>{const r=e(4789),{Base64:i,Bits:t,Convert:c}=e(840),{BinaryMetaBlock:l,SMFHeader:u,SMPMessage:o}=e(2981),{Check:f}=e(2201),{ClientCtrlMessage:g,KeepAliveMessage:h,AdProtocolMessage:T}=e(2981),{Codec:S}=e(7252),{ContentSummaryElement:C}=e(7347),{ContentSummaryType:p}=e(507),{DestinationType:R}=e(3170),{encAdp:N}=e(2228),{encCC:w}=e(9179),{ErrorSubcode:y,OperationError:P}=e(3870),{Lazy:x}=e(9359),{LOG_TRACE:B,LOG_INFO:H}=e(390),{ParamParse:L}=e(633),{PriorityUserCosMap:M}=e(2224),{SDTField:G,SDTFieldType:K,SDTMapContainer:F,SDTStreamContainer:Y}=e(7252),{SMFParameterType:_,SMFExtendedParameterType:U}=e(2095),{SMFProtocol:A}=e(8958),{SMP:z}=e(7025),{encode:J}=i,{set:se}=t,{int8ToStr:Te,int16ToStr:pe,int24ToStr:ne,int32ToStr:oe,int64ToStr:de}=c,{lazyValue:_e}=x,{encContentSummary:b,encDeliveryMode:X,encLightSMFParam:ae,encodeSMFParam:ie,encodeSMFExtendedParam:q}=L,{encodeSingleElement:Pe}=S,{encSmp:ve}=z,Qe=_e(()=>new M().forward);function Z(Ae,ut,Ke,mt){if(f.anything(Ke)&&Ke.length>0){const Dt=new C(mt,NaN,Ke.length);Ae.push(Dt),ut.push(Ke)}}function ee(Ae,ut,Ke,mt){f.anything(mt)&&Ae.addField(ut,G.create(Ke,mt))}function ge(Ae){let ut;(Ae.getCorrelationId()||Ae.getApplicationMessageId()||Ae.getApplicationMessageType()||Ae.getReplyTo()||Ae.getSenderId()||Ae.getSequenceNumber()||Ae.getSenderTimestamp()||Ae.getUserPropertyMap()||Ae.isReplyMessage()||Ae.getType()!==r.MessageType.BINARY)&&(ut=function(Ye){let Rt;const ze=new F;ee(ze,"ci",K.STRING,Ye.getCorrelationId()),ee(ze,"mi",K.STRING,Ye.getApplicationMessageId()),ee(ze,"mt",K.STRING,Ye.getApplicationMessageType()),ee(ze,"rt",K.DESTINATION,Ye.getReplyTo()),ee(ze,"si",K.STRING,Ye.getSenderId()),ee(ze,"sn",K.INT64,Ye.getSequenceNumber()),ee(ze,"ts",K.INT64,Ye.getSenderTimestamp()),ee(ze,"ex",K.INT64,Ye.getGMExpiration());const Ut=new F;Ye.getUserPropertyMap()&&Ut.addField("p",G.create(K.MAP,Ye.getUserPropertyMap())),ze.getKeys().length>0&&Ut.addField("h",G.create(K.MAP,ze));let kt=0;switch(Ye.getType()){case r.MessageType.BINARY:kt|=128;break;case r.MessageType.MAP:kt|=10,Rt=Pe(Ye._structuredContainer);break;case r.MessageType.STREAM:kt|=11,Rt=Pe(Ye._structuredContainer);break;case r.MessageType.TEXT:kt|=7,Rt=Pe(Ye._structuredContainer);break;default:H(`Unhandled messageType: ${Ye.getType()}`)}const nn=Ye.isReplyMessage()?128:0,rn=G.create(K.BYTEARRAY,String.fromCharCode(kt,nn)),Tn=new Y;Tn.addField(rn),Tn.addField(G.create(K.MAP,Ut));const Gt=new l;return Gt.type=0,Gt.payload=Pe(G.create(K.STREAM,Tn)),Ye.binaryMetadataChunk=Gt,Rt}(Ae));const Ke=[],mt=[];Z(Ke,mt,Ae.getXmlMetadata(),p.XML_META),Z(Ke,mt,Ae.getXmlContent(),p.XML_PAYLOAD),Z(Ke,mt,ut||(Ae._binaryAttachment?Ae._binaryAttachment.toString("latin1"):""),p.BINARY_ATTACHMENT);const Dt=Ae.binaryMetadataChunk;if(Dt!==null){const Ye=Dt.asEncodedSmf(),Rt=16777215;if(Ye.length>Rt)throw Ye.length,new P(`binary-meta data (${Ye.length}) over the ${Rt} limit`,y.PARAMETER_OUT_OF_RANGE);Z(Ke,mt,Ye,p.BINARY_METADATA)}return Ae._memoized_csumm=Ke,Ae._memoized_payload=mt.join(""),Ae._payload_is_memoized=!0,Ae._memoized_payload?Ae._memoized_payload.length:0}const d=(Ae,ut)=>(Ke=>Array.from(Array(Math.pow(2,Ke))).map((mt,Dt)=>Dt))(ut).map(Ke=>se(0,Ke,Ae,ut)),O=d(31,1),D=d(30,1),Q=d(29,1),re=d(28,1),ce=d(27,1),me=d(24,3),Ee=d(22,2),Ce=d(16,6),Me=d(12,4),Be=d(0,8),He=d(8,8),Ot=d(0,8);function xt(Ae){let ut=0;ut|=O[Ae.smf_di?1:0],ut|=D[Ae.smf_elidingEligible?1:0],ut|=Q[Ae.smf_dto?1:0],ut|=re[Ae.smf_adf?1:0],ut|=ce[Ae.smf_deadMessageQueueEligible?1:0],ut|=me[Ae.smf_version||0],ut|=Ee[Ae.smf_uh||0],ut|=Ce[Ae.smf_protocol||0],ut|=Me[Ae.smf_priority||0],ut|=Be[Ae.smf_ttl||0];const Ke=[];Ae.pm_tr_topicname_bytes&&Ke.push(ie(2,_.TR_TOPICNAME,`${Ae.pm_tr_topicname_bytes}`)),Ae.pm_queue_len&&Ke.push(ae(0,_.LIGHT_QUEUE_NAME_OFFSET,pe(He[Ae.pm_queue_offset]|Ot[Ae.pm_queue_len]))),Ae.pm_topic_len&&Ke.push(ae(0,_.LIGHT_TOPIC_NAME_OFFSET,pe(He[Ae.pm_topic_offset]|He[Ae.pm_topic_len]))),Ae.pm_corrtag!==null&&Ae.pm_corrtag!==void 0&&Ke.push(ae(0,_.LIGHT_CORRELATION,ne(Ae.pm_corrtag))),Ae.pm_ad_ackimm&&Ke.push(ae(0,_.LIGHT_ACK_IMMEDIATELY,"")),Ae.pm_msg_priority!==null&&Ke.push(ie(0,_.MESSAGEPRIORITY,Te(Ae.pm_msg_priority))),Ae.pm_userdata!==null&&Ae.pm_userdata!==""&&Ke.push(ie(0,_.USERDATA,Ae.pm_userdata)),Ae.pm_username&&Ke.push(ie(0,_.USERNAME,J(Ae.pm_username))),Ae.pm_password&&Ke.push(ie(0,_.PASSWORD,J(Ae.pm_password))),Ae.pm_respcode&&Ke.push(ie(0,_.RESPONSE,oe(Ae.pm_respcode)+Ae.pm_respstr)),Ae.pm_deliverymode!==null&&Ke.push(ie(0,_.DELIVERY_MODE,X(Ae.pm_deliverymode))),Ae.pm_ad_msgid!==void 0&&(Ke.push(ie(2,_.ASSURED_MESSAGE_ID,de(Ae.pm_ad_msgid))),Ke.push(ie(2,_.ASSURED_PREVMESSAGE_ID,de(Ae.pm_ad_prevmsgid)))),Ae.pm_ad_flowid&&Ke.push(ie(0,_.ASSURED_FLOWID,oe(Ae.pm_ad_flowid))),Ae.pm_ad_redelflag&&Ke.push(ie(0,_.ASSURED_REDELIVERED_FLAG,void 0)),Ae.pm_ad_ttl!==void 0&&Ke.push(ie(0,_.AD_TIMETOLIVE,de(Ae.pm_ad_ttl))),Ae.pm_ad_publisherid&&Ke.push(ie(0,_.PUBLISHER_ID,oe(Ae.pm_ad_publisherid))),Ae.pm_ad_publisherMsgId&&Ke.push(ie(0,_.PUBLISHER_MSGID,de(Ae.pm_ad_publisherMsgId))),Ae.pm_content_summary&&Ke.push(ie(2,_.MESSAGE_CONTENT_SUMMARY,b(Ae.pm_content_summary)));let mt="",Dt=0;Ae.pm_oauth2_access_token&&(mt+=q(0,U.OAUTH2_ACCESS_TOKEN,Ae.pm_oauth2_access_token),Dt=Dt||0),Ae.pm_oidc_id_token&&(mt+=q(0,U.OIDC_ID_TOKEN,Ae.pm_oidc_id_token),Dt=Dt||0),Ae.pm_oauth2_issuer_identifier&&(mt+=q(0,U.OAUTH2_ISSUER_IDENTIFIER,Ae.pm_oauth2_issuer_identifier),Dt=Dt||0),mt.length>0&&Ke.push(ie(Dt,_.EXTENDED_TYPE_STREAM,mt));const Ye=Ke.join(""),Rt=12+Ye.length,ze=Rt+Ae.payloadLength;return Ae.setMessageSizes(Rt,Ae.payloadLength),oe(ut)+oe(Rt)+oe(ze)+Ye}const gt={encodeCompoundMessage:function(Ae){let ut="";var Ke,mt;Ae instanceof r.Message?(Ae.smfHeader||(Ae.smfHeader=new u(A.TRMSG,255)),Ke=Ae,mt=Ae._smfHeader,function(Ye,Rt){const ze=Rt;Ye._payload_is_memoized||ge(Ye);const Ut=Ye._memoized_csumm,kt=Ye._memoized_payload;Ut.length===0||Ut.length===1&&Ut[0].type===p.BINARY_ATTACHMENT||(ze.pm_content_summary=Ut),ze.payload=kt}(Ke,mt),function(Ye,Rt){const ze=Rt,Ut=Ye.getDeliveryMode();ze.smf_dto=Ye.isDeliverToOne(),ze.pm_deliverymode=Ut,ze.smf_adf=Ut===r.MessageDeliveryModeType.DIRECT?0:1,ze.smf_di=Ye.isDiscardIndication(),ze.smf_elidingEligible=Ye.isElidingEligible(),ze.smf_deadMessageQueueEligible=Ye.isDMQEligible(),ze.pm_ad_flowid=Ye.getFlowId(),ze.pm_ad_publisherid=Ye.getPublisherId(),ze.pm_ad_publishermsgId=Ye.getPublisherMessageId(),ze.pm_ad_msgid=Ye.getGuaranteedMessageId(),ze.pm_ad_prevmsgid=Ye.getGuaranteedPreviousMessageId(),ze.pm_ad_ttl=Ye.getTimeToLive(),ze.pm_ad_ackimm=Ye.isAcknowledgeImmediately(),ze.pm_ad_redelflag=Ye.isRedelivered();const kt=Ye.getDestination();if(kt&&(ze.pm_tr_topicname_bytes=kt.getBytes(),kt.type===R.QUEUE||kt.type===R.TEMPORARY_QUEUE)){const{offset:rn}=kt;ze.pm_queue_len=ze.pm_tr_topicname_bytes.length-rn,ze.pm_queue_offset=rn}ze.smf_priority=Qe.value.get(Ye.getUserCos()),Ye.getPriority()!==void 0&&typeof Ye.getPriority()=="number"&&Ye.getPriority()<=255&&Ye.getPriority()>=0?ze.pm_msg_priority=Ye.getPriority():ze.pm_msg_priority=null;const nn=Ye.getUserData();ze.pm_userdata=nn==null?null:Ye.getUserData()}(Ke,mt),ut=Ae._smfHeader.payload):Ae instanceof g?ut=w(Ae):Ae instanceof o?ut=ve(Ae):Ae instanceof h||Ae instanceof T&&(ut=N(Ae));const Dt=Ae.smfHeader;return Dt.setPayloadSize(ut.length),xt(Dt)+ut},encodeSMF:xt,adaptMessageToSmf_payloadMemoize:ge};n.exports.Encode=gt},633:(n,I,e)=>{const r=e(4789),{BidiMap:i,Lazy:t}=e(9359),{Bits:c,Convert:l}=e(840),{ContentSummaryElement:u}=e(7347),{ContentSummaryType:o}=e(507),{ErrorSubcode:f,OperationError:g}=e(3870),{LOG_ERROR:h}=e(390),{SMFUH:T}=e(2981),{lazyValue:S}=t,{int8ToStr:C,int16ToStr:p,int24ToStr:R,int32ToStr:N}=l,w=S(()=>{const G=[[0,r.MessageDeliveryModeType.NON_PERSISTENT],[1,r.MessageDeliveryModeType.PERSISTENT],[2,r.MessageDeliveryModeType.DIRECT]].map(K=>[K[0],K[1]]);return new i(...G)}),y=S(()=>w.value.forward),P=S(()=>w.value.reverse),x=(()=>{const G=[],K=Math.pow(2,5);return T.values.forEach(F=>{G[F]=[];for(let Y=0;Y<K;++Y){let _=0;_=c.set(_,F,6,2),_=c.set(_,Y,0,5),G[F][Y]=C(_)}}),G})(),B=new Array(256).fill(null).map((G,K)=>C(K)),H=(()=>{const G=[],K=Math.pow(2,3),F=Math.pow(2,2);return T.values.forEach(Y=>{G[Y]=[];for(let _=0;_<K;++_){G[Y][_]=[];for(let U=0;U<F;++U){let A=0;A=c.set(A,Y,6,2),A=c.set(A,1,5,1),A=c.set(A,_,2,3),A=c.set(A,U,0,2),G[Y][_][U]=C(A)}}}),G})(),L=[o.XML_META,o.XML_PAYLOAD,o.BINARY_ATTACHMENT,o.CID_LIST,o.BINARY_METADATA],M={parseTopicQueueOffsets:function(G,K){const F=[];return F[0]=G.readUInt8(K),F[1]=G.readUInt8(K+1),F},parseResponseParam:function(G,K,F){const Y=[];return Y[0]=G.readInt32BE(K),Y[1]=F>4?G.toString("latin1",K+4,K+F):"",Y},parseDeliveryMode:function(G,K){const F=G.readUInt8(K),Y=y.value.get(F);return Y!==void 0?Y:r.MessageDeliveryModeType.DIRECT},encDeliveryMode:function(G){const K=P.value.get(G);return C(K!==void 0?K:r.MessageDeliveryModeType.DIRECT)},parseContentSummary:function(G,K,F){const Y=[];let _=0,U=K;for(;U<K+F;){const A=G.readUInt8(U),z=c.get(A,4,4),J=c.get(A,0,4);let se=0;switch(J){case 2:se=G.readUInt8(U+1);break;case 3:se=G.readUInt16BE(U+1);break;case 4:se=G.readUIntBE(U+1,3);break;case 5:se=G.readInt32BE(U+1)}if(J===0)return h("Invalid content summary parameter - pos not advancing"),null;U+=J;const Te=L[z];Te===void 0&&h(`Unhandled element type ${z}`);const pe=new u(Te,_,se);Y.push(pe),_+=se}return Y},encContentSummary:function(G){const K=[];for(let F=0,Y=G.length;F<Y;++F){const _=G[F];let U="",A=c.set(0,_.type,4,4);_.length<=255?(A=c.set(A,2,0,4),U=C(_.length)):_.length<=65535?(A=c.set(A,3,0,4),U=p(_.length)):_.length<=16777215?(A=c.set(A,4,0,4),U=R(_.length)):(A=c.set(A,5,0,4),U=N(_.length)),K.push(C(A)),K.push(U)}return K.join("")},encodeSMFParam:function(G,K,F){if(F===void 0)return x[G][K]+B[2];const Y=F.length;return Y<=253?x[G][K]+B[Y+2]+F:x[G][K]+B[0]+N(Y+6)+F},encodeSMFExtendedParam:function(G,K,F){let Y=0;Y=c.set(Y,G?1:0,7,1);const _=F==null?0:F.length,U={0:0,1:1,2:2,4:3,8:4};let A=0,z="";if(Object.prototype.hasOwnProperty.call(U,_))A=U[_];else if(_<253)A=5,z=C(_+3);else{if(!(_<65532))throw h(`Extended parameter type ${K} is too long (${_} bytes) `),new g(`Extended parameter (${K}) over the 2^16 byte limit`,f.PARAMETER_OUT_OF_RANGE);A=6,z=p(_+4)}Y=c.set(Y,A,4,3),Y=c.set(Y,K>>8,0,4);const J=255&K;return C(Y)+C(J)+z+F},encLightSMFParam:function(G,K,F){return H[G][K][F.length]+F}};n.exports.ParamParse=M},1125:(n,I,e)=>{const r=e(1583),{LOG_DEBUG:i,LOG_ERROR:t,LOG_INFO:c,LOG_TRACE:l}=e(390),{Base64:u,Bits:o}=e(840),{ParamParse:f}=e(633),{SMFHeader:g}=e(2981),{SMFParameterType:h}=e(2095),{decode:T}=u,{get:S}=o;function C(w,y){return!(w.length-y<12)}function p(w,y){if(!C(w,y))return!1;const P=7&w.readUInt8(y);return P===3||(t(`Invalid smf version in smf header, version=${P}`),!1)}function R(w,y,P,x){let B=P;for(;B<P+x;){if(B+2>P+x){t("Extended parameter stream had padding inside.");break}const H=y.readUInt8(B),L=y.readUInt8(B+1),M=S(H,7,1),G=S(H,4,3),K=(S(H,0,4)<<8)+L;B+=2;const F={0:0,1:1,2:2,3:4,4:8};let Y=0;if(Object.prototype.hasOwnProperty.call(F,G))Y=F[G];else if(G===5)Y=y.readUInt8(B)-3,B++;else{if(G!==6)return t(`Invalid length mode ${G} in Extended Parameter type ${K}`),!1;Y=y.readUInt16BE(B)-4,B+=2}switch(K){case h.AD_REDELIVERY_COUNT:w.pm_ad_redeliveryCount=y.readUInt32BE(B);break;case h.AD_SPOOLER_UNIQUE_ID:w.pm_ad_spooler_unique_id=r.fromBits(y.readUInt32BE(B+4),y.readUInt32BE(B),!0);break;case h.AD_ACK_MESSAGE_ID:w.pm_ad_local_spooler_message_id=r.fromBits(y.readUInt32BE(B+4),y.readUInt32BE(B),!0);break;case h.AD_REPL_MATE_ACK_MSGID:w.pm_ad_replication_mate_ack_message_id=r.fromBits(y.readUInt32BE(B+4),y.readUInt32BE(B),!0);break;default:M===0||(w.discardMessage=!0)}B+=Y}return B>P+x&&t(`Last extended parameter ran beyond extended stream length by ${B-(P+x)}.`),!0}const N={isSMFHeaderAvailable:C,isSMFHeaderValid:p,isSMFAvailable:function(w,y){if(!p(w,y))return!1;const P=w.length-y;return w.readUInt32BE(y+8)<=P},parseSMFAt:function(w,y,P=!1){if(!p(w,y))return null;let x=y;const B=w.readUInt32BE(x),H=w.readUInt32BE(x+4),L=w.readUInt32BE(x+8),M=new g;M.smf_di=S(B,31,1),M.smf_elidingEligible=S(B,30,1),M.smf_dto=S(B,29,1),M.smf_adf=S(B,28,1),M.smf_deadMessageQueueEligible=S(B,27,1),M.smf_version=S(B,24,3),M.smf_uh=S(B,22,2),M.smf_protocol=S(B,16,6),M.smf_priority=S(B,12,4),M.smf_ttl=S(B,0,8);const G=L-H;if(G<0)return t("SMF parse error: lost framing"),null;if(M.setMessageSizes(H,G),P)return M;x+=12;const K=y+H;for(;x<K;){const F=w.readUInt8(x);++x;const Y=S(F,6,2);if(S(F,5,1)!==0){const _=S(F,2,3),U=S(F,0,2)+1,A=U-1;if(U<=0)return t("Invalid lightweight parameter length"),null;switch(_){case h.LIGHT_CORRELATION:M.pm_corrtag=w.readUIntBE(x,3);break;case h.LIGHT_TOPIC_NAME_OFFSET:{const z=f.parseTopicQueueOffsets(w,x);M.pm_queue_offset=z[0],M.pm_queue_len=z[1];break}case h.LIGHT_QUEUE_NAME_OFFSET:{const z=f.parseTopicQueueOffsets(w,x);M.pm_topic_offset=z[0],M.pm_topic_len=z[1];break}case h.LIGHT_ACK_IMMEDIATELY:M.pm_ad_ackimm=!!w.readUInt8(x);break;default:Y===0||(M.discardMessage=!0)}x+=A}else{const _=x,U=S(F,0,5);if(U===0)break;let A,z=w.readUInt8(x);if(x++,z===0?(z=w.readUInt32BE(x),x+=4,A=z-6):A=z-2,z<=0)return t(`Invalid regular parameter length ${z}/${A} with suspect type ${h.describe(U)} at parameter at position ${_}`),null;switch(U){case h.PUBLISHER_ID:M.pm_ad_publisher_id=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.PUBLISHER_MSGID:M.pm_ad_publishermsgid=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.MESSAGEPRIORITY:M.pm_msg_priority=w.readUInt8(x);break;case h.USERDATA:M.pm_userdata=w.toString("latin1",x,x+A);break;case h.USERNAME:M.pm_username=T(w.toString("latin1",x,x+A));break;case h.PASSWORD:M.pm_password=T(w.toString("latin1",x,x+A));break;case h.RESPONSE:{const J=f.parseResponseParam(w,x,A);M.pm_respcode=J[0],M.pm_respstr=J[1];break}case h.SUB_ID_LIST:case h.GENERIC_ATTACHMENT:case h.BINARY_ATTACHMENT:c("Skipping deprecated parameter type");break;case h.DELIVERY_MODE:M.smf_adf&&(M.pm_deliverymode=f.parseDeliveryMode(w,x));break;case h.ASSURED_MESSAGE_ID:M.pm_ad_msgid=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.ASSURED_PREVMESSAGE_ID:M.pm_ad_prevmsgid=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.ASSURED_REDELIVERED_FLAG:M.pm_ad_redelflag=!0;break;case h.AD_TIMETOLIVE:M.pm_ad_ttl=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.AD_TOPICSEQUENCE_NUMBER:M.pm_ad_topicSequenceNumber=r.fromBits(w.readUInt32BE(x+4),w.readUInt32BE(x),!0);break;case h.MESSAGE_CONTENT_SUMMARY:{const J=f.parseContentSummary(w,x,A);if(!J)return t(`Invalid message content summary at ${x}, len ${A}`),!1;M.pm_content_summary=J;break}case h.ASSURED_FLOWID:M.pm_ad_flowid=w.readUInt32BE(x);break;case h.TR_TOPICNAME:M.pm_tr_topicname_bytes=w.toString("latin1",x,x+A);break;case h.AD_FLOWREDELIVERED_FLAG:M.pm_ad_flowredelflag=!0;break;case h.EXTENDED_TYPE_STREAM:if(!R(M,w,x,A))return null;break;default:Y===0||(M.discardMessage=!0)}x+=A}}return M}};n.exports.ParseSMF=N},2224:(n,I,e)=>{const r=e(4789),{BidiMap:i}=e(9359);n.exports.PriorityUserCosMap=class extends i{constructor(){super([r.MessageUserCosType.COS1,0],[r.MessageUserCosType.COS2,1],[r.MessageUserCosType.COS3,2])}}},7025:(n,I,e)=>{const{Bits:r,Convert:i}=e(840);e(390);const{SMFSMPMessageType:t}=e(6874),{SMPMessage:c}=e(2981),{get:l,set:u}=r,{int8ToStr:o,int32ToStr:f}=i,g={parseSMPAt:function(h,T){if(T+6>h.length)return!1;let S=T;const C=h.readUInt8(S);S++;const p=l(C,0,7),R=new c;if(p!==t.ADDSUBSCRIPTION&&p!==t.REMSUBSCRIPTION&&p!==t.ADDQUEUESUBSCRIPTION&&p!==t.REMQUEUESUBSCRIPTION)return!1;h.toString("latin1");const N=h.readUInt32BE(S);if(S+=4,T+N>h.length)return!1;const w=h.readUInt8(S);if(S++,R.msgType=p,R.smpFlags=w,p===t.ADDSUBSCRIPTION||p===t.REMSUBSCRIPTION)R.encodedUtf8Subscription=h.toString("latin1",S,S+N-6);else{const y=h.readUInt8(S);S++,R.encodedUtf8QueueName=h.toString("latin1",S,S+y),S+=y;const P=h.readUInt8(S);S++,R.encodedUtf8Subscription=h.toString("latin1",S,S+P),S+=P}return R},encSmp:function(h){if(h.msgType!==t.ADDSUBSCRIPTION&&h.msgType!==t.REMSUBSCRIPTION&&h.msgType!==t.ADDQUEUESUBSCRIPTION&&h.msgType!==t.REMQUEUESUBSCRIPTION)return!1;const T=[];let S=0;S=u(S,1,7,1),S=u(S,h.msgType,0,7),T.push(o(S));let C=6+h.encodedUtf8Subscription.length;return h.msgType!==t.ADDQUEUESUBSCRIPTION&&h.msgType!==t.REMQUEUESUBSCRIPTION||(C+=2+h.encodedUtf8QueueName.length),T.push(f(C)),T.push(o(h.smpFlags)),(h.msgType===t.ADDQUEUESUBSCRIPTION||h.msgType===t.REMQUEUESUBSCRIPTION)&&(T.push(o(h.encodedUtf8QueueName.length)),T.push(h.encodedUtf8QueueName),T.push(o(h.encodedUtf8Subscription.length))),T.push(h.encodedUtf8Subscription),T.join("")}};n.exports.SMP=g},6624:(n,I,e)=>{const{Bits:r,Convert:i}=e(840),{Lazy:t}=e(9359),{LOG_ERROR:c}=e(390),{SMFTransportSessionMessageType:l}=e(5752),{TransportSMFMessage:u}=e(2981),{get:o}=r,{int16ToStr:f,int32ToStr:g}=i,{lazyValue:h}=t;function T(P,x){return P.length-x}function S(P,x,B){let H=x;if(T(P,H)<10)return c("TsSmf parse failed: not enough data, expected at least 10B"),!1;const L=new u;L.smfHeader=B;const M=P.readUInt16BE(H);H+=2,L.uh=o(M,15,1),L.messageType=o(M,8,7);const G=o(M,0,8);if(L.tsHeaderLength=G,L.sessionId=P.toString("latin1",H,H+8),H+=8,L.messageType===l.CREATE_RESP){const K=P.readUInt8(H);if(H++,T(P,H)<K)return c(`TsSmf parse failed: not enough data for RouterTag, expected ${K}B`),!1;L.routerTag=P.toString("latin1",H,H+K),H+=K}return H=x+G,B.payloadLength===4294967295?L.payloadLength=B.payloadLength:L.payloadLength=B.payloadLength-G,L}const C=h(()=>g(51642369)+g(12)),p=h(()=>C.value+g(22)+f(33290)),R=h(()=>C.value+g(22)+f(32778)+g(0)+g(0)),N=h(()=>g(60030977)+g(12)+g(22)+f(34058)),w=h(()=>g(60030977)+g(12)+g(24)+f(34316)),y={genTsCreateHeader:function(){return R.value},genTsDestroyHeader:function(P){return p.value+P},genTsDataTokenMsg:function(P){return N.value+P},genTsDataStreamTokenMsg:function(P,x){return w.value+P+f(x&&x>0?x:0)},genTsDataMsgHeaderParts:function(P){return[g(60030977)+g(12),f(33802)+P]},parseTsSmfHdrAt:S,parseTsSmfMsgAt:function(P,x,B){const H=S(P,x,B);if(!H)return null;const L=x+H.tsHeaderLength;return T(P,L)<H.payloadLength?(c(`Couldn't read full encapsulated TsSmf payload, expected ${H.payloadLength}B`),null):(H.payload=P.slice(L,L+H.payloadLength),H)}};n.exports.Transport=y},7780:(n,I,e)=>{const{BaseMessage:r}=e(3493),{Convert:i,Long:t}=e(840),{DestinationType:c}=e(3170);e(390);const{OperationError:l}=e(3870),{QueueAccessType:u,QueueDiscardBehavior:o}=e(5754),{QueuePermissions:f,QueueType:g}=e(5754),{ReplayStartType:h}=e(2604),{SMFAdProtocolMessageType:T}=e(948),{SMFAdProtocolParam:S}=e(4786),{SMFHeader:C}=e(6631),{SMFParameter:p}=e(2984),{SMFProtocol:R}=e(8958),{SMFUH:N}=e(3767),{StringUtils:w}=e(7882),y=e(8764).lW,{strToInt8:P,strToInt16:x,strToUInt32:B,strToUInt64:H}=i,L=y.prototype.readUInt8,M=y.prototype.readUInt16BE,G=y.prototype.readUInt32BE,K=function(ne){return t.fromBits(this.readUInt32BE(ne+4),this.readUInt32BE(ne),!0)},{nullTerminate:F,stripNullTerminate:Y}=w,_={[c.TOPIC]:S.DTENAME,[c.QUEUE]:S.QUEUENAME},U={[g.TOPIC_ENDPOINT]:S.DTENAME,[g.QUEUE]:S.QUEUENAME},A={[f.NONE]:0,[f.READ_ONLY]:1,[f.CONSUME]:3,[f.MODIFY_TOPIC]:7,[f.DELETE]:15},z={1:u.EXCLUSIVE,2:u.NONEXCLUSIVE},J={[u.EXCLUSIVE]:1,[u.NONEXCLUSIVE]:2},se={[o.NOTIFY_SENDER_OFF]:1,[o.NOTIFY_SENDER_ON]:2};function Te(ne,oe,de=!1){if(!oe)return;const{accessType:_e,discardBehavior:b,maxMessageRedelivery:X,maxMessageSize:ae,permissions:ie,quotaMB:q,respectsTTL:Pe}=oe;ie&&A[ie]!==void 0&&ne.addParameter(new p(N.IGNORE,S.EP_ALLOTHER_PERMISSION,A[ie])),de||_e===void 0||J[_e]===void 0||ne.addParameter(new p(N.IGNORE,S.ACCESSTYPE,J[_e])),q!=null&&ne.addParameter(new p(N.IGNORE,S.EP_QUOTA,q)),ae!=null&&ne.addParameter(new p(N.IGNORE,S.EP_MAX_MSGSIZE,ae));let ve=0;b!=null&&(ve|=se[b]<<12),ve&&ne.addParameter(new p(N.IGNORE,S.EP_BEHAVIOUR,ve)),X!=null&&ne.addParameter(new p(N.IGNORE,S.MAX_REDELIVERY,X)),Pe!=null&&ne.addParameter(new p(N.IGNORE,S.EP_RESPECTS_TTL,Pe?1:0))}class pe extends r{constructor(oe=0,de=3){super(new C(R.ADCTRL,1)),this.msgType=oe,this.version=de}_readParameter(oe,de=null,_e=null){const b=this.getParameter(oe);if(b===void 0)return;if(_e&&b.getBuffer())return _e.call(b.getBuffer(),b.getBegin());const X=b.getValue();return de?de(X):X}getAccessType(){const oe=this._readParameter(S.ACCESSTYPE,P,L);return z[oe]}getActiveFlow(){return this._readParameter(S.ACTIVE_FLOW_INDICATION,P,L)}getQueueDiscardBehavior(){const oe=this._readParameter(S.EP_BEHAVIOUR,x,M);if(oe===void 0)return;const de=(12288&oe)>>12;return de===se[o.NOTIFY_SENDER_OFF]?o.NOTIFY_SENDER_OFF:de===se[o.NOTIFY_SENDER_ON]?o.NOTIFY_SENDER_ON:void 0}getEndpointDeliveryCountSent(){switch((3072&this._readParameter(S.EP_BEHAVIOUR,x,M))>>10){case 0:default:return;case 1:return!1;case 2:return!0}}getEndpointId(){return this._readParameter(S.ENDPOINT_ID,B,G)}getRespectsTTL(){const oe=this._readParameter(S.EP_RESPECTS_TTL,P,L);if(oe!==void 0)return!!oe}getFlowName(){return this._readParameter(S.FLOWNAME,Y)}getFlowId(){return this._readParameter(S.FLOWID,B,G)}getQuota(){return this._readParameter(S.EP_QUOTA,B,G)}getMaxMsgSize(){return this._readParameter(S.EP_MAX_MSGSIZE,B,G)}getTopicEndpointBytes(){return this._readParameter(S.DTENAME)}getGrantedPermissions(){const oe=this._readParameter(S.GRANTED_PERMISSIONS,B,G);let de;return Object.keys(A).forEach(_e=>{A[_e]===oe&&(de=_e)}),de}getAllOthersPermissions(){const oe=this._readParameter(S.EP_ALLOTHER_PERMISSION,B,G);let de;return Object.keys(A).forEach(_e=>{A[_e]===oe&&(de=_e)}),de}getLastMsgIdAcked(){return this._readParameter(S.LASTMSGIDACKED,H,K)}getLastMsgIdReceived(){return this._readParameter(S.LASTMSGIDRECEIVED,H,K)}getPublisherId(){return this._readParameter(S.PUBLISHER_ID,B,G)}getWantFlowChangeNotify(){return!!this._readParameter(S.WANT_FLOW_CHANGE_NOTIFY,P,L)}getWindow(){return this._readParameter(S.WINDOW,P,L)}getMaxRedelivery(){return this._readParameter(S.MAX_REDELIVERY,P,L)}getMaxUnackedMessages(){return this._readParameter(S.MAX_DELIVERED_UNACKED_MESSAGES_PER_FLOW,B,G)}getEndpointErrorId(){return this._readParameter(S.ENDPOINT_ERROR_ID,H,K)}getSpoolerUniqueId(){return this._readParameter(S.SPOOLER_UNIQUE_ID,H,K)}static getCloseMessagePublisher(oe,de){const _e=new pe(T.CLOSEPUBFLOW);return _e.smfHeader.pm_corrtag=de,_e.addParameter(new p(N.REJECT,S.FLOWID,oe)),_e}static getCreate(oe,de,_e){const b=new pe(T.CREATE);b.smfHeader.pm_corrtag=_e;const X=U[oe.type];if(X===void 0)throw new l("Unknown destination type");return b.addParameter(new p(N.REJECT,X,F(oe.name))),b.addParameter(new p(N.IGNORE,S.EP_DURABLE,oe.durable)),Te(b,de),b}static getOpenMessagePublisher(oe,de,_e,b,X){const ae=new pe(T.OPENPUBFLOW);return ae.smfHeader.pm_corrtag=X,oe!==void 0&&ae.addParameter(new p(N.REJECT,S.LASTMSGIDACKED,oe)),de!==void 0&&ae.addParameter(new p(N.REJECT,S.LASTMSGIDSENT,de)),ae.addParameter(new p(N.REJECT,S.WINDOW,_e)),ae.addParameter(new p(N.IGNORE,S.FLOWNAME,b||"")),ae}static getOpenMessageConsumer(oe,de,_e,b,X,ae,ie,q,Pe=t.UZERO,ve=t.UZERO,Qe=!1,Z,ee){const ge=oe.durable,d=_e.bytes,O=_e.type,D=new pe(T.BIND);D.smfHeader.pm_corrtag=X;const Q=_[O];if(Q===void 0)throw new l("Unknown destination type");if(D.addParameter(new p(N.REJECT,Q,d)),b&&D.addParameter(new p(N.REJECT,S.TOPICNAME,b.bytes)),O===c.QUEUE&&(D.addParameter(new p(N.REJECT,S.LASTMSGIDACKED,Pe)),D.addParameter(new p(N.IGNORE,S.LASTMSGIDRECEIVED,ve))),D.addParameter(new p(N.REJECT,S.WINDOW,ae)),D.addParameter(new p(N.IGNORE,S.EP_DURABLE,ge)),Te(D,de,!0),ie&&D.addParameter(new p(N.REJECT,S.NOLOCAL,1)),q&&D.addParameter(new p(N.IGNORE,S.WANT_FLOW_CHANGE_NOTIFY,1)),Qe&&D.addParameter(new p(N.REJECT,S.FLOWTYPE,2)),Z!==void 0){let re=Z._replayStartValue;Z._type===h.DATE&&(re=t.fromNumber(Z._replayStartValue,!0).multiply(1e6)),D.addParameter(new p(N.REJECT,S.REPLAY_START_LOCATION,{type:Z._type,value:re}))}return ee!==void 0&&D.addParameter(new p(N.IGNORE,S.ENDPOINT_ERROR_ID,ee)),D}static getCloseMessageConsumer(oe,de){const _e=new pe(T.UNBIND);return _e.smfHeader.pm_corrtag=de,_e.addParameter(new p(N.REJECT,S.FLOWID,oe)),_e}static getDTEUnsubscribeMessage(oe,de){const _e=new pe(T.UNSUBSCRIBE);return _e.smfHeader.pm_corrtag=oe,_e.addParameter(new p(N.REJECT,S.DTENAME,de.getBytes())),_e}static getAck(oe,de,_e,b){const X=new pe(T.CLIENTACK);if(X.addParameter(new p(N.REJECT,S.FLOWID,oe)),de&&X.addParameter(new p(N.REJECT,S.LASTMSGIDACKED,de)),_e!=null&&X.addParameter(new p(N.REJECT,_e<=255?S.WINDOW:S.TRANSPORT_WINDOW,_e)),b&&b.length){if(b.length>pe.MAX_CLIENT_ACK_RANGES)throw new l("Application ack range count exceeds limit of 64");X.addParameter(new p(N.REJECT,S.APPLICATION_ACK,b))}return X}static getUnbindAck(oe,de,_e){const b=new pe(T.UNBIND);return b.addParameter(new p(N.REJECT,S.FLOWID,oe)),de&&b.addParameter(new p(N.IGNORE,S.ENDPOINT_ERROR_ID,de)),b}}pe.MAX_CLIENT_ACK_RANGES=64,n.exports.AdProtocolMessage=pe},2981:(n,I,e)=>{const{AdProtocolMessage:r}=e(7780),{BinaryMetaBlock:i}=e(2578),{ClientCtrlMessage:t}=e(7385),{KeepAliveMessage:c}=e(2347),{SMFHeader:l}=e(6631),{SMFParameter:u}=e(2984),{SMFUH:o}=e(3767),{SMPMessage:f}=e(807),{TransportSMFMessage:g}=e(3902);n.exports.AdProtocolMessage=r,n.exports.BinaryMetaBlock=i,n.exports.ClientCtrlMessage=t,n.exports.KeepAliveMessage=c,n.exports.SMFHeader=l,n.exports.SMFParameter=u,n.exports.SMFUH=o,n.exports.SMPMessage=f,n.exports.TransportSMFMessage=g},3493:n=>{n.exports.BaseMessage=class{constructor(I=null,e=[]){this._smfHeader=I,this._parameters=e}addParameter(I){this._parameters[I.getType()]=I}getParameter(I){return this._parameters[I]}getParameterArray(){return this._parameters}get smfHeader(){return this._smfHeader}set smfHeader(I){this._smfHeader=I}getResponse(){const I=this.smfHeader;return I&&I.pm_respcode&&I.pm_respstr?{responseCode:I.pm_respcode,responseString:I.pm_respstr}:null}}},2578:(n,I,e)=>{const{Bits:r,Convert:i}=e(840),{get:t}=r,{int8ToStr:c,int24ToStr:l}=i;class u{constructor(f,g){this.type=f,this.payload=g}asEncodedSmf(){const f=[];return f.push(c(1)),f.push(c(this.type)),f.push(l(this.payload.length)),f.push(this.payload.toString("latin1")),f.join("")}static fromEncodedSmf(f,g=0){if(f.length-g<6)return null;const h=f.readUInt8(g),T=f.readInt32BE(g+1),S=t(T,24,8),C=t(T,0,24),p=4*h+1,R=f.slice(g+p,g+p+C);return new u(S,R)}}n.exports.BinaryMetaBlock=u},7385:(n,I,e)=>{const{AuthenticationScheme:r,CapabilityType:i,ClientCapabilityType:t,MutableSessionProperty:c,SessionProperties:l}=e(5594),{BaseMessage:u}=e(3493),{Bits:o,Convert:f}=e(840),{DestinationType:g,DestinationUtil:h}=e(3170),{ErrorSubcode:T,OperationError:S}=e(3870),{Process:C,StringUtils:p,Version:R}=e(7882),{SMFClientCtrlMessageType:N}=e(9947),{SMFClientCtrlParam:w,SMFClientCtrlAuthType:y}=e(1200),{SMFHeader:P}=e(6631),{SMFParameter:x}=e(2984),{SMFProtocol:B}=e(8958);e(390);const{get:H,set:L}=o,{int8ToStr:M,strToInt8:G,int16ToStr:K,int32ToStr:F,strToInt16:Y,strToInt32:_}=f,{nullTerminate:U,stripNullTerminate:A}=p,{validateAndEncode:z}=h,J=[i.JNDI,i.COMPRESSION,i.GUARANTEED_MESSAGE_CONSUME,i.TEMPORARY_ENDPOINT,i.GUARANTEED_MESSAGE_PUBLISH,i.GUARANTEED_MESSAGE_BROWSE,i.ENDPOINT_MGMT,i.SELECTOR,i.ENDPOINT_MESSAGE_TTL,i.QUEUE_SUBSCRIPTIONS,null,i.SUBSCRIPTION_MANAGER,i.MESSAGE_ELIDING,i.TRANSACTED_SESSION,i.NO_LOCAL,i.ACTIVE_CONSUMER_INDICATION,i.PER_TOPIC_SEQUENCE_NUMBERING,i.ENDPOINT_DISCARD_BEHAVIOR,i.CUT_THROUGH,null,i.MESSAGE_REPLAY,i.COMPRESSED_SSL,null,i.SHARED_SUBSCRIPTIONS,i.BR_REPLAY_ERRORID],se=new Map([[t.UNBIND_ACK,128],[t.BR_ERRORID,64]]);class Te extends u{constructor(ne=0){super(new P(B.CLIENTCTRL,1)),this.msgType=ne,this.version=1}getP2PTopicValue(){const ne=this.getParameter(w.P2PTOPIC);return ne?A(ne.getValue()):null}getVpnNameInUseValue(){const ne=this.getParameter(w.MSGVPNNAME);return ne?A(ne.getValue()):null}getVridInUseValue(){const ne=this.getParameter(w.VRIDNAME);return ne?A(ne.getValue()):null}getUserIdValue(){const ne=this.getParameter(w.USERID);return ne?A(ne.getValue()):null}getRouterCapabilities(){let ne=[],oe=this.getParameter(w.ROUTER_CAPABILITIES);return oe&&(ne=Te.prmParseCapabilitiesValue(oe.getValue(),ne)),oe=this.getParameter(w.SOFTWAREVERSION),oe&&(ne[i.PEER_SOFTWARE_VERSION]=A(oe.getValue())),oe=this.getParameter(w.SOFTWAREDATE),oe&&(ne[i.PEER_SOFTWARE_DATE]=A(oe.getValue())),oe=this.getParameter(w.PLATFORM),oe&&(ne[i.PEER_PLATFORM]=A(oe.getValue())),oe=this.getParameter(w.PHYSICALROUTERNAME),oe&&(ne[i.PEER_ROUTER_NAME]=A(oe.getValue())),ne}static prmGetDtoPriorityValue(ne){if(ne.local===void 0||ne.network===void 0)return!1;let oe=0;return oe=L(oe,ne.local,8,8),oe=L(oe,ne.network,0,8),K(oe)}static prmParseDtoPriorityValue(ne){const oe={},de=Y(ne.substr(0,2));return oe.local=H(de,8,8),oe.network=H(de,0,8),oe}static prmParseCapabilitiesValue(ne,oe){const de=oe;if(!ne||!de)return!1;const _e=i;let b=0;const X=G(ne[b]);let ae;++b;for(let ie=0;ie<X;++ie){const q=7&ie;q===0&&(ae=G(ne[b]),++b);const Pe=J[ie];Pe&&(de[Pe]=!!H(ae,7-q,1))}for(let ie=0;b<ne.length&&ie<500;++ie){const q=G(ne[b]);b++;const Pe=_(ne.substr(b,4))-5;b+=4;const ve=ne.substr(b,Pe);switch(b+=Pe,q){case 0:de[_e.PEER_PORT_SPEED]=ve.length===4?_(ve):0;break;case 1:de[_e.PEER_PORT_TYPE]=ve.length===1?G(ve):0;break;case 2:de[_e.MAX_GUARANTEED_MSG_SIZE]=ve.length===4?_(ve):0;break;case 3:de[_e.MAX_DIRECT_MSG_SIZE]=ve.length===4?_(ve):0}}return de}static getLogin(ne,oe,de,_e){if(!(ne instanceof l))return!1;const b=new Te(N.LOGIN),X=b._smfHeader,ae=ne.authenticationScheme===r.CLIENT_CERTIFICATE;X.pm_corrtag=_e,ne.password&&!ae&&(X.pm_password=ne.password),ne.userName&&(X.pm_username=ne.userName),ne.subscriberLocalPriority&&ne.subscriberNetworkPriority&&b.addParameter(new x(0,w.DELIVERTOONEPRIORITY,Te.prmGetDtoPriorityValue({local:ne.subscriberLocalPriority,network:ne.subscriberNetworkPriority}))),ne.vpnName&&ne.vpnName.length>0&&b.addParameter(new x(1,w.MSGVPNNAME,U(ne.vpnName))),ne.applicationDescription&&ne.applicationDescription.length>0&&b.addParameter(new x(0,w.CLIENTDESC,U(ne.applicationDescription))),ne.userIdentification&&ne.userIdentification.length>0&&b.addParameter(new x(0,w.USERID,U(ne.userIdentification))),ne.authenticationScheme===r.OAUTH2&&(b.addParameter(new x(1,w.AUTHENTICATION_SCHEME,y.OAUTH2)),ne.idToken&&(X.pm_oidc_id_token=U(ne.idToken)),ne.accessToken&&(X.pm_oauth2_access_token=U(ne.accessToken)),ne.issuerIdentifier&&(X.pm_oauth2_issuer_identifier=U(ne.issuerIdentifier))),b.addParameter(new x(0,w.CLIENTNAME,U(ne.clientName))),b.addParameter(new x(0,w.PLATFORM,U(`${C.platform} - JS API (${R.mode})`))),ne.noLocal&&b.addParameter(new x(0,w.NO_LOCAL,"")),ae&&b.addParameter(new x(1,w.AUTHENTICATION_SCHEME,y.CLIENT_CERTIFICATE)),b.addParameter(new x(0,w.SOFTWAREDATE,U(R.formattedDate))),b.addParameter(new x(0,w.SOFTWAREVERSION,U(R.version))),oe&&de?b.addParameter(new x(1,w.SSL_DOWNGRADE,"")):oe?b.addParameter(new x(1,w.SSL_DOWNGRADE,"")):de&&b.addParameter(new x(1,w.SSL_DOWNGRADE,"\0"));const ie=function(Pe){const ve=Math.max.apply(null,Pe)+1;let Qe=0;return Pe.forEach(Z=>{Qe+=se.get(Z)}),M(ve)+M(Qe)}([t.UNBIND_ACK,t.BR_ERRORID]);b.addParameter(new x(0,w.CLIENT_CAPABILITIES,ie));const q=F(ne.keepAliveIntervalInMsecs/1e3);return b.addParameter(new x(0,w.KEEP_ALIVE_INTERVAL,q)),b}static getUpdate(ne,oe,de){const _e=new Te(N.UPDATE);if(_e.smfHeader.pm_corrtag=de,ne===c.CLIENT_DESCRIPTION){const b=(oe||"").toString().substr(0,250);_e.addParameter(new x(0,w.CLIENTDESC,U(b)))}else if(ne===c.CLIENT_NAME){const b=Te.validateClientName(oe,X=>new S(`Invalid clientName: ${X}`,T.PARAMETER_OUT_OF_RANGE));if(b)throw b;_e.addParameter(new x(0,w.CLIENTNAME,U(oe)))}return _e}static validateClientName(ne,oe){const de=z(g.TOPIC,ne,oe);return de.error?de.error:de.bytes.length>161?oe("Client Name too long (max length: 160)."):null}}n.exports.ClientCtrlMessage=Te},2347:(n,I,e)=>{const{BaseMessage:r}=e(3493),{SMFHeader:i}=e(6631),{SMFProtocol:t}=e(8958);n.exports.KeepAliveMessage=class extends r{constructor(){super(new i(t.KEEPALIVEV2,2)),this._smfHeader.smf_uh=2}}},6631:n=>{n.exports.SMFHeader=class{constructor(I=0,e=0){this._parameters=[],this.smf_version=3,this.smf_uh=0,this.smf_protocol=I,this.smf_priority=0,this.smf_ttl=e,this.smf_msgLen=0,this.smf_di=0,this.smf_tqd=0,this.smf_elidingEligible=0,this.smf_dto=0,this.smf_adf=0,this.smf_deadMessageQueueEligible=0,this.pm_userdata=null,this.pm_respcode=0,this.pm_respstr=null,this.pm_username=null,this.pm_password=null,this.pm_tr_topicname_bytes=null,this.pm_deliverymode=null,this.pm_ad_msgid=void 0,this.pm_ad_prevmsgid=void 0,this.pm_ad_redelflag=0,this.pm_ad_flowredelflag=0,this.pm_ad_ttl=void 0,this.pm_ad_ackimm=void 0,this.pm_ad_flowid=0,this.pm_ad_publisherid=0,this.pm_ad_publishermsgid=0,this.pm_content_summary=null,this.pm_corrtag=null,this.pm_topic_offset=0,this.pm_topic_len=0,this.pm_queue_offset=0,this.pm_queue_len=0,this.pm_msg_priority=null,this.pm_oauth2_access_token=null,this.pm_oidc_id_token=null,this.pm_oauth2_issuer_identifier=null,this.unknownProtoFlag=!1,this.messageLength=0,this.payloadLength=0,this.headerLength=0,this.payload=null,this.discardMessage=!1}setMessageSizes(I,e){this.headerLength=I,this.payloadLength=e,this.messageLength=I+e}setPayloadSize(I){this.payloadLength=I}}},2984:n=>{n.exports.SMFParameter=class{constructor(I,e,r,i,t,c){this._type=e,this._value=r,this._uh=I,this._buffer=i,this._begin=t,this._end=c}getType(){return this._type}getValue(){return this._buffer&&!this._value?this._buffer.toString("latin1",this._begin,this._end):this._value}getUh(){return this._uh}getBuffer(){return this._buffer}getBegin(){return this._begin}getEnd(){return this._end}toString(){return`${this._uh}:0x${this._type.toString(16)} = ${this.getValue()}`}}},3767:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFUH=r.new({IGNORE:0,REJECT:2})},807:(n,I,e)=>{const{assert:r}=e(9359),{BaseMessage:i}=e(3493),{Destination:t,DestinationUtil:c}=e(3170),{SMFHeader:l}=e(6631),{SMFProtocol:u}=e(8958),{SMFSMPMessageType:o}=e(6874),{SMFSMPMessageTypeFlags:f}=e(8488);class g extends i{constructor(){super(new l(u.SMP,1)),this.msgType=0,this.encodedUtf8Subscription=null,this.encodedUtf8QueueName=null,this.smpFlags=0|f.SMF_SMP_FLAG_TOPIC,this._encodedQueueName=null,this._encodedClientName=null}isFlag(T){return this.smpFlags&T}setFlag(T,S){S?this.smpFlags|=T:this.smpFlags&=~T}static getSubscriptionMessage(T,S,C,p){r(S instanceof t,"Topics are not UCS-2 strings. Pass a Topic object.");const R=new g;return R.msgType=C?o.ADDSUBSCRIPTION:o.REMSUBSCRIPTION,R.encodedUtf8Subscription=S.getBytes(),r(R.encodedUtf8Subscription,"Topic had no encoding"),R.setFlag(f.SMF_SMP_FLAG_TOPIC,!0),p&&R.setFlag(f.SMF_SMP_FLAG_RESPREQUIRED,!0),R._smfHeader.pm_corrtag=T,R}static getQueueSubscriptionMessage(T,S,C,p){r(S instanceof t,"Topics are not UCS-2 strings. Pass a Topic object.");const R=new g;return R.msgType=p?o.ADDQUEUESUBSCRIPTION:o.REMQUEUESUBSCRIPTION,R.encodedUtf8QueueName=c.encodeBytes(C.getName()),R.encodedUtf8Subscription=S.getBytes(),r(R.encodedUtf8Subscription,"Topic had no encoding"),r(R.encodedUtf8QueueName,"Queue had no encoding"),R.setFlag(f.SMF_SMP_FLAG_TOPIC,!0),R.setFlag(f.SMF_SMP_FLAG_RESPREQUIRED,!0),R.setFlag(f.SMF_SMP_FLAG_PERSIST,!0),R._smfHeader.pm_corrtag=T,R}}n.exports.SMPMessage=g},3902:(n,I,e)=>{const{BaseMessage:r}=e(3493);n.exports.TransportSMFMessage=class extends r{constructor(){super(null,null),this.uh=0,this.messageType=null,this.sessionId=null,this.routerTag=null,this.payload=null,this.payloadLength=0,this.tsHeaderLength=0}}},948:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFAdProtocolMessageType=r.new({OPENPUBFLOW:0,CLIENTACK:3,BIND:4,UNBIND:5,UNSUBSCRIBE:6,CLOSEPUBFLOW:7,CREATE:8,DELETE:9,TRANSACTIONCTRL:11,FLOWCHANGEUPDATE:12,XACTRL:14,CLIENTNACK:15})},4786:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFAdProtocolParam=r.new({LASTMSGIDSENT:1,LASTMSGIDACKED:2,WINDOW:3,TRANSPORT_PRIORITY:4,APPLICATION_ACK:5,FLOWID:6,QUEUENAME:7,DTENAME:8,TOPICNAME:9,FLOWNAME:10,EP_DURABLE:11,ACCESSTYPE:12,SELECTOR:13,TRANSPORT_WINDOW:14,LINGER_OPTION:15,LASTMSGIDRECEIVED:16,EP_ALLOTHER_PERMISSION:17,FLOWTYPE:18,EP_QUOTA:19,EP_MAX_MSGSIZE:20,GRANTED_PERMISSIONS:21,EP_RESPECTS_TTL:22,TRANSACTION_CTRL_MESSAGE_TYPE:23,TRANSACTED_SESSION_ID:24,TRANSACTED_SESSION_NAME:25,TRANSACTION_ID:26,TRANSACTED_SESSION_STATE:27,TRANSACTION_FLOW_DESCRIPTOR_PUB_NOTIFY:28,TRANSACTION_FLOW_DESCRIPTOR_PUB_ACK:29,TRANSACTION_FLOW_DESCRIPTOR_SUB_ACK:30,NOLOCAL:31,ACTIVE_FLOW_INDICATION:32,WANT_FLOW_CHANGE_NOTIFY:33,EP_BEHAVIOUR:34,PUBLISHER_ID:35,APPLICATION_PUB_ACK:36,NUM_MESSAGES_SPOOLED:37,CUT_THROUGH:38,PUBLISHER_FLAGS:39,APP_MSG_ID_TYPE:40,QUEUE_ENDPOINT_HASH:41,MAX_REDELIVERY:42,PAYLOAD:43,ENDPOINT_ID:44,ACK_SEQUENCE_NUMBER:45,ACK_RECONCILE_REQUEST:46,START_OF_ACK_RECONCILE:47,TIMESTAMP:48,MAX_DELIVERED_UNACKED_MESSAGES_PER_FLOW:49,REPLAY_START_LOCATION:51,ENDPOINT_ERROR_ID:52,SPOOLER_UNIQUE_ID:54})},9947:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFClientCtrlMessageType=r.new({LOGIN:0,UPDATE:1})},1200:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFClientCtrlAuthType=r.new({CLIENT_CERTIFICATE:"",OAUTH2:`
`}),n.exports.SMFClientCtrlParam=r.new({SOFTWAREVERSION:0,SOFTWAREDATE:1,PLATFORM:2,USERID:3,CLIENTDESC:4,CLIENTNAME:5,MSGVPNNAME:6,DELIVERTOONEPRIORITY:7,P2PTOPIC:8,ROUTER_CAPABILITIES:9,VRIDNAME:10,PHYSICALROUTERNAME:12,BRIDGE_MSG_VPN_NAME:13,BRIDGE_ROUTER_NAME:14,NO_LOCAL:15,BRIDGE_VERSION:16,AUTHENTICATION_SCHEME:17,CONNECTION_TYPE:18,ROUTER_CAPABILITIES_EXTENDED:19,REQUIRES_RELEASE_7:20,SSL_DOWNGRADE:21,CLIENT_CAPABILITIES:23,KEEP_ALIVE_INTERVAL:24})},2095:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFParameterType=r.new({PADDING:0,PUBLISHER_ID:1,PUBLISHER_MSGID:2,MESSAGEPRIORITY:3,USERDATA:4,USERNAME:6,PASSWORD:7,RESPONSE:8,SUB_ID_LIST:10,GENERIC_ATTACHMENT:11,BINARY_ATTACHMENT:12,DELIVERY_MODE:16,ASSURED_MESSAGE_ID:17,ASSURED_PREVMESSAGE_ID:18,ASSURED_REDELIVERED_FLAG:19,MESSAGE_CONTENT_SUMMARY:22,ASSURED_FLOWID:23,TR_TOPICNAME:24,AD_FLOWREDELIVERED_FLAG:25,AD_TIMETOLIVE:28,AD_TOPICSEQUENCE_NUMBER:30,EXTENDED_TYPE_STREAM:31,AD_ACK_MESSAGE_ID:41,AD_SPOOLER_UNIQUE_ID:44,AD_REPL_MATE_ACK_MSGID:45,AD_REDELIVERY_COUNT:46,LIGHT_CORRELATION:0,LIGHT_TOPIC_NAME_OFFSET:1,LIGHT_QUEUE_NAME_OFFSET:2,LIGHT_ACK_IMMEDIATELY:3}),n.exports.SMFExtendedParameterType=r.new({OAUTH2_ISSUER_IDENTIFIER:47,OIDC_ID_TOKEN:48,OAUTH2_ACCESS_TOKEN:49})},8958:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFProtocol=r.new({CSPF:1,CSMP:2,PUBMSG:3,XMLLINK:4,WSE:5,SEMP:6,SUBCTRL:7,PUBCTRL:8,ADCTRL:9,KEEPALIVE:10,KEEPALIVEV2:11,CLIENTCTRL:12,TRMSG:13,JNDI:14,SMP:15,SMRP:16,SMF_IN_SMF:17,SMF_IN_RV:18,ADCTRL_PASSTHROUGH:19,TSESSION:20})},8488:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFSMPMessageTypeFlags=r.new({FLAG_FILTER:1,FLAG_PERSIST:2,SMF_SMP_FLAG_TOPIC:4,SMF_SMP_FLAG_RESPREQUIRED:8,SMF_SMP_FLAG_DELIVERALWAYS:16})},6874:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFSMPMessageType=r.new({ADDSUBSCRIPTION:0,REMSUBSCRIPTION:1,ADDQUEUESUBSCRIPTION:2,REMQUEUESUBSCRIPTION:3,ADDSUBSCRIPTIONFORCLIENTNAME:4,REMSUBSCRIPTIONFORCLIENTNAME:5})},5752:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.SMFTransportSessionMessageType=r.new({CREATE:0,CREATE_RESP:1,DESTROY:2,DESTROY_RESP:3,DATA:4,DATA_TOKEN:5,DATA_STREAM_TOKEN:6})},1843:(n,I,e)=>{const{CacheCBInfo:r}=e(5417),{CacheContext:i}=e(748),{CacheLiveDataAction:t}=e(5563),{CacheRequest:c}=e(4802),{CacheRequestResult:l}=e(4449),{CacheReturnCode:u}=e(372),{CacheReturnSubcode:o}=e(2698),{CacheSession:f}=e(1460),{CacheSessionProperties:g}=e(1166);n.exports.CacheCBInfo=r,n.exports.CACHE_REQUEST_PREFIX=i.CACHE_REQUEST_PREFIX,n.exports.CacheLiveDataAction=t,n.exports.CacheRequestResult=l,n.exports.CacheReturnCode=u,n.exports.CacheReturnSubcode=o,n.exports.CacheRequest=c,n.exports.CacheSession=f,n.exports.CacheSessionProperties=g},5417:n=>{n.exports.CacheCBInfo=class{constructor(I,e){this.cacheCBFunction=I,this.userObject=e}getCallback(){return this.cacheCBFunction}getUserObject(){return this.userObject}}},748:n=>{n.exports.CacheContext={CACHE_REQUEST_PREFIX:"#CRQ",cacheRequestCorrelationId:0}},7263:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CacheGetResultCode=r.new({INVALID:0,OK:1})},1981:(n,I,e)=>{const{CacheGetResultCode:r}=e(7263),i={messageID:null,version:0,responseCode:r.INVALID,responseString:"",matchTopic:"",sessionID:null,isSuspect:null,hasMore:null,hasTimestamps:null,replyTo:null,messageStream:null,clusterNameStream:null};n.exports.CacheGetResult=class{constructor(t=i){Object.assign(this,t)}readFromStream(t){this.messageID=t.getNext().getValue(),this.version=t.getNext().getValue(),this.responseCode=t.getNext().getValue(),this.responseString=t.getNext().getValue(),this.matchTopic=t.getNext().getValue(),this.sessionID=t.getNext().getValue(),this.isSuspect=t.getNext().getValue(),this.hasMore=t.getNext().getValue(),this.hasTimestamps=t.getNext().getValue(),t.hasNext()&&(this.messageStream=t.getNext().getValue()),t.hasNext()&&(this.clusterNameStream=this.messageStream,this.messageStream=t.getNext().getValue())}}},5563:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CacheLiveDataAction=r.new({FULFILL:1,QUEUE:2,FLOW_THRU:3})},4449:n=>{n.exports.CacheRequestResult=class{constructor(I,e,r,i){this._returnCode=I,this._subcode=e,this._topic=r,this._error=i}getReturnCode(){return this._returnCode}getReturnSubcode(){return this._subcode}getTopic(){return this._topic}getError(){return this._error}}},5507:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CacheRequestType=r.new({INVALID:0,BULK_MSG:1,REGISTER_REQUEST:2,REGISTER_RESPONSE:3,HEARTBEAT_REQUEST:4,HEARTBEAT_RESPONSE:5,EVENT_NOTIFY:6,EVENT_ACK:7,ACTION_REQUEST:8,ACTION_RESPONSE:9,GET_REQUEST:10,GET_RESPONSE:11,GET_NEXT_REQUEST:12,GET_NEXT_RESPONSE:13,SET_REQUEST:14,SET_RESPONSE:15,GET_MSG_REQUEST:16,GET_MSG_RESPONSE:17,GET_NEXT_MSG_REQUEST:18,GET_NEXT_MSG_RESPONSE:19,UNREGISTER_IND:20,BULK_SET_REQUEST:21,BULK_SET_RESPONSE:22,PURGE_MSG_SEQUENCE_REQUEST:23,PURGE_MSG_SEQUENCE_RESPONSE:24,GET_MSG_SEQUENCE_REQUEST:25,GET_NEXT_MSG_SEQUENCE_REQUEST:26,GET_TOPIC_INFO_REQUEST:27,GET_TOPIC_INFO_RESPONSE:28,READY_MARKER:29,GET_TOPIC_INFO_REQUEST_RANGE:30,SYNC_READY_MARKER:31,VACUUM_REQUEST:32,VACUUM_RESPONSE:33})},4802:(n,I,e)=>{const{CacheContext:r}=e(748);e(390);const{CACHE_REQUEST_PREFIX:i}=r;class t{constructor(l,u,o,f,g,h,T){this.cacheSession=l,this.cacheMessageType=u,this.requestID=o,this.cbInfo=f,this.liveDataAction=g,this.topic=h,this.cacheName=T,this.subscriptionWaiting=null,this.replyReceived=!1,this.dataReceived=!1,this.isSuspect=!1,this.correlationID=`${i}${r.cacheRequestCorrelationId++}`,this.childRequests=[],this.parentRequest=null,this.queuedLiveData=[],this.liveDataFulfilled=!1,this.timeoutHandle=null}getRootRequest(){return this.parentRequest?this.parentRequest.getRootRequest():this}addChild(l){if(!(l instanceof t))throw new Error(`Invalid child ${l}`);if(l===this)throw new Error("Constructing circular child reference");const u=l;u.parentRequest=this,this.childRequests.push(u)}removeChild(l){if(l===this)throw new Error("Attempting to deconstruct invalid circular child reference");const u=l,o=this.childRequests.indexOf(u);this.childRequests.splice(o,1),u.parentRequest=null}collapse(){const l=this.parentRequest;l.isSuspect=l.isSuspect||this.isSuspect,l.dataReceived=l.dataReceived||this.dataReceived,l.removeChild(this)}cancel(){for(this.parentRequest&&this.collapse();this.childRequests.length;){const l=this.childRequests.shift();l.childRequests&&l.cancel(),this.removeChild(l)}this.clearRequestTimeout()}getRequestID(){return this.requestID}getCBInfo(){return this.cbInfo}getTopic(){return this.topic}getLiveDataAction(){return this.liveDataAction}startRequestTimeout(l,u){this.timeoutHandle=setTimeout(()=>{l(this)},u)}clearRequestTimeout(){this.timeoutHandle!==null&&this.timeoutHandle!==void 0&&(clearTimeout(this.timeoutHandle),this.timeoutHandle=null)}toString(){return`CacheRequest[correlationID=${this.correlationID},requestID=${this.requestID},cacheName=${this.cacheName},topic=${this.topic.getName()}]`}}t.VERSION=1,t.DEFAULT_REPLY_SIZE_LIMIT=1e6,t.REPLY_SIZE_LIMIT=t.DEFAULT_REPLY_SIZE_LIMIT,n.exports.CacheRequest=t},372:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CacheReturnCode=r.new({OK:1,FAIL:2,INCOMPLETE:3})},2698:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.CacheReturnSubcode=r.new({REQUEST_COMPLETE:0,LIVE_DATA_FULFILL:1,ERROR_RESPONSE:2,INVALID_SESSION:3,REQUEST_TIMEOUT:4,REQUEST_ALREADY_IN_PROGRESS:5,NO_DATA:6,SUSPECT_DATA:7,CACHE_SESSION_DISPOSED:8,SUBSCRIPTION_ERROR:9})},1166:n=>{n.exports.CacheSessionProperties=class{constructor(I,e,r,i){this.cacheName=I,this.maxAgeSec=e||0,this.maxMessages=r??1,this.timeoutMsec=i||1e4,this.includeOtherClusters=!0,this.cachePrefix="#P2P/CACHEINST/"}getCacheName(){return this.cacheName}setCacheName(I){this.cacheName=I}getMaxMessageAgeSec(){return this.maxAgeSec}setMaxMessageAgeSec(I){this.maxAgeSec=I}getMaxMessages(){return this.maxMessages}setMaxMessages(I){this.maxMessages=I}getTimeoutMsec(){return this.timeoutMsec}setTimeoutMsec(I){this.timeoutMsec=I}}},6303:n=>{n.exports.CacheSessionSubscribeInfo=class{constructor(I,e,r){Object.assign(this,{correlationID:I,topic:e,cacheSession:r})}}},1460:(n,I,e)=>{const r=e(4789),i=e(5594),t=e(7291),c=e(6818),{ErrorSubcode:l,OperationError:u}=e(3870),{LOG_TRACE:o,LOG_DEBUG:f,LOG_INFO:g,LOG_WARN:h}=e(390),{SDTField:T,SDTFieldType:S,SDTStreamContainer:C}=e(7252),{CacheCBInfo:p}=e(5417),{CacheContext:R}=e(748),{CacheGetResult:N}=e(1981),{CacheLiveDataAction:w}=e(5563),{CacheRequest:y}=e(4802),{CacheRequestResult:P}=e(4449),{CacheRequestType:x}=e(5507),{CacheReturnCode:B}=e(372),{CacheReturnSubcode:H}=e(2698),{CacheSessionProperties:L}=e(1166),{CacheSessionSubscribeInfo:M}=e(6303),{Destination:G,Topic:K}=e(3170),{CACHE_REQUEST_PREFIX:F}=R,Y=()=>{};class _{constructor(A,z,J){_._validateProps(A);const se=new L(A.cacheName,A.maxAgeSec,A.maxMessages,A.timeoutMsec);Object.assign(this,{_outstandingRequests:{},_outstandingIDs:{},_disposed:!1,_nextMessageCallbackInfo:null,_nextSessionEventCallbackInfo:null,_properties:se,_session:z,_sessionIF:J}),this._connectToSession(z)}_connectToSession(A){this._nextSessionEventCallbackInfo=A.getEventCBInfo(),this._nextMessageCallbackInfo=A.getMessageCBInfo(),A.setMessageCBInfo(new i.MessageRxCBInfo((z,J)=>{this._handleMessage(J)},this)),A.setEventCBInfo(this._createCompoundEventCB(this._nextSessionEventCallbackInfo))}_createCompoundEventCB(A){return new i.SessionEventCBInfo((z,J,se,Te)=>{this._handleSessionEvent(A,z,J,se,Te)},null)}_handleSessionEvent(A,z,J){if(!this._processSessionEvent(z,J))return;const se=A.userObject;se?A.sessionEventCBFunction(z,J,se):A.sessionEventCBFunction(z,J)}_sendToNextDelegate(A){const z=this._nextMessageCallbackInfo.userObject;z?this._nextMessageCallbackInfo.messageRxCBFunction(this._session,A,z):this._nextMessageCallbackInfo.messageRxCBFunction(this._session,A)}_processSessionEvent(A,z){switch(z.sessionEventCode){case i.SessionEventCode.SUBSCRIPTION_ERROR:case i.SessionEventCode.SUBSCRIPTION_OK:return this._checkSubscriptionStatus(z);case i.SessionEventCode.DOWN_ERROR:return this.dispose(),!0;default:return z.sessionEventCode,!0}}_checkSubscriptionStatus(A){if(A.correlationKey===null||A.correlationKey===void 0||!(A.correlationKey instanceof M)||A.correlationKey.cacheSession!==this)return!0;const z=this._getOutstandingRequest(A.correlationKey.correlationID);return z?A.sessionEventCode===i.SessionEventCode.SUBSCRIPTION_OK?(this._handleSubscriptionSuccess(z,A.correlationKey.topic),!1):(this._handleSubscriptionError(z,A),!1):(h(`No request found for subscription success on ${A.correlationKey.topic}`),!0)}_handleSubscriptionSuccess(A){const z=A;z.subscriptionWaiting=null,this._startCacheRequest(z)}_handleSubscriptionError(A){this._terminateRequest(A,B.FAIL,H.SUBSCRIPTION_ERROR)}_checkRequestCompletion(A){if(A.childRequests.length)return void A.childRequests.length;if(A.subscriptionWaiting||A.timeoutHandle!==null&&!A.replyReceived)return;if(A.parentRequest){const se=A.parentRequest;return A.cancel(),this._unregisterRequest(A),void this._checkRequestCompletion(se)}let z,J;if(A.isSuspect)z=B.INCOMPLETE,J=H.SUSPECT_DATA;else if(A.dataReceived)z=B.OK,J=A.liveDataFulfilled?H.LIVE_DATA_FULFILL:H.REQUEST_COMPLETE;else{if(!A.replyReceived)throw new Error("Sanity: should never happen");z=B.INCOMPLETE,J=H.NO_DATA}this._terminateRequest(A,z,J)}_sendSeeOther(A,z){const J=z.clusterNameStream.getNext().getValue(),se=new y(this,x.GET_MSG_REQUEST,A.requestID,new p(Y,null),A.liveDataAction,A.topic,J);A.addChild(se),this._registerRequest(se),se.startRequestTimeout(_._handleCacheRequestTimeout,this._properties.timeoutMsec),this._startCacheRequest(se,null,null,!0)}_sendGetNext(A,z){const J=new y(this,x.GET_NEXT_MSG_REQUEST,A.requestID,new p(Y,null),A.liveDataAction,A.topic,A.cacheName);A.addChild(J),this._registerRequest(J),J.startRequestTimeout(_._handleCacheRequestTimeout,this._properties.timeoutMsec),this._startCacheRequest(J,z.sessionID,z.replyTo)}_handleMessage(A){const z=A.getCorrelationId(),J=z==null?null:this._outstandingRequests[z];if(!J)return void(this._relevantLiveData(A)&&this._sendToNextDelegate(A));J.clearRequestTimeout();const se=A.getSdtContainer(),Te=se&&se.getValue();if(Te||(g(`Invalid message format for cache response: no SDT container (${se}) or stream (${Te})`),this._terminateRequest(J,B.FAIL,H.ERROR_RESPONSE)),this._incStat(c.RX_REPLY_MSG_RECVED),J.replyReceived=!0,J.getRootRequest().liveDataFulfilled)return this._incStat(c.CACHE_REQUEST_FULFILL_DISCARD_RESPONSE),void this._checkRequestCompletion(J);if(Te)try{const pe=new N;pe.readFromStream(Te),pe.replyTo=A.getReplyTo(),pe.responseString&&pe.responseString,pe.responseCode!==7&&pe.responseString!="Invalid Session"||(g(`Cluster response indicates invalid session: ${pe.responseString} code: ${pe.responseCode}`),this._terminateRequest(J,B.FAIL,H.INVALID_SESSION)),J.isSuspect=J.isSuspect||pe.isSuspect;const ne=_._decodeMessageStream(J,pe);if(this._incStat(c.RX_CACHE_MSG,ne.length),pe.hasMore&&this._sendGetNext(J,pe),pe.clusterNameStream)for(;pe.clusterNameStream.hasNext();)this._sendSeeOther(J,pe);ne&&ne.forEach(oe=>{this._sendToNextDelegate(oe)}),this._checkRequestCompletion(J)}catch(pe){g(`Invalid message format for cache response: ${pe.stack}`),this._terminateRequest(J,B.FAIL,H.ERROR_RESPONSE)}else g("Invalid cache response did not fulfill request. Skipping response processing")}_relevantLiveData(A){return!A.getCorrelationId()||!A.getCorrelationId().startsWith(F)||this._nextMessageCallbackInfo.userObject instanceof _?Object.keys(this._outstandingRequests).every(z=>this._performLiveDataAction(this._outstandingRequests[z],A)):(h("DROP: Dropping CRQ reply due to no remaining Cache Session processors on message callback chain"),this._incStat(c.RX_REPLY_MSG_DISCARD),!1)}_performLiveDataAction(A,z){const J=A;switch(J.dataReceived=!0,J.liveDataAction){case w.QUEUE:return J.queuedLiveData.push(z),!1;case w.FULFILL:return J.liveDataFulfilled||this._fulfillRequest(J),!0;default:return!0}}_fulfillRequest(A){const z=A;z.liveDataFulfilled=!0,this._trackCompletionStats(B.OK,H.LIVE_DATA_FULFILL),setTimeout(()=>{_._notifyCallback(z,B.OK,H.LIVE_DATA_FULFILL,z.getTopic(),null)},0)}dispose(){Object.keys(this._outstandingRequests).map(A=>this._outstandingRequests[A]).filter(A=>A instanceof y).forEach(A=>{this._terminateRequest(A,B.INCOMPLETE,H.CACHE_SESSION_DISPOSED)}),this._outstandingRequests=[],this._session.setEventCBInfo(this._nextSessionEventCallbackInfo),this._session.setMessageCBInfo(this._nextMessageCallbackInfo),this._disposed=!0}getProperties(){return this._properties}sendCacheRequest(A,z,J,se,Te){if(arguments.length!==5)throw new u(`sendCacheRequest() invoked with an illegal argument count of ${arguments.length}`);if(typeof J!="boolean")throw new u("Invalid subscribe flag argument, should be a boolean but was "+typeof J);if(typeof A!="number"||Number.isNaN(A))throw new u("Invalid requestID",l.PARAMETER_INVALID_TYPE,null);if(this._outstandingIDs[A])throw new u("Request already in progress with this requestID");if(!(z instanceof G))throw new u("Invalid topic",l.PARAMETER_INVALID_TYPE,typeof z);if(z.validate(),se!==w.FLOW_THRU&&se!==w.FULFILL&&se!==w.QUEUE)throw new u("Invalid live data action",l.PARAMETER_OUT_OF_RANGE);if(z.isWildcarded()&&se!==w.FLOW_THRU)throw new u("Wildcarded topic not supported for this live data action",l.PARAMETER_CONFLICT);if(!(Te instanceof p))throw new u("Callback info was not an instance of CacheCBInfo");if(this._disposed)return void _._notifyCallbackError(Te,A,B.FAIL,H.CACHE_SESSION_DISPOSED,z,"Cache request failed: the cache session is disposed.");if(this._session._disposed)return void _._notifyCallbackError(Te,A,B.FAIL,H.INVALID_SESSION,z,"Cache request failed: the session is disposed.");const pe=new y(this,x.GET_MSG_REQUEST,A,Te,se,z,this._properties.cacheName),ne=Object.keys(this._outstandingRequests).filter(oe=>this._outstandingRequests[oe].topic.getName()===z.getName());if(ne.length){const oe=se!==w.FLOW_THRU?ne:ne.filter(de=>this._outstandingRequests[de].liveDataAction!==w.FLOW_THRU);if(oe.length){const de=this._outstandingRequests[oe[0]];return h(`Existing request ${de} conflicts. Rejecting request ${pe}`),this._registerRequest(pe),void this._terminateRequest(pe,B.FAIL,H.REQUEST_ALREADY_IN_PROGRESS)}}if(this._registerRequest(pe),pe.startRequestTimeout(_._handleCacheRequestTimeout,this._properties.timeoutMsec),J){const oe=new M(pe.correlationID,z,this);return pe._subscriptionWaiting=oe,void this._session.subscribe(z,!0,oe)}this._startCacheRequest(pe)}_handleCacheRequestFailed(A,z,J){this._terminateRequest(J.getRequestID(),B.FAIL,H.ERROR_RESPONSE)}_registerRequest(A){this._outstandingRequests[A.correlationID]=A,A.parentRequest||(this._outstandingIDs[A.requestID]=A)}_getOutstandingRequest(A){return this._outstandingRequests[A]}_startCacheRequest(A,z,J,se){const Te=new r.Message;Te.setCorrelationId(A.correlationID),J?Te.setDestination(J):Te.setDestination(K.createFromName(this._properties.cachePrefix+A.cacheName)),Te.setReplyTo(K.createFromName(this._session.getSessionProperties().p2pInboxInUse)),Te.setDeliverToOne(A.cacheMessageType===x.GET_MSG_REQUEST);const pe=new C;pe.addField(S.UINT32,A.cacheMessageType),pe.addField(S.UINT32,y.VERSION),pe.addField(S.STRING,A.topic.getName()),pe.addField(S.UINT32,y.REPLY_SIZE_LIMIT),typeof z=="number"&&pe.addField(S.UINT32,z),pe.addField(S.UINT32,this._properties.maxMessages),pe.addField(S.UINT32,this._properties.maxAgeSec),A.cacheMessageType===x.GET_MSG_REQUEST&&pe.addField(S.BOOL,this._properties.includeOtherClusters&&!se),pe.addField(S.BOOL,!1),A.cacheMessageType===x.GET_MSG_REQUEST&&pe.addField(S.UINT32,Math.round(this._properties.timeoutMsec/1e3)),Te.setSdtContainer(T.create(S.STREAM,pe));try{this._session.send(Te),A.parentRequest||this._incStat(c.CACHE_REQUEST_SENT)}catch(ne){g(`Failed to send request: ${ne.message}`),this._terminateRequest(A,B.FAIL,H.ERROR_RESPONSE,ne)}}_incStat(A,z){this._session&&(this._sessionIF?this._sessionIF.incStat(A,z):g("Can't log stat: session statistics not available"))}_unregisterRequest(A){delete this._outstandingRequests[A.correlationID],delete this._outstandingIDs[A.requestID]}_trackCompletionStats(A,z){switch(A){case B.OK:this._incStat(c.CACHE_REQUEST_OK_RESPONSE),z===H.LIVE_DATA_FULFILL&&this._incStat(c.CACHE_REQUEST_LIVE_DATA_FULFILL);break;case B.INCOMPLETE:this._incStat(c.CACHE_REQUEST_INCOMPLETE_RESPONSE);break;case B.FAIL:this._incStat(c.CACHE_REQUEST_FAIL_RESPONSE);break;default:throw new Error("Sanity: no return code supplied")}}_terminateRequest(A,z,J,se){const Te=A.getRootRequest();if(!this._outstandingRequests[Te.correlationID])return;const pe=Te.cbInfo;if(!pe)return void h(`No callback info provided for ${Te}. Cannot notify`);if(!pe.getCallback())return void h(`No callback provided for ${Te}. Cannot notify`);const ne=Te.getTopic();ne||h(`No topic provided for ${Te}`),Te.queuedLiveData.forEach(oe=>this._sendToNextDelegate(oe)),Te.cancel(),this._unregisterRequest(Te),Te.liveDataFulfilled||(this._trackCompletionStats(z,J),_._notifyCallback(Te,z,J,ne,se))}static _decodeMessageStream(A,z){if(!z.messageStream)return[];const J=[],se=A;for(;z.messageStream.hasNext();){se.dataReceived=!0;const Te=z.messageStream.getNext().getValue(),pe=t.Codec.Decode.decodeCompoundMessage(Te,0);if(!pe)continue;const ne=z.isSuspect?r.MessageCacheStatus.SUSPECT:r.MessageCacheStatus.CACHED;pe._setCacheStatus(ne),pe._setCacheRequestID(se.requestID),J.push(pe)}return J.length,J}static _handleCacheRequestTimeout(A){const z=A.cacheSession;z._getOutstandingRequest(A.correlationID)?(g(`Request ${A} timed out`),z._terminateRequest(A.getRootRequest(),B.INCOMPLETE,H.REQUEST_TIMEOUT)):g(`Timeout for ${A} was not unregistered. Ignoring`)}static _notifyCallback(A,z,J,se,Te){const pe=A.cbInfo;pe.getCallback()(A.requestID,new P(z,J,se,Te),pe.getUserObject())}static _notifyCallbackError(A,z,J,se,Te,pe){A.getCallback()(z,new P(J,se,Te,pe),A.getUserObject())}static _validateProps(A){if(typeof A.cacheName!="string")throw new u("Invalid parameter type for cacheName",l.PARAMETER_INVALID_TYPE);if(K.createFromName(A.cacheName).isWildcarded())throw new u(`Invalid cacheName '${A.cacheName}'. The cacheName cannot be wildcarded`,l.PARAMETER_OUT_OF_RANGE);if(typeof A.maxAgeSec!="number")throw new u("Invalid parameter type for maxAgeSec",l.PARAMETER_INVALID_TYPE);if(A.maxAgeSec<0)throw new u("Invalid value for maxAgeSec; must be >= 0",l.PARAMETER_OUT_OF_RANGE);if(typeof A.maxMessages!="number")throw new u("Invalid parameter type for maxMessages",l.PARAMETER_INVALID_TYPE);if(A.maxMessages<0)throw new u("Invalid value for maxMessages; must be >= 0",l.PARAMETER_OUT_OF_RANGE);if(typeof A.timeoutMsec!="number")throw new u("Invalid parameter type for timeoutMsec",l.PARAMETER_INVALID_TYPE);if(A.timeoutMsec<3e3)throw new u("Invalid value for timeoutMsec; must be >= 3000",l.PARAMETER_OUT_OF_RANGE)}}n.exports.CacheSession=_},6818:(n,I,e)=>{const{Stats:r}=e(7533),{StatsByMode:i}=e(7466),{StatType:t}=e(4266);n.exports={Stats:r,StatType:t,StatsByMode:i}},7466:(n,I,e)=>{const{StatType:r}=e(4266);n.exports={StatsByMode:{STAT_TX_BYMODE_MSGS:[r.TX_DIRECT_MSGS,r.TX_PERSISTENT_MSGS,r.TX_NONPERSISTENT_MSGS],STAT_TX_BYMODE_BYTES:[r.TX_DIRECT_BYTES,r.TX_PERSISTENT_BYTES,r.TX_NONPERSISTENT_BYTES],STAT_TX_BYMODE_REDELIVERED:[r.TX_DIRECT_MSGS,r.TX_PERSISTENT_REDELIVERED,r.TX_NONPERSISTENT_REDELIVERED],STAT_TX_BYMODE_BYTES_REDELIVERED:[r.TX_DIRECT_BYTES,r.TX_PERSISTENT_BYTES_REDELIVERED,r.TX_NONPERSISTENT_BYTES_REDELIVERED],STAT_RX_BYMODE_MSGS:[r.RX_DIRECT_MSGS,r.RX_PERSISTENT_MSGS,r.RX_NONPERSISTENT_MSGS],STAT_RX_BYMODE_BYTES:[r.RX_DIRECT_BYTES,r.RX_PERSISTENT_BYTES,r.RX_NONPERSISTENT_BYTES]}}},4266:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.StatType=r.new({TX_TOTAL_DATA_BYTES:0,TX_TOTAL_DATA_MSGS:1,TX_DIRECT_BYTES:2,TX_DIRECT_MSGS:3,TX_CONTROL_BYTES:4,TX_CONTROL_MSGS:5,TX_REQUEST_SENT:6,TX_REQUEST_TIMEOUT:7,RX_TOTAL_DATA_BYTES:8,RX_TOTAL_DATA_MSGS:9,RX_DIRECT_BYTES:10,RX_DIRECT_MSGS:11,RX_CONTROL_BYTES:12,RX_CONTROL_MSGS:13,RX_DISCARD_MSG_INDICATION:14,RX_REPLY_MSG_RECVED:15,RX_REPLY_MSG_DISCARD:16,RX_DISCARD_SMF_UNKNOWN_ELEMENT:17,CACHE_REQUEST_SENT:18,CACHE_REQUEST_OK_RESPONSE:19,CACHE_REQUEST_FAIL_RESPONSE:20,CACHE_REQUEST_FULFILL_DISCARD_RESPONSE:21,RX_CACHE_MSG:22,CACHE_REQUEST_INCOMPLETE_RESPONSE:23,CACHE_REQUEST_LIVE_DATA_FULFILL:24,TX_PERSISTENT_BYTES:25,TX_PERSISTENT_MSGS:26,TX_NONPERSISTENT_BYTES:27,TX_NONPERSISTENT_MSGS:28,TX_PERSISTENT_BYTES_REDELIVERED:29,TX_PERSISTENT_REDELIVERED:30,TX_NONPERSISTENT_BYTES_REDELIVERED:31,TX_NONPERSISTENT_REDELIVERED:32,TX_ACKS_RXED:33,TX_WINDOW_CLOSE:34,TX_ACK_TIMEOUT:35,RX_PERSISTENT_BYTES:36,RX_PERSISTENT_MSGS:37,RX_NONPERSISTENT_BYTES:38,RX_NONPERSISTENT_MSGS:39,RX_ACKED:40,RX_DISCARD_DUPLICATE:41,RX_DISCARD_NO_MATCHING_CONSUMER:42,RX_DISCARD_OUT_OF_ORDER:43})},7533:(n,I,e)=>{const{EventEmitter:r}=e(7758),{StatType:i}=e(4266);n.exports.Stats=class extends r{constructor(t){super(),this._parent=t,this._statsMap=[],i.values.forEach(c=>{this._statsMap[c]=0})}resetStats(){this.emit("reset"),this._statsMap=this._statsMap.map(()=>0)}incStat(t,c=1){this._statsMap[t]+=c,this._parent&&this._parent.incStat(t,c)}getStat(t){return this._statsMap[t]}}},3147:(n,I,e)=>{const{SMFClient:r}=e(3742),{TransportCapabilities:i}=e(3670),{TransportError:t}=e(1663),{TransportFactory:c}=e(6436),{TransportProtocol:l}=e(4080),{TransportReturnCode:u}=e(4882),{TransportSessionEventCode:o}=e(9045),{TransportSessionStates:f}=e(9385);n.exports.SMFClient=r,n.exports.TransportCapabilities=i,n.exports.TransportError=t,n.exports.TransportFactory=c,n.exports.TransportProtocol=l,n.exports.TransportReturnCode=u,n.exports.TransportSessionEventCode=o,n.exports.TransportSessionStates=f},864:n=>{class I{constructor(r,i,t){this.reset(),this._rxSmfCB=r,this._rxMessageErrorCB=i,this._session=t}reset(){this._correlationCounter=0}nextCorrelationTag(){return++this._correlationCounter>=I.SMF_MAX_CORRELATION&&(this._correlationCounter=1),this._correlationCounter}}I.SMF_MAX_CORRELATION=16777215,n.exports.BaseSMFClient=I},6700:(n,I,e)=>{const r=e(8764).lW;function i(l,u,o){const f=r.allocUnsafe(o);let g,h=0;const T=l[0];for(h+=T.copy(f,0,u,T.length),g=1;g<l.length&&h<o;g++){const S=l[g];h+=S.copy(f,h,0,S.length)}return f}function t(l,u,o){let f=u,g=o;const h=[];let T=0;for(T=0;T<4;T++){for(;l[f].length<=g;)if(g-=l[f].length,f++,f>=l.length)return null;h[T]=l[f].readUInt8(g),g++}return(h[0]<<24)+(h[1]<<16)+(h[2]<<8)+h[3]}class c{constructor(u){let o=[];const f=u;let g=0,h=0;this.peekView=function(T){const S=[];return o.length<1||T>g?null:(o[0].length>=T+h?(S[0]=o[0],S[1]=h):(S[0]=i(o,h,T),S[1]=0),S)},this.readUInt8=function(T){if(T>=g)return null;const S=T+h;if(S<o[0].length)return o[0].readUInt8(S);let C=o[0].length,p=1;for(;C+o[p].length<=S;)C+=o[p].length,p++;return o[p].readUInt8(S-C)},this.readUInt32BE=function(T){if(T+3>=g)return null;const S=T+h;if(S+3<o[0].length)return o[0].readUInt32BE(S);if(S<o[0].length)return t(o,0,S);let C=o[0].length,p=1;for(;C+o[p].length<=S;)C+=o[p].length,p++;return S-C+3<o[p].length?o[p].readUInt32BE(S-C):t(o,p,S-C)},this.put=function(T){const S=c.adaptData(T),C=S.length;return C===0||!(g+C>=f)&&(o.push(S),g+=C,!0)},this.advance=function(T){if(T<1)return;if(T>=g)return void this.reset();let S=0;for(;S<T;){if(!(o[0].length-h<=T-S)){h+=T-S,g-=T-S;break}{const C=o[0].length-h;o.shift(),S+=C,g-=C,h=0}}},this.reset=function(){o=[],g=0,h=0},this.remaining=function(){return g},this.isEmpty=function(){return g===0}}static adaptData(u){return u instanceof r?u:r.from(u)}}n.exports.BufferQueue=c,n.exports.concatFrom=i},8281:(n,I,e)=>{const r=e(1880),i=e(7291),{BaseSMFClient:t}=e(864),{BufferQueue:c}=e(6700),{Convert:l,Hex:u}=e(840),{LogFormatter:o}=e(390),f=e(8764).lW,{stringToUint8Array:g}=l,{formatHexString:h}=u,{LOG_ERROR:T}=new o("[buffer-smf-client]");function S(C){const p=C.peekView(Math.min(C.remaining(),64));T(`First 64 bytes (or fewer) of incoming buffer: 
${r.Debug.formatDumpBytes(p[0].toString("latin1",p[1]),!0,0)}`)}n.exports.M=class extends t{constructor(C,p,R){super(C,p,R),this._incomingBuffer=new c(8e7)}reset(){super.reset(),this._incomingBuffer&&this._incomingBuffer.reset()}rxDataString(C){this._rxDataCB(f.from(g(C)))}rxDataArrayBuffer(C){this._rxDataCB(f.from(C))}rxDataBuffer(C){this._rxDataCB(C)}_rxDataCB(C){this._session&&this._session.resetKeepAliveCounter();const p=this._incomingBuffer,R=p.put(C);let N=p.remaining();for(R||(S(p),this._rxMessageErrorCB(`Buffer overflow (length: ${N})`),this._incomingBuffer.reset());N>12;){const w=7&p.readUInt8(0);if(w!==3)return T(`Invalid smf version in smf header, version=${w}`),T("BufferSMFClient._rxDataCB(): couldn't decode message due to invalid smf header"),S(p),this._incomingBuffer.reset(),void this._rxMessageErrorCB("Error parsing incoming SMF - invalid SMF header detected");const y=p.readUInt32BE(8);if(y>p.remaining())break;const P=p.peekView(y),x=i.Codec.Decode.decodeCompoundMessage(P[0],P[1]);if(!x||!x.smfHeader){const B=this._session?this._session._sessionId:null,H=B?h(B):"N/A";return T(`BufferSMFClient._rxDataCB(): couldn't decode message (sessionId=${H})`),S(p),this._incomingBuffer.reset(),void this._rxMessageErrorCB("Error parsing incoming SMF")}p.advance(x.smfHeader.messageLength),this._rxSmfCB(x),N=p.remaining()}N||this._incomingBuffer.reset()}}},3742:(n,I,e)=>{const{BaseSMFClient:r}=e(864),i=(typeof navigator>"u"||navigator.appVersion.indexOf("MSIE 9.")===-1&&navigator.appVersion.indexOf("Trident/"),e(8281).M);i.SMF_CLIENTCTRL_LOGIN_FAKE_CORRELATIONTAG=r.SMF_MAX_CORRELATION,n.exports.SMFClient=i},2422:(n,I,e)=>{const{ErrorSubcode:r,OperationError:i}=e(3870),{TransportReturnCode:t}=e(4882);class c{constructor(u,o,f,g,h=null){this._url=u,this._ssl=c.useSsl(u),this._client=f,this._eventCB=o,this._props=g,this.setInterceptor(h)}connect(){return t.OK}destroy(u,o,f){return t.OK}flush(u){return u(),t.OK}send(u,o=!1){return t.OK}getTransportProtocol(){return this._props.transportProtocol}getInfoStr(){return null}getClientStats(){return null}beginDowngrade(u,o){return!1}setInterceptor(u){this._interceptor&&this._interceptor.removed&&this._interceptor.removed(this),this._interceptor=u,u&&u.installed&&u.installed(this)}toString(){return`${this.getTransportProtocol()}${this._ssl?" (SSL)":""}`}static useSsl(u){const o=(u||"").split("://");if(o.length===0||c.validSchemes.indexOf(o[0])<0)throw new i(`Invalid url "${u}": Only [${c.validSchemes.join(", ")}] URL schemes are supported`,r.PARAMETER_OUT_OF_RANGE);return o[0]==="https"||o[0]==="wss"||o[0]==="tcps"}}c.validSchemes=["http","https","ws","wss","tcp","tcps"],n.exports.TransportBase=c},3670:(n,I,e)=>{const{WebTransportCapabilities:r}=e(2395),i={web:r};n.exports.TransportCapabilities=i},4581:n=>{n.exports.TransportClientStats=class{constructor(){this.bytesWritten=0,this.msgWritten=0}}},1663:(n,I,e)=>{const{SolaceError:r}=e(3870);n.exports.TransportError=class extends r{constructor(i,t){super("TransportError",i),this.subcode=t}toString(){return`${super.toString()}, subcode=${this.subcode}`}}},6436:(n,I,e)=>{e(390);const{TcpRawTransport:r,CompressedTransport:i,TlsOnlyTransport:t,TcpTlsTransport:c}={},{WebTransport:l}=e(2395),u={createTransport(o,f,g,h,T){const S=o;if(Object.assign(h,{connectTimeoutInMsecs:1e5}),r&&S.trim().startsWith("tcp")){if(!S.trim().startsWith("tcps")){if(h.compressionLevel===0)return new r(S,f,g,h);const R=new i(f,g,h),N=new r(S,R.eventCB.bind(R),R,h);return R.setClientStats(N.getClientStats()),N.setClientStats(null),R.setUnderlyingTransport(N),R}if(h.sslConnectionDowngradeTo!=="PLAIN_TEXT")return new c(S,f,g,h);const C=new t(S,f,g,h),p=new r(S,C.eventCB.bind(C),C,h);return C.setClientStats(p.getClientStats()),p.setClientStats(null),C.setUnderlyingTransport(p),C}return new l(S,f,g,h,T)},startCompression(o){const f=o._eventCB,g=o._client,h=o._props,T=new i(f,g,h);return o.rehome(T.eventCB.bind(T),T),T.setClientStats(o.getClientStats()),o.setClientStats(null),T.setUnderlyingTransport(o),T.connect(),T},severTls(o,f,g){if(f){const h=T=>g(this.startCompression(T));o.tlsShutdown(h)}else o.tlsShutdown(g)}};n.exports.TransportFactory=u},1175:(n,I,e)=>{const r=e(2395),{Lazy:i}=e(9359);e(390);const{TransportBase:t}=e(2422),{TransportProtocol:c}=e(4080),{lazyValue:l}=i,u=l(()=>({[c.HTTP_BASE64]:r.StateBase64,[c.HTTP_BINARY]:r.StateBinary,[c.HTTP_BINARY_STREAMING]:r.StateStreamingAndBinary,[c.WS_BINARY]:r.StateWebSocketBinary}));n.exports.TransportProtocolHandler=class{constructor(o,f){const g=t.useSsl(o);let h=null,T=null;f.slice().reverse().forEach(S=>{const C=u.value[S];h=new C(g,this.switchState.bind(this),T),T=h}),this._transport=h,this._transport.onEnter()}getTransportProtocol(){return this._transport.getTransportProtocol()}completeDowngrade(o){return this._transport.completeDowngrade(o)}canCompleteDowngrade(){return this._transport.getNextState()!==null}toString(){return this._transport.toString()}switchState(o,f){this._transport,this._transport=o,o.onEnter()}}},4080:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.TransportProtocol=r.new({HTTP_BASE64:"HTTP_BASE64",HTTP_BINARY:"HTTP_BINARY",HTTP_BINARY_STREAMING:"HTTP_BINARY_STREAMING",WS_BINARY:"WS_BINARY"})},4882:(n,I,e)=>{const{Enum:r}=e(9359),i={OK:0,FAIL:1,NO_SPACE:2,DATA_DECODE_ERROR:3,INVALID_STATE_FOR_OPERATION:4,CONNECTION_ERROR:5};n.exports.TransportReturnCode=r.new(i),n.exports.TransportReturnCode._setCanonical({OK:i.OK,FAIL:i.FAIL,NO_SPACE:i.NO_SPACE,DATA_DECODE_ERROR:i.DATA_DECODE_ERROR,INVALID_STATE_FOR_OPERATION:i.INVALID_STATE_FOR_OPERATION,CONNECTION_ERROR:i.CONNECTION_ERROR})},9045:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.TransportSessionEventCode=r.new({UP_NOTICE:1,DESTROYED_NOTICE:2,CAN_ACCEPT_DATA:4,DATA_DECODE_ERROR:5,PARSE_FAILURE:6,CONNECT_TIMEOUT:7,SEND_ERROR:8,DOWNGRADE_FAILED:10,DOWNGRADE_SUCCEEDED:11})},414:(n,I,e)=>{var r=e(9489);const{ErrorSubcode:i}=e(3870),{Hex:t}=e(840),{TransportSessionEventCode:c}=e(9045),{formatHexString:l}=t;n.exports.TransportSessionEvent=class{constructor(u,o,f,g,h){this._transportEventCode=u,this._infoStr=o,this._responseCode=f,this._errorSubcode=g,this._sid=h}getTransportEventCode(){return this._transportEventCode}get transportEventCode(){return this._transportEventCode}getInfoStr(){return this.infoStr}get infoStr(){return this._infoStr}getResponseCode(){return this.responseCode}get responseCode(){return this._responseCode}getSubcode(){return this.errorSubcode}get errorSubcode(){return this._errorSubcode}getSessionId(){return this.sessionId}get sessionId(){return this._sid}inspect(){return{transportEventCode:c.describe(this.transportEventCode),infoStr:this.infoStr,responseCode:this.responseCode,errorSubcode:i.describe(this.errorSubcode),sid:this.sid&&l(this.sid)||"N/A"}}toString(){return r(this)}}},9385:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.TransportSessionState=r.new({DOWN:0,WAITING_FOR_CREATE:1,SESSION_UP:2,WAITING_FOR_DESTROY:4,CONNECTION_FAILED:5})},4295:(n,I,e)=>{const{LOG_INFO:r,LOG_WARN:i}=e(390),{Process:t}=e(7882);n.exports.TSHState=class{constructor(c,l,u,o){this._ssl=!!c,this._transportProtocol=l,this._exitCallback=u,this._nextState=o,this._unsupportedRuntimeMessage=`${this._transportProtocol} not supported by this runtime: ${t.userAgent}`}getNextState(){return this._nextState}setNextState(c){this._nextState=c}getTransportProtocol(){return this._transportProtocol}getUseSsl(){return this._ssl}validateLegal(){return!0}onEnter(){this.validateLegal()||(this._nextState&&this._exitCallback?this._exitCallback(this._nextState,this._unsupportedRuntimeMessage):i(`${this._unsupportedRuntimeMessage}, no next state.`))}completeDowngrade(c){return this._nextState&&this._exitCallback?(r(`Connect failed (${c}), try next state.`),this._exitCallback(this._nextState,"Connect failed"),!0):(i(`Connect failed (${c}), no next state.`),!1)}toString(){return this._transportProtocol+(this._ssl?" (SSL)":"")}}},2395:(n,I,e)=>{const r=e(3124),{StateBase64:i}=e(7538),{StateBinary:t}=e(6959),{StateStreamingAndBinary:c}=e(9929),{StateWebSocketBinary:l}=e(1022),{WebTransport:u}=e(5372),{WebTransportCapabilities:o}=e(7483),{HTTPConnection:f,HTTPTransportSession:g}=r;n.exports.HTTPConnection=f,n.exports.HTTPTransportSession=g,n.exports.StateBase64=i,n.exports.StateBinary=t,n.exports.StateStreamingAndBinary=c,n.exports.StateWebSocketBinary=l,n.exports.WebTransport=u,n.exports.WebTransportCapabilities=o},3124:(n,I,e)=>{const{HTTPConnection:r}=e(2949),{HTTPTransportSession:i}=e(3240);n.exports.HTTPConnection=r,n.exports.HTTPTransportSession=i},2949:(n,I,e)=>{const r=e(1880),{Convert:i,Base64:t}=e(840),{LOG_DEBUG:c,LOG_INFO:l,LOG_WARN:u,LOG_ERROR:o}=e(390),{sendXhrBinary:f,sendXhrText:g}=e(8186),{StringBuffer:h,TimingBucket:T}=e(7882),{TransportReturnCode:S}=e(4882),{XHRFactory:C}=e(6145),{arrayBufferToString:p}=i;function R(y){return!y.match(/^(http|ws)(s?):/i)&&window.location&&window.location.origin?window.location.origin+(y.charAt(0)!=="/"?"/":"")+y:y}class N{constructor(){this.WaitedToken=new T("WaitedToken",100),this.HadToken=new T("HadToken",100),this.ReturnedToken=new T("ReturnedToken",100)}toString(){let P="";return[this.WaitedToken,this.HadToken,this.ReturnedToken].forEach(x=>{x&&x.bucketCount()>0&&(P+=`${x.name} >> ${x}
`)}),P}}class w{constructor(P,x,B,H,L,M,G){this.Options={url:R(P),contentType:M,base64Enc:x,streamProgressEvents:B,connectionClose:G},this._streamProgressBytes=0,this._xhr=null,this._rxDataCb=H,this._connErrorCb=L,this._reqActive=!1,this._REQCOUNTER=0,this._REQBASE=Math.floor(1e3*Math.random()),this._xhr=C.create(),this._handleAbortedReq=!w.browserSupportsXhrBinary(),this.stats=new N}recStat(P){}send(P,x=0,B=1){x>0&&(this._xhr.abort(),this._xhr=C.create()),this._xhr.open("POST",this.Options.url,!0),this._streamProgressBytes=0,this._xhr.onreadystatechange=()=>this.xhrStateChange(P,x,B),this._reqActive=!0,this.Options.base64Enc?g(this._xhr,P,this.Options.contentType,this.Options.connectionClose):f(this._xhr,P,this.Options.contentType,this.Options.connectionClose),this.recStat("SendMsg")}xhrStateChange(P,x,B){const H=this._xhr.readyState,L=this._xhr.LOADING,M=this._xhr.DONE;if(!(this.Options.streamProgressEvents&&H===L||H===M)||!this._reqActive)return;let G=null;if(this._handleAbortedReq)try{G=this._xhr.status}catch(J){return void l(`Error trying to access status in XHR due to request aborted: ${J.message}`)}else G=this._xhr.status;if(G===200||G===304){let J=null;if(J=this._xhr.responseType&&this._xhr.responseType==="arraybuffer"?p(this._xhr.response):this._xhr.responseText,J=J.substring(this._streamProgressBytes,J.length),this._streamProgressBytes+=J.length,J.length===0&&H===L)return;if(this.Options.base64Enc)try{J=t.decode(J)}catch(se){return o(`Data decode error on: ${J}`),o(`Data decode error is: ${se.message}`),void this._rxDataCb(S.DATA_DECODE_ERROR,J)}else{const se=[],Te=J.length;for(let pe=0;pe<Te;pe++)se.push(String.fromCharCode(255&J.charCodeAt(pe)));J=se.join("")}return H===M&&(this._reqActive=!1),this._rxDataCb(S.OK,J),void(H===M&&J.length>0&&this._rxDataCb(S.OK,""))}const K=this._xhr.statusText;let F="";F=this._xhr.responseType&&this._xhr.responseType==="arraybuffer"?p(this._xhr.response):this._xhr.responseText||"";const Y=F.length,_=(this.Options.url,P?P.length:0),{formatDumpBytes:U}=r.Debug,A=U(F.substr(0,Math.min(Y,64)),!0,0);U((P||"").substr(0,Math.min(_,256)),!0,0);const z=B;this._reqActive&&G!==400&&F.length===0&&(x===0||x<z)?(l(`XHR failed while request active, will retry send, retry=${x+1}`),this.send(P,x+1,z)):(this._reqActive=!1,this._connErrorCb(G,new h(`HTTP request failed(status=${G} statusText=${K}, `,`responseText length=${Y}, responseText[0..64]=
`,A,`XHR errorCode=${this._xhr._error?this._xhr._error.code:""})`).toString()))}isUsingBase64(){return this.Options.base64Enc}abort(){this._reqActive=!1,this._xhr&&this._xhr.abort&&this._xhr.abort()}static browserSupportsXhrBinary(){return f!==g}static browserSupportsStreamingResponse(){const P=C.create(),x=P&&P.onprogress===null;return l(`http browserStreamingCheck - if XMLHTTPRequest supported and XMLHTTPRequest support onprogress: ${x}`),x}}n.exports.HTTPConnection=w},3240:(n,I,e)=>{const r=e(1880),i=e(7291),{Check:t}=e(2201),{Convert:c,Hex:l}=e(840),{ErrorSubcode:u,OperationError:o}=e(3870),{HTTPConnection:f}=e(2949),{LogFormatter:g}=e(390),{SMFClient:h}=e(3742),{TransportError:T}=e(1663),{TransportProtocol:S}=e(4080),{TransportReturnCode:C}=e(4882),{TransportSessionEvent:p}=e(414),{TransportSessionEventCode:R}=e(9045),{TransportSessionState:N}=e(9385),{WebTransportSessionBase:w}=e(5677),{int32ToStr:y,strToByteArray:P,strToHexArray:x}=c,{formatHexString:B}=l,{LOG_TRACE:H,LOG_DEBUG:L,LOG_ERROR:M,LOG_INFO:G}=new g("[http-transport-session]"),K=e(8764).lW;n.exports.HTTPTransportSession=class extends w{constructor(F,Y,_,U){if(super(F,Y,_,U),this._haveToken=!0,this._confMaxWebPayload=U.maxWebPayload,this._maxPayloadBytes=0,this._destroyTimer=null,this._destroyTimeout=U.connectTimeoutInMsecs,this._createUrl=`http${F.match(/(ws|http)(s?:\/\/.+)/)[2]}`,this._routerUrl=this._createUrl,this._rxChannelClient=null,this._httpSendConn=null,this._httpReceiveConn=null,this._smfDataTokenTSHeader=null,this._routerTag="",this._sid=null,U.transportProtocol===null||U.transportProtocol===void 0)throw new o("transportProtocol is not set",u.PARAMETER_OUT_OF_RANGE);this._transportProtocol=U.transportProtocol,this._useBinaryTransport=!1,this._useStreamingTransport=!1,this._streamingTransportPadding=0,this._useBinaryTransport=U.transportProtocol!==S.HTTP_BASE64,this._useStreamingTransport=U.transportProtocol===S.HTTP_BINARY_STREAMING,this._incomingBuffer="",this._packetReadState=0;const A=navigator.userAgent||"";if((A.match(/trident/i)||A.match(/msie/i))&&(this._streamingTransportPadding=257),U.transportContentType===null||U.transportContentType===void 0)throw new o("transportContentType is not set",u.PARAMETER_OUT_OF_RANGE);this._contentType=U.transportContentType}connectTimerExpiry(){G("HTTP transport connect timeout"),this.destroyCleanup("HTTP transport connect timeout",u.TIMEOUT)}get sessionIdHex(){return this._sid?B(this._sid):""}updateMaxWebPayload(){const F=this._confMaxWebPayload-22;this._maxPayloadBytes=this._useBinaryTransport?F:Math.floor(.75*F)}connect(){return this._state!==N.DOWN?C.INVALID_STATE_FOR_OPERATION:this.connectInternal()}connectInternal(){this._connError=null;try{this._createConn=new f(this._createUrl,!this._useBinaryTransport,!1,(Y,_)=>this.handleCreateResponse(Y,_),(Y,_)=>this.handleCreateConnFailure(Y,_),this._contentType)}catch(Y){return G(`Failed to create connection to router: ${Y.message}`),this._connError=Y,C.CONNECTION_ERROR}if(t.nothing(this._createConn))return G("Failed to create connection to router"),C.CONNECTION_ERROR;const F=i.Codec.Transport.genTsCreateHeader();this._state===N.WAITING_FOR_CREATE||(this.createConnectTimeout(),this._state=N.WAITING_FOR_CREATE);try{this._createConn.send(F)}catch(Y){return G(`Error connecting: ${Y.message}`),Y.stack,this._state=N.CONNECTION_FAILED,this.cancelConnectTimeout(),this._connError=Y instanceof T?Y:new T(`Could not create HTTP transport session: ${Y.message}`,Y.subcode||u.CONNECTION_ERROR),C.CONNECTION_ERROR}return C.OK}destroy(F,Y){if(this._state,this._state===N.WAITING_FOR_DESTROY||this._state===N.DOWN)return C.OK;if(this._state===N.CONNECTION_FAILED||this._state===N.WAITING_FOR_CREATE)return G("The connection is in unreliable state, close transport"),this.destroyCleanup(F,Y,!0),C.OK;G("Destroy transport session immediately"),this._state=N.WAITING_FOR_DESTROY,this._httpSendConn!==null&&(G("Destroy transport session: abort sendConn"),this._httpSendConn.abort()),this._httpReceiveConn!==null&&(G("Destroy transport session: abort receiveConn"),this._httpReceiveConn.abort()),this._destroyTimer=setTimeout(()=>{this.destroyTimerExpiry()},this._destroyTimeout),this._httpSendConn=new f(this._routerUrl,!this._useBinaryTransport,!1,(U,A)=>this.handleRxDataToken(U,A),(U,A)=>this.handleSendFailure(U,A),this._contentType,!0);const _=i.Codec.Transport.genTsDestroyHeader(this._sid);return x(_),this._httpSendConn.send(_),C.OK}send(F,Y=!1){let _=F;if(this._state!==N.SESSION_UP)return C.INVALID_STATE_FOR_OPERATION;if(this._queuedData.length>0||!this._haveToken)return this.enqueueData(_,Y);let U=null;if(_.length>this._maxPayloadBytes&&(U=_.substr(this._maxPayloadBytes),_=_.substr(0,this._maxPayloadBytes),!this.allowEnqueue(U.length)))return this.enqueueFailNoSpace();this._haveToken=!1;const A=this._smfDataTSHeaderParts[0].length+4+this._smfDataTSHeaderParts[1].length+_.length;return this._httpSendConn.send(this._smfDataTSHeaderParts[0]+y(A)+this._smfDataTSHeaderParts[1]+_),this._clientstats.bytesWritten+=_.length,U?this.enqueueData(U,null):(this._clientstats.msgWritten++,C.OK)}enqueueData(F,Y=!1){const _=F.length;return Y||this.allowEnqueue(_)?(this._queuedDataSize+=_,this._queuedData.push(F),C.OK):this.enqueueFailNoSpace()}initPreformattedHeaders(F){this._smfDataTSHeaderParts=i.Codec.Transport.genTsDataMsgHeaderParts(F),this._useStreamingTransport?this._smfDataTokenTSHeader=i.Codec.Transport.genTsDataStreamTokenMsg(F,this._streamingTransportPadding):this._smfDataTokenTSHeader=i.Codec.Transport.genTsDataTokenMsg(F)}flush(F){this._queuedDataSize?this._flushCallback=F:F()}sendQueuedData(){if(this._queuedDataSize===0)return;this._haveToken=!1;const F=this.getQueuedDataToSend(),Y=this._smfDataTSHeaderParts[0].length+4+this._smfDataTSHeaderParts[1].length+F.length;if(this._httpSendConn.send(this._smfDataTSHeaderParts[0]+y(Y)+this._smfDataTSHeaderParts[1]+F),this._clientstats.bytesWritten+=F.length,this._canSendNeeded&&(this._canSendNeeded=!1,this._eventCB(new p(R.CAN_ACCEPT_DATA,"",null,0,this._sid))),this._flushCallback){const _=this._flushCallback;this._flushCallback=null,_()}}handleCreateResponse(F,Y){if(this._state===N.WAITING_FOR_DESTROY||this._state===N.DOWN)return;if(this.updateMaxWebPayload(),F!==C.OK)return G(`Received create response with return code ${C.describe(F)}`),void(F===C.DATA_DECODE_ERROR?this.destroyCleanup("Received data decode error on create session response",u.DATA_DECODE_ERROR):this.destroyCleanup("Failed to handle create session response",u.CONNECTION_ERROR));if(Y.length===0)return;const _=i.Codec.Decode.decodeCompoundMessage(K.from(Y,"latin1"),0);if(!_)return M("Could not parse create response as SMF. Destroying transport"),void this.destroyCleanup("Failed to parse create response message",u.CONNECTION_ERROR);const U=_.getResponse();if(U.responseCode!==200)return void this.destroyCleanup(`Transport create request failed (${U.responseCode}, ${U.responseString})`,u.CONNECTION_ERROR);this.cancelConnectTimeout(),this._createConn.abort(),this._createConn=null,this._state=N.SESSION_UP,this._sid=_.sessionId,this._routerTag=_.routerTag,this._routerUrl=this._createUrl.replace(/\?.*/,""),this._routerTag!==""&&(this._routerUrl=this._routerUrl+this._routerTag),this.initPreformattedHeaders(this._sid);const A=!this._useBinaryTransport,z=this._useStreamingTransport;this._httpSendConn=new f(this._routerUrl,A,!1,(J,se)=>this.handleRxDataToken(J,se),(J,se)=>this.handleSendFailure(J,se),this._contentType),this._useStreamingTransport?this._httpReceiveConn=new f(this._routerUrl,A,z,(J,se)=>this.handleRxStreaming(J,se),(J,se)=>this.handleSendFailure(J,se),this._contentType,!0):(this._rxChannelClient=new h(J=>this.handleSmfMessage(J),J=>this.handleSmfParseError(J),null),this._httpReceiveConn=new f(this._routerUrl,A,z,(J,se)=>this.handleRxData(J,se),(J,se)=>this.handleSendFailure(J,se),this._contentType)),this._httpReceiveConn.send(this._smfDataTokenTSHeader),this._eventCB(new p(R.UP_NOTICE,U.responseString,U.responseCode,0,_.sessionId))}handleDestroyResponse(F){this.cancelDestroyTimeout();const Y=F.getResponse(),_=Y?Y.responseString:"";this.destroyCleanup(`${_} handled Destroy Response addressed to session ${B(F.sessionId)}, on session ${B(this._sid)}`,0)}handleSmfMessage(F){const Y=F.smfHeader;if(Y.smf_protocol!==i.SMFProtocol.TSESSION)return void this.handleSmfParseError(`Unexpected Message Prototcol (${Y.smf_protocol}) on ReceiveData connection`);const _=F.payload,U=F.payloadLength;switch(F.messageType){case i.SMFTransportSessionMessageType.DESTROY_RESP:return void this.handleDestroyResponse(F);case i.SMFTransportSessionMessageType.DATA:if(F.sessionId!==this._sid){const A=F.getResponse(),z=A?` (${A.responseCode} ${A.responseString})`:"",J=A?A.responseCode:null;return P(this._sid),P(F.sessionId),this._state=N.CONNECTION_FAILED,void this._eventCB(new p(R.PARSE_FAILURE,`Session ID mismatch in data message, expected: ${B(this._sid)}, got: ${B(F.sessionId)}, ${z}`,J,u.PROTOCOL_ERROR,this._sid))}U>0&&this._client.rxDataBuffer(_);break;default:this.handleSmfParseError(`Unexpected message type (${F.messageType}) on ReceiveData connection`)}}handleSmfParseError(){this._eventCB(new p(R.DATA_DECODE_ERROR,"Received data decode error",null,u.DATA_DECODE_ERROR,this._sid))}handleRxData(F,Y){this._httpReceiveConn!==null&&this._rxChannelClient!==null?this._state!==N.WAITING_FOR_DESTROY?(this._httpReceiveConn.recStat("GotData"),F===C.OK?Y.length===0?this._httpReceiveConn.send(this._smfDataTokenTSHeader):this._rxChannelClient.rxDataString(Y):this.handleRxError(F,Y)):r.Debug.formatDumpBytes(Y.substring(0,64),!0,0):this._state===N.DOWN?G("Transport session is down, ignore data from receive connection"):M(`Transport session is not in working state, state: ${this._state}`)}handleRxStreaming(F,Y){if(this._httpReceiveConn===null)return void(this._state===N.DOWN||M(`Transport session is not in working state, state: ${this._state}`));if(this._state===N.WAITING_FOR_DESTROY)return void r.Debug.formatDumpBytes(Y.substring(0,64),!0,0);if(this._httpReceiveConn.recStat("GotData"),F!==C.OK)return void this.handleRxError(F,Y);if(Y.length===0)return this._packetReadState=0,void this._httpReceiveConn.send(this._smfDataTokenTSHeader);if(this._packetReadState===1)return void this._client.rxDataString(Y);this._incomingBuffer+=Y;const _=i.Codec.ParseSMF.parseSMFAt(K.from(this._incomingBuffer,"latin1"),0,!0);if(_){const U=i.Codec.Transport.parseTsSmfHdrAt(K.from(this._incomingBuffer,"latin1"),_.headerLength,_);if(!U)return;switch(U.messageType){case i.SMFTransportSessionMessageType.DESTROY_RESP:return void this.handleDestroyResponse(U);case i.SMFTransportSessionMessageType.DATA:if(U.sessionId!==this._sid){const A=U.getResponse(),z=A?` (${A.responseCode} ${A.responseString})`:"",J=A?A.responseCode:null;return P(this._sid),P(U.sessionId),P(Y.substr(0,64)),this._state=N.CONNECTION_FAILED,void this._eventCB(new p(R.PARSE_FAILURE,`Session ID mismatch in data message, expected: ${B(this._sid)}, got: ${B(U.sessionId)}, ${z}`,J,u.PROTOCOL_ERROR,this._sid))}return this._packetReadState=1,this._incomingBuffer.length>_.headerLength+U.tsHeaderLength&&this._client.rxDataString(this._incomingBuffer.substr(_.headerLength+U.tsHeaderLength)),void(this._incomingBuffer="");default:throw new T(`Unexpected message type (${U.messageType}) on ReceiveData connection`,0)}}else if(i.Codec.ParseSMF.isSMFHeaderAvailable(K.from(this._incomingBuffer,"latin1"),0)&&!i.Codec.ParseSMF.isSMFHeaderValid(K.from(this._incomingBuffer,"latin1"),0)){M(`Couldn't decode message due to invalid smf header, dump first 64 bytes (or fewer) of buffer content:
${r.Debug.formatDumpBytes(this._incomingBuffer.substring(0,64),!0,0)}`);const U="Error parsing incoming message - invalid SMF header detected";this._state=N.CONNECTION_FAILED,this._eventCB(new p(R.PARSE_FAILURE,U,null,u.PROTOCOL_ERROR,null))}}handleRxDataToken(F,Y){if(F!==C.OK)return void this.handleRxError(F,Y);if(Y.length===0)return;const _=i.Codec.Decode.decodeCompoundMessage(K.from(Y,"latin1"),0);if(_)if(_.messageType!==i.SMFTransportSessionMessageType.DESTROY_RESP){if(_.sessionId!==this._sid){const U=_.getResponse(),A=U?` (${U.responseCode} ${U.responseString})`:"",z=U?U.responseCode:null;return P(this._sid),P(_.sessionId),P(Y.substr(0,64)),void(this._state!==N.WAITING_FOR_DESTROY?(this._state=N.CONNECTION_FAILED,this._eventCB(new p(R.PARSE_FAILURE,`Session ID mismatch in response message, expected: ${B(this._sid)}, got: ${B(_.sessionId)}, ${A}`,z,u.PROTOCOL_ERROR,this._sid))):this.destroyCleanup("Session ID mismatch in response message",u.PROTOCOL_ERROR))}if(_.messageType!==i.SMFTransportSessionMessageType.DATA_TOKEN&&_.messageType!==i.SMFTransportSessionMessageType.DATA_STREAM_TOKEN)throw new T(`Unexpected message type (${_.messageType}) on SendData connection`,0);this._haveToken=!0,this._httpSendConn.recStat("GotToken"),this.sendQueuedData()}else this.handleDestroyResponse(_);else this._state!==N.WAITING_FOR_DESTROY?(this._state=N.CONNECTION_FAILED,this._eventCB(new p(R.PARSE_FAILURE,"Failed to parse received data message",null,u.PROTOCOL_ERROR,this._sid))):this.destroyCleanup("Failed to parse received data message",u.PROTOCOL_ERROR)}handleRxError(F){G(`handleRxError, transport return code ${C.name(F)}`),this._state=N.CONNECTION_FAILED,F===C.DATA_DECODE_ERROR?this._eventCB(new p(R.DATA_DECODE_ERROR,"Received data decode error",null,u.DATA_DECODE_ERROR,this._sid)):this._eventCB(new p(R.SEND_ERROR,"Connection error",u.CONNECTION_ERROR,this._sid))}handleSendFailure(F,Y){this._state===N.WAITING_FOR_DESTROY?(G(`Connection destroy failure (${Y}) while in state ${this._state}`),this.destroyCleanup(`Connection destroy failure: ${Y}`,u.CONNECTION_ERROR)):(G(`Connection failure (${Y}) while in state ${this._state}`),this._eventCB(new p(R.SEND_ERROR,`Connection error: ${Y}`,F,u.CONNECTION_ERROR,this._sid)))}handleCreateConnFailure(F,Y){this._state!==N.DOWN&&(G(`Connection create failure (${Y}) while in state ${this._state}`),this.destroyCleanup(`Connection create failure: ${Y}`,u.CONNECTION_ERROR))}destroyTimerExpiry(){this.destroyCleanup("Destroy request timeout",u.CONNECTION_ERROR)}cancelDestroyTimeout(){this._destroyTimer&&(clearTimeout(this._destroyTimer),this._destroyTimer=null)}destroyCleanup(F,Y,_){this._createConn&&this._createConn.abort(),this._httpSendConn&&this._httpSendConn.abort(),this._httpReceiveConn&&this._httpReceiveConn.abort(),this._createUrl=null,this._routerUrl=null,this._createConn=null,this._httpSendConn=null,this._httpReceiveConn=null,this._smfDataTokenTSHeader=null,this._rxChannelClient=null,this._routerTag="",this._queuedData=[],this._queuedDataSize=0,this._canSendNeeded=!1,this.cancelDestroyTimeout(),this.cancelConnectTimeout(),this._state=N.DOWN;const U=()=>{this._eventCB&&this._eventCB(new p(R.DESTROYED_NOTICE,F||"Session is destroyed",null,Y||0,this._sid)),this._client=null,this._eventCB=null};_?setTimeout(U,0):U()}getInfoStr(){return`HTTPTransportSession; sid=${B(this._sid)}; routerTag=${this._routerTag}`}}},8186:(n,I,e)=>{const{Base64:r,Convert:i}=e(840),{XHRFactory:t}=e(6145),{encode:c}=r,{stringToUint8Array:l}=i;function u(h,T,S){h.responseType="arraybuffer",h.overrideMimeType(`${S}; charset=x-user-defined`),h.setRequestHeader("Content-Type",`${S}; charset=x-user-defined`),h.send(l(T))}function o(h,T,S){h.overrideMimeType(`${S}; charset=x-user-defined`),h.setRequestHeader("Content-Type",`${S}; charset=x-user-defined`),h.send(l(T).buffer)}function f(h,T,S,C){h.setRequestHeader("Content-Type",`${S}; charset=x-user-defined`),h.send(T==null?T:c(T),C)}const g=typeof window<"u"&&window.Uint8Array&&window.Blob?t.create(!0).responseType?u:o:f;n.exports.sendXhrBinary=g,n.exports.sendXhrText=f},6145:(n,I,e)=>{const{ErrorSubcode:r}=e(3870),{TransportError:i}=e(1663),t={create(c=!1){const l=typeof XMLHttpRequest<"u"?new XMLHttpRequest:null;if(!c&&!l)throw new i("Failed to create an XMLHTTPRequest",r.CREATE_XHR_FAILED);return l}};n.exports.XHRFactory=t},7538:(n,I,e)=>{const{TransportProtocol:r}=e(4080),{TSHState:i}=e(4295);n.exports.StateBase64=class extends i{constructor(t,c,l){super(t,r.HTTP_BASE64,c,l)}}},6959:(n,I,e)=>{const{TransportProtocol:r}=e(4080),{TSHState:i}=e(4295),{WebTransportCapabilities:t}=e(7483);n.exports.StateBinary=class extends i{constructor(c,l,u){super(c,r.HTTP_BINARY,l,u)}validateLegal(){return t.xhrBinary()}}},9929:(n,I,e)=>{const{TransportProtocol:r}=e(4080),{TSHState:i}=e(4295),{WebTransportCapabilities:t}=e(7483);n.exports.StateStreamingAndBinary=class extends i{constructor(c,l,u){super(c,r.HTTP_BINARY_STREAMING,l,u)}validateLegal(){return t.streaming()&&t.xhrBinary()}}},1022:(n,I,e)=>{const{TransportProtocol:r}=e(4080),{TSHState:i}=e(4295),{WebTransportCapabilities:t}=e(7483);n.exports.StateWebSocketBinary=class extends i{constructor(c,l,u){super(c,r.WS_BINARY,l,u)}validateLegal(){return t.webSocket()}}},7483:(n,I,e)=>{const r=e(3124),{WebSocketTransportSession:i}=e(2519),{HTTPConnection:t}=r,c={webSocket:()=>i.browserSupportsBinaryWebSockets(),xhrBinary:()=>t.browserSupportsXhrBinary(),streaming:()=>t.browserSupportsStreamingResponse()};n.exports.WebTransportCapabilities=c},6671:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.WebTransportEvent=r.new({CONNECT:"Connect",DESTROY:"Destroy",DOWNGRADE:"Downgrade",DESTROYED_NOTICE:"DestroyedNotice",CONNECT_TIMEOUT:"ConnectTimeout",UP_NOTICE:"UpNotice",SEND_ERROR:"SendError"})},4035:(n,I,e)=>{const{ErrorSubcode:r}=e(3870),{FsmEvent:i,State:t,StateMachine:c}=e(8535),{LogFormatter:l}=e(390),{TransportReturnCode:u}=e(4882),{TransportSessionEvent:o}=e(414),{TransportSessionEventCode:f}=e(9045),{WebTransportEvent:g}=e(6671),{WebTransportState:h}=e(7317),{LOG_TRACE:T,LOG_INFO:S}=new l;n.exports.WebTransportFSM=class extends c{constructor(C,p){super({name:"WebTransportFSM"});const R=C,N=this,w=new l;w.formatter=function(...y){return[`[web-transport-fsm=${p()}]`,...y]},this.log=w.wrap(this.log,this),this.transport=R,this.initial(function(){return this.transitionTo(this.WebTransportDown,y=>{y.getStateMachine().getName()})}),this.unhandledEventReaction(function(y){return y.getName(),this.getCurrentState().getName(),this}),this.WebTransportDown=new t({name:h.DOWN,parentContext:this}).reaction(g.CONNECT,function(){return this.transitionTo(N.WebTransportConnecting)}).reaction(g.DESTROY,function(y){return R.destroyInternal(y._destroyMsg,y._subcode),this.transitionTo(N.WebTransportDestroying)}),this.WebTransportConnecting=new t({name:h.CONNECTING,parentContext:this}).entry(()=>{try{if(R.connectInternal()!==u.OK){const y=R.getConnError(),P=new i({name:g.DESTROY});return P._destroyMsg=y?y.message:"Error occurred while establishing transport",P._subcode=y?y.subcode:null,P._eventReason=y,this.processEvent(P)}}catch(y){S(`transport.connectInternal threw: ${y.message}`);const P=new i({name:g.DESTROY});return P._destroyMsg=y.message,P._subcode=y.subcode?y.subcode:r.CONNECTION_ERROR,P._eventReason=y,this.processEvent(P)}}).reaction(g.SEND_ERROR,y=>(R.notifyEvent(y._transportEvent),N.attemptDowngrade(y._transportEvent))).reaction(g.CONNECT_TIMEOUT,y=>N.attemptDowngrade(y._transportEvent)).reaction(g.DESTROYED_NOTICE,y=>(R.notifyEvent(y._transportEvent),this.transitionTo(N.WebTransportDown))).reaction(g.UP_NOTICE,function(y){return R.notifyEvent(y._transportEvent),this.transitionTo(N.WebTransportUp)}).reaction(g.DESTROY,function(y){return R.destroyInternal(y._destroyMsg,y._subcode),this.transitionTo(N.WebTransportDestroying)}),this.WebTransportDowngrading=new t({name:h.DOWNGRADING,parentContext:this}).reaction(g.DESTROYED_NOTICE,function(y){return S("Web transport: request downgrade"),R.completeDowngrade()?this.transitionTo(N.WebTransportConnecting):(S("Web transport: connection error, no downgrade"),R.notifyEvent(y._transportEvent),N.notifyDowngradeFailed(),this.transitionTo(N.WebTransportDown))}).reaction(g.DESTROY,function(y){return R.destroyInternal(y._destroyMsg,y._subcode),this.transitionTo(N.WebTransportDestroying)}),this.WebTransportUp=new t({name:h.UP,parentContext:this}).reaction(g.DOWNGRADE,y=>N.attemptDowngrade(new o(y._downgradeMsg,y._subcode))).reaction(g.DESTROYED_NOTICE,function(y){return R.notifyEvent(y._transportEvent),this.transitionTo(N.WebTransportDown)}).reaction(g.DESTROY,function(y){return R.destroyInternal(y._destroyMsg,y._subcode),this.transitionTo(N.WebTransportDestroying)}).reaction(g.SEND_ERROR,function(y){return R.notifyEvent(y._transportEvent),R.destroyInternal(y._destroyMsg,y._subcode),this.transitionTo(N.WebTransportDestroying)}),this.WebTransportDestroying=new t({name:h.DESTROYING,parentContext:this}).reaction(g.DESTROYED_NOTICE,function(y){return R.notifyEvent(y._transportEvent),this.transitionTo(N.WebTransportDown)})}attemptDowngrade(C){const{infoStr:p,errorSubcode:R}=C;return this.transport.beginDowngrade(p,R)?this.transitionTo(this.WebTransportDowngrading):(this.transport.destroyInternal(p,R),this.transport.notifyEvent(C),this.transitionTo(this.WebTransportDestroying))}notifyDowngradeFailed(){this.transport.notifyEvent(new o(f.DOWNGRADE_FAILED,"Downgrade failed"))}}},5677:(n,I,e)=>{e(390);const{TransportBase:r}=e(2422),{TransportClientStats:i}=e(4581),{TransportReturnCode:t}=e(4882),{TransportSessionState:c}=e(9385);n.exports.WebTransportSessionBase=class extends r{constructor(l,u,o,f){super(l,u,o,f),this._connectTimeout=f.transportDowngradeTimeoutInMsecs,this._connectTimer=null,this._clientstats=new i,this._sendBufferMaxSize=f.sendBufferMaxSize,this._maxPayloadBytes=f.maxWebPayload,this._queuedData=[],this._queuedDataSize=0,this._canSendNeeded=!1,this._state=c.DOWN,this._connError=null}getClientStats(){return this._clientstats}createConnectTimeout(){this._connectTimeout>0&&(this._connectTimer=setTimeout(()=>{this.connectTimerExpiry()},this._connectTimeout))}cancelConnectTimeout(){this._connectTimer&&(clearTimeout(this._connectTimer),this._connectTimer=null)}connectTimerExpiry(){}allowEnqueue(l){return this._queuedDataSize===0||l+this._queuedDataSize<=this._sendBufferMaxSize}enqueueFailNoSpace(){return this._canSendNeeded=!0,t.NO_SPACE}flush(l){l()}getQueuedDataToSend(){let l="",u=this._maxPayloadBytes;if(this.getBufferedAmount&&this.getBufferedAmount(),this.getBufferedAmount){if(u=this._maxPayloadBytes-this.getBufferedAmount(),u<=0)return this._maxPayloadBytes,this.getBufferedAmount(),this._bufferedAmountQueryIntervalInMsecs*this._bufferedAmountQueryIntervalDelayMultiplier<=4e3&&(this._bufferedAmountQueryIntervalDelayMultiplier*=2),l;this._bufferedAmountQueryIntervalDelayMultiplier=1}if(this._queuedDataSize>u){let o=u;for(;o&&this._queuedDataSize;){const f=this._queuedData[0],g=f.length;g>o?(l+=f.substr(0,o),this._queuedData[0]=f.substr(o),this._queuedDataSize-=o,o=0):(l+=this._queuedData.shift(),o-=g,this._queuedDataSize-=g,this._clientstats.msgWritten++)}}else l=this._queuedData.join(""),this._clientstats.msgWritten+=this._queuedData.length,this._queuedData=[],this._queuedDataSize=0;return l.length,l}}},7317:(n,I,e)=>{const{Enum:r}=e(9359);n.exports.WebTransportState=r.new({DOWN:"WebTransportDown",CONNECTING:"WebTransportConnecting",DOWNGRADING:"WebTransportDowngrading",DESTROYING:"WebTransportDestroying",UP:"WebTransportUp"})},5372:(n,I,e)=>{const{ErrorSubcode:r,OperationError:i}=e(3870),{HTTPTransportSession:t}=e(3124),{LOG_TRACE:c,LOG_INFO:l,LOG_ERROR:u}=e(390),{FsmEvent:o}=e(8535),{TransportBase:f}=e(2422),{TransportProtocol:g}=e(4080),{TransportProtocolHandler:h}=e(1175),{TransportReturnCode:T}=e(4882),{TransportSessionEventCode:S}=e(9045),{WebSocketTransportSession:C}=e(2519),{WebTransportEvent:p}=e(6671),{WebTransportFSM:R}=e(4035);n.exports.WebTransport=class extends f{constructor(N,w,y,P,x){super(N,w,y,P),P.webTransportProtocolList,this._transportHandler=new h(N,P.webTransportProtocolList),this._webTransportFsm=new R(this,x),this._webTransportFsm.start()}notifyEvent(N){this._eventCB(N)}handleDestroyed(){this._transportSession=null}handleTransportEvent(N){let w;switch(l(`Web transport receive transport event: ${N}`),N.getTransportEventCode()){case S.UP_NOTICE:w=new o({name:p.UP_NOTICE}),w._transportEvent=N,this._webTransportFsm.processEvent(w);break;case S.DESTROYED_NOTICE:this.handleDestroyed(),w=new o({name:p.DESTROYED_NOTICE}),w._transportEvent=N,this._webTransportFsm.processEvent(w);break;case S.SEND_ERROR:w=new o({name:p.SEND_ERROR}),w._transportEvent=N,this._webTransportFsm.processEvent(w);break;case S.CONNECT_TIMEOUT:w=new o({name:p.CONNECT_TIMEOUT}),w._transportEvent=N,this._webTransportFsm.processEvent(w);break;case S.DOWNGRADE_FAILED:this._lastDowngradeSucceeded=!1;break;case S.DOWNGRADE_SUCCEEDED:this._lastDowngradeSucceeded=!0;break;default:this._eventCB(N)}}connect(){const N=new o({name:p.CONNECT});return this._webTransportFsm.processEvent(N),T.OK}connectInternal(){this._transportSession=null;const N=this._transportHandler.getTransportProtocol();switch(this._props.transportProtocol=N,N){case g.HTTP_BASE64:case g.HTTP_BINARY:case g.HTTP_BINARY_STREAMING:this._transportSession=new t(this._url,w=>this.handleTransportEvent(w),this._client,this._props);break;case g.WS_BINARY:this._transportSession=new C(this._url,w=>this.handleTransportEvent(w),this._client,this._props);break;default:throw u(`Web transport unrecognized TransportProtocol: ${N}`),new i(`No transport session provider for scheme: ${N}`,r.CONNECTION_ERROR,N)}return l(`Connect Transport ${N}`),this._transportSession.connect()}destroy(N,w){const y=new o({name:p.DESTROY});return y._destroyMsg=N,y._subcode=w,this._webTransportFsm.processEvent(y),T.OK}beginDowngrade(N,w){return!!this._transportHandler.canCompleteDowngrade()&&(this.destroyInternal(N,w),!0)}completeDowngrade(){return!!this._transportHandler.canCompleteDowngrade()&&this._transportHandler.completeDowngrade()}destroyInternal(N,w){this._transportSession&&this._transportSession.destroy(N,w)}flush(N){return this._transportSession.flush(N)}getConnError(){return this._transportSession?this._transportSession._connError:null}getInfoStr(){return this._transportSession?this._transportSession.getInfoStr():"Not connected."}getTransportProtocol(){return this._transportHandler.getTransportProtocol()}getClientStats(){return this._transportSession?this._transportSession.getClientStats():null}requestDowngrade(N,w){this._lastDowngradeSucceeded=void 0;const y=new o({name:p.DOWNGRADE});return y._downgradeMsg=N,y._subcode=w,this._webTransportFsm.processEvent(y),this._lastDowngradeSucceeded}send(N,w){return this._transportSession.send(N,w)}}},8645:n=>{n.exports.WebSocketCloseCodes={0:{name:"Unknown code",description:"No status code was returned by the operation"},1e3:{name:"Normal Closure",description:"The connection closed normally"},1001:{name:"Going Away",description:"The endpoint is going away due to a server failure or client navigation"},1002:{name:"Protocol Error",description:"A WebSocket protocol error occurred"},1003:{name:"Unsupported Data",description:"The endpoint cannot handle the specified data type"},1004:{name:"Reserved",description:""},1005:{name:"No Status Recvd",description:"Expected a status code but none was provided"},1006:{name:"Abnormal Closure",description:"No close frame was received before remote hangup"},1007:{name:"Invalid Frame Payload Data",description:"A message contained data inconsistent with its encoding"},1008:{name:"Policy Violation",description:"A message violated endpoint policy"},1009:{name:"Message Too Big",description:"A data frame was too large"},1010:{name:"Missing Extension",description:"The endpoint did not negotiate an expected extension"},1011:{name:"Internal Error",description:"The server encountered an unexpected condition that prevented it from fulfilling the request"},1012:{name:"Service Restart",description:"The server is restarting"},1013:{name:"Try Again Later",description:"The server is terminating the connection due to a temporary condition"},1014:{name:"Bad Gateway",description:"A gateway or proxy received an invalid response from the upstream server"},1015:{name:"TLS Handshake",description:"The connection was closed due to a failure to perform a TLS handshake"}}},2519:(n,I,e)=>{const{LOG_TRACE:r,LOG_DEBUG:i,LOG_INFO:t,LOG_WARN:c,LOG_ERROR:l}=e(390),{ArrayUtils:u}=e(7882),{Convert:o,Hex:f}=e(840),{ErrorSubcode:g}=e(3870),{mixin:h}=e(9359),{TransportError:T}=e(1663),{TransportReturnCode:S}=e(4882),{TransportSessionEvent:C}=e(414),{TransportSessionEventCode:p}=e(9045),{TransportSessionState:R}=e(9385),{WebSocketCloseCodes:N}=e(8645),{WebTransportSessionBase:w}=e(5677),{stringToArrayBuffer:y}=(e(8293),e(1209),o),{formatHexString:P}=f,{includes:x}=u;let B=(typeof window>"u"?e.g:window).WebSocket;class H extends w{constructor(M,G,K,F){super(M,G,K,F),this._url=function(Y){return`ws${Y.match(/(ws|http)(s?:\/\/.+)/)[2]}`}(M),this._socket=null,this._sessionId=new Date().getTime(),this._bufferedAmountQueryIntervalInMsecs=F.bufferedAmountQueryIntervalInMsecs,this._bufferedAmountQueryTimer=null,this._bufferedAmountQueryIntervalDelayMultiplier=1}onOpen(){this.cancelConnectTimeout(),this._state=R.SESSION_UP,this._eventCB(new C(p.UP_NOTICE,"Connected",0,null,this._sessionId))}onClose(M,G){if(M!==this._socket||this._state===R.WAITING_FOR_DESTROY)return;const K=[],F=N[G.code]||N[0];K.push(`${G.code} ${F.name} (${F.description})`),G.wasClean!==void 0&&K.push(`clean closure: ${G.wasClean}`),G.reason&&K.push(`reason: ${G.reason}`);const Y=K.join(", ");G.type,G.wasClean,G.code,G.reason,this._state=R.CONNECTION_FAILED,this.destroy(`Connection closed: ${Y}`,g.COMMUNICATION_ERROR)}onDrain(){this.maybeEmitCanSend(),this.maybeEmitFlush()}onBufferedAmountPoll(){this.getBufferedAmount()===0?this.onDrain():this.scheduleQuery&&this.scheduleQuery()}onError(M,G){if(t(`Websocket Transport Session onError for socket ${M} while socket is ${this._socket}`),M!==this._socket)return void t("Websocket Transport Session stray onError for previous socket, ignoring.");if(this._state===R.WAITING_FOR_DESTROY)return void t("WebSocket transport is being destroyed, ignore error");const K=G.message?`: ${G.message}`:"";t(`WebSocket transport connection error ${K} while in state ${this._state}`),this._state===R.WAITING_FOR_CONNECT?(this.cancelConnectTimeout(),this._state=R.CONNECTION_FAILED,this.destroy(`Connection failed: ${K}`,g.CONNECTION_ERROR)):this._eventCB(new C(p.SEND_ERROR,`Connection error${K}`,null,g.CONNECTION_ERROR,null))}onMessage(M){this._client&&this._client.rxDataArrayBuffer(M.data)}connectTimerExpiry(){t("WebSocket transport connect timeout"),this.state=R.CONNECTION_FAILED,this._eventCB(new C(p.CONNECT_TIMEOUT,"Connection timed out",null,g.TIMEOUT))}connect(){if(this._state!==R.DOWN)return l(`Invalid state for operation: ${R.nameOf(this._state)}`),S.INVALID_STATE_FOR_OPERATION;if(!this._url)return c("Cannot connect to null URL"),S.CONNECTION_ERROR;this._socket&&this.onError("Socket already connected"),t("Establishing WebSocket transport session");try{this.createConnectTimeout(),this._state=R.WAITING_FOR_CREATE,t("Constructing socket"),this._socket=new B(this._url,"smf.solacesystems.com"),this._socket.binaryType="arraybuffer",this._socket.onopen=this.onOpen.bind(this),this._socket.onmessage=this.onMessage.bind(this),this._socket.onclose=this.onClose.bind(this,this._socket),this._socket.onerror=this.onError.bind(this,this._socket)}catch(M){if(t(`Error connecting: ${M.message}`),M.stack,this._state=R.CONNECTION_FAILED,this.cancelConnectTimeout(),!(M instanceof T))throw new T(`Could not create WebSocket: ${M.message}`,M.subcode||g.CONNECTION_ERROR);return this._connError=M,S.CONNECTION_ERROR}return t("WebSocket is connecting"),S.OK}send(M,G=!1){if(this._state!==R.SESSION_UP)return S.INVALID_STATE_FOR_OPERATION;const K=M.length,F=this._sendBufferMaxSize-this.getBufferedAmount()>=0;if(!G&&!F)return this._canSendNeeded=!0,this.scheduleQuery&&this.scheduleQuery(),S.NO_SPACE;const Y=this._maxPayloadBytes,_=y(M);if(K>Y)for(let U=0;U<K;U+=Y)this._socket.send(_.slice(U,U+Y));else this._socket.send(_);return this._clientstats.bytesWritten+=K,++this._clientstats.msgWritten,S.OK}getBufferedAmount(){return this._socket?this._socket.bufferedAmount:0}flush(M){this._flushCallback=M,this.maybeEmitFlush()}maybeEmitCanSend(){this._canSendNeeded&&this.getBufferedAmount()<this._sendBufferMaxSize&&(this._canSendNeeded=!1,this._eventCB(new C(p.CAN_ACCEPT_DATA,"",null,0,this._sessionId)))}maybeEmitFlush(){if(!this._flushCallback)return;if(this.getBufferedAmount()>0)return void(this._bufferedAmountQueryTimer||this.scheduleQuery());const M=this._flushCallback;this._flushCallback=null,M()}destroy(M,G){return this._state!==R.DOWN&&(t(`Destroy WebSocket transport: ${M}`),this._state=R.WAITING_FOR_DESTROY,this._socket&&(this._socket.close(),this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=function(){},this._socket=null),this._connectTimer&&(clearTimeout(this._connectTimer),this._connectTimer=void 0),this.cancelQuery(),this._bufferedAmountQueryIntervalDelayMultiplier=1,this._canSendNeeded=!1,this._state=R.DOWN,this._client=null),this._eventCB&&(this._eventCB(new C(p.DESTROYED_NOTICE,M||"Session is destroyed",null,G||0,this._sessionId)),this._eventCB=null),S.OK}getInfoStr(){return`WebSocketTransportSession; sid=${P(this._sessionId)}`}static browserSupportsBinaryWebSockets(){const M=["function","object"];return x(M,typeof B)&&x(M,typeof ArrayBuffer)&&x(M,typeof Uint8Array)?"binaryType"in B.prototype?(t("websocket browserSupportBinaryCheck: true - WebSocket supports binaryType"),!0):(t("websocket browserSupportBinaryCheck: false - WebSocket does not support binaryType"),!1):(t("websocket browserSupportBinaryCheck: false - some required classes not supported"),!1)}}h(H,class{scheduleQuery(){if(this.getBufferedAmount()>0&&this._bufferedAmountQueryIntervalInMsecs>0){this.cancelQuery(),this._bufferedAmountQueryIntervalDelayMultiplier>1&&(this._bufferedAmountQueryIntervalInMsecs,this._bufferedAmountQueryIntervalDelayMultiplier);const L=this._bufferedAmountQueryIntervalInMsecs*this._bufferedAmountQueryIntervalDelayMultiplier;this._bufferedAmountQueryTimer=setTimeout(()=>{this.cancelQuery();try{this.onBufferedAmountPoll()}catch(M){l(`Error occurred in onBufferedAmountPoll: ${M.message}`),M.stack}},L)}}cancelQuery(){this._bufferedAmountQueryTimer&&(clearTimeout(this._bufferedAmountQueryTimer),this._bufferedAmountQueryTimer=null)}}),n.exports.WebSocketTransportSession=H},7882:(n,I,e)=>{const{APIProperties:r}=e(3845),{APIPropertiesValidators:i}=e(9396),{ArrayUtils:t}=e(2273),{parseURL:c}=e(7567),{Process:l}=e(4672),{StringBuffer:u}=e(2901),{StringUtils:o}=e(3517),{TimingBucket:f}=e(9495),{UUID:g}=e(8632),{Version:h}=e(5686);n.exports={parseURL:c,APIProperties:r,APIPropertiesValidators:i,ArrayUtils:t,Process:l,StringBuffer:u,StringUtils:o,TimingBucket:f,UUID:g,Version:h}},9396:(n,I,e)=>{const{Check:r}=e(2201),{ErrorSubcode:i,OperationError:t}=e(3870),c={validateInstance(l,u,o,...f){f.forEach(g=>{g.shift()(l,u,o,...g)})},valInstance(l,u,o,f,g){if(!r.instanceOf(u[o],f))throw new t(`${l} validation: Property '${o}' must be instance of ${g}`)},valNotEmpty(l,u,o){if(r.none(u[o])||u[o]==="")throw new t(`${l} validation: Property '${o}' cannot be empty.`,i.PARAMETER_OUT_OF_RANGE)},valLength(l,u,o,f){if(r.string(u[o])&&u[o].length>f)throw new t(`${l} validation: Property '${o}' exceeded max length ${f}`,i.PARAMETER_OUT_OF_RANGE)},valRange(l,u,o,f,g){if(r.number(u[o])&&(u[o]<f||u[o]>g))throw new t(`${l} validation: Property '${o}' out of range [${f}; ${g}].`,i.PARAMETER_OUT_OF_RANGE)},valString(l,u,o){if(!r.string(u[o]))throw new t(`${l} validation: Property '${o}' must be type string; was ${typeof u[o]}`,i.PARAMETER_INVALID_TYPE)},valNumber(l,u,o){if(!r.number(u[o]))throw new t(`${l} validation: Property '${o}' must be type number; was ${typeof u[o]}`,i.PARAMETER_INVALID_TYPE)},valBoolean(l,u,o){const f=u[o];if(!r.boolean(f))throw new t(`${l} validation: Property '${o}' must be type boolean; was ${typeof f}`,i.PARAMETER_INVALID_TYPE)},valIsMember(l,u,o,f,g,h=!1){const T=u[o];if(!(h&&T==null||f.values.indexOf(T)>=0))throw new t(`${l} validation: Property '${o}'=${T} must be a member of ${g}`,i.PARAMETER_INVALID_TYPE)},valStringOrArray(l,u,o){const f=u[o];if(typeof f!="string"&&!Array.isArray(f))throw new t(`${l} validation: Property '${o}' must be a string or array`,i.PARAMETER_INVALID_TYPE)},valArrayIsMember(l,u,o,f,g,h,T,S){if(u[o]==null){if(h)return;throw new t(`${l} validation: Property '${o}' must be type Array`,i.PARAMETER_INVALID_TYPE)}if(!Array.isArray(u[o]))throw new t(`${l} validation: Property '${o}' must be type Array`,i.PARAMETER_INVALID_TYPE);if(!T&&u[o].length===0)throw new t(`${l} validation: Property '${o}' cannot be empty`,i.PARAMETER_INVALID_TYPE);u[o].forEach((C,p)=>{if(!f.values.includes(C))throw new t(`${l} validation: Property '${o}' must be an array of ${g}`,i.PARAMETER_INVALID_TYPE);if(!S&&u[o].indexOf(C,p+1)>=0)throw new t(`${l} validation: Property '${o}' cannot have duplicate element value`,i.PARAMETER_OUT_OF_RANGE)})},valArrayOfString(l,u,o){const f=u[o];if(r.something(f)){if(!Array.isArray(f))throw new t(`${l} validation: Property '${o}' must be type Array`,i.PARAMETER_INVALID_TYPE);f.forEach(g=>{if(typeof g!="string")throw new t(`${l} validation: Property '${o}' must be an array of string`,i.PARAMETER_INVALID_TYPE)})}},valTopicString(l,u,o){const{DestinationUtil:f,DestinationType:g}=e(3170);n.exports.APIPropertiesValidators.valString(l,u,o);const h=u[o],T=f.validateAndEncode(g.TOPIC,h);if(T.error)throw new t(`${l} validation: Property '${o}' must be a valid topic string: ${T.error}`,i.PARAMETER_OUT_OF_RANGE)},valTopicStringOrEmpty(l,u,o){const f=u[o];f&&f.length&&n.exports.APIPropertiesValidators.valTopicString(l,u,o)}};n.exports.APIPropertiesValidators=c},3845:(n,I,e)=>{var r=e(9489);const i=e(6313);n.exports.APIProperties=class{constructor(...t){Object.assign(this,...t)}toString(){return r(this)}clone(){return i(this,!1,1)}}},2273:n=>{n.exports.ArrayUtils={flatten:function I(e){return e.reduce((r,i)=>r.concat(Array.isArray(i)?I(i):i),[])},includes:function(I,e){return I.some(r=>r===e)}}},3196:n=>{n.exports=function(I){let e=!1;if(!I.forceJURL)try{const R=new URL("b","http://a");R.pathname="c%20d",e=R.href==="http://a/c%20d"}catch{}if(e)return;const r=Object.create(null);r.ftp=21,r.file=0,r.gopher=70,r.http=80,r.https=443,r.ws=80,r.wss=443;const i=Object.create(null);function t(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function c(R){return r[R]!==void 0}function l(){t.call(this),this._isInvalid=!0}function u(R){return R===""&&l.call(this),R.toLowerCase()}function o(R){const N=R.charCodeAt(0);return N>32&&N<127&&[34,35,60,62,63,96].indexOf(N)===-1?R:encodeURIComponent(R)}function f(R){const N=R.charCodeAt(0);return N>32&&N<127&&[34,35,60,62,96].indexOf(N)===-1?R:encodeURIComponent(R)}let g;i["%2e"]=".",i[".%2e"]="..",i["%2e."]="..",i["%2e%2e"]="..";const h=/[a-zA-Z]/,T=/[a-zA-Z0-9+\-.]/;function S(R,N,w){function y(M){}let P=N||"scheme start",x=0,B="",H=!1,L=!1;e:for(;(R[x-1]!==g||x===0)&&!this._isInvalid;){const M=R[x];switch(P){case"scheme start":if(!M||!h.test(M)){if(N)break e;B="",P="no scheme";continue}B+=M.toLowerCase(),P="scheme";break;case"scheme":if(M&&T.test(M))B+=M.toLowerCase();else{if(M!==":"){if(N){if(g===M)break e;break e}B="",x=0,P="no scheme";continue}if(this._scheme=B,B="",N)break e;c(this._scheme)&&(this._isRelative=!0),P=this._scheme==="file"?"relative":this._isRelative&&w&&w._scheme===this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":M==="?"?(this._query="?",P="query"):M==="#"?(this._fragment="#",P="fragment"):g!==M&&M!=="	"&&M!==`
`&&M!=="\r"&&(this._schemeData+=o(M));break;case"no scheme":if(w&&c(w._scheme)){P="relative";continue}l.call(this);break;case"relative or authority":if(M!=="/"||R[x+1]!=="/"){P="relative";continue}P="authority ignore slashes";break;case"relative":if(this._isRelative=!0,this._scheme!=="file"&&(this._scheme=w._scheme),g===M){this._host=w._host,this._port=w._port,this._path=w._path.slice(),this._query=w._query,this._username=w._username,this._password=w._password;break e}if(M==="/"||M==="\\")P="relative slash";else if(M==="?")this._host=w._host,this._port=w._port,this._path=w._path.slice(),this._query="?",this._username=w._username,this._password=w._password,P="query";else{if(M!=="#"){const G=R[x+1],K=R[x+2];(this._scheme!=="file"||!h.test(M)||G!==":"&&G!=="|"||g!==K&&K!=="/"&&K!=="\\"&&K!=="?"&&K!=="#")&&(this._host=w._host,this._port=w._port,this._username=w._username,this._password=w._password,this._path=w._path.slice(),this._path.pop()),P="relative path";continue}this._host=w._host,this._port=w._port,this._path=w._path.slice(),this._query=w._query,this._fragment="#",this._username=w._username,this._password=w._password,P="fragment"}break;case"relative slash":if(M!=="/"&&M!=="\\"){this._scheme!=="file"&&(this._host=w._host,this._port=w._port,this._username=w._username,this._password=w._password),P="relative path";continue}P=this._scheme==="file"?"file host":"authority ignore slashes";break;case"authority first slash":if(M!=="/"){P="authority ignore slashes";continue}P="authority second slash";break;case"authority second slash":if(P="authority ignore slashes",M!=="/")continue;break;case"authority ignore slashes":if(M!=="/"&&M!=="\\"){P="authority";continue}break;case"authority":if(M==="@"){H&&(B+="%40"),H=!0;for(let G=0;G<B.length;G++){const K=B[G];if(K==="	"||K===`
`||K==="\r")continue;if(K===":"&&this._password===null){this._password="";continue}const F=o(K);this._password!==null?this._password+=F:this._username+=F}B=""}else{if(g===M||M==="/"||M==="\\"||M==="?"||M==="#"){x-=B.length,B="",P="host";continue}B+=M}break;case"file host":if(g===M||M==="/"||M==="\\"||M==="?"||M==="#"){B.length!==2||!h.test(B[0])||B[1]!==":"&&B[1]!=="|"?(B.length===0||(this._host=u.call(this,B),B=""),P="relative path start"):P="relative path";continue}M==="	"||M===`
`||M==="\r"?void 0:B+=M;break;case"host":case"hostname":if(M!==":"||L){if(g===M||M==="/"||M==="\\"||M==="?"||M==="#"){if(this._host=u.call(this,B),B="",P="relative path start",N)break e;continue}M!=="	"&&M!==`
`&&M!=="\r"?(M==="["?L=!0:M==="]"&&(L=!1),B+=M):void 0}else if(this._host=u.call(this,B),B="",P="port",N==="hostname")break e;break;case"port":if(/[0-9]/.test(M))B+=M;else{if(g===M||M==="/"||M==="\\"||M==="?"||M==="#"||N){if(B!==""){const G=parseInt(B,10);G!==r[this._scheme]&&(this._port=`${G}`),B=""}if(N)break e;P="relative path start";continue}M==="	"||M===`
`||M==="\r"?void 0:l.call(this)}break;case"relative path start":if(P="relative path",M!=="/"&&M!=="\\")continue;break;case"relative path":if(g!==M&&M!=="/"&&M!=="\\"&&(N||M!=="?"&&M!=="#"))M!=="	"&&M!==`
`&&M!=="\r"&&(B+=o(M));else{const G=i[B.toLowerCase()];G&&(B=G),B===".."?(this._path.pop(),M!=="/"&&M!=="\\"&&this._path.push("")):B==="."&&M!=="/"&&M!=="\\"?this._path.push(""):B!=="."&&(this._scheme==="file"&&this._path.length===0&&B.length===2&&h.test(B[0])&&B[1]==="|"&&(B=`${B[0]}:`),this._path.push(B)),B="",M==="?"?(this._query="?",P="query"):M==="#"&&(this._fragment="#",P="fragment")}break;case"query":N||M!=="#"?g!==M&&M!=="	"&&M!==`
`&&M!=="\r"&&(this._query+=f(M)):(this._fragment="#",P="fragment");break;case"fragment":g!==M&&M!=="	"&&M!==`
`&&M!=="\r"&&(this._fragment+=M)}x++}}function C(R,N){N===void 0||N instanceof C||(N=new C(String(N))),R=String(R),this._url=R,t.call(this);const w=R.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");S.call(this,w,null,N)}C.prototype={toString(){return this.href},get href(){if(this._isInvalid)return this._url;let R="";return this._username===""&&this._password===null||(R=this._username+(this._password!==null?`:${this._password}`:"")+"@"),this.protocol+(this._isRelative?`//${R}${this.host}`:"")+this.pathname+this._query+this._fragment},set href(R){t.call(this),S.call(this,R)},get protocol(){return`${this._scheme}:`},set protocol(R){this._isInvalid||S.call(this,`${R}:`,"scheme start")},get host(){return this._isInvalid?"":this._port?`${this._host}:${this._port}`:this._host},set host(R){!this._isInvalid&&this._isRelative&&S.call(this,R,"host")},get hostname(){return this._host},set hostname(R){!this._isInvalid&&this._isRelative&&S.call(this,R,"hostname")},get port(){return this._port},set port(R){!this._isInvalid&&this._isRelative&&S.call(this,R,"port")},get pathname(){return this._isInvalid?"":this._isRelative?`/${this._path.join("/")}`:this._schemeData},set pathname(R){!this._isInvalid&&this._isRelative&&(this._path=[],S.call(this,R,"relative path start"))},get search(){return this._isInvalid||!this._query||this._query==="?"?"":this._query},set search(R){!this._isInvalid&&this._isRelative&&(this._query="?",R[0]==="?"&&(R=R.slice(1)),S.call(this,R,"query"))},get hash(){return this._isInvalid||!this._fragment||this._fragment==="#"?"":this._fragment},set hash(R){this._isInvalid||(this._fragment="#",R[0]==="#"&&(R=R.slice(1)),S.call(this,R,"fragment"))},get origin(){if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}const R=this.host;return R?`${this._scheme}://${R}`:""}};const p=I.URL;p&&(C.createObjectURL=function(...R){return p.createObjectURL(...R)},C.revokeObjectURL=function(R){p.revokeObjectURL(R)}),I.URL=C}},4672:(n,I,e)=>{const r={6.4:"10.0",6.3:"8.1",6.2:"8",6.1:"7","6.0":"Vista",5.2:"Server 2003",5.1:"XP",5.01:"2000 SP1","5.0":"2000","4.0":"4.0"},i=typeof window<"u"?window:e.g,t=(i.process,{product:"solclientjs",platform:"unknown",agent:"Gecko"});try{if(i.navigator){const l=o=>o.replace(/[^a-zA-Z0-9_/.]/g,"-");Object.assign(t,{platform:i.navigator.platform,agent:i.navigator.product,description:l(i.navigator.userAgent),navigator:i.navigator});const u=function(){if(typeof navigator>"u"||!navigator)return null;const o=navigator.userAgent,f={browser:{name:"unknown",version:"0.0.0"},platform:{os:"unknown",arch:"unknown",version:"unknown"}},g=(...C)=>C.some(p=>o.indexOf(p)>=0),h=(...C)=>C.filter(Boolean).shift();Object.assign(f,[["edge",/Edge\/([0-9._]+)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9.]+)(?:\s|$)/],["opera",/Opera\/([0-9.]+)(?:\s|$)/],["opera",/OPR\/([0-9.]+)(:?\s|$)$/],["ie",/Trident\/7\.0.*rv:([0-9.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9.]+);.*Trident\/[4-8].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9.]+)/],["android",/Android\s([0-9.]+)/],["ios",/Version\/([0-9._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9._]+).*Safari/]].map(([C,p])=>{if(!p.test(o))return!1;const R=p.exec(o),N=(R&&R[1].split(/[._]/).slice(0,3)).map(w=>parseInt(w,10));for(;N.length<3;)N.push(0);return{browser:{name:C,version:N.join(".")}}}).filter(Boolean).shift());const T=h(g("Windows Phone")&&"WindowsPhone",g("Windows")&&"Windows",g("Linux")&&"Linux",g("like Mac OS X")&&"iOS",g("OS X")&&"OSX",g("Android","Adr")&&"Android",g("BB10","RIM Tablet OS","BlackBerry")&&"BlackBerry"),S={Windows:()=>h(g("Win16")&&"3.1.1",g("Windows CE")&&"CE",g("Windows 95")&&"4.00.950",g("Windows 98; Win 9x 4.90")&&"4.90",g("Windows 98")&&"4.10",(()=>{const C=o.match(/\(.+?\)/)[0];return!!C&&h(...Object.keys(r).map(p=>{return R=p,C.indexOf(R)>=0&&r[p];var R}))})()),OSX:()=>o.match(/OS X ((\d+[._])+\d+)\b/)[1],Linux:()=>"",iOS:()=>o.match(/OS ((\d+[._])+\d+) like Mac OS X/)[1],Android:()=>o.match(/(?:Android|Adr) ((\d+[._])+\d_)/)[1],BlackBerry:()=>o.match(/(?:Version\/|RIM Tablet OS )((\d+\.)+\d+)/)[1]}[T];return f.platform.os=T||"Unknown",f.platform.version=(S&&S()||"0.0.0").replace(/_/g,"."),f}();u&&(t.agent=l(`${u.browser.name}-${u.browser.version}`),t.platform=`${t.agent}-${l(`${u.platform.os}-${u.platform.version}`)}`)}}catch{}const c=Object.assign({},{},t,{});n.exports.Process=c},2901:n=>{n.exports.StringBuffer=class{constructor(...I){this.clear(),this.append(...I)}append(...I){return[...I].forEach(e=>{this.buffer[this.index++]=String(e)}),this}clear(){this.buffer=[],this.index=0}toString(){return this.buffer.join("")}}},3517:(n,I,e)=>{const{StringBuffer:r}=e(2901),i=(()=>{const f=[];for(let g=0;g<256;++g)f[g]=g<33||g>126?".":String.fromCharCode(g);return f})();function t(f,g,h,T=" "){if(typeof f!="string"||f.length>=g)return f;const S=new r;for(let C=0;C<g-f.length;C++)S.append(T.charAt(0));switch(h){case 0:return`${S}${f}`;case 1:return`${f}${S}`;default:return f}}function c(f,g){if(!g.length)return f;const h=g.match(/^\s*/)[0].length;return h<f?h:f}function l(f){return`${f.charAt(0).toUpperCase()}${f.substr(1)}`}function u(f){return f==null||f.length===0}const o={capitalize:function(f){return f&&f.length?f.split(" ").map(l).join(" "):f}};o.isEmpty=u,o.notEmpty=function(f){return!u(f)},o.toSafeChars=function(f){return f.replace(/[^a-zA-Z0-9_/.]/g,"")},o.padLeft=function(f,g,h){return t(f,g,0,h)},o.padRight=function(f,g,h){return t(f,g,1,h)},o.nullTerminate=function(f){if(f==null)throw new Error("non str in nullTerminate");return f.charCodeAt(f.length-1)===0?f:f+String.fromCharCode(0)},o.stripNullTerminate=function(f){if(f==null)throw new Error("null str in stripNullTerminate");return f.charCodeAt(f.length-1)===0?f.substr(0,f.length-1):f},o.hexdump=function(f){const g=new r,h=new r,T=C=>C===8||C===16?"  ":" ";let S=0;for(let C=0,p=f.length;C<p;C++){const R=f.charCodeAt(C);if(g.append(t(R.toString(16),2,0)),h.append(i[R]||"."),g.append(T(++S)),C===f.length-1)for(;S<16;)g.append(`  ${T(++S)}`);S===16&&(g.append(h.join("")),g.append(`
`),S=0,h.clear())}return g.toString()},o.heredoc=function(f,...g){const h=[...g,""],T=f.map(C=>C+h.shift()).join("").split(/\r?\n/),S=T.length===1?0:T.reduce(c,1/0);for(;T[0]==="";)T.shift();return T.map(C=>C.substring(S)).join(`
`)},n.exports.StringUtils=o},9495:n=>{n.exports.TimingBucket=class{constructor(I,e){this.name=I,this.interval=e,this.buckets=[]}get bucketCount(){let I=0;for(let e=0,r=this.buckets.length;e<r;++e)I+=this.buckets[e]||0;return I}log(I){if(I===void 0||isNaN(I))return;const e=Math.floor(I/this.interval)*this.interval;this.buckets[e]=this.buckets[e]||0,this.buckets[e]++}toString(){const I=[];return this.buckets.forEach(e=>{I.push(`${e}: ${this.buckets[e]}`)}),`{${I.join(", ")}}`}}},7567:function(n,I,e){let r;{const i=typeof window<"u"?window:this;e(3196)(i),r=function(...t){return new URL(...t)}}n.exports.parseURL=r},8632:n=>{n.exports.UUID={generateUUID:function(){let I=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const r=(I+16*Math.random())%16|0;return I=Math.floor(I/16),(e==="x"?r:3&r|8).toString(16)})}}},5686:n=>{const I=new Date(Date.parse("Thu Jan 12 2023 11:02:02 GMT-0500 (Eastern Standard Time)")),e="RELEASE",r=(()=>{const c=u=>u<10?`0${u}`:u,l=I;return`${l.getFullYear()}/${c(l.getMonth()+1)}/${c(l.getDate())} ${c(l.getHours())}:${c(l.getMinutes())}`})(),i=["SolclientJS","10.12.0",e,r].join(", "),t={version:"10.12.0",date:I,formattedDate:r,target:{name:"browser",node:!1,browser:!0},mode:e,debug:!1,release:!0,summary:i,toString:()=>i};n.exports.Version=t},2201:(n,I,e)=>{const{Check:r}=e(2595),{Parameter:i}=e(6362);n.exports.Check=r,n.exports.Parameter=i},9070:n=>{function I(r){return r.reduce((i,t)=>i.concat(Array.isArray(t)?I(t):t),[])}const e=(()=>{const r={nothing:i=>i==null,anything:i=>!e.nothing(i),undefined:i=>i===void 0,defined:i=>!e.undefined(i),array:i=>e.anything(i)&&Array.isArray(i),object:i=>!e.array(i)&&i!==null&&(typeof i=="object"||i instanceof Object),instanceOf:(i,t)=>e.object(i)&&i instanceof t,type:(i,t)=>typeof i===t,instanceOfAny:(i,...t)=>e.array(t)&&I(t).some(c=>e.instanceOf(i,c)),empty:i=>!!e.nothing(i)||!(!e.object(i)||Object.keys(i).length!==0)||i.length===0,truthy:(i,t)=>!!t(i),rangeGe:(i,t)=>i>=t,rangeGt:(i,t)=>i>t,rangeLe:(i,t)=>i<=t,rangeLt:(i,t)=>i<t,rangeCompare(i,t,c,...l){switch(t){case"=":case"==":case"===":return i===c;case"~=":case"=~":{const u=l[0]||1e6;return Math.abs(i-c)<u}case"<":return i<c;case"<=":return i<=c;case">":return i>c;case">=":return i>=c;default:throw new Error(`Illegal operator for rangeCompare: ${t}`)}},NaN:i=>Number.isNaN(i),included(i,t){if(e.nothing(t))return!1;if(t.includes)return t.includes(i);if(Array.isArray(t))return t.indexOf(i)>=0;if(e.object(t)){const c=Object.keys(t);return e.included(i,c)}return!1},equal:(i,t)=>i===t,member:(i,t)=>e.anything(t)&&(e.array(t)?e.included(i,t):Object.keys(t).some(c=>t[c]===i)),boolean:i=>e.type(i,"boolean"),number:i=>e.type(i,"number"),string:i=>e.type(i,"string"),function:i=>e.type(i,"function")};return r.none=r.nothing,r.something=r.anything,Object.keys(r).forEach(i=>{r[i].orNull=function(t,...c){return t===null||r[i](t,...c)},r[i].orUndefined=function(t,...c){return t===void 0||r[i](t,...c)},r[i].orNothing=function(t,...c){return r.nothing(t)||r[i](t,...c)}}),r})();n.exports.BaseChecks=e},2595:(n,I,e)=>{const{BaseChecks:r}=e(9070);function i(c){return{then:c?l=>l():(l,u)=>u()}}const t=(()=>{const c=Object.assign({},r);return c.when=l=>i(l),c.unless=l=>i(!l),c})();n.exports.Check=t},6362:(n,I,e)=>{const{Check:r}=e(2595),{ErrorSubcode:i,OperationError:t}=e(3870),c={};function l(g,h=null,T=c){const S=h?`; expected: ${h}`:"",C=T!==c?`; got: ${T}`:"";return g===i.PARAMETER_INVALID_TYPE?`Parameter type was invalid${S}${C}`:i.nameOf(g).toLowerCase().replace(/_/," ")+S}function u(g,h,T,S,C,...p){return S(C,...p)?C:function(R,N,w){throw new t(`Parameter ${R} failed validation`,N,w)}(g,h,T)}const o=g=>g&&g.constructor&&g.constructor.name||typeof g,f={isArray:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"array",h)){return u(g,T,S,r.isArray,h)},isBoolean:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"boolean",h)){return u(g,T,S,r.boolean,h)},isBooleanOrNothing:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"boolean or nothing",h)){return u(g,T,S,r.boolean.orNothing,h)},isEnumMember:function(g,h,T,S=i.PARAMETER_OUT_OF_RANGE,C=l(S,`one of [${T.names.join(", ")}]`,h)){return u(g,S,C,r.member,h,T)},isEnumMemberOrNothing:function(g,h,T,S=i.PARAMETER_OUT_OF_RANGE,C=l(S,`one of [${T.names.join(", ")}]`,h)){return u(g,S,C,r.member.orNothing,h,T)},isFunction:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"function",h)){return u(g,T,S,r.function,h)},isFunctionOrNothing:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"function or nothing",h)){return u(g,T,S,r.function.orNothing,h)},isInstanceOf:function(g,h,T,S=i.PARAMETER_INVALID_TYPE,C=l(S,T.name,o(h))){return u(g,S,C,r.instanceOf,h,T)},isInstanceOfOrNothing:function(g,h,T,S=i.PARAMETER_INVALID_TYPE,C=l(S,`${T.name} or nothing`,o(h))){return u(g,S,C,r.instanceOf.orNothing,h,T)},isInstanceOfOrNull:function(g,h,T,S=i.PARAMETER_INVALID_TYPE,C=l(S,`${T.name} or null`,o(h))){return u(g,S,C,r.instanceOf.orNull,h,T)},isInstanceOfOrUndefined:function(g,h,T,S=i.PARAMETER_INVALID_TYPE,C=l(S,`${T.name} or undefined`,o(h))){return u(g,S,C,r.instanceOf.orUndefined,h,T)},isMember:function(g,h,T,S=i.PARAMETER_OUT_OF_RANGE,C=l(S,`one of ${T.name}.[${function(p){return Object.keys(p).map(R=>p[R])}(T).join(", ")}]`,h)){return u(g,S,C,r.member,h,T)},isNumber:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"number",h)){return u(g,T,S,r.number,h)},isNumberOrNothing:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"number or nothing",h)){return u(g,T,S,r.number.orNothing,h)},isNumberOrNull:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"number or null",h)){return u(g,T,S,r.number.orNull,h)},isRangeCompare:function(g,h,T,S,C=i.PARAMETER_OUT_OF_RANGE,p=l(C,`${T} ${S}`,h)){return u(g,C,p,r.rangeCompare,h,T,S)},isRangeCompareOrNothing:function(g,h,T,S,C=i.PARAMETER_OUT_OF_RANGE,p=l(C,`${T} ${S} or nothing`,h)){return u(g,C,p,r.rangeCompare.orNothing,h,T,S)},isStringOrNull:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"string or null",h)){return u(g,T,S,r.string.orNull,h)},isString:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"string",h)){return u(g,T,S,r.string,h)},isStringOrNothing:function(g,h,T=i.PARAMETER_INVALID_TYPE,S=l(T,"string or nothing",h)){return u(g,T,S,r.string.orNothing,h)},isValue:function(g,h,T,S=i.PARAMETER_OUT_OF_RANGE,C=l(S,`must be ${h}`)){return u(g,S,C,r.equal,h,T)}};n.exports.Parameter=f},9742:(n,I)=>{I.byteLength=function(f){var g=u(f),h=g[0],T=g[1];return 3*(h+T)/4-T},I.toByteArray=function(f){var g,h,T=u(f),S=T[0],C=T[1],p=new i(function(w,y,P){return 3*(y+P)/4-P}(0,S,C)),R=0,N=C>0?S-4:S;for(h=0;h<N;h+=4)g=r[f.charCodeAt(h)]<<18|r[f.charCodeAt(h+1)]<<12|r[f.charCodeAt(h+2)]<<6|r[f.charCodeAt(h+3)],p[R++]=g>>16&255,p[R++]=g>>8&255,p[R++]=255&g;return C===2&&(g=r[f.charCodeAt(h)]<<2|r[f.charCodeAt(h+1)]>>4,p[R++]=255&g),C===1&&(g=r[f.charCodeAt(h)]<<10|r[f.charCodeAt(h+1)]<<4|r[f.charCodeAt(h+2)]>>2,p[R++]=g>>8&255,p[R++]=255&g),p},I.fromByteArray=function(f){for(var g,h=f.length,T=h%3,S=[],C=16383,p=0,R=h-T;p<R;p+=C)S.push(o(f,p,p+C>R?R:p+C));return T===1?(g=f[h-1],S.push(e[g>>2]+e[g<<4&63]+"==")):T===2&&(g=(f[h-2]<<8)+f[h-1],S.push(e[g>>10]+e[g>>4&63]+e[g<<2&63]+"=")),S.join("")};for(var e=[],r=[],i=typeof Uint8Array<"u"?Uint8Array:Array,t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",c=0,l=t.length;c<l;++c)e[c]=t[c],r[t.charCodeAt(c)]=c;function u(f){var g=f.length;if(g%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var h=f.indexOf("=");return h===-1&&(h=g),[h,h===g?0:4-h%4]}function o(f,g,h){for(var T,S,C=[],p=g;p<h;p+=3)T=(f[p]<<16&16711680)+(f[p+1]<<8&65280)+(255&f[p+2]),C.push(e[(S=T)>>18&63]+e[S>>12&63]+e[S>>6&63]+e[63&S]);return C.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},9489:n=>{function I(w,y){var P={seen:[],stylize:e};return arguments.length>=3&&(P.depth=arguments[2]),arguments.length>=4&&(P.colors=arguments[3]),r(y)?P.showHidden=y:y&&N(P,y),i(P.showHidden)&&(P.showHidden=!1),i(P.depth)&&(P.depth=2),i(P.colors)&&(P.colors=!1),i(P.customInspect)&&(P.customInspect=!0),P.colors&&(P.stylize=t),p(P,w,P.depth)}function e(w,y){return w}function r(w){return typeof w=="boolean"}function i(w){return w===void 0}function t(w,y){var P=I.styles[y];return P?"\x1B["+I.colors[P][0]+"m"+w+"\x1B["+I.colors[P][1]+"m":w}function c(w){return typeof w=="function"}function l(w){return typeof w=="string"}function u(w){return w===null}function o(w,y){return Object.prototype.hasOwnProperty.call(w,y)}function f(w){return g(w)&&S(w)==="[object RegExp]"}function g(w){return typeof w=="object"&&w!==null}function h(w){return g(w)&&(S(w)==="[object Error]"||w instanceof Error)}function T(w){return g(w)&&S(w)==="[object Date]"}function S(w){return Object.prototype.toString.call(w)}function C(w){return"["+Error.prototype.toString.call(w)+"]"}function p(w,y,P){if(w.customInspect&&y&&c(y.inspect)&&y.inspect!==I&&(!y.constructor||y.constructor.prototype!==y)){var x=y.inspect(P,w);return l(x)||(x=p(w,x,P)),x}var B=function(_,U){if(i(U))return _.stylize("undefined","undefined");if(l(U)){var A="'"+JSON.stringify(U).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return _.stylize(A,"string")}return typeof U=="number"?_.stylize(""+U,"number"):r(U)?_.stylize(""+U,"boolean"):u(U)?_.stylize("null","null"):void 0}(w,y);if(B)return B;var H=Object.keys(y),L=function(_){var U={};return _.forEach(function(A,z){U[A]=!0}),U}(H);try{w.showHidden&&Object.getOwnPropertyNames&&(H=Object.getOwnPropertyNames(y))}catch{}if(h(y)&&(H.indexOf("message")>=0||H.indexOf("description")>=0))return C(y);if(H.length===0){if(c(y)){var M=y.name?": "+y.name:"";return w.stylize("[Function"+M+"]","special")}if(f(y))return w.stylize(RegExp.prototype.toString.call(y),"regexp");if(T(y))return w.stylize(Date.prototype.toString.call(y),"date");if(h(y))return C(y)}var G,K="",F=!1,Y=["{","}"];return Array.isArray(y)&&(F=!0,Y=["[","]"]),c(y)&&(K=" [Function"+(y.name?": "+y.name:"")+"]"),f(y)&&(K=" "+RegExp.prototype.toString.call(y)),T(y)&&(K=" "+Date.prototype.toUTCString.call(y)),h(y)&&(K=" "+C(y)),H.length!==0||F&&y.length!=0?P<0?f(y)?w.stylize(RegExp.prototype.toString.call(y),"regexp"):w.stylize("[Object]","special"):(w.seen.push(y),G=F?function(_,U,A,z,J){for(var se=[],Te=0,pe=U.length;Te<pe;++Te)o(U,String(Te))?se.push(R(_,U,A,z,String(Te),!0)):se.push("");return J.forEach(function(ne){ne.match(/^\d+$/)||se.push(R(_,U,A,z,ne,!0))}),se}(w,y,P,L,H):H.map(function(_){return R(w,y,P,L,_,F)}),w.seen.pop(),function(_,U,A){return _.reduce(function(z,J){return J.indexOf(`
`),z+J.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?A[0]+(U===""?"":U+`
 `)+" "+_.join(`,
  `)+" "+A[1]:A[0]+U+" "+_.join(", ")+" "+A[1]}(G,K,Y)):Y[0]+K+Y[1]}function R(w,y,P,x,B,H){var L,M,G;G={value:void 0};try{G.value=y[B]}catch{}try{Object.getOwnPropertyDescriptor&&(G=Object.getOwnPropertyDescriptor(y,B)||G)}catch{}if(G.get?M=G.set?w.stylize("[Getter/Setter]","special"):w.stylize("[Getter]","special"):G.set&&(M=w.stylize("[Setter]","special")),o(x,B)||(L="["+B+"]"),M||(w.seen.indexOf(G.value)<0?(M=u(P)?p(w,G.value,null):p(w,G.value,P-1)).indexOf(`
`)>-1&&(M=H?M.split(`
`).map(function(K){return"  "+K}).join(`
`).substr(2):`
`+M.split(`
`).map(function(K){return"   "+K}).join(`
`)):M=w.stylize("[Circular]","special")),i(L)){if(H&&B.match(/^\d+$/))return M;(L=JSON.stringify(""+B)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(L=L.substr(1,L.length-2),L=w.stylize(L,"name")):(L=L.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),L=w.stylize(L,"string"))}return L+": "+M}function N(w,y){if(!y||!g(y))return w;for(var P=Object.keys(y),x=P.length;x--;)w[P[x]]=y[P[x]];return w}n.exports=I,I.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},I.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"}},8764:(n,I,e)=>{const r=e(9742),i=e(645),t=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;I.lW=u,I.h2=50;const c=2147483647;function l(d){if(d>c)throw new RangeError('The value "'+d+'" is invalid for option "size"');const O=new Uint8Array(d);return Object.setPrototypeOf(O,u.prototype),O}function u(d,O,D){if(typeof d=="number"){if(typeof O=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return g(d)}return o(d,O,D)}function o(d,O,D){if(typeof d=="string")return function(ce,me){if(typeof me=="string"&&me!==""||(me="utf8"),!u.isEncoding(me))throw new TypeError("Unknown encoding: "+me);const Ee=0|C(ce,me);let Ce=l(Ee);const Me=Ce.write(ce,me);return Me!==Ee&&(Ce=Ce.slice(0,Me)),Ce}(d,O);if(ArrayBuffer.isView(d))return function(ce){if(ve(ce,Uint8Array)){const me=new Uint8Array(ce);return T(me.buffer,me.byteOffset,me.byteLength)}return h(ce)}(d);if(d==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d);if(ve(d,ArrayBuffer)||d&&ve(d.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(ve(d,SharedArrayBuffer)||d&&ve(d.buffer,SharedArrayBuffer)))return T(d,O,D);if(typeof d=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const Q=d.valueOf&&d.valueOf();if(Q!=null&&Q!==d)return u.from(Q,O,D);const re=function(ce){if(u.isBuffer(ce)){const me=0|S(ce.length),Ee=l(me);return Ee.length===0||ce.copy(Ee,0,0,me),Ee}return ce.length!==void 0?typeof ce.length!="number"||Qe(ce.length)?l(0):h(ce):ce.type==="Buffer"&&Array.isArray(ce.data)?h(ce.data):void 0}(d);if(re)return re;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof d[Symbol.toPrimitive]=="function")return u.from(d[Symbol.toPrimitive]("string"),O,D);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof d)}function f(d){if(typeof d!="number")throw new TypeError('"size" argument must be of type number');if(d<0)throw new RangeError('The value "'+d+'" is invalid for option "size"')}function g(d){return f(d),l(d<0?0:0|S(d))}function h(d){const O=d.length<0?0:0|S(d.length),D=l(O);for(let Q=0;Q<O;Q+=1)D[Q]=255&d[Q];return D}function T(d,O,D){if(O<0||d.byteLength<O)throw new RangeError('"offset" is outside of buffer bounds');if(d.byteLength<O+(D||0))throw new RangeError('"length" is outside of buffer bounds');let Q;return Q=O===void 0&&D===void 0?new Uint8Array(d):D===void 0?new Uint8Array(d,O):new Uint8Array(d,O,D),Object.setPrototypeOf(Q,u.prototype),Q}function S(d){if(d>=c)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+c.toString(16)+" bytes");return 0|d}function C(d,O){if(u.isBuffer(d))return d.length;if(ArrayBuffer.isView(d)||ve(d,ArrayBuffer))return d.byteLength;if(typeof d!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof d);const D=d.length,Q=arguments.length>2&&arguments[2]===!0;if(!Q&&D===0)return 0;let re=!1;for(;;)switch(O){case"ascii":case"latin1":case"binary":return D;case"utf8":case"utf-8":return ie(d).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*D;case"hex":return D>>>1;case"base64":return q(d).length;default:if(re)return Q?-1:ie(d).length;O=(""+O).toLowerCase(),re=!0}}function p(d,O,D){let Q=!1;if((O===void 0||O<0)&&(O=0),O>this.length||((D===void 0||D>this.length)&&(D=this.length),D<=0)||(D>>>=0)<=(O>>>=0))return"";for(d||(d="utf8");;)switch(d){case"hex":return Y(this,O,D);case"utf8":case"utf-8":return M(this,O,D);case"ascii":return K(this,O,D);case"latin1":case"binary":return F(this,O,D);case"base64":return L(this,O,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,O,D);default:if(Q)throw new TypeError("Unknown encoding: "+d);d=(d+"").toLowerCase(),Q=!0}}function R(d,O,D){const Q=d[O];d[O]=d[D],d[D]=Q}function N(d,O,D,Q,re){if(d.length===0)return-1;if(typeof D=="string"?(Q=D,D=0):D>2147483647?D=2147483647:D<-2147483648&&(D=-2147483648),Qe(D=+D)&&(D=re?0:d.length-1),D<0&&(D=d.length+D),D>=d.length){if(re)return-1;D=d.length-1}else if(D<0){if(!re)return-1;D=0}if(typeof O=="string"&&(O=u.from(O,Q)),u.isBuffer(O))return O.length===0?-1:w(d,O,D,Q,re);if(typeof O=="number")return O&=255,typeof Uint8Array.prototype.indexOf=="function"?re?Uint8Array.prototype.indexOf.call(d,O,D):Uint8Array.prototype.lastIndexOf.call(d,O,D):w(d,[O],D,Q,re);throw new TypeError("val must be string, number or Buffer")}function w(d,O,D,Q,re){let ce,me=1,Ee=d.length,Ce=O.length;if(Q!==void 0&&((Q=String(Q).toLowerCase())==="ucs2"||Q==="ucs-2"||Q==="utf16le"||Q==="utf-16le")){if(d.length<2||O.length<2)return-1;me=2,Ee/=2,Ce/=2,D/=2}function Me(Be,He){return me===1?Be[He]:Be.readUInt16BE(He*me)}if(re){let Be=-1;for(ce=D;ce<Ee;ce++)if(Me(d,ce)===Me(O,Be===-1?0:ce-Be)){if(Be===-1&&(Be=ce),ce-Be+1===Ce)return Be*me}else Be!==-1&&(ce-=ce-Be),Be=-1}else for(D+Ce>Ee&&(D=Ee-Ce),ce=D;ce>=0;ce--){let Be=!0;for(let He=0;He<Ce;He++)if(Me(d,ce+He)!==Me(O,He)){Be=!1;break}if(Be)return ce}return-1}function y(d,O,D,Q){D=Number(D)||0;const re=d.length-D;Q?(Q=Number(Q))>re&&(Q=re):Q=re;const ce=O.length;let me;for(Q>ce/2&&(Q=ce/2),me=0;me<Q;++me){const Ee=parseInt(O.substr(2*me,2),16);if(Qe(Ee))return me;d[D+me]=Ee}return me}function P(d,O,D,Q){return Pe(ie(O,d.length-D),d,D,Q)}function x(d,O,D,Q){return Pe(function(re){const ce=[];for(let me=0;me<re.length;++me)ce.push(255&re.charCodeAt(me));return ce}(O),d,D,Q)}function B(d,O,D,Q){return Pe(q(O),d,D,Q)}function H(d,O,D,Q){return Pe(function(re,ce){let me,Ee,Ce;const Me=[];for(let Be=0;Be<re.length&&!((ce-=2)<0);++Be)me=re.charCodeAt(Be),Ee=me>>8,Ce=me%256,Me.push(Ce),Me.push(Ee);return Me}(O,d.length-D),d,D,Q)}function L(d,O,D){return O===0&&D===d.length?r.fromByteArray(d):r.fromByteArray(d.slice(O,D))}function M(d,O,D){D=Math.min(d.length,D);const Q=[];let re=O;for(;re<D;){const ce=d[re];let me=null,Ee=ce>239?4:ce>223?3:ce>191?2:1;if(re+Ee<=D){let Ce,Me,Be,He;switch(Ee){case 1:ce<128&&(me=ce);break;case 2:Ce=d[re+1],(192&Ce)==128&&(He=(31&ce)<<6|63&Ce,He>127&&(me=He));break;case 3:Ce=d[re+1],Me=d[re+2],(192&Ce)==128&&(192&Me)==128&&(He=(15&ce)<<12|(63&Ce)<<6|63&Me,He>2047&&(He<55296||He>57343)&&(me=He));break;case 4:Ce=d[re+1],Me=d[re+2],Be=d[re+3],(192&Ce)==128&&(192&Me)==128&&(192&Be)==128&&(He=(15&ce)<<18|(63&Ce)<<12|(63&Me)<<6|63&Be,He>65535&&He<1114112&&(me=He))}}me===null?(me=65533,Ee=1):me>65535&&(me-=65536,Q.push(me>>>10&1023|55296),me=56320|1023&me),Q.push(me),re+=Ee}return function(ce){const me=ce.length;if(me<=G)return String.fromCharCode.apply(String,ce);let Ee="",Ce=0;for(;Ce<me;)Ee+=String.fromCharCode.apply(String,ce.slice(Ce,Ce+=G));return Ee}(Q)}u.TYPED_ARRAY_SUPPORT=function(){try{const d=new Uint8Array(1),O={foo:function(){return 42}};return Object.setPrototypeOf(O,Uint8Array.prototype),Object.setPrototypeOf(d,O),d.foo()===42}catch{return!1}}(),u.TYPED_ARRAY_SUPPORT||typeof console>"u"||typeof console.error!="function"||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}}),u.poolSize=8192,u.from=function(d,O,D){return o(d,O,D)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array),u.alloc=function(d,O,D){return function(Q,re,ce){return f(Q),Q<=0?l(Q):re!==void 0?typeof ce=="string"?l(Q).fill(re,ce):l(Q).fill(re):l(Q)}(d,O,D)},u.allocUnsafe=function(d){return g(d)},u.allocUnsafeSlow=function(d){return g(d)},u.isBuffer=function(d){return d!=null&&d._isBuffer===!0&&d!==u.prototype},u.compare=function(d,O){if(ve(d,Uint8Array)&&(d=u.from(d,d.offset,d.byteLength)),ve(O,Uint8Array)&&(O=u.from(O,O.offset,O.byteLength)),!u.isBuffer(d)||!u.isBuffer(O))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(d===O)return 0;let D=d.length,Q=O.length;for(let re=0,ce=Math.min(D,Q);re<ce;++re)if(d[re]!==O[re]){D=d[re],Q=O[re];break}return D<Q?-1:Q<D?1:0},u.isEncoding=function(d){switch(String(d).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(d,O){if(!Array.isArray(d))throw new TypeError('"list" argument must be an Array of Buffers');if(d.length===0)return u.alloc(0);let D;if(O===void 0)for(O=0,D=0;D<d.length;++D)O+=d[D].length;const Q=u.allocUnsafe(O);let re=0;for(D=0;D<d.length;++D){let ce=d[D];if(ve(ce,Uint8Array))re+ce.length>Q.length?(u.isBuffer(ce)||(ce=u.from(ce)),ce.copy(Q,re)):Uint8Array.prototype.set.call(Q,ce,re);else{if(!u.isBuffer(ce))throw new TypeError('"list" argument must be an Array of Buffers');ce.copy(Q,re)}re+=ce.length}return Q},u.byteLength=C,u.prototype._isBuffer=!0,u.prototype.swap16=function(){const d=this.length;if(d%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let O=0;O<d;O+=2)R(this,O,O+1);return this},u.prototype.swap32=function(){const d=this.length;if(d%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let O=0;O<d;O+=4)R(this,O,O+3),R(this,O+1,O+2);return this},u.prototype.swap64=function(){const d=this.length;if(d%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let O=0;O<d;O+=8)R(this,O,O+7),R(this,O+1,O+6),R(this,O+2,O+5),R(this,O+3,O+4);return this},u.prototype.toString=function(){const d=this.length;return d===0?"":arguments.length===0?M(this,0,d):p.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(d){if(!u.isBuffer(d))throw new TypeError("Argument must be a Buffer");return this===d||u.compare(this,d)===0},u.prototype.inspect=function(){let d="";const O=I.h2;return d=this.toString("hex",0,O).replace(/(.{2})/g,"$1 ").trim(),this.length>O&&(d+=" ... "),"<Buffer "+d+">"},t&&(u.prototype[t]=u.prototype.inspect),u.prototype.compare=function(d,O,D,Q,re){if(ve(d,Uint8Array)&&(d=u.from(d,d.offset,d.byteLength)),!u.isBuffer(d))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof d);if(O===void 0&&(O=0),D===void 0&&(D=d?d.length:0),Q===void 0&&(Q=0),re===void 0&&(re=this.length),O<0||D>d.length||Q<0||re>this.length)throw new RangeError("out of range index");if(Q>=re&&O>=D)return 0;if(Q>=re)return-1;if(O>=D)return 1;if(this===d)return 0;let ce=(re>>>=0)-(Q>>>=0),me=(D>>>=0)-(O>>>=0);const Ee=Math.min(ce,me),Ce=this.slice(Q,re),Me=d.slice(O,D);for(let Be=0;Be<Ee;++Be)if(Ce[Be]!==Me[Be]){ce=Ce[Be],me=Me[Be];break}return ce<me?-1:me<ce?1:0},u.prototype.includes=function(d,O,D){return this.indexOf(d,O,D)!==-1},u.prototype.indexOf=function(d,O,D){return N(this,d,O,D,!0)},u.prototype.lastIndexOf=function(d,O,D){return N(this,d,O,D,!1)},u.prototype.write=function(d,O,D,Q){if(O===void 0)Q="utf8",D=this.length,O=0;else if(D===void 0&&typeof O=="string")Q=O,D=this.length,O=0;else{if(!isFinite(O))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");O>>>=0,isFinite(D)?(D>>>=0,Q===void 0&&(Q="utf8")):(Q=D,D=void 0)}const re=this.length-O;if((D===void 0||D>re)&&(D=re),d.length>0&&(D<0||O<0)||O>this.length)throw new RangeError("Attempt to write outside buffer bounds");Q||(Q="utf8");let ce=!1;for(;;)switch(Q){case"hex":return y(this,d,O,D);case"utf8":case"utf-8":return P(this,d,O,D);case"ascii":case"latin1":case"binary":return x(this,d,O,D);case"base64":return B(this,d,O,D);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return H(this,d,O,D);default:if(ce)throw new TypeError("Unknown encoding: "+Q);Q=(""+Q).toLowerCase(),ce=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const G=4096;function K(d,O,D){let Q="";D=Math.min(d.length,D);for(let re=O;re<D;++re)Q+=String.fromCharCode(127&d[re]);return Q}function F(d,O,D){let Q="";D=Math.min(d.length,D);for(let re=O;re<D;++re)Q+=String.fromCharCode(d[re]);return Q}function Y(d,O,D){const Q=d.length;(!O||O<0)&&(O=0),(!D||D<0||D>Q)&&(D=Q);let re="";for(let ce=O;ce<D;++ce)re+=Z[d[ce]];return re}function _(d,O,D){const Q=d.slice(O,D);let re="";for(let ce=0;ce<Q.length-1;ce+=2)re+=String.fromCharCode(Q[ce]+256*Q[ce+1]);return re}function U(d,O,D){if(d%1!=0||d<0)throw new RangeError("offset is not uint");if(d+O>D)throw new RangeError("Trying to access beyond buffer length")}function A(d,O,D,Q,re,ce){if(!u.isBuffer(d))throw new TypeError('"buffer" argument must be a Buffer instance');if(O>re||O<ce)throw new RangeError('"value" argument is out of bounds');if(D+Q>d.length)throw new RangeError("Index out of range")}function z(d,O,D,Q,re){_e(O,Q,re,d,D,7);let ce=Number(O&BigInt(4294967295));d[D++]=ce,ce>>=8,d[D++]=ce,ce>>=8,d[D++]=ce,ce>>=8,d[D++]=ce;let me=Number(O>>BigInt(32)&BigInt(4294967295));return d[D++]=me,me>>=8,d[D++]=me,me>>=8,d[D++]=me,me>>=8,d[D++]=me,D}function J(d,O,D,Q,re){_e(O,Q,re,d,D,7);let ce=Number(O&BigInt(4294967295));d[D+7]=ce,ce>>=8,d[D+6]=ce,ce>>=8,d[D+5]=ce,ce>>=8,d[D+4]=ce;let me=Number(O>>BigInt(32)&BigInt(4294967295));return d[D+3]=me,me>>=8,d[D+2]=me,me>>=8,d[D+1]=me,me>>=8,d[D]=me,D+8}function se(d,O,D,Q,re,ce){if(D+Q>d.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("Index out of range")}function Te(d,O,D,Q,re){return O=+O,D>>>=0,re||se(d,0,D,4),i.write(d,O,D,Q,23,4),D+4}function pe(d,O,D,Q,re){return O=+O,D>>>=0,re||se(d,0,D,8),i.write(d,O,D,Q,52,8),D+8}u.prototype.slice=function(d,O){const D=this.length;(d=~~d)<0?(d+=D)<0&&(d=0):d>D&&(d=D),(O=O===void 0?D:~~O)<0?(O+=D)<0&&(O=0):O>D&&(O=D),O<d&&(O=d);const Q=this.subarray(d,O);return Object.setPrototypeOf(Q,u.prototype),Q},u.prototype.readUintLE=u.prototype.readUIntLE=function(d,O,D){d>>>=0,O>>>=0,D||U(d,O,this.length);let Q=this[d],re=1,ce=0;for(;++ce<O&&(re*=256);)Q+=this[d+ce]*re;return Q},u.prototype.readUintBE=u.prototype.readUIntBE=function(d,O,D){d>>>=0,O>>>=0,D||U(d,O,this.length);let Q=this[d+--O],re=1;for(;O>0&&(re*=256);)Q+=this[d+--O]*re;return Q},u.prototype.readUint8=u.prototype.readUInt8=function(d,O){return d>>>=0,O||U(d,1,this.length),this[d]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(d,O){return d>>>=0,O||U(d,2,this.length),this[d]|this[d+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(d,O){return d>>>=0,O||U(d,2,this.length),this[d]<<8|this[d+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(d,O){return d>>>=0,O||U(d,4,this.length),(this[d]|this[d+1]<<8|this[d+2]<<16)+16777216*this[d+3]},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(d,O){return d>>>=0,O||U(d,4,this.length),16777216*this[d]+(this[d+1]<<16|this[d+2]<<8|this[d+3])},u.prototype.readBigUInt64LE=ee(function(d){b(d>>>=0,"offset");const O=this[d],D=this[d+7];O!==void 0&&D!==void 0||X(d,this.length-8);const Q=O+256*this[++d]+65536*this[++d]+this[++d]*2**24,re=this[++d]+256*this[++d]+65536*this[++d]+D*2**24;return BigInt(Q)+(BigInt(re)<<BigInt(32))}),u.prototype.readBigUInt64BE=ee(function(d){b(d>>>=0,"offset");const O=this[d],D=this[d+7];O!==void 0&&D!==void 0||X(d,this.length-8);const Q=O*2**24+65536*this[++d]+256*this[++d]+this[++d],re=this[++d]*2**24+65536*this[++d]+256*this[++d]+D;return(BigInt(Q)<<BigInt(32))+BigInt(re)}),u.prototype.readIntLE=function(d,O,D){d>>>=0,O>>>=0,D||U(d,O,this.length);let Q=this[d],re=1,ce=0;for(;++ce<O&&(re*=256);)Q+=this[d+ce]*re;return re*=128,Q>=re&&(Q-=Math.pow(2,8*O)),Q},u.prototype.readIntBE=function(d,O,D){d>>>=0,O>>>=0,D||U(d,O,this.length);let Q=O,re=1,ce=this[d+--Q];for(;Q>0&&(re*=256);)ce+=this[d+--Q]*re;return re*=128,ce>=re&&(ce-=Math.pow(2,8*O)),ce},u.prototype.readInt8=function(d,O){return d>>>=0,O||U(d,1,this.length),128&this[d]?-1*(255-this[d]+1):this[d]},u.prototype.readInt16LE=function(d,O){d>>>=0,O||U(d,2,this.length);const D=this[d]|this[d+1]<<8;return 32768&D?4294901760|D:D},u.prototype.readInt16BE=function(d,O){d>>>=0,O||U(d,2,this.length);const D=this[d+1]|this[d]<<8;return 32768&D?4294901760|D:D},u.prototype.readInt32LE=function(d,O){return d>>>=0,O||U(d,4,this.length),this[d]|this[d+1]<<8|this[d+2]<<16|this[d+3]<<24},u.prototype.readInt32BE=function(d,O){return d>>>=0,O||U(d,4,this.length),this[d]<<24|this[d+1]<<16|this[d+2]<<8|this[d+3]},u.prototype.readBigInt64LE=ee(function(d){b(d>>>=0,"offset");const O=this[d],D=this[d+7];O!==void 0&&D!==void 0||X(d,this.length-8);const Q=this[d+4]+256*this[d+5]+65536*this[d+6]+(D<<24);return(BigInt(Q)<<BigInt(32))+BigInt(O+256*this[++d]+65536*this[++d]+this[++d]*16777216)}),u.prototype.readBigInt64BE=ee(function(d){b(d>>>=0,"offset");const O=this[d],D=this[d+7];O!==void 0&&D!==void 0||X(d,this.length-8);const Q=(O<<24)+65536*this[++d]+256*this[++d]+this[++d];return(BigInt(Q)<<BigInt(32))+BigInt(this[++d]*16777216+65536*this[++d]+256*this[++d]+D)}),u.prototype.readFloatLE=function(d,O){return d>>>=0,O||U(d,4,this.length),i.read(this,d,!0,23,4)},u.prototype.readFloatBE=function(d,O){return d>>>=0,O||U(d,4,this.length),i.read(this,d,!1,23,4)},u.prototype.readDoubleLE=function(d,O){return d>>>=0,O||U(d,8,this.length),i.read(this,d,!0,52,8)},u.prototype.readDoubleBE=function(d,O){return d>>>=0,O||U(d,8,this.length),i.read(this,d,!1,52,8)},u.prototype.writeUintLE=u.prototype.writeUIntLE=function(d,O,D,Q){d=+d,O>>>=0,D>>>=0,Q||A(this,d,O,D,Math.pow(2,8*D)-1,0);let re=1,ce=0;for(this[O]=255&d;++ce<D&&(re*=256);)this[O+ce]=d/re&255;return O+D},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(d,O,D,Q){d=+d,O>>>=0,D>>>=0,Q||A(this,d,O,D,Math.pow(2,8*D)-1,0);let re=D-1,ce=1;for(this[O+re]=255&d;--re>=0&&(ce*=256);)this[O+re]=d/ce&255;return O+D},u.prototype.writeUint8=u.prototype.writeUInt8=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,1,255,0),this[O]=255&d,O+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,2,65535,0),this[O]=255&d,this[O+1]=d>>>8,O+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,2,65535,0),this[O]=d>>>8,this[O+1]=255&d,O+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,4,4294967295,0),this[O+3]=d>>>24,this[O+2]=d>>>16,this[O+1]=d>>>8,this[O]=255&d,O+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,4,4294967295,0),this[O]=d>>>24,this[O+1]=d>>>16,this[O+2]=d>>>8,this[O+3]=255&d,O+4},u.prototype.writeBigUInt64LE=ee(function(d,O=0){return z(this,d,O,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=ee(function(d,O=0){return J(this,d,O,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(d,O,D,Q){if(d=+d,O>>>=0,!Q){const Ee=Math.pow(2,8*D-1);A(this,d,O,D,Ee-1,-Ee)}let re=0,ce=1,me=0;for(this[O]=255&d;++re<D&&(ce*=256);)d<0&&me===0&&this[O+re-1]!==0&&(me=1),this[O+re]=(d/ce>>0)-me&255;return O+D},u.prototype.writeIntBE=function(d,O,D,Q){if(d=+d,O>>>=0,!Q){const Ee=Math.pow(2,8*D-1);A(this,d,O,D,Ee-1,-Ee)}let re=D-1,ce=1,me=0;for(this[O+re]=255&d;--re>=0&&(ce*=256);)d<0&&me===0&&this[O+re+1]!==0&&(me=1),this[O+re]=(d/ce>>0)-me&255;return O+D},u.prototype.writeInt8=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,1,127,-128),d<0&&(d=255+d+1),this[O]=255&d,O+1},u.prototype.writeInt16LE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,2,32767,-32768),this[O]=255&d,this[O+1]=d>>>8,O+2},u.prototype.writeInt16BE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,2,32767,-32768),this[O]=d>>>8,this[O+1]=255&d,O+2},u.prototype.writeInt32LE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,4,2147483647,-2147483648),this[O]=255&d,this[O+1]=d>>>8,this[O+2]=d>>>16,this[O+3]=d>>>24,O+4},u.prototype.writeInt32BE=function(d,O,D){return d=+d,O>>>=0,D||A(this,d,O,4,2147483647,-2147483648),d<0&&(d=4294967295+d+1),this[O]=d>>>24,this[O+1]=d>>>16,this[O+2]=d>>>8,this[O+3]=255&d,O+4},u.prototype.writeBigInt64LE=ee(function(d,O=0){return z(this,d,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=ee(function(d,O=0){return J(this,d,O,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeFloatLE=function(d,O,D){return Te(this,d,O,!0,D)},u.prototype.writeFloatBE=function(d,O,D){return Te(this,d,O,!1,D)},u.prototype.writeDoubleLE=function(d,O,D){return pe(this,d,O,!0,D)},u.prototype.writeDoubleBE=function(d,O,D){return pe(this,d,O,!1,D)},u.prototype.copy=function(d,O,D,Q){if(!u.isBuffer(d))throw new TypeError("argument should be a Buffer");if(D||(D=0),Q||Q===0||(Q=this.length),O>=d.length&&(O=d.length),O||(O=0),Q>0&&Q<D&&(Q=D),Q===D||d.length===0||this.length===0)return 0;if(O<0)throw new RangeError("targetStart out of bounds");if(D<0||D>=this.length)throw new RangeError("Index out of range");if(Q<0)throw new RangeError("sourceEnd out of bounds");Q>this.length&&(Q=this.length),d.length-O<Q-D&&(Q=d.length-O+D);const re=Q-D;return this===d&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(O,D,Q):Uint8Array.prototype.set.call(d,this.subarray(D,Q),O),re},u.prototype.fill=function(d,O,D,Q){if(typeof d=="string"){if(typeof O=="string"?(Q=O,O=0,D=this.length):typeof D=="string"&&(Q=D,D=this.length),Q!==void 0&&typeof Q!="string")throw new TypeError("encoding must be a string");if(typeof Q=="string"&&!u.isEncoding(Q))throw new TypeError("Unknown encoding: "+Q);if(d.length===1){const ce=d.charCodeAt(0);(Q==="utf8"&&ce<128||Q==="latin1")&&(d=ce)}}else typeof d=="number"?d&=255:typeof d=="boolean"&&(d=Number(d));if(O<0||this.length<O||this.length<D)throw new RangeError("Out of range index");if(D<=O)return this;let re;if(O>>>=0,D=D===void 0?this.length:D>>>0,d||(d=0),typeof d=="number")for(re=O;re<D;++re)this[re]=d;else{const ce=u.isBuffer(d)?d:u.from(d,Q),me=ce.length;if(me===0)throw new TypeError('The value "'+d+'" is invalid for argument "value"');for(re=0;re<D-O;++re)this[re+O]=ce[re%me]}return this};const ne={};function oe(d,O,D){ne[d]=class extends D{constructor(){super(),Object.defineProperty(this,"message",{value:O.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${d}]`,this.stack,delete this.name}get code(){return d}set code(Q){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Q,writable:!0})}toString(){return`${this.name} [${d}]: ${this.message}`}}}function de(d){let O="",D=d.length;const Q=d[0]==="-"?1:0;for(;D>=Q+4;D-=3)O=`_${d.slice(D-3,D)}${O}`;return`${d.slice(0,D)}${O}`}function _e(d,O,D,Q,re,ce){if(d>D||d<O){const me=typeof O=="bigint"?"n":"";let Ee;throw Ee=ce>3?O===0||O===BigInt(0)?`>= 0${me} and < 2${me} ** ${8*(ce+1)}${me}`:`>= -(2${me} ** ${8*(ce+1)-1}${me}) and < 2 ** ${8*(ce+1)-1}${me}`:`>= ${O}${me} and <= ${D}${me}`,new ne.ERR_OUT_OF_RANGE("value",Ee,d)}(function(me,Ee,Ce){b(Ee,"offset"),me[Ee]!==void 0&&me[Ee+Ce]!==void 0||X(Ee,me.length-(Ce+1))})(Q,re,ce)}function b(d,O){if(typeof d!="number")throw new ne.ERR_INVALID_ARG_TYPE(O,"number",d)}function X(d,O,D){throw Math.floor(d)!==d?(b(d,D),new ne.ERR_OUT_OF_RANGE(D||"offset","an integer",d)):O<0?new ne.ERR_BUFFER_OUT_OF_BOUNDS:new ne.ERR_OUT_OF_RANGE(D||"offset",`>= ${D?1:0} and <= ${O}`,d)}oe("ERR_BUFFER_OUT_OF_BOUNDS",function(d){return d?`${d} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),oe("ERR_INVALID_ARG_TYPE",function(d,O){return`The "${d}" argument must be of type number. Received type ${typeof O}`},TypeError),oe("ERR_OUT_OF_RANGE",function(d,O,D){let Q=`The value of "${d}" is out of range.`,re=D;return Number.isInteger(D)&&Math.abs(D)>4294967296?re=de(String(D)):typeof D=="bigint"&&(re=String(D),(D>BigInt(2)**BigInt(32)||D<-(BigInt(2)**BigInt(32)))&&(re=de(re)),re+="n"),Q+=` It must be ${O}. Received ${re}`,Q},RangeError);const ae=/[^+/0-9A-Za-z-_]/g;function ie(d,O){let D;O=O||1/0;const Q=d.length;let re=null;const ce=[];for(let me=0;me<Q;++me){if(D=d.charCodeAt(me),D>55295&&D<57344){if(!re){if(D>56319){(O-=3)>-1&&ce.push(239,191,189);continue}if(me+1===Q){(O-=3)>-1&&ce.push(239,191,189);continue}re=D;continue}if(D<56320){(O-=3)>-1&&ce.push(239,191,189),re=D;continue}D=65536+(re-55296<<10|D-56320)}else re&&(O-=3)>-1&&ce.push(239,191,189);if(re=null,D<128){if((O-=1)<0)break;ce.push(D)}else if(D<2048){if((O-=2)<0)break;ce.push(D>>6|192,63&D|128)}else if(D<65536){if((O-=3)<0)break;ce.push(D>>12|224,D>>6&63|128,63&D|128)}else{if(!(D<1114112))throw new Error("Invalid code point");if((O-=4)<0)break;ce.push(D>>18|240,D>>12&63|128,D>>6&63|128,63&D|128)}}return ce}function q(d){return r.toByteArray(function(O){if((O=(O=O.split("=")[0]).trim().replace(ae,"")).length<2)return"";for(;O.length%4!=0;)O+="=";return O}(d))}function Pe(d,O,D,Q){let re;for(re=0;re<Q&&!(re+D>=O.length||re>=d.length);++re)O[re+D]=d[re];return re}function ve(d,O){return d instanceof O||d!=null&&d.constructor!=null&&d.constructor.name!=null&&d.constructor.name===O.name}function Qe(d){return d!=d}const Z=function(){const d="0123456789abcdef",O=new Array(256);for(let D=0;D<16;++D){const Q=16*D;for(let re=0;re<16;++re)O[Q+re]=d[D]+d[re]}return O}();function ee(d){return typeof BigInt>"u"?ge:d}function ge(){throw new Error("BigInt not supported")}},6313:(n,I,e)=>{var r=e(8764).lW,i=function(){function t(h,T){return T!=null&&h instanceof T}var c,l,u;try{c=Map}catch{c=function(){}}try{l=Set}catch{l=function(){}}try{u=Promise}catch{u=function(){}}function o(h,T,S,C,p){typeof T=="object"&&(S=T.depth,C=T.prototype,p=T.includeNonEnumerable,T=T.circular);var R=[],N=[],w=r!==void 0;return T===void 0&&(T=!0),S===void 0&&(S=1/0),function y(P,x){if(P===null)return null;if(x===0)return P;var B,H;if(typeof P!="object")return P;if(t(P,c))B=new c;else if(t(P,l))B=new l;else if(t(P,u))B=new u(function(A,z){P.then(function(J){A(y(J,x-1))},function(J){z(y(J,x-1))})});else if(o.__isArray(P))B=[];else if(o.__isRegExp(P))B=new RegExp(P.source,g(P)),P.lastIndex&&(B.lastIndex=P.lastIndex);else if(o.__isDate(P))B=new Date(P.getTime());else{if(w&&r.isBuffer(P))return B=r.allocUnsafe?r.allocUnsafe(P.length):new r(P.length),P.copy(B),B;t(P,Error)?B=Object.create(P):C===void 0?(H=Object.getPrototypeOf(P),B=Object.create(H)):(B=Object.create(C),H=C)}if(T){var L=R.indexOf(P);if(L!=-1)return N[L];R.push(P),N.push(B)}for(var M in t(P,c)&&P.forEach(function(A,z){var J=y(z,x-1),se=y(A,x-1);B.set(J,se)}),t(P,l)&&P.forEach(function(A){var z=y(A,x-1);B.add(z)}),P){var G;H&&(G=Object.getOwnPropertyDescriptor(H,M)),G&&G.set==null||(B[M]=y(P[M],x-1))}if(Object.getOwnPropertySymbols){var K=Object.getOwnPropertySymbols(P);for(M=0;M<K.length;M++){var F=K[M];(!(_=Object.getOwnPropertyDescriptor(P,F))||_.enumerable||p)&&(B[F]=y(P[F],x-1),_.enumerable||Object.defineProperty(B,F,{enumerable:!1}))}}if(p){var Y=Object.getOwnPropertyNames(P);for(M=0;M<Y.length;M++){var _,U=Y[M];(_=Object.getOwnPropertyDescriptor(P,U))&&_.enumerable||(B[U]=y(P[U],x-1),Object.defineProperty(B,U,{enumerable:!1}))}}return B}(h,S)}function f(h){return Object.prototype.toString.call(h)}function g(h){var T="";return h.global&&(T+="g"),h.ignoreCase&&(T+="i"),h.multiline&&(T+="m"),T}return o.clonePrototype=function(h){if(h===null)return null;var T=function(){};return T.prototype=h,new T},o.__objToStr=f,o.__isDate=function(h){return typeof h=="object"&&f(h)==="[object Date]"},o.__isArray=function(h){return typeof h=="object"&&f(h)==="[object Array]"},o.__isRegExp=function(h){return typeof h=="object"&&f(h)==="[object RegExp]"},o.__getRegExpFlags=g,o}();n.exports&&(n.exports=i)},4370:n=>{var I,e=typeof Reflect=="object"?Reflect:null,r=e&&typeof e.apply=="function"?e.apply:function(p,R,N){return Function.prototype.apply.call(p,R,N)};I=e&&typeof e.ownKeys=="function"?e.ownKeys:Object.getOwnPropertySymbols?function(p){return Object.getOwnPropertyNames(p).concat(Object.getOwnPropertySymbols(p))}:function(p){return Object.getOwnPropertyNames(p)};var i=Number.isNaN||function(p){return p!=p};function t(){t.init.call(this)}n.exports=t,n.exports.once=function(p,R){return new Promise(function(N,w){function y(x){p.removeListener(R,P),w(x)}function P(){typeof p.removeListener=="function"&&p.removeListener("error",y),N([].slice.call(arguments))}C(p,R,P,{once:!0}),R!=="error"&&function(x,B,H){typeof x.on=="function"&&C(x,"error",B,{once:!0})}(p,y)})},t.EventEmitter=t,t.prototype._events=void 0,t.prototype._eventsCount=0,t.prototype._maxListeners=void 0;var c=10;function l(p){if(typeof p!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof p)}function u(p){return p._maxListeners===void 0?t.defaultMaxListeners:p._maxListeners}function o(p,R,N,w){var y,P,x,B;if(l(N),(P=p._events)===void 0?(P=p._events=Object.create(null),p._eventsCount=0):(P.newListener!==void 0&&(p.emit("newListener",R,N.listener?N.listener:N),P=p._events),x=P[R]),x===void 0)x=P[R]=N,++p._eventsCount;else if(typeof x=="function"?x=P[R]=w?[N,x]:[x,N]:w?x.unshift(N):x.push(N),(y=u(p))>0&&x.length>y&&!x.warned){x.warned=!0;var H=new Error("Possible EventEmitter memory leak detected. "+x.length+" "+String(R)+" listeners added. Use emitter.setMaxListeners() to increase limit");H.name="MaxListenersExceededWarning",H.emitter=p,H.type=R,H.count=x.length,B=H,console&&console.warn&&console.warn(B)}return p}function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function g(p,R,N){var w={fired:!1,wrapFn:void 0,target:p,type:R,listener:N},y=f.bind(w);return y.listener=N,w.wrapFn=y,y}function h(p,R,N){var w=p._events;if(w===void 0)return[];var y=w[R];return y===void 0?[]:typeof y=="function"?N?[y.listener||y]:[y]:N?function(P){for(var x=new Array(P.length),B=0;B<x.length;++B)x[B]=P[B].listener||P[B];return x}(y):S(y,y.length)}function T(p){var R=this._events;if(R!==void 0){var N=R[p];if(typeof N=="function")return 1;if(N!==void 0)return N.length}return 0}function S(p,R){for(var N=new Array(R),w=0;w<R;++w)N[w]=p[w];return N}function C(p,R,N,w){if(typeof p.on=="function")w.once?p.once(R,N):p.on(R,N);else{if(typeof p.addEventListener!="function")throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof p);p.addEventListener(R,function y(P){w.once&&p.removeEventListener(R,y),N(P)})}}Object.defineProperty(t,"defaultMaxListeners",{enumerable:!0,get:function(){return c},set:function(p){if(typeof p!="number"||p<0||i(p))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+p+".");c=p}}),t.init=function(){this._events!==void 0&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},t.prototype.setMaxListeners=function(p){if(typeof p!="number"||p<0||i(p))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+p+".");return this._maxListeners=p,this},t.prototype.getMaxListeners=function(){return u(this)},t.prototype.emit=function(p){for(var R=[],N=1;N<arguments.length;N++)R.push(arguments[N]);var w=p==="error",y=this._events;if(y!==void 0)w=w&&y.error===void 0;else if(!w)return!1;if(w){var P;if(R.length>0&&(P=R[0]),P instanceof Error)throw P;var x=new Error("Unhandled error."+(P?" ("+P.message+")":""));throw x.context=P,x}var B=y[p];if(B===void 0)return!1;if(typeof B=="function")r(B,this,R);else{var H=B.length,L=S(B,H);for(N=0;N<H;++N)r(L[N],this,R)}return!0},t.prototype.addListener=function(p,R){return o(this,p,R,!1)},t.prototype.on=t.prototype.addListener,t.prototype.prependListener=function(p,R){return o(this,p,R,!0)},t.prototype.once=function(p,R){return l(R),this.on(p,g(this,p,R)),this},t.prototype.prependOnceListener=function(p,R){return l(R),this.prependListener(p,g(this,p,R)),this},t.prototype.removeListener=function(p,R){var N,w,y,P,x;if(l(R),(w=this._events)===void 0)return this;if((N=w[p])===void 0)return this;if(N===R||N.listener===R)--this._eventsCount==0?this._events=Object.create(null):(delete w[p],w.removeListener&&this.emit("removeListener",p,N.listener||R));else if(typeof N!="function"){for(y=-1,P=N.length-1;P>=0;P--)if(N[P]===R||N[P].listener===R){x=N[P].listener,y=P;break}if(y<0)return this;y===0?N.shift():function(B,H){for(;H+1<B.length;H++)B[H]=B[H+1];B.pop()}(N,y),N.length===1&&(w[p]=N[0]),w.removeListener!==void 0&&this.emit("removeListener",p,x||R)}return this},t.prototype.off=t.prototype.removeListener,t.prototype.removeAllListeners=function(p){var R,N,w;if((N=this._events)===void 0)return this;if(N.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):N[p]!==void 0&&(--this._eventsCount==0?this._events=Object.create(null):delete N[p]),this;if(arguments.length===0){var y,P=Object.keys(N);for(w=0;w<P.length;++w)(y=P[w])!=="removeListener"&&this.removeAllListeners(y);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(typeof(R=N[p])=="function")this.removeListener(p,R);else if(R!==void 0)for(w=R.length-1;w>=0;w--)this.removeListener(p,R[w]);return this},t.prototype.listeners=function(p){return h(this,p,!0)},t.prototype.rawListeners=function(p){return h(this,p,!1)},t.listenerCount=function(p,R){return typeof p.listenerCount=="function"?p.listenerCount(R):T.call(p,R)},t.prototype.listenerCount=T,t.prototype.eventNames=function(){return this._eventsCount>0?I(this._events):[]}},645:(n,I)=>{I.read=function(e,r,i,t,c){var l,u,o=8*c-t-1,f=(1<<o)-1,g=f>>1,h=-7,T=i?c-1:0,S=i?-1:1,C=e[r+T];for(T+=S,l=C&(1<<-h)-1,C>>=-h,h+=o;h>0;l=256*l+e[r+T],T+=S,h-=8);for(u=l&(1<<-h)-1,l>>=-h,h+=t;h>0;u=256*u+e[r+T],T+=S,h-=8);if(l===0)l=1-g;else{if(l===f)return u?NaN:1/0*(C?-1:1);u+=Math.pow(2,t),l-=g}return(C?-1:1)*u*Math.pow(2,l-t)},I.write=function(e,r,i,t,c,l){var u,o,f,g=8*l-c-1,h=(1<<g)-1,T=h>>1,S=c===23?Math.pow(2,-24)-Math.pow(2,-77):0,C=t?0:l-1,p=t?1:-1,R=r<0||r===0&&1/r<0?1:0;for(r=Math.abs(r),isNaN(r)||r===1/0?(o=isNaN(r)?1:0,u=h):(u=Math.floor(Math.log(r)/Math.LN2),r*(f=Math.pow(2,-u))<1&&(u--,f*=2),(r+=u+T>=1?S/f:S*Math.pow(2,1-T))*f>=2&&(u++,f/=2),u+T>=h?(o=0,u=h):u+T>=1?(o=(r*f-1)*Math.pow(2,c),u+=T):(o=r*Math.pow(2,T-1)*Math.pow(2,c),u=0));c>=8;e[i+C]=255&o,C+=p,o/=256,c-=8);for(u=u<<c|o,g+=c;g>0;e[i+C]=255&u,C+=p,u/=256,g-=8);e[i+C-p]|=128*R}},2545:()=>{},8293:()=>{},1209:()=>{},1583:(n,I)=>{var e,r=function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function c(_,U,A){this.low=0|_,this.high=0|U,this.unsigned=!!A}function l(_){return(_&&_.__isLong__)===!0}function u(_){var U=Math.clz32(_&-_);return _?31-U:U}c.prototype.__isLong__,Object.defineProperty(c.prototype,"__isLong__",{value:!0}),c.isLong=l;var o={},f={};function g(_,U){var A,z,J;return U?(J=0<=(_>>>=0)&&_<256)&&(z=f[_])?z:(A=T(_,0,!0),J&&(f[_]=A),A):(J=-128<=(_|=0)&&_<128)&&(z=o[_])?z:(A=T(_,_<0?-1:0,!1),J&&(o[_]=A),A)}function h(_,U){if(isNaN(_))return U?x:P;if(U){if(_<0)return x;if(_>=N)return G}else{if(_<=-w)return K;if(_+1>=w)return M}return _<0?h(-_,U).neg():T(_%R|0,_/R|0,U)}function T(_,U,A){return new c(_,U,A)}c.fromInt=g,c.fromNumber=h,c.fromBits=T;var S=Math.pow;function C(_,U,A){if(_.length===0)throw Error("empty string");if(typeof U=="number"?(A=U,U=!1):U=!!U,_==="NaN"||_==="Infinity"||_==="+Infinity"||_==="-Infinity")return U?x:P;if((A=A||10)<2||36<A)throw RangeError("radix");var z;if((z=_.indexOf("-"))>0)throw Error("interior hyphen");if(z===0)return C(_.substring(1),U,A).neg();for(var J=h(S(A,8)),se=P,Te=0;Te<_.length;Te+=8){var pe=Math.min(8,_.length-Te),ne=parseInt(_.substring(Te,Te+pe),A);if(pe<8){var oe=h(S(A,pe));se=se.mul(oe).add(h(ne))}else se=(se=se.mul(J)).add(h(ne))}return se.unsigned=U,se}function p(_,U){return typeof _=="number"?h(_,U):typeof _=="string"?C(_,U):T(_.low,_.high,typeof U=="boolean"?U:_.unsigned)}c.fromString=C,c.fromValue=p;var R=4294967296,N=R*R,w=N/2,y=g(1<<24),P=g(0);c.ZERO=P;var x=g(0,!0);c.UZERO=x;var B=g(1);c.ONE=B;var H=g(1,!0);c.UONE=H;var L=g(-1);c.NEG_ONE=L;var M=T(-1,2147483647,!1);c.MAX_VALUE=M;var G=T(-1,-1,!0);c.MAX_UNSIGNED_VALUE=G;var K=T(0,-2147483648,!1);c.MIN_VALUE=K;var F=c.prototype;F.toInt=function(){return this.unsigned?this.low>>>0:this.low},F.toNumber=function(){return this.unsigned?(this.high>>>0)*R+(this.low>>>0):this.high*R+(this.low>>>0)},F.toString=function(_){if((_=_||10)<2||36<_)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(K)){var U=h(_),A=this.div(U),z=A.mul(U).sub(this);return A.toString(_)+z.toInt().toString(_)}return"-"+this.neg().toString(_)}for(var J=h(S(_,6),this.unsigned),se=this,Te="";;){var pe=se.div(J),ne=(se.sub(pe.mul(J)).toInt()>>>0).toString(_);if((se=pe).isZero())return ne+Te;for(;ne.length<6;)ne="0"+ne;Te=""+ne+Te}},F.getHighBits=function(){return this.high},F.getHighBitsUnsigned=function(){return this.high>>>0},F.getLowBits=function(){return this.low},F.getLowBitsUnsigned=function(){return this.low>>>0},F.getNumBitsAbs=function(){if(this.isNegative())return this.eq(K)?64:this.neg().getNumBitsAbs();for(var _=this.high!=0?this.high:this.low,U=31;U>0&&!(_&1<<U);U--);return this.high!=0?U+33:U+1},F.isZero=function(){return this.high===0&&this.low===0},F.eqz=F.isZero,F.isNegative=function(){return!this.unsigned&&this.high<0},F.isPositive=function(){return this.unsigned||this.high>=0},F.isOdd=function(){return(1&this.low)==1},F.isEven=function(){return(1&this.low)==0},F.equals=function(_){return l(_)||(_=p(_)),(this.unsigned===_.unsigned||this.high>>>31!=1||_.high>>>31!=1)&&this.high===_.high&&this.low===_.low},F.eq=F.equals,F.notEquals=function(_){return!this.eq(_)},F.neq=F.notEquals,F.ne=F.notEquals,F.lessThan=function(_){return this.comp(_)<0},F.lt=F.lessThan,F.lessThanOrEqual=function(_){return this.comp(_)<=0},F.lte=F.lessThanOrEqual,F.le=F.lessThanOrEqual,F.greaterThan=function(_){return this.comp(_)>0},F.gt=F.greaterThan,F.greaterThanOrEqual=function(_){return this.comp(_)>=0},F.gte=F.greaterThanOrEqual,F.ge=F.greaterThanOrEqual,F.compare=function(_){if(l(_)||(_=p(_)),this.eq(_))return 0;var U=this.isNegative(),A=_.isNegative();return U&&!A?-1:!U&&A?1:this.unsigned?_.high>>>0>this.high>>>0||_.high===this.high&&_.low>>>0>this.low>>>0?-1:1:this.sub(_).isNegative()?-1:1},F.comp=F.compare,F.negate=function(){return!this.unsigned&&this.eq(K)?K:this.not().add(B)},F.neg=F.negate,F.add=function(_){l(_)||(_=p(_));var U=this.high>>>16,A=65535&this.high,z=this.low>>>16,J=65535&this.low,se=_.high>>>16,Te=65535&_.high,pe=_.low>>>16,ne=0,oe=0,de=0,_e=0;return de+=(_e+=J+(65535&_.low))>>>16,oe+=(de+=z+pe)>>>16,ne+=(oe+=A+Te)>>>16,ne+=U+se,T((de&=65535)<<16|(_e&=65535),(ne&=65535)<<16|(oe&=65535),this.unsigned)},F.subtract=function(_){return l(_)||(_=p(_)),this.add(_.neg())},F.sub=F.subtract,F.multiply=function(_){if(this.isZero())return this;if(l(_)||(_=p(_)),t)return T(t.mul(this.low,this.high,_.low,_.high),t.get_high(),this.unsigned);if(_.isZero())return this.unsigned?x:P;if(this.eq(K))return _.isOdd()?K:P;if(_.eq(K))return this.isOdd()?K:P;if(this.isNegative())return _.isNegative()?this.neg().mul(_.neg()):this.neg().mul(_).neg();if(_.isNegative())return this.mul(_.neg()).neg();if(this.lt(y)&&_.lt(y))return h(this.toNumber()*_.toNumber(),this.unsigned);var U=this.high>>>16,A=65535&this.high,z=this.low>>>16,J=65535&this.low,se=_.high>>>16,Te=65535&_.high,pe=_.low>>>16,ne=65535&_.low,oe=0,de=0,_e=0,b=0;return _e+=(b+=J*ne)>>>16,de+=(_e+=z*ne)>>>16,_e&=65535,de+=(_e+=J*pe)>>>16,oe+=(de+=A*ne)>>>16,de&=65535,oe+=(de+=z*pe)>>>16,de&=65535,oe+=(de+=J*Te)>>>16,oe+=U*ne+A*pe+z*Te+J*se,T((_e&=65535)<<16|(b&=65535),(oe&=65535)<<16|(de&=65535),this.unsigned)},F.mul=F.multiply,F.divide=function(_){if(l(_)||(_=p(_)),_.isZero())throw Error("division by zero");var U,A,z;if(t)return this.unsigned||this.high!==-2147483648||_.low!==-1||_.high!==-1?T((this.unsigned?t.div_u:t.div_s)(this.low,this.high,_.low,_.high),t.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?x:P;if(this.unsigned){if(_.unsigned||(_=_.toUnsigned()),_.gt(this))return x;if(_.gt(this.shru(1)))return H;z=x}else{if(this.eq(K))return _.eq(B)||_.eq(L)?K:_.eq(K)?B:(U=this.shr(1).div(_).shl(1)).eq(P)?_.isNegative()?B:L:(A=this.sub(_.mul(U)),z=U.add(A.div(_)));if(_.eq(K))return this.unsigned?x:P;if(this.isNegative())return _.isNegative()?this.neg().div(_.neg()):this.neg().div(_).neg();if(_.isNegative())return this.div(_.neg()).neg();z=P}for(A=this;A.gte(_);){U=Math.max(1,Math.floor(A.toNumber()/_.toNumber()));for(var J=Math.ceil(Math.log(U)/Math.LN2),se=J<=48?1:S(2,J-48),Te=h(U),pe=Te.mul(_);pe.isNegative()||pe.gt(A);)pe=(Te=h(U-=se,this.unsigned)).mul(_);Te.isZero()&&(Te=B),z=z.add(Te),A=A.sub(pe)}return z},F.div=F.divide,F.modulo=function(_){return l(_)||(_=p(_)),t?T((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,_.low,_.high),t.get_high(),this.unsigned):this.sub(this.div(_).mul(_))},F.mod=F.modulo,F.rem=F.modulo,F.not=function(){return T(~this.low,~this.high,this.unsigned)},F.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},F.clz=F.countLeadingZeros,F.countTrailingZeros=function(){return this.low?u(this.low):u(this.high)+32},F.ctz=F.countTrailingZeros,F.and=function(_){return l(_)||(_=p(_)),T(this.low&_.low,this.high&_.high,this.unsigned)},F.or=function(_){return l(_)||(_=p(_)),T(this.low|_.low,this.high|_.high,this.unsigned)},F.xor=function(_){return l(_)||(_=p(_)),T(this.low^_.low,this.high^_.high,this.unsigned)},F.shiftLeft=function(_){return l(_)&&(_=_.toInt()),(_&=63)==0?this:_<32?T(this.low<<_,this.high<<_|this.low>>>32-_,this.unsigned):T(0,this.low<<_-32,this.unsigned)},F.shl=F.shiftLeft,F.shiftRight=function(_){return l(_)&&(_=_.toInt()),(_&=63)==0?this:_<32?T(this.low>>>_|this.high<<32-_,this.high>>_,this.unsigned):T(this.high>>_-32,this.high>=0?0:-1,this.unsigned)},F.shr=F.shiftRight,F.shiftRightUnsigned=function(_){return l(_)&&(_=_.toInt()),(_&=63)==0?this:_<32?T(this.low>>>_|this.high<<32-_,this.high>>>_,this.unsigned):T(_===32?this.high:this.high>>>_-32,0,this.unsigned)},F.shru=F.shiftRightUnsigned,F.shr_u=F.shiftRightUnsigned,F.rotateLeft=function(_){var U;return l(_)&&(_=_.toInt()),(_&=63)==0?this:_===32?T(this.high,this.low,this.unsigned):_<32?(U=32-_,T(this.low<<_|this.high>>>U,this.high<<_|this.low>>>U,this.unsigned)):(U=32-(_-=32),T(this.high<<_|this.low>>>U,this.low<<_|this.high>>>U,this.unsigned))},F.rotl=F.rotateLeft,F.rotateRight=function(_){var U;return l(_)&&(_=_.toInt()),(_&=63)==0?this:_===32?T(this.high,this.low,this.unsigned):_<32?(U=32-_,T(this.high<<U|this.low>>>_,this.low<<U|this.high>>>_,this.unsigned)):(U=32-(_-=32),T(this.low<<U|this.high>>>_,this.high<<U|this.low>>>_,this.unsigned))},F.rotr=F.rotateRight,F.toSigned=function(){return this.unsigned?T(this.low,this.high,!1):this},F.toUnsigned=function(){return this.unsigned?this:T(this.low,this.high,!0)},F.toBytes=function(_){return _?this.toBytesLE():this.toBytesBE()},F.toBytesLE=function(){var _=this.high,U=this.low;return[255&U,U>>>8&255,U>>>16&255,U>>>24,255&_,_>>>8&255,_>>>16&255,_>>>24]},F.toBytesBE=function(){var _=this.high,U=this.low;return[_>>>24,_>>>16&255,_>>>8&255,255&_,U>>>24,U>>>16&255,U>>>8&255,255&U]},c.fromBytes=function(_,U,A){return A?c.fromBytesLE(_,U):c.fromBytesBE(_,U)},c.fromBytesLE=function(_,U){return new c(_[0]|_[1]<<8|_[2]<<16|_[3]<<24,_[4]|_[5]<<8|_[6]<<16|_[7]<<24,U)},c.fromBytesBE=function(_,U){return new c(_[4]<<24|_[5]<<16|_[6]<<8|_[7],_[0]<<24|_[1]<<16|_[2]<<8|_[3],U)};var Y=c;return i.default=Y,"default"in i?i.default:i}({});(e=function(){return r}.apply(I,[]))===void 0||(n.exports=e)}},k={};function V(n){var I=k[n];if(I!==void 0)return I.exports;var e=k[n]={exports:{}};return E[n].call(e.exports,e,e.exports,V),e.exports}return V.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch{if(typeof window=="object")return window}}(),V(6010)})())})(ai);const Ct=ri(zn);var Zn;try{Zn=new TextDecoder}catch{}var xe,Qt,ue=0,wt={},pt,tn,jt=0,Xt=0,Bt,Zt,Ht=[],dt,yr={useRecords:!1,mapsAsObjects:!0};class Es{}const gs=new Es;gs.name="MessagePack 0xC1";var pn=!1,Ts=2,br;try{new Function("")}catch{Ts=1/0}class Rn{constructor(a){a&&(a.useRecords===!1&&a.mapsAsObjects===void 0&&(a.mapsAsObjects=!0),a.sequential&&a.trusted!==!1&&(a.trusted=!0,!a.structures&&a.useRecords!=!1&&(a.structures=[],a.maxSharedStructures||(a.maxSharedStructures=0))),a.structures?a.structures.sharedLength=a.structures.length:a.getStructures&&((a.structures=[]).uninitialized=!0,a.structures.sharedLength=0),a.int64AsNumber&&(a.int64AsType="number")),Object.assign(this,a)}unpack(a,E){if(xe)return As(()=>(er(),this?this.unpack(a,E):Rn.prototype.unpack.call(yr,a,E)));typeof E=="object"?(Qt=E.end||a.length,ue=E.start||0):(ue=0,Qt=E>-1?E:a.length),Xt=0,tn=null,Bt=null,xe=a;try{dt=a.dataView||(a.dataView=new DataView(a.buffer,a.byteOffset,a.byteLength))}catch(k){throw xe=null,a instanceof Uint8Array?k:new Error("Source must be a Uint8Array or Buffer but was a "+(a&&typeof a=="object"?a.constructor.name:typeof a))}if(this instanceof Rn){if(wt=this,this.structures)return pt=this.structures,Mn(E);(!pt||pt.length>0)&&(pt=[])}else wt=yr,(!pt||pt.length>0)&&(pt=[]);return Mn(E)}unpackMultiple(a,E){let k,V=0;try{pn=!0;let n=a.length,I=this?this.unpack(a,n):Gn.unpack(a,n);if(E){if(E(I)===!1)return;for(;ue<n;)if(V=ue,E(Mn())===!1)return}else{for(k=[I];ue<n;)V=ue,k.push(Mn());return k}}catch(n){throw n.lastPosition=V,n.values=k,n}finally{pn=!1,er()}}_mergeStructures(a,E){a=a||[],Object.isFrozen(a)&&(a=a.map(k=>k.slice(0)));for(let k=0,V=a.length;k<V;k++){let n=a[k];n&&(n.isShared=!0,k>=32&&(n.highByte=k-32>>5))}a.sharedLength=a.length;for(let k in E||[])if(k>=0){let V=a[k],n=E[k];n&&(V&&((a.restoreStructures||(a.restoreStructures=[]))[k]=V),a[k]=n)}return this.structures=a}decode(a,E){return this.unpack(a,E)}}function Mn(s){try{if(!wt.trusted&&!pn){let E=pt.sharedLength||0;E<pt.length&&(pt.length=E)}let a;if(wt.randomAccessStructure&&xe[ue]<64&&xe[ue]>=32&&br?(a=br(xe,ue,Qt,wt),xe=null,!(s&&s.lazy)&&a&&(a=a.toJSON()),ue=Qt):a=Mt(),Bt&&(ue=Bt.postBundlePosition,Bt=null),ue==Qt)pt&&pt.restoreStructures&&Pr(),pt=null,xe=null,Zt&&(Zt=null);else{if(ue>Qt)throw new Error("Unexpected end of MessagePack data");if(!pn)throw new Error("Data read, but end of buffer not reached "+JSON.stringify(a).slice(0,100))}return a}catch(a){throw pt&&pt.restoreStructures&&Pr(),er(),(a instanceof RangeError||a.message.startsWith("Unexpected end of buffer")||ue>Qt)&&(a.incomplete=!0),a}}function Pr(){for(let s in pt.restoreStructures)pt[s]=pt.restoreStructures[s];pt.restoreStructures=null}function Mt(){let s=xe[ue++];if(s<160)if(s<128){if(s<64)return s;{let a=pt[s&63]||wt.getStructures&&Ss()[s&63];return a?(a.read||(a.read=cr(a,s&63)),a.read()):s}}else if(s<144)if(s-=128,wt.mapsAsObjects){let a={};for(let E=0;E<s;E++){let k=Is();k==="__proto__"&&(k="__proto_"),a[k]=Mt()}return a}else{let a=new Map;for(let E=0;E<s;E++)a.set(Mt(),Mt());return a}else{s-=144;let a=new Array(s);for(let E=0;E<s;E++)a[E]=Mt();return wt.freezeData?Object.freeze(a):a}else if(s<192){let a=s-160;if(Xt>=ue)return tn.slice(ue-jt,(ue+=a)-jt);if(Xt==0&&Qt<140){let E=a<16?ur(a):ms(a);if(E!=null)return E}return Jn(a)}else{let a;switch(s){case 192:return null;case 193:return Bt?(a=Mt(),a>0?Bt[1].slice(Bt.position1,Bt.position1+=a):Bt[0].slice(Bt.position0,Bt.position0-=a)):gs;case 194:return!1;case 195:return!0;case 196:if(a=xe[ue++],a===void 0)throw new Error("Unexpected end of buffer");return jn(a);case 197:return a=dt.getUint16(ue),ue+=2,jn(a);case 198:return a=dt.getUint32(ue),ue+=4,jn(a);case 199:return sn(xe[ue++]);case 200:return a=dt.getUint16(ue),ue+=2,sn(a);case 201:return a=dt.getUint32(ue),ue+=4,sn(a);case 202:if(a=dt.getFloat32(ue),wt.useFloat32>2){let E=lr[(xe[ue]&127)<<1|xe[ue+1]>>7];return ue+=4,(E*a+(a>0?.5:-.5)>>0)/E}return ue+=4,a;case 203:return a=dt.getFloat64(ue),ue+=8,a;case 204:return xe[ue++];case 205:return a=dt.getUint16(ue),ue+=2,a;case 206:return a=dt.getUint32(ue),ue+=4,a;case 207:return wt.int64AsType==="number"?(a=dt.getUint32(ue)*4294967296,a+=dt.getUint32(ue+4)):wt.int64AsType==="string"?a=dt.getBigUint64(ue).toString():a=dt.getBigUint64(ue),ue+=8,a;case 208:return dt.getInt8(ue++);case 209:return a=dt.getInt16(ue),ue+=2,a;case 210:return a=dt.getInt32(ue),ue+=4,a;case 211:return wt.int64AsType==="number"?(a=dt.getInt32(ue)*4294967296,a+=dt.getUint32(ue+4)):wt.int64AsType==="string"?a=dt.getBigInt64(ue).toString():a=dt.getBigInt64(ue),ue+=8,a;case 212:if(a=xe[ue++],a==114)return Lr(xe[ue++]&63);{let E=Ht[a];if(E)return E.read?(ue++,E.read(Mt())):E.noBuffer?(ue++,E()):E(xe.subarray(ue,++ue));throw new Error("Unknown extension "+a)}case 213:return a=xe[ue],a==114?(ue++,Lr(xe[ue++]&63,xe[ue++])):sn(2);case 214:return sn(4);case 215:return sn(8);case 216:return sn(16);case 217:return a=xe[ue++],Xt>=ue?tn.slice(ue-jt,(ue+=a)-jt):ui(a);case 218:return a=dt.getUint16(ue),ue+=2,Xt>=ue?tn.slice(ue-jt,(ue+=a)-jt):li(a);case 219:return a=dt.getUint32(ue),ue+=4,Xt>=ue?tn.slice(ue-jt,(ue+=a)-jt):hi(a);case 220:return a=dt.getUint16(ue),ue+=2,Dr(a);case 221:return a=dt.getUint32(ue),ue+=4,Dr(a);case 222:return a=dt.getUint16(ue),ue+=2,vr(a);case 223:return a=dt.getUint32(ue),ue+=4,vr(a);default:if(s>=224)return s-256;if(s===void 0){let E=new Error("Unexpected end of MessagePack data");throw E.incomplete=!0,E}throw new Error("Unknown MessagePack token "+s)}}}const ci=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function cr(s,a){function E(){if(E.count++>Ts){let V=s.read=new Function("r","return function(){return "+(wt.freezeData?"Object.freeze":"")+"({"+s.map(n=>n==="__proto__"?"__proto_:r()":ci.test(n)?n+":r()":"["+JSON.stringify(n)+"]:r()").join(",")+"})}")(Mt);return s.highByte===0&&(s.read=wr(a,s.read)),V()}let k={};for(let V=0,n=s.length;V<n;V++){let I=s[V];I==="__proto__"&&(I="__proto_"),k[I]=Mt()}return wt.freezeData?Object.freeze(k):k}return E.count=0,s.highByte===0?wr(a,E):E}const wr=(s,a)=>function(){let E=xe[ue++];if(E===0)return a();let k=s<32?-(s+(E<<5)):s+(E<<5),V=pt[k]||Ss()[k];if(!V)throw new Error("Record id is not defined for "+k);return V.read||(V.read=cr(V,s)),V.read()};function Ss(){let s=As(()=>(xe=null,wt.getStructures()));return pt=wt._mergeStructures(s,pt)}var Jn=Dn,ui=Dn,li=Dn,hi=Dn;function Dn(s){let a;if(s<16&&(a=ur(s)))return a;if(s>64&&Zn)return Zn.decode(xe.subarray(ue,ue+=s));const E=ue+s,k=[];for(a="";ue<E;){const V=xe[ue++];if(!(V&128))k.push(V);else if((V&224)===192){const n=xe[ue++]&63;k.push((V&31)<<6|n)}else if((V&240)===224){const n=xe[ue++]&63,I=xe[ue++]&63;k.push((V&31)<<12|n<<6|I)}else if((V&248)===240){const n=xe[ue++]&63,I=xe[ue++]&63,e=xe[ue++]&63;let r=(V&7)<<18|n<<12|I<<6|e;r>65535&&(r-=65536,k.push(r>>>10&1023|55296),r=56320|r&1023),k.push(r)}else k.push(V);k.length>=4096&&(a+=Ft.apply(String,k),k.length=0)}return k.length>0&&(a+=Ft.apply(String,k)),a}function Dr(s){let a=new Array(s);for(let E=0;E<s;E++)a[E]=Mt();return wt.freezeData?Object.freeze(a):a}function vr(s){if(wt.mapsAsObjects){let a={};for(let E=0;E<s;E++){let k=Is();k==="__proto__"&&(k="__proto_"),a[k]=Mt()}return a}else{let a=new Map;for(let E=0;E<s;E++)a.set(Mt(),Mt());return a}}var Ft=String.fromCharCode;function ms(s){let a=ue,E=new Array(s);for(let k=0;k<s;k++){const V=xe[ue++];if((V&128)>0){ue=a;return}E[k]=V}return Ft.apply(String,E)}function ur(s){if(s<4)if(s<2){if(s===0)return"";{let a=xe[ue++];if((a&128)>1){ue-=1;return}return Ft(a)}}else{let a=xe[ue++],E=xe[ue++];if((a&128)>0||(E&128)>0){ue-=2;return}if(s<3)return Ft(a,E);let k=xe[ue++];if((k&128)>0){ue-=3;return}return Ft(a,E,k)}else{let a=xe[ue++],E=xe[ue++],k=xe[ue++],V=xe[ue++];if((a&128)>0||(E&128)>0||(k&128)>0||(V&128)>0){ue-=4;return}if(s<6){if(s===4)return Ft(a,E,k,V);{let n=xe[ue++];if((n&128)>0){ue-=5;return}return Ft(a,E,k,V,n)}}else if(s<8){let n=xe[ue++],I=xe[ue++];if((n&128)>0||(I&128)>0){ue-=6;return}if(s<7)return Ft(a,E,k,V,n,I);let e=xe[ue++];if((e&128)>0){ue-=7;return}return Ft(a,E,k,V,n,I,e)}else{let n=xe[ue++],I=xe[ue++],e=xe[ue++],r=xe[ue++];if((n&128)>0||(I&128)>0||(e&128)>0||(r&128)>0){ue-=8;return}if(s<10){if(s===8)return Ft(a,E,k,V,n,I,e,r);{let i=xe[ue++];if((i&128)>0){ue-=9;return}return Ft(a,E,k,V,n,I,e,r,i)}}else if(s<12){let i=xe[ue++],t=xe[ue++];if((i&128)>0||(t&128)>0){ue-=10;return}if(s<11)return Ft(a,E,k,V,n,I,e,r,i,t);let c=xe[ue++];if((c&128)>0){ue-=11;return}return Ft(a,E,k,V,n,I,e,r,i,t,c)}else{let i=xe[ue++],t=xe[ue++],c=xe[ue++],l=xe[ue++];if((i&128)>0||(t&128)>0||(c&128)>0||(l&128)>0){ue-=12;return}if(s<14){if(s===12)return Ft(a,E,k,V,n,I,e,r,i,t,c,l);{let u=xe[ue++];if((u&128)>0){ue-=13;return}return Ft(a,E,k,V,n,I,e,r,i,t,c,l,u)}}else{let u=xe[ue++],o=xe[ue++];if((u&128)>0||(o&128)>0){ue-=14;return}if(s<15)return Ft(a,E,k,V,n,I,e,r,i,t,c,l,u,o);let f=xe[ue++];if((f&128)>0){ue-=15;return}return Ft(a,E,k,V,n,I,e,r,i,t,c,l,u,o,f)}}}}}function Mr(){let s=xe[ue++],a;if(s<192)a=s-160;else switch(s){case 217:a=xe[ue++];break;case 218:a=dt.getUint16(ue),ue+=2;break;case 219:a=dt.getUint32(ue),ue+=4;break;default:throw new Error("Expected string")}return Dn(a)}function jn(s){return wt.copyBuffers?Uint8Array.prototype.slice.call(xe,ue,ue+=s):xe.subarray(ue,ue+=s)}function sn(s){let a=xe[ue++];if(Ht[a]){let E;return Ht[a](xe.subarray(ue,E=ue+=s),k=>{ue=k;try{return Mt()}finally{ue=E}})}else throw new Error("Unknown extension type "+a)}var xr=new Array(4096);function Is(){let s=xe[ue++];if(s>=160&&s<192){if(s=s-160,Xt>=ue)return tn.slice(ue-jt,(ue+=s)-jt);if(!(Xt==0&&Qt<180))return Jn(s)}else return ue--,Mt().toString();let a=(s<<5^(s>1?dt.getUint16(ue):s>0?xe[ue]:0))&4095,E=xr[a],k=ue,V=ue+s-3,n,I=0;if(E&&E.bytes==s){for(;k<V;){if(n=dt.getUint32(k),n!=E[I++]){k=1879048192;break}k+=4}for(V+=3;k<V;)if(n=xe[k++],n!=E[I++]){k=1879048192;break}if(k===V)return ue=k,E.string;V-=3,k=ue}for(E=[],xr[a]=E,E.bytes=s;k<V;)n=dt.getUint32(k),E.push(n),k+=4;for(V+=3;k<V;)n=xe[k++],E.push(n);let e=s<16?ur(s):ms(s);return e!=null?E.string=e:E.string=Jn(s)}const Lr=(s,a)=>{let E=Mt().map(n=>n.toString()),k=s;a!==void 0&&(s=s<32?-((a<<5)+s):(a<<5)+s,E.highByte=a);let V=pt[s];return V&&V.isShared&&((pt.restoreStructures||(pt.restoreStructures=[]))[s]=V),pt[s]=E,E.read=cr(E,k),E.read()};Ht[0]=()=>{};Ht[0].noBuffer=!0;Ht[101]=()=>{let s=Mt();return(globalThis[s[0]]||Error)(s[1])};Ht[105]=s=>{let a=dt.getUint32(ue-4);Zt||(Zt=new Map);let E=xe[ue],k;E>=144&&E<160||E==220||E==221?k=[]:k={};let V={target:k};Zt.set(a,V);let n=Mt();return V.used?Object.assign(k,n):(V.target=n,n)};Ht[112]=s=>{let a=dt.getUint32(ue-4),E=Zt.get(a);return E.used=!0,E.target};Ht[115]=()=>new Set(Mt());const Rs=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map(s=>s+"Array");Ht[116]=s=>{let a=s[0],E=Rs[a];if(!E)throw new Error("Could not find typed array for code "+a);return new globalThis[E](Uint8Array.prototype.slice.call(s,1).buffer)};Ht[120]=()=>{let s=Mt();return new RegExp(s[0],s[1])};const di=[];Ht[98]=s=>{let a=(s[0]<<24)+(s[1]<<16)+(s[2]<<8)+s[3],E=ue;return ue+=a-s.length,Bt=di,Bt=[Mr(),Mr()],Bt.position0=0,Bt.position1=0,Bt.postBundlePosition=ue,ue=E,Mt()};Ht[255]=s=>s.length==4?new Date((s[0]*16777216+(s[1]<<16)+(s[2]<<8)+s[3])*1e3):s.length==8?new Date(((s[0]<<22)+(s[1]<<14)+(s[2]<<6)+(s[3]>>2))/1e6+((s[3]&3)*4294967296+s[4]*16777216+(s[5]<<16)+(s[6]<<8)+s[7])*1e3):s.length==12?new Date(((s[0]<<24)+(s[1]<<16)+(s[2]<<8)+s[3])/1e6+((s[4]&128?-281474976710656:0)+s[6]*1099511627776+s[7]*4294967296+s[8]*16777216+(s[9]<<16)+(s[10]<<8)+s[11])*1e3):new Date("invalid");function As(s){let a=Qt,E=ue,k=jt,V=Xt,n=tn,I=Zt,e=Bt,r=new Uint8Array(xe.slice(0,Qt)),i=pt,t=pt.slice(0,pt.length),c=wt,l=pn,u=s();return Qt=a,ue=E,jt=k,Xt=V,tn=n,Zt=I,Bt=e,xe=r,pn=l,pt=i,pt.splice(0,pt.length,...t),wt=c,dt=new DataView(xe.buffer,xe.byteOffset,xe.byteLength),u}function er(){xe=null,Zt=null,pt=null}const lr=new Array(147);for(let s=0;s<256;s++)lr[s]=+("1e"+Math.floor(45.15-s*.30103));var Gn=new Rn({useRecords:!1});const Cs=Gn.unpack;Gn.unpackMultiple;Gn.unpack;let pi=new Float32Array(1);new Uint8Array(pi.buffer,0,4);let Un;try{Un=new TextEncoder}catch{}let tr,Os;const $n=typeof Buffer<"u",xn=$n?function(s){return Buffer.allocUnsafeSlow(s)}:Uint8Array,Ns=$n?Buffer:Uint8Array,Ur=$n?4294967296:2144337920;let Se,Sn,St,he=0,Vt,Nt=null,fi;const _i=21760,Ei=/[\u0080-\uFFFF]/,dn=Symbol("record-id");class gi extends Rn{constructor(a){super(a),this.offset=0;let E,k,V,n,I=Ns.prototype.utf8Write?function(y,P){return Se.utf8Write(y,P,4294967295)}:Un&&Un.encodeInto?function(y,P){return Un.encodeInto(y,Se.subarray(P)).written}:!1,e=this;a||(a={});let r=a&&a.sequential,i=a.structures||a.saveStructures,t=a.maxSharedStructures;if(t==null&&(t=i?32:0),t>8160)throw new Error("Maximum maxSharedStructure is 8160");a.structuredClone&&a.moreTypes==null&&(this.moreTypes=!0);let c=a.maxOwnStructures;c==null&&(c=i?32:64),!this.structures&&a.useRecords!=!1&&(this.structures=[]);let l=t>32||c+t>64,u=t+64,o=t+c+64;if(o>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let f=[],g=0,h=0;this.pack=this.encode=function(y,P){if(Se||(Se=new xn(8192),St=Se.dataView||(Se.dataView=new DataView(Se.buffer,0,8192)),he=0),Vt=Se.length-10,Vt-he<2048?(Se=new xn(Se.length),St=Se.dataView||(Se.dataView=new DataView(Se.buffer,0,Se.length)),Vt=Se.length-10,he=0):he=he+7&2147483640,E=he,n=e.structuredClone?new Map:null,e.bundleStrings&&typeof y!="string"?(Nt=[],Nt.size=1/0):Nt=null,V=e.structures,V){V.uninitialized&&(V=e._mergeStructures(e.getStructures()));let x=V.sharedLength||0;if(x>t)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+V.sharedLength);if(!V.transitions){V.transitions=Object.create(null);for(let B=0;B<x;B++){let H=V[B];if(!H)continue;let L,M=V.transitions;for(let G=0,K=H.length;G<K;G++){let F=H[G];L=M[F],L||(L=M[F]=Object.create(null)),M=L}M[dn]=B+64}this.lastNamedStructuresLength=x}r||(V.nextId=x+64)}k&&(k=!1);try{e.randomAccessStructure&&y.constructor&&y.constructor===Object?w(y):S(y);let x=Nt;if(Nt&&kr(E,S,0),n&&n.idsToInsert){let B=n.idsToInsert.sort((G,K)=>G.offset>K.offset?1:-1),H=B.length,L=-1;for(;x&&H>0;){let G=B[--H].offset+E;G<x.stringsPosition+E&&L===-1&&(L=0),G>x.position+E?L>=0&&(L+=6):(L>=0&&(St.setUint32(x.position+E,St.getUint32(x.position+E)+L),L=-1),x=x.previous,H++)}L>=0&&x&&St.setUint32(x.position+E,St.getUint32(x.position+E)+L),he+=B.length*6,he>Vt&&p(he),e.offset=he;let M=Si(Se.subarray(E,he),B);return n=null,M}return e.offset=he,P&Ii?(Se.start=E,Se.end=he,Se):Se.subarray(E,he)}finally{if(V){h<10&&h++;let x=V.sharedLength||0;if(V.length>x&&(V.length=x),g>1e4)V.transitions=null,h=0,g=0,f.length>0&&(f=[]);else if(f.length>0&&!r){for(let B=0,H=f.length;B<H;B++)f[B][dn]=0;f=[]}if(k&&e.saveStructures){let B=Se.subarray(E,he),H=mi(V,e);return e.saveStructures(H,H.isCompatible)===!1?e.pack(y):(e.lastNamedStructuresLength=x,B)}}P&Ri&&(he=E)}};const T=y=>{var P=y.length;P<16?Se[he++]=144|P:P<65536?(Se[he++]=220,Se[he++]=P>>8,Se[he++]=P&255):(Se[he++]=221,St.setUint32(he,P),he+=4);for(let x=0;x<P;x++)S(y[x])},S=y=>{he>Vt&&(Se=p(he));var P=typeof y,x;if(P==="string"){let B=y.length;if(Nt&&B>=4&&B<4096){if((Nt.size+=B)>_i){let G,K=(Nt[0]?Nt[0].length*3+Nt[1].length:0)+10;he+K>Vt&&(Se=p(he+K));let F;Nt.position?(F=Nt,Se[he]=200,he+=3,Se[he++]=98,G=he-E,he+=4,kr(E,S,0),St.setUint16(G+E-3,he-E-G)):(Se[he++]=214,Se[he++]=98,G=he-E,he+=4),Nt=["",""],Nt.previous=F,Nt.size=0,Nt.position=G}let M=Ei.test(y);Nt[M?0:1]+=y,Se[he++]=193,S(M?-B:B);return}let H;B<32?H=1:B<256?H=2:B<65536?H=3:H=5;let L=B*3;if(he+L>Vt&&(Se=p(he+L)),B<64||!I){let M,G,K,F=he+H;for(M=0;M<B;M++)G=y.charCodeAt(M),G<128?Se[F++]=G:G<2048?(Se[F++]=G>>6|192,Se[F++]=G&63|128):(G&64512)===55296&&((K=y.charCodeAt(M+1))&64512)===56320?(G=65536+((G&1023)<<10)+(K&1023),M++,Se[F++]=G>>18|240,Se[F++]=G>>12&63|128,Se[F++]=G>>6&63|128,Se[F++]=G&63|128):(Se[F++]=G>>12|224,Se[F++]=G>>6&63|128,Se[F++]=G&63|128);x=F-he-H}else x=I(y,he+H);x<32?Se[he++]=160|x:x<256?(H<2&&Se.copyWithin(he+2,he+1,he+1+x),Se[he++]=217,Se[he++]=x):x<65536?(H<3&&Se.copyWithin(he+3,he+2,he+2+x),Se[he++]=218,Se[he++]=x>>8,Se[he++]=x&255):(H<5&&Se.copyWithin(he+5,he+3,he+3+x),Se[he++]=219,St.setUint32(he,x),he+=4),he+=x}else if(P==="number")if(y>>>0===y)y<32||y<128&&this.useRecords===!1||y<64&&!this.randomAccessStructure?Se[he++]=y:y<256?(Se[he++]=204,Se[he++]=y):y<65536?(Se[he++]=205,Se[he++]=y>>8,Se[he++]=y&255):(Se[he++]=206,St.setUint32(he,y),he+=4);else if(y>>0===y)y>=-32?Se[he++]=256+y:y>=-128?(Se[he++]=208,Se[he++]=y+256):y>=-32768?(Se[he++]=209,St.setInt16(he,y),he+=2):(Se[he++]=210,St.setInt32(he,y),he+=4);else{let B;if((B=this.useFloat32)>0&&y<4294967296&&y>=-2147483648){Se[he++]=202,St.setFloat32(he,y);let H;if(B<4||(H=y*lr[(Se[he]&127)<<1|Se[he+1]>>7])>>0===H){he+=4;return}else he--}Se[he++]=203,St.setFloat64(he,y),he+=8}else if(P==="object")if(!y)Se[he++]=192;else{if(n){let H=n.get(y);if(H){if(!H.id){let L=n.idsToInsert||(n.idsToInsert=[]);H.id=L.push(H)}Se[he++]=214,Se[he++]=112,St.setUint32(he,H.id),he+=4;return}else n.set(y,{offset:he-E})}let B=y.constructor;if(B===Object)C(y,!0);else if(B===Array)T(y);else if(B===Map){x=y.size,x<16?Se[he++]=128|x:x<65536?(Se[he++]=222,Se[he++]=x>>8,Se[he++]=x&255):(Se[he++]=223,St.setUint32(he,x),he+=4);for(let[H,L]of y)S(H),S(L)}else{for(let H=0,L=tr.length;H<L;H++){let M=Os[H];if(y instanceof M){let G=tr[H];if(G.write){G.type&&(Se[he++]=212,Se[he++]=G.type,Se[he++]=0);let U=G.write.call(this,y);U===y?Array.isArray(y)?T(y):C(y):S(U);return}let K=Se,F=St,Y=he;Se=null;let _;try{_=G.pack.call(this,y,U=>(Se=K,K=null,he+=U,he>Vt&&p(he),{target:Se,targetView:St,position:he-U}),S)}finally{K&&(Se=K,St=F,he=Y,Vt=Se.length-10)}_&&(_.length+he>Vt&&p(_.length+he),he=Ti(_,Se,he,G.type));return}}Array.isArray(y)?T(y):C(y,!y.hasOwnProperty)}}else if(P==="boolean")Se[he++]=y?195:194;else if(P==="bigint"){if(y<BigInt(1)<<BigInt(63)&&y>=-(BigInt(1)<<BigInt(63)))Se[he++]=211,St.setBigInt64(he,y);else if(y<BigInt(1)<<BigInt(64)&&y>0)Se[he++]=207,St.setBigUint64(he,y);else if(this.largeBigIntToFloat)Se[he++]=203,St.setFloat64(he,Number(y));else throw new RangeError(y+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");he+=8}else if(P==="undefined")this.encodeUndefinedAsNil?Se[he++]=192:(Se[he++]=212,Se[he++]=0,Se[he++]=0);else if(P==="function")S(this.writeFunction&&this.writeFunction());else throw new Error("Unknown type: "+P)},C=this.useRecords===!1?this.variableMapSize?y=>{let P=Object.keys(y),x=P.length;x<16?Se[he++]=128|x:x<65536?(Se[he++]=222,Se[he++]=x>>8,Se[he++]=x&255):(Se[he++]=223,St.setUint32(he,x),he+=4);let B;for(let H=0;H<x;H++)S(B=P[H]),S(y[B])}:(y,P)=>{Se[he++]=222;let x=he-E;he+=2;let B=0;for(let H in y)(P||y.hasOwnProperty(H))&&(S(H),S(y[H]),B++);Se[x+++E]=B>>8,Se[x+E]=B&255}:a.progressiveRecords&&!l?(y,P)=>{let x,B=V.transitions||(V.transitions=Object.create(null)),H=he++-E,L;for(let M in y)if(P||y.hasOwnProperty(M)){if(x=B[M],x)B=x;else{let G=Object.keys(y),K=B;B=V.transitions;let F=0;for(let Y=0,_=G.length;Y<_;Y++){let U=G[Y];x=B[U],x||(x=B[U]=Object.create(null),F++),B=x}H+E+1==he?(he--,R(B,G,F)):N(B,G,H,F),L=!0,B=K[M]}S(y[M])}if(!L){let M=B[dn];M?Se[H+E]=M:N(B,Object.keys(y),H,0)}}:(y,P)=>{let x,B=V.transitions||(V.transitions=Object.create(null)),H=0;for(let M in y)(P||y.hasOwnProperty(M))&&(x=B[M],x||(x=B[M]=Object.create(null),H++),B=x);let L=B[dn];L?L>=96&&l?(Se[he++]=((L-=96)&31)+96,Se[he++]=L>>5):Se[he++]=L:R(B,B.__keys__||Object.keys(y),H);for(let M in y)(P||y.hasOwnProperty(M))&&S(y[M])},p=y=>{let P;if(y>16777216){if(y-E>Ur)throw new Error("Packed buffer would be larger than maximum buffer size");P=Math.min(Ur,Math.round(Math.max((y-E)*(y>67108864?1.25:2),4194304)/4096)*4096)}else P=(Math.max(y-E<<2,Se.length-1)>>12)+1<<12;let x=new xn(P);return St=x.dataView||(x.dataView=new DataView(x.buffer,0,P)),y=Math.min(y,Se.length),Se.copy?Se.copy(x,0,E,y):x.set(Se.slice(E,y)),he-=E,E=0,Vt=x.length-10,Se=x},R=(y,P,x)=>{let B=V.nextId;B||(B=64),B<u&&this.shouldShareStructure&&!this.shouldShareStructure(P)?(B=V.nextOwnId,B<o||(B=u),V.nextOwnId=B+1):(B>=o&&(B=u),V.nextId=B+1);let H=P.highByte=B>=96&&l?B-96>>5:-1;y[dn]=B,y.__keys__=P,V[B-64]=P,B<u?(P.isShared=!0,V.sharedLength=B-63,k=!0,H>=0?(Se[he++]=(B&31)+96,Se[he++]=H):Se[he++]=B):(H>=0?(Se[he++]=213,Se[he++]=114,Se[he++]=(B&31)+96,Se[he++]=H):(Se[he++]=212,Se[he++]=114,Se[he++]=B),x&&(g+=h*x),f.length>=c&&(f.shift()[dn]=0),f.push(y),S(P))},N=(y,P,x,B)=>{let H=Se,L=he,M=Vt,G=E;Se=Sn,he=0,E=0,Se||(Sn=Se=new xn(8192)),Vt=Se.length-10,R(y,P,B),Sn=Se;let K=he;if(Se=H,he=L,Vt=M,E=G,K>1){let F=he+K-1;F>Vt&&p(F);let Y=x+E;Se.copyWithin(Y+K,Y+1,he),Se.set(Sn.slice(0,K),Y),he=F}else Se[x+E]=Sn[0]},w=(y,P)=>{let x=fi(y,Se,he,V,p,(B,H,L)=>{if(L)return k=!0;he=H;let M=Se;return S(B),M!==Se?{position:he,targetView:St,target:Se}:he},this);if(x===0)return C(y,!0);he=x}}useBuffer(a){Se=a,St=new DataView(Se.buffer,Se.byteOffset,Se.byteLength),he=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}Os=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Es];tr=[{pack(s,a,E){let k=s.getTime()/1e3;if((this.useTimestamp32||s.getMilliseconds()===0)&&k>=0&&k<4294967296){let{target:V,targetView:n,position:I}=a(6);V[I++]=214,V[I++]=255,n.setUint32(I,k)}else if(k>0&&k<4294967296){let{target:V,targetView:n,position:I}=a(10);V[I++]=215,V[I++]=255,n.setUint32(I,s.getMilliseconds()*4e6+(k/1e3/4294967296>>0)),n.setUint32(I+4,k)}else if(isNaN(k)){if(this.onInvalidDate)return a(0),E(this.onInvalidDate());let{target:V,targetView:n,position:I}=a(3);V[I++]=212,V[I++]=255,V[I++]=255}else{let{target:V,targetView:n,position:I}=a(15);V[I++]=199,V[I++]=12,V[I++]=255,n.setUint32(I,s.getMilliseconds()*1e6),n.setBigInt64(I+4,BigInt(Math.floor(k)))}}},{pack(s,a,E){let k=Array.from(s),{target:V,position:n}=a(this.moreTypes?3:0);this.moreTypes&&(V[n++]=212,V[n++]=115,V[n++]=0),E(k)}},{pack(s,a,E){let{target:k,position:V}=a(this.moreTypes?3:0);this.moreTypes&&(k[V++]=212,k[V++]=101,k[V++]=0),E([s.name,s.message])}},{pack(s,a,E){let{target:k,position:V}=a(this.moreTypes?3:0);this.moreTypes&&(k[V++]=212,k[V++]=120,k[V++]=0),E([s.source,s.flags])}},{pack(s,a){this.moreTypes?Fr(s,16,a):Br($n?Buffer.from(s):new Uint8Array(s),a)}},{pack(s,a){let E=s.constructor;E!==Ns&&this.moreTypes?Fr(s,Rs.indexOf(E.name),a):Br(s,a)}},{pack(s,a){let{target:E,position:k}=a(1);E[k]=193}}];function Fr(s,a,E,k){let V=s.byteLength;if(V+1<256){var{target:n,position:I}=E(4+V);n[I++]=199,n[I++]=V+1}else if(V+1<65536){var{target:n,position:I}=E(5+V);n[I++]=200,n[I++]=V+1>>8,n[I++]=V+1&255}else{var{target:n,position:I,targetView:e}=E(7+V);n[I++]=201,e.setUint32(I,V+1),I+=4}n[I++]=116,n[I++]=a,n.set(new Uint8Array(s.buffer,s.byteOffset,s.byteLength),I)}function Br(s,a){let E=s.byteLength;var k,V;if(E<256){var{target:k,position:V}=a(E+2);k[V++]=196,k[V++]=E}else if(E<65536){var{target:k,position:V}=a(E+3);k[V++]=197,k[V++]=E>>8,k[V++]=E&255}else{var{target:k,position:V,targetView:n}=a(E+5);k[V++]=198,n.setUint32(V,E),V+=4}k.set(s,V)}function Ti(s,a,E,k){let V=s.length;switch(V){case 1:a[E++]=212;break;case 2:a[E++]=213;break;case 4:a[E++]=214;break;case 8:a[E++]=215;break;case 16:a[E++]=216;break;default:V<256?(a[E++]=199,a[E++]=V):V<65536?(a[E++]=200,a[E++]=V>>8,a[E++]=V&255):(a[E++]=201,a[E++]=V>>24,a[E++]=V>>16&255,a[E++]=V>>8&255,a[E++]=V&255)}return a[E++]=k,a.set(s,E),E+=V,E}function Si(s,a){let E,k=a.length*6,V=s.length-k;for(;E=a.pop();){let n=E.offset,I=E.id;s.copyWithin(n+k,n,V),k-=6;let e=n+k;s[e++]=214,s[e++]=105,s[e++]=I>>24,s[e++]=I>>16&255,s[e++]=I>>8&255,s[e++]=I&255,V=n}return s}function kr(s,a,E){if(Nt.length>0){St.setUint32(Nt.position+s,he+E-Nt.position-s),Nt.stringsPosition=he-s;let k=Nt;Nt=null,a(k[0]),a(k[1])}}function mi(s,a){return s.isCompatible=E=>{let k=!E||(a.lastNamedStructuresLength||0)===E.length;return k||a._mergeStructures(E),k},s}let ys=new gi({useRecords:!1});const hr=ys.pack;ys.pack;const Ii=512,Ri=1024,bs=new Ct.SDTMapContainer;bs.addField("ct",Ct.SDTField.create(Ct.SDTFieldType.STRING,"msgpack"));const on=(s,a)=>{const E=Ct.SolclientFactory.createMessage();return E.setDestination(Ct.SolclientFactory.createTopicDestination(s)),E.setDeliverToOne(!0),E.setUserPropertyMap(bs),E.setBinaryAttachment(hr(a)),E},Yt=s=>{const a=s.getBinaryAttachment();if(a instanceof Uint8Array)return Cs(a)};var Ai="[object AsyncFunction]",Ci="[object Function]",Oi="[object GeneratorFunction]",Ni="[object Proxy]";function Ps(s){if(!bn(s))return!1;var a=Pn(s);return a==Ci||a==Oi||a==Ai||a==Ni}var yi=Jt["__core-js_shared__"];const Qn=yi;var Gr=function(){var s=/[^.]+$/.exec(Qn&&Qn.keys&&Qn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}();function bi(s){return!!Gr&&Gr in s}var Pi=Function.prototype,wi=Pi.toString;function ln(s){if(s!=null){try{return wi.call(s)}catch{}try{return s+""}catch{}}return""}var Di=/[\\^$.*+?()[\]{}|]/g,vi=/^\[object .+?Constructor\]$/,Mi=Function.prototype,xi=Object.prototype,Li=Mi.toString,Ui=xi.hasOwnProperty,Fi=RegExp("^"+Li.call(Ui).replace(Di,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Bi(s){if(!bn(s)||bi(s))return!1;var a=Ps(s)?Fi:vi;return a.test(ln(s))}function ki(s,a){return s?.[a]}function hn(s,a){var E=ki(s,a);return Bi(E)?E:void 0}var Gi=hn(Jt,"WeakMap");const nr=Gi;var $r=Object.create,$i=function(){function s(){}return function(a){if(!bn(a))return{};if($r)return $r(a);s.prototype=a;var E=new s;return s.prototype=void 0,E}}();const Wi=$i;function qi(s,a){var E=-1,k=s.length;for(a||(a=Array(k));++E<k;)a[E]=s[E];return a}var Vi=function(){try{var s=hn(Object,"defineProperty");return s({},"",{}),s}catch{}}();const Wr=Vi;function Hi(s,a){for(var E=-1,k=s==null?0:s.length;++E<k&&a(s[E],E,s)!==!1;);return s}var Yi=9007199254740991,ji=/^(?:0|[1-9]\d*)$/;function Qi(s,a){var E=typeof s;return a=a??Yi,!!a&&(E=="number"||E!="symbol"&&ji.test(s))&&s>-1&&s%1==0&&s<a}function ws(s,a,E){a=="__proto__"&&Wr?Wr(s,a,{configurable:!0,enumerable:!0,value:E,writable:!0}):s[a]=E}function Ds(s,a){return s===a||s!==s&&a!==a}var Ki=Object.prototype,Xi=Ki.hasOwnProperty;function vs(s,a,E){var k=s[a];(!(Xi.call(s,a)&&Ds(k,E))||E===void 0&&!(a in s))&&ws(s,a,E)}function Wn(s,a,E,k){var V=!E;E||(E={});for(var n=-1,I=a.length;++n<I;){var e=a[n],r=k?k(E[e],s[e],e,E,s):void 0;r===void 0&&(r=s[e]),V?ws(E,e,r):vs(E,e,r)}return E}var zi=9007199254740991;function Ms(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=zi}function xs(s){return s!=null&&Ms(s.length)&&!Ps(s)}var Zi=Object.prototype;function dr(s){var a=s&&s.constructor,E=typeof a=="function"&&a.prototype||Zi;return s===E}function Ji(s,a){for(var E=-1,k=Array(s);++E<s;)k[E]=a(E);return k}var eo="[object Arguments]";function qr(s){return wn(s)&&Pn(s)==eo}var Ls=Object.prototype,to=Ls.hasOwnProperty,no=Ls.propertyIsEnumerable,ro=qr(function(){return arguments}())?qr:function(s){return wn(s)&&to.call(s,"callee")&&!no.call(s,"callee")};const so=ro;function io(){return!1}var Us=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Vr=Us&&typeof module=="object"&&module&&!module.nodeType&&module,oo=Vr&&Vr.exports===Us,Hr=oo?Jt.Buffer:void 0,ao=Hr?Hr.isBuffer:void 0,co=ao||io;const Fs=co;var uo="[object Arguments]",lo="[object Array]",ho="[object Boolean]",po="[object Date]",fo="[object Error]",_o="[object Function]",Eo="[object Map]",go="[object Number]",To="[object Object]",So="[object RegExp]",mo="[object Set]",Io="[object String]",Ro="[object WeakMap]",Ao="[object ArrayBuffer]",Co="[object DataView]",Oo="[object Float32Array]",No="[object Float64Array]",yo="[object Int8Array]",bo="[object Int16Array]",Po="[object Int32Array]",wo="[object Uint8Array]",Do="[object Uint8ClampedArray]",vo="[object Uint16Array]",Mo="[object Uint32Array]",At={};At[Oo]=At[No]=At[yo]=At[bo]=At[Po]=At[wo]=At[Do]=At[vo]=At[Mo]=!0;At[uo]=At[lo]=At[Ao]=At[ho]=At[Co]=At[po]=At[fo]=At[_o]=At[Eo]=At[go]=At[To]=At[So]=At[mo]=At[Io]=At[Ro]=!1;function xo(s){return wn(s)&&Ms(s.length)&&!!At[Pn(s)]}function pr(s){return function(a){return s(a)}}var Bs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,In=Bs&&typeof module=="object"&&module&&!module.nodeType&&module,Lo=In&&In.exports===Bs,Kn=Lo&&ii.process,Uo=function(){try{var s=In&&In.require&&In.require("util").types;return s||Kn&&Kn.binding&&Kn.binding("util")}catch{}}();const fn=Uo;var Yr=fn&&fn.isTypedArray,Fo=Yr?pr(Yr):xo;const Bo=Fo;var ko=Object.prototype,Go=ko.hasOwnProperty;function ks(s,a){var E=ar(s),k=!E&&so(s),V=!E&&!k&&Fs(s),n=!E&&!k&&!V&&Bo(s),I=E||k||V||n,e=I?Ji(s.length,String):[],r=e.length;for(var i in s)(a||Go.call(s,i))&&!(I&&(i=="length"||V&&(i=="offset"||i=="parent")||n&&(i=="buffer"||i=="byteLength"||i=="byteOffset")||Qi(i,r)))&&e.push(i);return e}function Gs(s,a){return function(E){return s(a(E))}}var $o=Gs(Object.keys,Object);const Wo=$o;var qo=Object.prototype,Vo=qo.hasOwnProperty;function Ho(s){if(!dr(s))return Wo(s);var a=[];for(var E in Object(s))Vo.call(s,E)&&E!="constructor"&&a.push(E);return a}function fr(s){return xs(s)?ks(s):Ho(s)}function Yo(s){var a=[];if(s!=null)for(var E in Object(s))a.push(E);return a}var jo=Object.prototype,Qo=jo.hasOwnProperty;function Ko(s){if(!bn(s))return Yo(s);var a=dr(s),E=[];for(var k in s)k=="constructor"&&(a||!Qo.call(s,k))||E.push(k);return E}function _r(s){return xs(s)?ks(s,!0):Ko(s)}var Xo=hn(Object,"create");const An=Xo;function zo(){this.__data__=An?An(null):{},this.size=0}function Zo(s){var a=this.has(s)&&delete this.__data__[s];return this.size-=a?1:0,a}var Jo="__lodash_hash_undefined__",ea=Object.prototype,ta=ea.hasOwnProperty;function na(s){var a=this.__data__;if(An){var E=a[s];return E===Jo?void 0:E}return ta.call(a,s)?a[s]:void 0}var ra=Object.prototype,sa=ra.hasOwnProperty;function ia(s){var a=this.__data__;return An?a[s]!==void 0:sa.call(a,s)}var oa="__lodash_hash_undefined__";function aa(s,a){var E=this.__data__;return this.size+=this.has(s)?0:1,E[s]=An&&a===void 0?oa:a,this}function un(s){var a=-1,E=s==null?0:s.length;for(this.clear();++a<E;){var k=s[a];this.set(k[0],k[1])}}un.prototype.clear=zo;un.prototype.delete=Zo;un.prototype.get=na;un.prototype.has=ia;un.prototype.set=aa;function ca(){this.__data__=[],this.size=0}function qn(s,a){for(var E=s.length;E--;)if(Ds(s[E][0],a))return E;return-1}var ua=Array.prototype,la=ua.splice;function ha(s){var a=this.__data__,E=qn(a,s);if(E<0)return!1;var k=a.length-1;return E==k?a.pop():la.call(a,E,1),--this.size,!0}function da(s){var a=this.__data__,E=qn(a,s);return E<0?void 0:a[E][1]}function pa(s){return qn(this.__data__,s)>-1}function fa(s,a){var E=this.__data__,k=qn(E,s);return k<0?(++this.size,E.push([s,a])):E[k][1]=a,this}function en(s){var a=-1,E=s==null?0:s.length;for(this.clear();++a<E;){var k=s[a];this.set(k[0],k[1])}}en.prototype.clear=ca;en.prototype.delete=ha;en.prototype.get=da;en.prototype.has=pa;en.prototype.set=fa;var _a=hn(Jt,"Map");const Cn=_a;function Ea(){this.size=0,this.__data__={hash:new un,map:new(Cn||en),string:new un}}function ga(s){var a=typeof s;return a=="string"||a=="number"||a=="symbol"||a=="boolean"?s!=="__proto__":s===null}function Vn(s,a){var E=s.__data__;return ga(a)?E[typeof a=="string"?"string":"hash"]:E.map}function Ta(s){var a=Vn(this,s).delete(s);return this.size-=a?1:0,a}function Sa(s){return Vn(this,s).get(s)}function ma(s){return Vn(this,s).has(s)}function Ia(s,a){var E=Vn(this,s),k=E.size;return E.set(s,a),this.size+=E.size==k?0:1,this}function En(s){var a=-1,E=s==null?0:s.length;for(this.clear();++a<E;){var k=s[a];this.set(k[0],k[1])}}En.prototype.clear=Ea;En.prototype.delete=Ta;En.prototype.get=Sa;En.prototype.has=ma;En.prototype.set=Ia;function $s(s,a){for(var E=-1,k=a.length,V=s.length;++E<k;)s[V+E]=a[E];return s}var Ra=Gs(Object.getPrototypeOf,Object);const Ws=Ra;function Aa(){this.__data__=new en,this.size=0}function Ca(s){var a=this.__data__,E=a.delete(s);return this.size=a.size,E}function Oa(s){return this.__data__.get(s)}function Na(s){return this.__data__.has(s)}var ya=200;function ba(s,a){var E=this.__data__;if(E instanceof en){var k=E.__data__;if(!Cn||k.length<ya-1)return k.push([s,a]),this.size=++E.size,this;E=this.__data__=new En(k)}return E.set(s,a),this.size=E.size,this}function gn(s){var a=this.__data__=new en(s);this.size=a.size}gn.prototype.clear=Aa;gn.prototype.delete=Ca;gn.prototype.get=Oa;gn.prototype.has=Na;gn.prototype.set=ba;function Pa(s,a){return s&&Wn(a,fr(a),s)}function wa(s,a){return s&&Wn(a,_r(a),s)}var qs=typeof exports=="object"&&exports&&!exports.nodeType&&exports,jr=qs&&typeof module=="object"&&module&&!module.nodeType&&module,Da=jr&&jr.exports===qs,Qr=Da?Jt.Buffer:void 0,Kr=Qr?Qr.allocUnsafe:void 0;function va(s,a){if(a)return s.slice();var E=s.length,k=Kr?Kr(E):new s.constructor(E);return s.copy(k),k}function Ma(s,a){for(var E=-1,k=s==null?0:s.length,V=0,n=[];++E<k;){var I=s[E];a(I,E,s)&&(n[V++]=I)}return n}function Vs(){return[]}var xa=Object.prototype,La=xa.propertyIsEnumerable,Xr=Object.getOwnPropertySymbols,Ua=Xr?function(s){return s==null?[]:(s=Object(s),Ma(Xr(s),function(a){return La.call(s,a)}))}:Vs;const Er=Ua;function Fa(s,a){return Wn(s,Er(s),a)}var Ba=Object.getOwnPropertySymbols,ka=Ba?function(s){for(var a=[];s;)$s(a,Er(s)),s=Ws(s);return a}:Vs;const Hs=ka;function Ga(s,a){return Wn(s,Hs(s),a)}function Ys(s,a,E){var k=a(s);return ar(s)?k:$s(k,E(s))}function $a(s){return Ys(s,fr,Er)}function Wa(s){return Ys(s,_r,Hs)}var qa=hn(Jt,"DataView");const rr=qa;var Va=hn(Jt,"Promise");const sr=Va;var Ha=hn(Jt,"Set");const ir=Ha;var zr="[object Map]",Ya="[object Object]",Zr="[object Promise]",Jr="[object Set]",es="[object WeakMap]",ts="[object DataView]",ja=ln(rr),Qa=ln(Cn),Ka=ln(sr),Xa=ln(ir),za=ln(nr),cn=Pn;(rr&&cn(new rr(new ArrayBuffer(1)))!=ts||Cn&&cn(new Cn)!=zr||sr&&cn(sr.resolve())!=Zr||ir&&cn(new ir)!=Jr||nr&&cn(new nr)!=es)&&(cn=function(s){var a=Pn(s),E=a==Ya?s.constructor:void 0,k=E?ln(E):"";if(k)switch(k){case ja:return ts;case Qa:return zr;case Ka:return Zr;case Xa:return Jr;case za:return es}return a});const gr=cn;var Za=Object.prototype,Ja=Za.hasOwnProperty;function ec(s){var a=s.length,E=new s.constructor(a);return a&&typeof s[0]=="string"&&Ja.call(s,"index")&&(E.index=s.index,E.input=s.input),E}var tc=Jt.Uint8Array;const ns=tc;function Tr(s){var a=new s.constructor(s.byteLength);return new ns(a).set(new ns(s)),a}function nc(s,a){var E=a?Tr(s.buffer):s.buffer;return new s.constructor(E,s.byteOffset,s.byteLength)}var rc=/\w*$/;function sc(s){var a=new s.constructor(s.source,rc.exec(s));return a.lastIndex=s.lastIndex,a}var rs=Nr?Nr.prototype:void 0,ss=rs?rs.valueOf:void 0;function ic(s){return ss?Object(ss.call(s)):{}}function oc(s,a){var E=a?Tr(s.buffer):s.buffer;return new s.constructor(E,s.byteOffset,s.length)}var ac="[object Boolean]",cc="[object Date]",uc="[object Map]",lc="[object Number]",hc="[object RegExp]",dc="[object Set]",pc="[object String]",fc="[object Symbol]",_c="[object ArrayBuffer]",Ec="[object DataView]",gc="[object Float32Array]",Tc="[object Float64Array]",Sc="[object Int8Array]",mc="[object Int16Array]",Ic="[object Int32Array]",Rc="[object Uint8Array]",Ac="[object Uint8ClampedArray]",Cc="[object Uint16Array]",Oc="[object Uint32Array]";function Nc(s,a,E){var k=s.constructor;switch(a){case _c:return Tr(s);case ac:case cc:return new k(+s);case Ec:return nc(s,E);case gc:case Tc:case Sc:case mc:case Ic:case Rc:case Ac:case Cc:case Oc:return oc(s,E);case uc:return new k;case lc:case pc:return new k(s);case hc:return sc(s);case dc:return new k;case fc:return ic(s)}}function yc(s){return typeof s.constructor=="function"&&!dr(s)?Wi(Ws(s)):{}}var bc="[object Map]";function Pc(s){return wn(s)&&gr(s)==bc}var is=fn&&fn.isMap,wc=is?pr(is):Pc;const Dc=wc;var vc="[object Set]";function Mc(s){return wn(s)&&gr(s)==vc}var os=fn&&fn.isSet,xc=os?pr(os):Mc;const Lc=xc;var Uc=1,Fc=2,Bc=4,js="[object Arguments]",kc="[object Array]",Gc="[object Boolean]",$c="[object Date]",Wc="[object Error]",Qs="[object Function]",qc="[object GeneratorFunction]",Vc="[object Map]",Hc="[object Number]",Ks="[object Object]",Yc="[object RegExp]",jc="[object Set]",Qc="[object String]",Kc="[object Symbol]",Xc="[object WeakMap]",zc="[object ArrayBuffer]",Zc="[object DataView]",Jc="[object Float32Array]",eu="[object Float64Array]",tu="[object Int8Array]",nu="[object Int16Array]",ru="[object Int32Array]",su="[object Uint8Array]",iu="[object Uint8ClampedArray]",ou="[object Uint16Array]",au="[object Uint32Array]",It={};It[js]=It[kc]=It[zc]=It[Zc]=It[Gc]=It[$c]=It[Jc]=It[eu]=It[tu]=It[nu]=It[ru]=It[Vc]=It[Hc]=It[Ks]=It[Yc]=It[jc]=It[Qc]=It[Kc]=It[su]=It[iu]=It[ou]=It[au]=!0;It[Wc]=It[Qs]=It[Xc]=!1;function Fn(s,a,E,k,V,n){var I,e=a&Uc,r=a&Fc,i=a&Bc;if(E&&(I=V?E(s,k,V,n):E(s)),I!==void 0)return I;if(!bn(s))return s;var t=ar(s);if(t){if(I=ec(s),!e)return qi(s,I)}else{var c=gr(s),l=c==Qs||c==qc;if(Fs(s))return va(s,e);if(c==Ks||c==js||l&&!V){if(I=r||l?{}:yc(s),!e)return r?Ga(s,wa(I,s)):Fa(s,Pa(I,s))}else{if(!It[c])return V?s:{};I=Nc(s,c,e)}}n||(n=new gn);var u=n.get(s);if(u)return u;n.set(s,I),Lc(s)?s.forEach(function(g){I.add(Fn(g,a,E,g,s,n))}):Dc(s)&&s.forEach(function(g,h){I.set(h,Fn(g,a,E,h,s,n))});var o=i?r?Wa:$a:r?_r:fr,f=t?void 0:o(s);return Hi(f||s,function(g,h){f&&(h=g,g=s[h]),vs(I,h,Fn(g,a,E,h,s,n))}),I}var cu=1,uu=4;function On(s){return Fn(s,cu|uu)}const mn=(s,a,E)=>{zt.error(s.detail),console.log(s.detail),a.status_code===401&&E("setAuth",!1)},lu=([s,a,E,k,V,n,I,e,r,i,t])=>({code:s,time:Kt(`${a.replaceAll("/","-")} ${E}`),bid_price:k.map(c=>+c),bid_volume:V,diff_bid_vol:n,ask_price:I.reverse().map(c=>+c),ask_volume:e.reverse(),diff_ask_vol:r,bid:k.map((c,l)=>({price:+c,volume:V[l]})),ask:I.map((c,l)=>({price:+c,volume:e[l]})),suspend:i,simtrade:t}),hu=([s,a,E,k,V,n,I,e,r,i,t,c,l,u,o,f,g])=>({code:s,time:Kt(`${a.replaceAll("/","-")} ${E}`),bid_price:n.map(h=>+h),bid_volume:I,diff_bid_vol:e,ask_price:r.reverse().map(h=>+h),ask_volume:i.reverse(),diff_ask_vol:t,bid:n.map((h,T)=>({price:+h,volume:I[T]})),ask:r.map((h,T)=>({price:+h,volume:i[T]})),suspend:!1,simtrade:g}),as=s=>({ts:s.time,buy_price:s.bid[0].price,buy_volume:s.bid[0].volume,sell_price:s.ask.at(-1)?.price,sell_volume:s.ask.at(-1)?.volume}),du=([s,a,E,k,V,n,I,e,r,i,t,c,l,u,o,f,g,h,T,S,C,p,R,N,w,y,P,x,B])=>({code:s,time:Kt(`${a.replaceAll("/","-")} ${E}`),open:+k,high:+I,low:+e,close:+n,volume:t,total_volume:c,amount:r,total_amount:i,tick_type:l,chg_type:u,price_chg:+o,pct_chg:+f/100,bid_side_total_vol:g,ask_side_total_vol:h,suspend:x,simtrade:B}),pu=([s,a,E,k,V,n,I,e,r,i,t,c,l,u,o,f,g,h,T,S])=>({code:s,time:Kt(`${a.replaceAll("/","-")} ${E}`),open:+k,high:+i,low:+t,close:+r,volume:u,total_volume:o,amount:+c,total_amount:+l,tick_type:f,chg_type:g,price_chg:+h,pct_chg:+T,bid_side_total_vol:n,ask_side_total_vol:I,suspend:!1,simtrade:S}),cs=s=>({ts:s.time,open:s.open,high:s.high,low:s.low,close:s.close,tick_type:s.tick_type===1?"Buy":s.tick_type===2?"Sell":"None",change_price:s.price_chg,change_rate:s.pct_chg,change_type:s.chg_type===1?"LimitUp":s.chg_type===2?"Up":s.chg_type===3?"Unchange":s.chg_type===4?"Down":"LimitDown",volume:s.volume,total_volume:s.total_volume});let fu={code:"2330",time:Kt(),bid_price:[500,501,502,503,504],bid_volume:[1,1,1,1,1],diff_bid_vol:[],ask_price:[495,496,497,498,499],ask_volume:[1,1,1,1,1],diff_ask_vol:[],ask:[{price:500,volume:1},{price:501,volume:1},{price:502,volume:1},{price:503,volume:1},{price:504,volume:1}],bid:[{price:494,volume:1},{price:495,volume:1},{price:496,volume:1},{price:497,volume:1},{price:498,volume:1}],suspend:!1,simtrade:!1};const us=(s,a)=>(a=On(a),s.operation.op_type==="New"&&s.operation.op_code==="00"?(a.order.ordno=s.order.ordno,a.status.status="Submitted",a.status.order_quantity=s.status.order_quantity):s.operation.op_type==="New"&&s.operation.op_code!=="00"?(a.order.ordno=s.order.ordno,a.status.status="Failed",a.status.order_quantity=s.status.order_quantity):s.operation.op_type==="Cancel"&&s.operation.op_code==="00"&&(a.status.status="Cancelled",a.status.cancel_quantity=s.status.cancel_quantity),a),_u=(s,a)=>a?(a=On(a),us(s,a)):(a={contract:{...s.contract,name:"",currency:"TWD"},order:s.order,status:{...s.status,status:"PendingSubmit",status_code:s.operation.op_code,msg:s.operation.op_msg,deal_quantity:0,order_ts:s.status.exchange_ts,modified_ts:s.status.exchange_ts,deals:[]}},us(s,a)),Eu=(s,a)=>(a=On(a),a.status.status="PartFilled",a.status.deal_quantity+=s.quantity,a.status.order_quantity===a.status.deal_quantity&&(a.status.status="Filled"),a.status.deals.push({ts:s.ts,price:s.price,quantity:s.quantity,seq:s.exchange_seq}),a);function gu(s){throw new Error('Could not dynamically require "'+s+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Bn={},Tu={get exports(){return Bn},set exports(s){Bn=s}};(function(s){(function(a){var E=function(v){var W,$=new Float64Array(16);if(v)for(W=0;W<v.length;W++)$[W]=v[W];return $},k=function(){throw new Error("no PRNG")},V=new Uint8Array(16),n=new Uint8Array(32);n[0]=9;var I=E(),e=E([1]),r=E([56129,1]),i=E([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),t=E([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),c=E([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=E([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),u=E([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function o(v,W,$,m){v[W]=$>>24&255,v[W+1]=$>>16&255,v[W+2]=$>>8&255,v[W+3]=$&255,v[W+4]=m>>24&255,v[W+5]=m>>16&255,v[W+6]=m>>8&255,v[W+7]=m&255}function f(v,W,$,m,j){var le,fe=0;for(le=0;le<j;le++)fe|=v[W+le]^$[m+le];return(1&fe-1>>>8)-1}function g(v,W,$,m){return f(v,W,$,m,16)}function h(v,W,$,m){return f(v,W,$,m,32)}function T(v,W,$,m){for(var j=m[0]&255|(m[1]&255)<<8|(m[2]&255)<<16|(m[3]&255)<<24,le=$[0]&255|($[1]&255)<<8|($[2]&255)<<16|($[3]&255)<<24,fe=$[4]&255|($[5]&255)<<8|($[6]&255)<<16|($[7]&255)<<24,Ne=$[8]&255|($[9]&255)<<8|($[10]&255)<<16|($[11]&255)<<24,De=$[12]&255|($[13]&255)<<8|($[14]&255)<<16|($[15]&255)<<24,qe=m[4]&255|(m[5]&255)<<8|(m[6]&255)<<16|(m[7]&255)<<24,Ue=W[0]&255|(W[1]&255)<<8|(W[2]&255)<<16|(W[3]&255)<<24,ft=W[4]&255|(W[5]&255)<<8|(W[6]&255)<<16|(W[7]&255)<<24,ke=W[8]&255|(W[9]&255)<<8|(W[10]&255)<<16|(W[11]&255)<<24,Xe=W[12]&255|(W[13]&255)<<8|(W[14]&255)<<16|(W[15]&255)<<24,Ze=m[8]&255|(m[9]&255)<<8|(m[10]&255)<<16|(m[11]&255)<<24,rt=$[16]&255|($[17]&255)<<8|($[18]&255)<<16|($[19]&255)<<24,nt=$[20]&255|($[21]&255)<<8|($[22]&255)<<16|($[23]&255)<<24,Je=$[24]&255|($[25]&255)<<8|($[26]&255)<<16|($[27]&255)<<24,tt=$[28]&255|($[29]&255)<<8|($[30]&255)<<16|($[31]&255)<<24,et=m[12]&255|(m[13]&255)<<8|(m[14]&255)<<16|(m[15]&255)<<24,Ge=j,Ve=le,Fe=fe,$e=Ne,We=De,Le=qe,Ie=Ue,Re=ft,be=ke,Oe=Xe,ye=Ze,we=rt,je=nt,st=Je,ot=tt,it=et,te,ct=0;ct<20;ct+=2)te=Ge+je|0,We^=te<<7|te>>>32-7,te=We+Ge|0,be^=te<<9|te>>>32-9,te=be+We|0,je^=te<<13|te>>>32-13,te=je+be|0,Ge^=te<<18|te>>>32-18,te=Le+Ve|0,Oe^=te<<7|te>>>32-7,te=Oe+Le|0,st^=te<<9|te>>>32-9,te=st+Oe|0,Ve^=te<<13|te>>>32-13,te=Ve+st|0,Le^=te<<18|te>>>32-18,te=ye+Ie|0,ot^=te<<7|te>>>32-7,te=ot+ye|0,Fe^=te<<9|te>>>32-9,te=Fe+ot|0,Ie^=te<<13|te>>>32-13,te=Ie+Fe|0,ye^=te<<18|te>>>32-18,te=it+we|0,$e^=te<<7|te>>>32-7,te=$e+it|0,Re^=te<<9|te>>>32-9,te=Re+$e|0,we^=te<<13|te>>>32-13,te=we+Re|0,it^=te<<18|te>>>32-18,te=Ge+$e|0,Ve^=te<<7|te>>>32-7,te=Ve+Ge|0,Fe^=te<<9|te>>>32-9,te=Fe+Ve|0,$e^=te<<13|te>>>32-13,te=$e+Fe|0,Ge^=te<<18|te>>>32-18,te=Le+We|0,Ie^=te<<7|te>>>32-7,te=Ie+Le|0,Re^=te<<9|te>>>32-9,te=Re+Ie|0,We^=te<<13|te>>>32-13,te=We+Re|0,Le^=te<<18|te>>>32-18,te=ye+Oe|0,we^=te<<7|te>>>32-7,te=we+ye|0,be^=te<<9|te>>>32-9,te=be+we|0,Oe^=te<<13|te>>>32-13,te=Oe+be|0,ye^=te<<18|te>>>32-18,te=it+ot|0,je^=te<<7|te>>>32-7,te=je+it|0,st^=te<<9|te>>>32-9,te=st+je|0,ot^=te<<13|te>>>32-13,te=ot+st|0,it^=te<<18|te>>>32-18;Ge=Ge+j|0,Ve=Ve+le|0,Fe=Fe+fe|0,$e=$e+Ne|0,We=We+De|0,Le=Le+qe|0,Ie=Ie+Ue|0,Re=Re+ft|0,be=be+ke|0,Oe=Oe+Xe|0,ye=ye+Ze|0,we=we+rt|0,je=je+nt|0,st=st+Je|0,ot=ot+tt|0,it=it+et|0,v[0]=Ge>>>0&255,v[1]=Ge>>>8&255,v[2]=Ge>>>16&255,v[3]=Ge>>>24&255,v[4]=Ve>>>0&255,v[5]=Ve>>>8&255,v[6]=Ve>>>16&255,v[7]=Ve>>>24&255,v[8]=Fe>>>0&255,v[9]=Fe>>>8&255,v[10]=Fe>>>16&255,v[11]=Fe>>>24&255,v[12]=$e>>>0&255,v[13]=$e>>>8&255,v[14]=$e>>>16&255,v[15]=$e>>>24&255,v[16]=We>>>0&255,v[17]=We>>>8&255,v[18]=We>>>16&255,v[19]=We>>>24&255,v[20]=Le>>>0&255,v[21]=Le>>>8&255,v[22]=Le>>>16&255,v[23]=Le>>>24&255,v[24]=Ie>>>0&255,v[25]=Ie>>>8&255,v[26]=Ie>>>16&255,v[27]=Ie>>>24&255,v[28]=Re>>>0&255,v[29]=Re>>>8&255,v[30]=Re>>>16&255,v[31]=Re>>>24&255,v[32]=be>>>0&255,v[33]=be>>>8&255,v[34]=be>>>16&255,v[35]=be>>>24&255,v[36]=Oe>>>0&255,v[37]=Oe>>>8&255,v[38]=Oe>>>16&255,v[39]=Oe>>>24&255,v[40]=ye>>>0&255,v[41]=ye>>>8&255,v[42]=ye>>>16&255,v[43]=ye>>>24&255,v[44]=we>>>0&255,v[45]=we>>>8&255,v[46]=we>>>16&255,v[47]=we>>>24&255,v[48]=je>>>0&255,v[49]=je>>>8&255,v[50]=je>>>16&255,v[51]=je>>>24&255,v[52]=st>>>0&255,v[53]=st>>>8&255,v[54]=st>>>16&255,v[55]=st>>>24&255,v[56]=ot>>>0&255,v[57]=ot>>>8&255,v[58]=ot>>>16&255,v[59]=ot>>>24&255,v[60]=it>>>0&255,v[61]=it>>>8&255,v[62]=it>>>16&255,v[63]=it>>>24&255}function S(v,W,$,m){for(var j=m[0]&255|(m[1]&255)<<8|(m[2]&255)<<16|(m[3]&255)<<24,le=$[0]&255|($[1]&255)<<8|($[2]&255)<<16|($[3]&255)<<24,fe=$[4]&255|($[5]&255)<<8|($[6]&255)<<16|($[7]&255)<<24,Ne=$[8]&255|($[9]&255)<<8|($[10]&255)<<16|($[11]&255)<<24,De=$[12]&255|($[13]&255)<<8|($[14]&255)<<16|($[15]&255)<<24,qe=m[4]&255|(m[5]&255)<<8|(m[6]&255)<<16|(m[7]&255)<<24,Ue=W[0]&255|(W[1]&255)<<8|(W[2]&255)<<16|(W[3]&255)<<24,ft=W[4]&255|(W[5]&255)<<8|(W[6]&255)<<16|(W[7]&255)<<24,ke=W[8]&255|(W[9]&255)<<8|(W[10]&255)<<16|(W[11]&255)<<24,Xe=W[12]&255|(W[13]&255)<<8|(W[14]&255)<<16|(W[15]&255)<<24,Ze=m[8]&255|(m[9]&255)<<8|(m[10]&255)<<16|(m[11]&255)<<24,rt=$[16]&255|($[17]&255)<<8|($[18]&255)<<16|($[19]&255)<<24,nt=$[20]&255|($[21]&255)<<8|($[22]&255)<<16|($[23]&255)<<24,Je=$[24]&255|($[25]&255)<<8|($[26]&255)<<16|($[27]&255)<<24,tt=$[28]&255|($[29]&255)<<8|($[30]&255)<<16|($[31]&255)<<24,et=m[12]&255|(m[13]&255)<<8|(m[14]&255)<<16|(m[15]&255)<<24,Ge=j,Ve=le,Fe=fe,$e=Ne,We=De,Le=qe,Ie=Ue,Re=ft,be=ke,Oe=Xe,ye=Ze,we=rt,je=nt,st=Je,ot=tt,it=et,te,ct=0;ct<20;ct+=2)te=Ge+je|0,We^=te<<7|te>>>32-7,te=We+Ge|0,be^=te<<9|te>>>32-9,te=be+We|0,je^=te<<13|te>>>32-13,te=je+be|0,Ge^=te<<18|te>>>32-18,te=Le+Ve|0,Oe^=te<<7|te>>>32-7,te=Oe+Le|0,st^=te<<9|te>>>32-9,te=st+Oe|0,Ve^=te<<13|te>>>32-13,te=Ve+st|0,Le^=te<<18|te>>>32-18,te=ye+Ie|0,ot^=te<<7|te>>>32-7,te=ot+ye|0,Fe^=te<<9|te>>>32-9,te=Fe+ot|0,Ie^=te<<13|te>>>32-13,te=Ie+Fe|0,ye^=te<<18|te>>>32-18,te=it+we|0,$e^=te<<7|te>>>32-7,te=$e+it|0,Re^=te<<9|te>>>32-9,te=Re+$e|0,we^=te<<13|te>>>32-13,te=we+Re|0,it^=te<<18|te>>>32-18,te=Ge+$e|0,Ve^=te<<7|te>>>32-7,te=Ve+Ge|0,Fe^=te<<9|te>>>32-9,te=Fe+Ve|0,$e^=te<<13|te>>>32-13,te=$e+Fe|0,Ge^=te<<18|te>>>32-18,te=Le+We|0,Ie^=te<<7|te>>>32-7,te=Ie+Le|0,Re^=te<<9|te>>>32-9,te=Re+Ie|0,We^=te<<13|te>>>32-13,te=We+Re|0,Le^=te<<18|te>>>32-18,te=ye+Oe|0,we^=te<<7|te>>>32-7,te=we+ye|0,be^=te<<9|te>>>32-9,te=be+we|0,Oe^=te<<13|te>>>32-13,te=Oe+be|0,ye^=te<<18|te>>>32-18,te=it+ot|0,je^=te<<7|te>>>32-7,te=je+it|0,st^=te<<9|te>>>32-9,te=st+je|0,ot^=te<<13|te>>>32-13,te=ot+st|0,it^=te<<18|te>>>32-18;v[0]=Ge>>>0&255,v[1]=Ge>>>8&255,v[2]=Ge>>>16&255,v[3]=Ge>>>24&255,v[4]=Le>>>0&255,v[5]=Le>>>8&255,v[6]=Le>>>16&255,v[7]=Le>>>24&255,v[8]=ye>>>0&255,v[9]=ye>>>8&255,v[10]=ye>>>16&255,v[11]=ye>>>24&255,v[12]=it>>>0&255,v[13]=it>>>8&255,v[14]=it>>>16&255,v[15]=it>>>24&255,v[16]=Ie>>>0&255,v[17]=Ie>>>8&255,v[18]=Ie>>>16&255,v[19]=Ie>>>24&255,v[20]=Re>>>0&255,v[21]=Re>>>8&255,v[22]=Re>>>16&255,v[23]=Re>>>24&255,v[24]=be>>>0&255,v[25]=be>>>8&255,v[26]=be>>>16&255,v[27]=be>>>24&255,v[28]=Oe>>>0&255,v[29]=Oe>>>8&255,v[30]=Oe>>>16&255,v[31]=Oe>>>24&255}function C(v,W,$,m){T(v,W,$,m)}function p(v,W,$,m){S(v,W,$,m)}var R=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function N(v,W,$,m,j,le,fe){var Ne=new Uint8Array(16),De=new Uint8Array(64),qe,Ue;for(Ue=0;Ue<16;Ue++)Ne[Ue]=0;for(Ue=0;Ue<8;Ue++)Ne[Ue]=le[Ue];for(;j>=64;){for(C(De,Ne,fe,R),Ue=0;Ue<64;Ue++)v[W+Ue]=$[m+Ue]^De[Ue];for(qe=1,Ue=8;Ue<16;Ue++)qe=qe+(Ne[Ue]&255)|0,Ne[Ue]=qe&255,qe>>>=8;j-=64,W+=64,m+=64}if(j>0)for(C(De,Ne,fe,R),Ue=0;Ue<j;Ue++)v[W+Ue]=$[m+Ue]^De[Ue];return 0}function w(v,W,$,m,j){var le=new Uint8Array(16),fe=new Uint8Array(64),Ne,De;for(De=0;De<16;De++)le[De]=0;for(De=0;De<8;De++)le[De]=m[De];for(;$>=64;){for(C(fe,le,j,R),De=0;De<64;De++)v[W+De]=fe[De];for(Ne=1,De=8;De<16;De++)Ne=Ne+(le[De]&255)|0,le[De]=Ne&255,Ne>>>=8;$-=64,W+=64}if($>0)for(C(fe,le,j,R),De=0;De<$;De++)v[W+De]=fe[De];return 0}function y(v,W,$,m,j){var le=new Uint8Array(32);p(le,m,j,R);for(var fe=new Uint8Array(8),Ne=0;Ne<8;Ne++)fe[Ne]=m[Ne+16];return w(v,W,$,fe,le)}function P(v,W,$,m,j,le,fe){var Ne=new Uint8Array(32);p(Ne,le,fe,R);for(var De=new Uint8Array(8),qe=0;qe<8;qe++)De[qe]=le[qe+16];return N(v,W,$,m,j,De,Ne)}var x=function(v){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var W,$,m,j,le,fe,Ne,De;W=v[0]&255|(v[1]&255)<<8,this.r[0]=W&8191,$=v[2]&255|(v[3]&255)<<8,this.r[1]=(W>>>13|$<<3)&8191,m=v[4]&255|(v[5]&255)<<8,this.r[2]=($>>>10|m<<6)&7939,j=v[6]&255|(v[7]&255)<<8,this.r[3]=(m>>>7|j<<9)&8191,le=v[8]&255|(v[9]&255)<<8,this.r[4]=(j>>>4|le<<12)&255,this.r[5]=le>>>1&8190,fe=v[10]&255|(v[11]&255)<<8,this.r[6]=(le>>>14|fe<<2)&8191,Ne=v[12]&255|(v[13]&255)<<8,this.r[7]=(fe>>>11|Ne<<5)&8065,De=v[14]&255|(v[15]&255)<<8,this.r[8]=(Ne>>>8|De<<8)&8191,this.r[9]=De>>>5&127,this.pad[0]=v[16]&255|(v[17]&255)<<8,this.pad[1]=v[18]&255|(v[19]&255)<<8,this.pad[2]=v[20]&255|(v[21]&255)<<8,this.pad[3]=v[22]&255|(v[23]&255)<<8,this.pad[4]=v[24]&255|(v[25]&255)<<8,this.pad[5]=v[26]&255|(v[27]&255)<<8,this.pad[6]=v[28]&255|(v[29]&255)<<8,this.pad[7]=v[30]&255|(v[31]&255)<<8};x.prototype.blocks=function(v,W,$){for(var m=this.fin?0:2048,j,le,fe,Ne,De,qe,Ue,ft,ke,Xe,Ze,rt,nt,Je,tt,et,Ge,Ve,Fe,$e=this.h[0],We=this.h[1],Le=this.h[2],Ie=this.h[3],Re=this.h[4],be=this.h[5],Oe=this.h[6],ye=this.h[7],we=this.h[8],je=this.h[9],st=this.r[0],ot=this.r[1],it=this.r[2],te=this.r[3],ct=this.r[4],_t=this.r[5],Et=this.r[6],at=this.r[7],lt=this.r[8],ht=this.r[9];$>=16;)j=v[W+0]&255|(v[W+1]&255)<<8,$e+=j&8191,le=v[W+2]&255|(v[W+3]&255)<<8,We+=(j>>>13|le<<3)&8191,fe=v[W+4]&255|(v[W+5]&255)<<8,Le+=(le>>>10|fe<<6)&8191,Ne=v[W+6]&255|(v[W+7]&255)<<8,Ie+=(fe>>>7|Ne<<9)&8191,De=v[W+8]&255|(v[W+9]&255)<<8,Re+=(Ne>>>4|De<<12)&8191,be+=De>>>1&8191,qe=v[W+10]&255|(v[W+11]&255)<<8,Oe+=(De>>>14|qe<<2)&8191,Ue=v[W+12]&255|(v[W+13]&255)<<8,ye+=(qe>>>11|Ue<<5)&8191,ft=v[W+14]&255|(v[W+15]&255)<<8,we+=(Ue>>>8|ft<<8)&8191,je+=ft>>>5|m,ke=0,Xe=ke,Xe+=$e*st,Xe+=We*(5*ht),Xe+=Le*(5*lt),Xe+=Ie*(5*at),Xe+=Re*(5*Et),ke=Xe>>>13,Xe&=8191,Xe+=be*(5*_t),Xe+=Oe*(5*ct),Xe+=ye*(5*te),Xe+=we*(5*it),Xe+=je*(5*ot),ke+=Xe>>>13,Xe&=8191,Ze=ke,Ze+=$e*ot,Ze+=We*st,Ze+=Le*(5*ht),Ze+=Ie*(5*lt),Ze+=Re*(5*at),ke=Ze>>>13,Ze&=8191,Ze+=be*(5*Et),Ze+=Oe*(5*_t),Ze+=ye*(5*ct),Ze+=we*(5*te),Ze+=je*(5*it),ke+=Ze>>>13,Ze&=8191,rt=ke,rt+=$e*it,rt+=We*ot,rt+=Le*st,rt+=Ie*(5*ht),rt+=Re*(5*lt),ke=rt>>>13,rt&=8191,rt+=be*(5*at),rt+=Oe*(5*Et),rt+=ye*(5*_t),rt+=we*(5*ct),rt+=je*(5*te),ke+=rt>>>13,rt&=8191,nt=ke,nt+=$e*te,nt+=We*it,nt+=Le*ot,nt+=Ie*st,nt+=Re*(5*ht),ke=nt>>>13,nt&=8191,nt+=be*(5*lt),nt+=Oe*(5*at),nt+=ye*(5*Et),nt+=we*(5*_t),nt+=je*(5*ct),ke+=nt>>>13,nt&=8191,Je=ke,Je+=$e*ct,Je+=We*te,Je+=Le*it,Je+=Ie*ot,Je+=Re*st,ke=Je>>>13,Je&=8191,Je+=be*(5*ht),Je+=Oe*(5*lt),Je+=ye*(5*at),Je+=we*(5*Et),Je+=je*(5*_t),ke+=Je>>>13,Je&=8191,tt=ke,tt+=$e*_t,tt+=We*ct,tt+=Le*te,tt+=Ie*it,tt+=Re*ot,ke=tt>>>13,tt&=8191,tt+=be*st,tt+=Oe*(5*ht),tt+=ye*(5*lt),tt+=we*(5*at),tt+=je*(5*Et),ke+=tt>>>13,tt&=8191,et=ke,et+=$e*Et,et+=We*_t,et+=Le*ct,et+=Ie*te,et+=Re*it,ke=et>>>13,et&=8191,et+=be*ot,et+=Oe*st,et+=ye*(5*ht),et+=we*(5*lt),et+=je*(5*at),ke+=et>>>13,et&=8191,Ge=ke,Ge+=$e*at,Ge+=We*Et,Ge+=Le*_t,Ge+=Ie*ct,Ge+=Re*te,ke=Ge>>>13,Ge&=8191,Ge+=be*it,Ge+=Oe*ot,Ge+=ye*st,Ge+=we*(5*ht),Ge+=je*(5*lt),ke+=Ge>>>13,Ge&=8191,Ve=ke,Ve+=$e*lt,Ve+=We*at,Ve+=Le*Et,Ve+=Ie*_t,Ve+=Re*ct,ke=Ve>>>13,Ve&=8191,Ve+=be*te,Ve+=Oe*it,Ve+=ye*ot,Ve+=we*st,Ve+=je*(5*ht),ke+=Ve>>>13,Ve&=8191,Fe=ke,Fe+=$e*ht,Fe+=We*lt,Fe+=Le*at,Fe+=Ie*Et,Fe+=Re*_t,ke=Fe>>>13,Fe&=8191,Fe+=be*ct,Fe+=Oe*te,Fe+=ye*it,Fe+=we*ot,Fe+=je*st,ke+=Fe>>>13,Fe&=8191,ke=(ke<<2)+ke|0,ke=ke+Xe|0,Xe=ke&8191,ke=ke>>>13,Ze+=ke,$e=Xe,We=Ze,Le=rt,Ie=nt,Re=Je,be=tt,Oe=et,ye=Ge,we=Ve,je=Fe,W+=16,$-=16;this.h[0]=$e,this.h[1]=We,this.h[2]=Le,this.h[3]=Ie,this.h[4]=Re,this.h[5]=be,this.h[6]=Oe,this.h[7]=ye,this.h[8]=we,this.h[9]=je},x.prototype.finish=function(v,W){var $=new Uint16Array(10),m,j,le,fe;if(this.leftover){for(fe=this.leftover,this.buffer[fe++]=1;fe<16;fe++)this.buffer[fe]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(m=this.h[1]>>>13,this.h[1]&=8191,fe=2;fe<10;fe++)this.h[fe]+=m,m=this.h[fe]>>>13,this.h[fe]&=8191;for(this.h[0]+=m*5,m=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=m,m=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=m,$[0]=this.h[0]+5,m=$[0]>>>13,$[0]&=8191,fe=1;fe<10;fe++)$[fe]=this.h[fe]+m,m=$[fe]>>>13,$[fe]&=8191;for($[9]-=1<<13,j=(m^1)-1,fe=0;fe<10;fe++)$[fe]&=j;for(j=~j,fe=0;fe<10;fe++)this.h[fe]=this.h[fe]&j|$[fe];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,le=this.h[0]+this.pad[0],this.h[0]=le&65535,fe=1;fe<8;fe++)le=(this.h[fe]+this.pad[fe]|0)+(le>>>16)|0,this.h[fe]=le&65535;v[W+0]=this.h[0]>>>0&255,v[W+1]=this.h[0]>>>8&255,v[W+2]=this.h[1]>>>0&255,v[W+3]=this.h[1]>>>8&255,v[W+4]=this.h[2]>>>0&255,v[W+5]=this.h[2]>>>8&255,v[W+6]=this.h[3]>>>0&255,v[W+7]=this.h[3]>>>8&255,v[W+8]=this.h[4]>>>0&255,v[W+9]=this.h[4]>>>8&255,v[W+10]=this.h[5]>>>0&255,v[W+11]=this.h[5]>>>8&255,v[W+12]=this.h[6]>>>0&255,v[W+13]=this.h[6]>>>8&255,v[W+14]=this.h[7]>>>0&255,v[W+15]=this.h[7]>>>8&255},x.prototype.update=function(v,W,$){var m,j;if(this.leftover){for(j=16-this.leftover,j>$&&(j=$),m=0;m<j;m++)this.buffer[this.leftover+m]=v[W+m];if($-=j,W+=j,this.leftover+=j,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if($>=16&&(j=$-$%16,this.blocks(v,W,j),W+=j,$-=j),$){for(m=0;m<$;m++)this.buffer[this.leftover+m]=v[W+m];this.leftover+=$}};function B(v,W,$,m,j,le){var fe=new x(le);return fe.update($,m,j),fe.finish(v,W),0}function H(v,W,$,m,j,le){var fe=new Uint8Array(16);return B(fe,0,$,m,j,le),g(v,W,fe,0)}function L(v,W,$,m,j){var le;if($<32)return-1;for(P(v,0,W,0,$,m,j),B(v,16,v,32,$-32,v),le=0;le<16;le++)v[le]=0;return 0}function M(v,W,$,m,j){var le,fe=new Uint8Array(32);if($<32||(y(fe,0,32,m,j),H(W,16,W,32,$-32,fe)!==0))return-1;for(P(v,0,W,0,$,m,j),le=0;le<32;le++)v[le]=0;return 0}function G(v,W){var $;for($=0;$<16;$++)v[$]=W[$]|0}function K(v){var W,$,m=1;for(W=0;W<16;W++)$=v[W]+m+65535,m=Math.floor($/65536),v[W]=$-m*65536;v[0]+=m-1+37*(m-1)}function F(v,W,$){for(var m,j=~($-1),le=0;le<16;le++)m=j&(v[le]^W[le]),v[le]^=m,W[le]^=m}function Y(v,W){var $,m,j,le=E(),fe=E();for($=0;$<16;$++)fe[$]=W[$];for(K(fe),K(fe),K(fe),m=0;m<2;m++){for(le[0]=fe[0]-65517,$=1;$<15;$++)le[$]=fe[$]-65535-(le[$-1]>>16&1),le[$-1]&=65535;le[15]=fe[15]-32767-(le[14]>>16&1),j=le[15]>>16&1,le[14]&=65535,F(fe,le,1-j)}for($=0;$<16;$++)v[2*$]=fe[$]&255,v[2*$+1]=fe[$]>>8}function _(v,W){var $=new Uint8Array(32),m=new Uint8Array(32);return Y($,v),Y(m,W),h($,0,m,0)}function U(v){var W=new Uint8Array(32);return Y(W,v),W[0]&1}function A(v,W){var $;for($=0;$<16;$++)v[$]=W[2*$]+(W[2*$+1]<<8);v[15]&=32767}function z(v,W,$){for(var m=0;m<16;m++)v[m]=W[m]+$[m]}function J(v,W,$){for(var m=0;m<16;m++)v[m]=W[m]-$[m]}function se(v,W,$){var m,j,le=0,fe=0,Ne=0,De=0,qe=0,Ue=0,ft=0,ke=0,Xe=0,Ze=0,rt=0,nt=0,Je=0,tt=0,et=0,Ge=0,Ve=0,Fe=0,$e=0,We=0,Le=0,Ie=0,Re=0,be=0,Oe=0,ye=0,we=0,je=0,st=0,ot=0,it=0,te=$[0],ct=$[1],_t=$[2],Et=$[3],at=$[4],lt=$[5],ht=$[6],vt=$[7],Tt=$[8],yt=$[9],bt=$[10],Pt=$[11],Lt=$[12],$t=$[13],Wt=$[14],qt=$[15];m=W[0],le+=m*te,fe+=m*ct,Ne+=m*_t,De+=m*Et,qe+=m*at,Ue+=m*lt,ft+=m*ht,ke+=m*vt,Xe+=m*Tt,Ze+=m*yt,rt+=m*bt,nt+=m*Pt,Je+=m*Lt,tt+=m*$t,et+=m*Wt,Ge+=m*qt,m=W[1],fe+=m*te,Ne+=m*ct,De+=m*_t,qe+=m*Et,Ue+=m*at,ft+=m*lt,ke+=m*ht,Xe+=m*vt,Ze+=m*Tt,rt+=m*yt,nt+=m*bt,Je+=m*Pt,tt+=m*Lt,et+=m*$t,Ge+=m*Wt,Ve+=m*qt,m=W[2],Ne+=m*te,De+=m*ct,qe+=m*_t,Ue+=m*Et,ft+=m*at,ke+=m*lt,Xe+=m*ht,Ze+=m*vt,rt+=m*Tt,nt+=m*yt,Je+=m*bt,tt+=m*Pt,et+=m*Lt,Ge+=m*$t,Ve+=m*Wt,Fe+=m*qt,m=W[3],De+=m*te,qe+=m*ct,Ue+=m*_t,ft+=m*Et,ke+=m*at,Xe+=m*lt,Ze+=m*ht,rt+=m*vt,nt+=m*Tt,Je+=m*yt,tt+=m*bt,et+=m*Pt,Ge+=m*Lt,Ve+=m*$t,Fe+=m*Wt,$e+=m*qt,m=W[4],qe+=m*te,Ue+=m*ct,ft+=m*_t,ke+=m*Et,Xe+=m*at,Ze+=m*lt,rt+=m*ht,nt+=m*vt,Je+=m*Tt,tt+=m*yt,et+=m*bt,Ge+=m*Pt,Ve+=m*Lt,Fe+=m*$t,$e+=m*Wt,We+=m*qt,m=W[5],Ue+=m*te,ft+=m*ct,ke+=m*_t,Xe+=m*Et,Ze+=m*at,rt+=m*lt,nt+=m*ht,Je+=m*vt,tt+=m*Tt,et+=m*yt,Ge+=m*bt,Ve+=m*Pt,Fe+=m*Lt,$e+=m*$t,We+=m*Wt,Le+=m*qt,m=W[6],ft+=m*te,ke+=m*ct,Xe+=m*_t,Ze+=m*Et,rt+=m*at,nt+=m*lt,Je+=m*ht,tt+=m*vt,et+=m*Tt,Ge+=m*yt,Ve+=m*bt,Fe+=m*Pt,$e+=m*Lt,We+=m*$t,Le+=m*Wt,Ie+=m*qt,m=W[7],ke+=m*te,Xe+=m*ct,Ze+=m*_t,rt+=m*Et,nt+=m*at,Je+=m*lt,tt+=m*ht,et+=m*vt,Ge+=m*Tt,Ve+=m*yt,Fe+=m*bt,$e+=m*Pt,We+=m*Lt,Le+=m*$t,Ie+=m*Wt,Re+=m*qt,m=W[8],Xe+=m*te,Ze+=m*ct,rt+=m*_t,nt+=m*Et,Je+=m*at,tt+=m*lt,et+=m*ht,Ge+=m*vt,Ve+=m*Tt,Fe+=m*yt,$e+=m*bt,We+=m*Pt,Le+=m*Lt,Ie+=m*$t,Re+=m*Wt,be+=m*qt,m=W[9],Ze+=m*te,rt+=m*ct,nt+=m*_t,Je+=m*Et,tt+=m*at,et+=m*lt,Ge+=m*ht,Ve+=m*vt,Fe+=m*Tt,$e+=m*yt,We+=m*bt,Le+=m*Pt,Ie+=m*Lt,Re+=m*$t,be+=m*Wt,Oe+=m*qt,m=W[10],rt+=m*te,nt+=m*ct,Je+=m*_t,tt+=m*Et,et+=m*at,Ge+=m*lt,Ve+=m*ht,Fe+=m*vt,$e+=m*Tt,We+=m*yt,Le+=m*bt,Ie+=m*Pt,Re+=m*Lt,be+=m*$t,Oe+=m*Wt,ye+=m*qt,m=W[11],nt+=m*te,Je+=m*ct,tt+=m*_t,et+=m*Et,Ge+=m*at,Ve+=m*lt,Fe+=m*ht,$e+=m*vt,We+=m*Tt,Le+=m*yt,Ie+=m*bt,Re+=m*Pt,be+=m*Lt,Oe+=m*$t,ye+=m*Wt,we+=m*qt,m=W[12],Je+=m*te,tt+=m*ct,et+=m*_t,Ge+=m*Et,Ve+=m*at,Fe+=m*lt,$e+=m*ht,We+=m*vt,Le+=m*Tt,Ie+=m*yt,Re+=m*bt,be+=m*Pt,Oe+=m*Lt,ye+=m*$t,we+=m*Wt,je+=m*qt,m=W[13],tt+=m*te,et+=m*ct,Ge+=m*_t,Ve+=m*Et,Fe+=m*at,$e+=m*lt,We+=m*ht,Le+=m*vt,Ie+=m*Tt,Re+=m*yt,be+=m*bt,Oe+=m*Pt,ye+=m*Lt,we+=m*$t,je+=m*Wt,st+=m*qt,m=W[14],et+=m*te,Ge+=m*ct,Ve+=m*_t,Fe+=m*Et,$e+=m*at,We+=m*lt,Le+=m*ht,Ie+=m*vt,Re+=m*Tt,be+=m*yt,Oe+=m*bt,ye+=m*Pt,we+=m*Lt,je+=m*$t,st+=m*Wt,ot+=m*qt,m=W[15],Ge+=m*te,Ve+=m*ct,Fe+=m*_t,$e+=m*Et,We+=m*at,Le+=m*lt,Ie+=m*ht,Re+=m*vt,be+=m*Tt,Oe+=m*yt,ye+=m*bt,we+=m*Pt,je+=m*Lt,st+=m*$t,ot+=m*Wt,it+=m*qt,le+=38*Ve,fe+=38*Fe,Ne+=38*$e,De+=38*We,qe+=38*Le,Ue+=38*Ie,ft+=38*Re,ke+=38*be,Xe+=38*Oe,Ze+=38*ye,rt+=38*we,nt+=38*je,Je+=38*st,tt+=38*ot,et+=38*it,j=1,m=le+j+65535,j=Math.floor(m/65536),le=m-j*65536,m=fe+j+65535,j=Math.floor(m/65536),fe=m-j*65536,m=Ne+j+65535,j=Math.floor(m/65536),Ne=m-j*65536,m=De+j+65535,j=Math.floor(m/65536),De=m-j*65536,m=qe+j+65535,j=Math.floor(m/65536),qe=m-j*65536,m=Ue+j+65535,j=Math.floor(m/65536),Ue=m-j*65536,m=ft+j+65535,j=Math.floor(m/65536),ft=m-j*65536,m=ke+j+65535,j=Math.floor(m/65536),ke=m-j*65536,m=Xe+j+65535,j=Math.floor(m/65536),Xe=m-j*65536,m=Ze+j+65535,j=Math.floor(m/65536),Ze=m-j*65536,m=rt+j+65535,j=Math.floor(m/65536),rt=m-j*65536,m=nt+j+65535,j=Math.floor(m/65536),nt=m-j*65536,m=Je+j+65535,j=Math.floor(m/65536),Je=m-j*65536,m=tt+j+65535,j=Math.floor(m/65536),tt=m-j*65536,m=et+j+65535,j=Math.floor(m/65536),et=m-j*65536,m=Ge+j+65535,j=Math.floor(m/65536),Ge=m-j*65536,le+=j-1+37*(j-1),j=1,m=le+j+65535,j=Math.floor(m/65536),le=m-j*65536,m=fe+j+65535,j=Math.floor(m/65536),fe=m-j*65536,m=Ne+j+65535,j=Math.floor(m/65536),Ne=m-j*65536,m=De+j+65535,j=Math.floor(m/65536),De=m-j*65536,m=qe+j+65535,j=Math.floor(m/65536),qe=m-j*65536,m=Ue+j+65535,j=Math.floor(m/65536),Ue=m-j*65536,m=ft+j+65535,j=Math.floor(m/65536),ft=m-j*65536,m=ke+j+65535,j=Math.floor(m/65536),ke=m-j*65536,m=Xe+j+65535,j=Math.floor(m/65536),Xe=m-j*65536,m=Ze+j+65535,j=Math.floor(m/65536),Ze=m-j*65536,m=rt+j+65535,j=Math.floor(m/65536),rt=m-j*65536,m=nt+j+65535,j=Math.floor(m/65536),nt=m-j*65536,m=Je+j+65535,j=Math.floor(m/65536),Je=m-j*65536,m=tt+j+65535,j=Math.floor(m/65536),tt=m-j*65536,m=et+j+65535,j=Math.floor(m/65536),et=m-j*65536,m=Ge+j+65535,j=Math.floor(m/65536),Ge=m-j*65536,le+=j-1+37*(j-1),v[0]=le,v[1]=fe,v[2]=Ne,v[3]=De,v[4]=qe,v[5]=Ue,v[6]=ft,v[7]=ke,v[8]=Xe,v[9]=Ze,v[10]=rt,v[11]=nt,v[12]=Je,v[13]=tt,v[14]=et,v[15]=Ge}function Te(v,W){se(v,W,W)}function pe(v,W){var $=E(),m;for(m=0;m<16;m++)$[m]=W[m];for(m=253;m>=0;m--)Te($,$),m!==2&&m!==4&&se($,$,W);for(m=0;m<16;m++)v[m]=$[m]}function ne(v,W){var $=E(),m;for(m=0;m<16;m++)$[m]=W[m];for(m=250;m>=0;m--)Te($,$),m!==1&&se($,$,W);for(m=0;m<16;m++)v[m]=$[m]}function oe(v,W,$){var m=new Uint8Array(32),j=new Float64Array(80),le,fe,Ne=E(),De=E(),qe=E(),Ue=E(),ft=E(),ke=E();for(fe=0;fe<31;fe++)m[fe]=W[fe];for(m[31]=W[31]&127|64,m[0]&=248,A(j,$),fe=0;fe<16;fe++)De[fe]=j[fe],Ue[fe]=Ne[fe]=qe[fe]=0;for(Ne[0]=Ue[0]=1,fe=254;fe>=0;--fe)le=m[fe>>>3]>>>(fe&7)&1,F(Ne,De,le),F(qe,Ue,le),z(ft,Ne,qe),J(Ne,Ne,qe),z(qe,De,Ue),J(De,De,Ue),Te(Ue,ft),Te(ke,Ne),se(Ne,qe,Ne),se(qe,De,ft),z(ft,Ne,qe),J(Ne,Ne,qe),Te(De,Ne),J(qe,Ue,ke),se(Ne,qe,r),z(Ne,Ne,Ue),se(qe,qe,Ne),se(Ne,Ue,ke),se(Ue,De,j),Te(De,ft),F(Ne,De,le),F(qe,Ue,le);for(fe=0;fe<16;fe++)j[fe+16]=Ne[fe],j[fe+32]=qe[fe],j[fe+48]=De[fe],j[fe+64]=Ue[fe];var Xe=j.subarray(32),Ze=j.subarray(16);return pe(Xe,Xe),se(Ze,Ze,Xe),Y(v,Ze),0}function de(v,W){return oe(v,W,n)}function _e(v,W){return k(W,32),de(v,W)}function b(v,W,$){var m=new Uint8Array(32);return oe(m,$,W),p(v,V,m,R)}var X=L,ae=M;function ie(v,W,$,m,j,le){var fe=new Uint8Array(32);return b(fe,j,le),X(v,W,$,m,fe)}function q(v,W,$,m,j,le){var fe=new Uint8Array(32);return b(fe,j,le),ae(v,W,$,m,fe)}var Pe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ve(v,W,$,m){for(var j=new Int32Array(16),le=new Int32Array(16),fe,Ne,De,qe,Ue,ft,ke,Xe,Ze,rt,nt,Je,tt,et,Ge,Ve,Fe,$e,We,Le,Ie,Re,be,Oe,ye,we,je=v[0],st=v[1],ot=v[2],it=v[3],te=v[4],ct=v[5],_t=v[6],Et=v[7],at=W[0],lt=W[1],ht=W[2],vt=W[3],Tt=W[4],yt=W[5],bt=W[6],Pt=W[7],Lt=0;m>=128;){for(We=0;We<16;We++)Le=8*We+Lt,j[We]=$[Le+0]<<24|$[Le+1]<<16|$[Le+2]<<8|$[Le+3],le[We]=$[Le+4]<<24|$[Le+5]<<16|$[Le+6]<<8|$[Le+7];for(We=0;We<80;We++)if(fe=je,Ne=st,De=ot,qe=it,Ue=te,ft=ct,ke=_t,Xe=Et,Ze=at,rt=lt,nt=ht,Je=vt,tt=Tt,et=yt,Ge=bt,Ve=Pt,Ie=Et,Re=Pt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=(te>>>14|Tt<<32-14)^(te>>>18|Tt<<32-18)^(Tt>>>41-32|te<<32-(41-32)),Re=(Tt>>>14|te<<32-14)^(Tt>>>18|te<<32-18)^(te>>>41-32|Tt<<32-(41-32)),be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Ie=te&ct^~te&_t,Re=Tt&yt^~Tt&bt,be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Ie=Pe[We*2],Re=Pe[We*2+1],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Ie=j[We%16],Re=le[We%16],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,Fe=ye&65535|we<<16,$e=be&65535|Oe<<16,Ie=Fe,Re=$e,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=(je>>>28|at<<32-28)^(at>>>34-32|je<<32-(34-32))^(at>>>39-32|je<<32-(39-32)),Re=(at>>>28|je<<32-28)^(je>>>34-32|at<<32-(34-32))^(je>>>39-32|at<<32-(39-32)),be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Ie=je&st^je&ot^st&ot,Re=at&lt^at&ht^lt&ht,be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,Xe=ye&65535|we<<16,Ve=be&65535|Oe<<16,Ie=qe,Re=Je,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=Fe,Re=$e,be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,qe=ye&65535|we<<16,Je=be&65535|Oe<<16,st=fe,ot=Ne,it=De,te=qe,ct=Ue,_t=ft,Et=ke,je=Xe,lt=Ze,ht=rt,vt=nt,Tt=Je,yt=tt,bt=et,Pt=Ge,at=Ve,We%16===15)for(Le=0;Le<16;Le++)Ie=j[Le],Re=le[Le],be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=j[(Le+9)%16],Re=le[(Le+9)%16],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Fe=j[(Le+1)%16],$e=le[(Le+1)%16],Ie=(Fe>>>1|$e<<32-1)^(Fe>>>8|$e<<32-8)^Fe>>>7,Re=($e>>>1|Fe<<32-1)^($e>>>8|Fe<<32-8)^($e>>>7|Fe<<32-7),be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Fe=j[(Le+14)%16],$e=le[(Le+14)%16],Ie=(Fe>>>19|$e<<32-19)^($e>>>61-32|Fe<<32-(61-32))^Fe>>>6,Re=($e>>>19|Fe<<32-19)^(Fe>>>61-32|$e<<32-(61-32))^($e>>>6|Fe<<32-6),be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,j[Le]=ye&65535|we<<16,le[Le]=be&65535|Oe<<16;Ie=je,Re=at,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[0],Re=W[0],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[0]=je=ye&65535|we<<16,W[0]=at=be&65535|Oe<<16,Ie=st,Re=lt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[1],Re=W[1],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[1]=st=ye&65535|we<<16,W[1]=lt=be&65535|Oe<<16,Ie=ot,Re=ht,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[2],Re=W[2],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[2]=ot=ye&65535|we<<16,W[2]=ht=be&65535|Oe<<16,Ie=it,Re=vt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[3],Re=W[3],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[3]=it=ye&65535|we<<16,W[3]=vt=be&65535|Oe<<16,Ie=te,Re=Tt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[4],Re=W[4],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[4]=te=ye&65535|we<<16,W[4]=Tt=be&65535|Oe<<16,Ie=ct,Re=yt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[5],Re=W[5],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[5]=ct=ye&65535|we<<16,W[5]=yt=be&65535|Oe<<16,Ie=_t,Re=bt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[6],Re=W[6],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[6]=_t=ye&65535|we<<16,W[6]=bt=be&65535|Oe<<16,Ie=Et,Re=Pt,be=Re&65535,Oe=Re>>>16,ye=Ie&65535,we=Ie>>>16,Ie=v[7],Re=W[7],be+=Re&65535,Oe+=Re>>>16,ye+=Ie&65535,we+=Ie>>>16,Oe+=be>>>16,ye+=Oe>>>16,we+=ye>>>16,v[7]=Et=ye&65535|we<<16,W[7]=Pt=be&65535|Oe<<16,Lt+=128,m-=128}return m}function Qe(v,W,$){var m=new Int32Array(8),j=new Int32Array(8),le=new Uint8Array(256),fe,Ne=$;for(m[0]=1779033703,m[1]=3144134277,m[2]=1013904242,m[3]=2773480762,m[4]=1359893119,m[5]=2600822924,m[6]=528734635,m[7]=1541459225,j[0]=4089235720,j[1]=2227873595,j[2]=4271175723,j[3]=1595750129,j[4]=2917565137,j[5]=725511199,j[6]=4215389547,j[7]=327033209,ve(m,j,W,$),$%=128,fe=0;fe<$;fe++)le[fe]=W[Ne-$+fe];for(le[$]=128,$=256-128*($<112?1:0),le[$-9]=0,o(le,$-8,Ne/536870912|0,Ne<<3),ve(m,j,le,$),fe=0;fe<8;fe++)o(v,8*fe,m[fe],j[fe]);return 0}function Z(v,W){var $=E(),m=E(),j=E(),le=E(),fe=E(),Ne=E(),De=E(),qe=E(),Ue=E();J($,v[1],v[0]),J(Ue,W[1],W[0]),se($,$,Ue),z(m,v[0],v[1]),z(Ue,W[0],W[1]),se(m,m,Ue),se(j,v[3],W[3]),se(j,j,t),se(le,v[2],W[2]),z(le,le,le),J(fe,m,$),J(Ne,le,j),z(De,le,j),z(qe,m,$),se(v[0],fe,Ne),se(v[1],qe,De),se(v[2],De,Ne),se(v[3],fe,qe)}function ee(v,W,$){var m;for(m=0;m<4;m++)F(v[m],W[m],$)}function ge(v,W){var $=E(),m=E(),j=E();pe(j,W[2]),se($,W[0],j),se(m,W[1],j),Y(v,m),v[31]^=U($)<<7}function d(v,W,$){var m,j;for(G(v[0],I),G(v[1],e),G(v[2],e),G(v[3],I),j=255;j>=0;--j)m=$[j/8|0]>>(j&7)&1,ee(v,W,m),Z(W,v),Z(v,v),ee(v,W,m)}function O(v,W){var $=[E(),E(),E(),E()];G($[0],c),G($[1],l),G($[2],e),se($[3],c,l),d(v,$,W)}function D(v,W,$){var m=new Uint8Array(64),j=[E(),E(),E(),E()],le;for($||k(W,32),Qe(m,W,32),m[0]&=248,m[31]&=127,m[31]|=64,O(j,m),ge(v,j),le=0;le<32;le++)W[le+32]=v[le];return 0}var Q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function re(v,W){var $,m,j,le;for(m=63;m>=32;--m){for($=0,j=m-32,le=m-12;j<le;++j)W[j]+=$-16*W[m]*Q[j-(m-32)],$=Math.floor((W[j]+128)/256),W[j]-=$*256;W[j]+=$,W[m]=0}for($=0,j=0;j<32;j++)W[j]+=$-(W[31]>>4)*Q[j],$=W[j]>>8,W[j]&=255;for(j=0;j<32;j++)W[j]-=$*Q[j];for(m=0;m<32;m++)W[m+1]+=W[m]>>8,v[m]=W[m]&255}function ce(v){var W=new Float64Array(64),$;for($=0;$<64;$++)W[$]=v[$];for($=0;$<64;$++)v[$]=0;re(v,W)}function me(v,W,$,m){var j=new Uint8Array(64),le=new Uint8Array(64),fe=new Uint8Array(64),Ne,De,qe=new Float64Array(64),Ue=[E(),E(),E(),E()];Qe(j,m,32),j[0]&=248,j[31]&=127,j[31]|=64;var ft=$+64;for(Ne=0;Ne<$;Ne++)v[64+Ne]=W[Ne];for(Ne=0;Ne<32;Ne++)v[32+Ne]=j[32+Ne];for(Qe(fe,v.subarray(32),$+32),ce(fe),O(Ue,fe),ge(v,Ue),Ne=32;Ne<64;Ne++)v[Ne]=m[Ne];for(Qe(le,v,$+64),ce(le),Ne=0;Ne<64;Ne++)qe[Ne]=0;for(Ne=0;Ne<32;Ne++)qe[Ne]=fe[Ne];for(Ne=0;Ne<32;Ne++)for(De=0;De<32;De++)qe[Ne+De]+=le[Ne]*j[De];return re(v.subarray(32),qe),ft}function Ee(v,W){var $=E(),m=E(),j=E(),le=E(),fe=E(),Ne=E(),De=E();return G(v[2],e),A(v[1],W),Te(j,v[1]),se(le,j,i),J(j,j,v[2]),z(le,v[2],le),Te(fe,le),Te(Ne,fe),se(De,Ne,fe),se($,De,j),se($,$,le),ne($,$),se($,$,j),se($,$,le),se($,$,le),se(v[0],$,le),Te(m,v[0]),se(m,m,le),_(m,j)&&se(v[0],v[0],u),Te(m,v[0]),se(m,m,le),_(m,j)?-1:(U(v[0])===W[31]>>7&&J(v[0],I,v[0]),se(v[3],v[0],v[1]),0)}function Ce(v,W,$,m){var j,le=new Uint8Array(32),fe=new Uint8Array(64),Ne=[E(),E(),E(),E()],De=[E(),E(),E(),E()];if($<64||Ee(De,m))return-1;for(j=0;j<$;j++)v[j]=W[j];for(j=0;j<32;j++)v[j+32]=m[j];if(Qe(fe,v,$),ce(fe),d(Ne,De,fe),O(De,W.subarray(32)),Z(Ne,De),ge(le,Ne),$-=64,h(W,0,le,0)){for(j=0;j<$;j++)v[j]=0;return-1}for(j=0;j<$;j++)v[j]=W[j+64];return $}var Me=32,Be=24,He=32,Ot=16,xt=32,gt=32,Ae=32,ut=32,Ke=32,mt=Be,Dt=He,Ye=Ot,Rt=64,ze=32,Ut=64,kt=32,nn=64;a.lowlevel={crypto_core_hsalsa20:p,crypto_stream_xor:P,crypto_stream:y,crypto_stream_salsa20_xor:N,crypto_stream_salsa20:w,crypto_onetimeauth:B,crypto_onetimeauth_verify:H,crypto_verify_16:g,crypto_verify_32:h,crypto_secretbox:L,crypto_secretbox_open:M,crypto_scalarmult:oe,crypto_scalarmult_base:de,crypto_box_beforenm:b,crypto_box_afternm:X,crypto_box:ie,crypto_box_open:q,crypto_box_keypair:_e,crypto_hash:Qe,crypto_sign:me,crypto_sign_keypair:D,crypto_sign_open:Ce,crypto_secretbox_KEYBYTES:Me,crypto_secretbox_NONCEBYTES:Be,crypto_secretbox_ZEROBYTES:He,crypto_secretbox_BOXZEROBYTES:Ot,crypto_scalarmult_BYTES:xt,crypto_scalarmult_SCALARBYTES:gt,crypto_box_PUBLICKEYBYTES:Ae,crypto_box_SECRETKEYBYTES:ut,crypto_box_BEFORENMBYTES:Ke,crypto_box_NONCEBYTES:mt,crypto_box_ZEROBYTES:Dt,crypto_box_BOXZEROBYTES:Ye,crypto_sign_BYTES:Rt,crypto_sign_PUBLICKEYBYTES:ze,crypto_sign_SECRETKEYBYTES:Ut,crypto_sign_SEEDBYTES:kt,crypto_hash_BYTES:nn,gf:E,D:i,L:Q,pack25519:Y,unpack25519:A,M:se,A:z,S:Te,Z:J,pow2523:ne,add:Z,set25519:G,modL:re,scalarmult:d,scalarbase:O};function rn(v,W){if(v.length!==Me)throw new Error("bad key size");if(W.length!==Be)throw new Error("bad nonce size")}function Tn(v,W){if(v.length!==Ae)throw new Error("bad public key size");if(W.length!==ut)throw new Error("bad secret key size")}function Gt(){for(var v=0;v<arguments.length;v++)if(!(arguments[v]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function mr(v){for(var W=0;W<v.length;W++)v[W]=0}a.randomBytes=function(v){var W=new Uint8Array(v);return k(W,v),W},a.secretbox=function(v,W,$){Gt(v,W,$),rn($,W);for(var m=new Uint8Array(He+v.length),j=new Uint8Array(m.length),le=0;le<v.length;le++)m[le+He]=v[le];return L(j,m,m.length,W,$),j.subarray(Ot)},a.secretbox.open=function(v,W,$){Gt(v,W,$),rn($,W);for(var m=new Uint8Array(Ot+v.length),j=new Uint8Array(m.length),le=0;le<v.length;le++)m[le+Ot]=v[le];return m.length<32||M(j,m,m.length,W,$)!==0?null:j.subarray(He)},a.secretbox.keyLength=Me,a.secretbox.nonceLength=Be,a.secretbox.overheadLength=Ot,a.scalarMult=function(v,W){if(Gt(v,W),v.length!==gt)throw new Error("bad n size");if(W.length!==xt)throw new Error("bad p size");var $=new Uint8Array(xt);return oe($,v,W),$},a.scalarMult.base=function(v){if(Gt(v),v.length!==gt)throw new Error("bad n size");var W=new Uint8Array(xt);return de(W,v),W},a.scalarMult.scalarLength=gt,a.scalarMult.groupElementLength=xt,a.box=function(v,W,$,m){var j=a.box.before($,m);return a.secretbox(v,W,j)},a.box.before=function(v,W){Gt(v,W),Tn(v,W);var $=new Uint8Array(Ke);return b($,v,W),$},a.box.after=a.secretbox,a.box.open=function(v,W,$,m){var j=a.box.before($,m);return a.secretbox.open(v,W,j)},a.box.open.after=a.secretbox.open,a.box.keyPair=function(){var v=new Uint8Array(Ae),W=new Uint8Array(ut);return _e(v,W),{publicKey:v,secretKey:W}},a.box.keyPair.fromSecretKey=function(v){if(Gt(v),v.length!==ut)throw new Error("bad secret key size");var W=new Uint8Array(Ae);return de(W,v),{publicKey:W,secretKey:new Uint8Array(v)}},a.box.publicKeyLength=Ae,a.box.secretKeyLength=ut,a.box.sharedKeyLength=Ke,a.box.nonceLength=mt,a.box.overheadLength=a.secretbox.overheadLength,a.sign=function(v,W){if(Gt(v,W),W.length!==Ut)throw new Error("bad secret key size");var $=new Uint8Array(Rt+v.length);return me($,v,v.length,W),$},a.sign.open=function(v,W){if(Gt(v,W),W.length!==ze)throw new Error("bad public key size");var $=new Uint8Array(v.length),m=Ce($,v,v.length,W);if(m<0)return null;for(var j=new Uint8Array(m),le=0;le<j.length;le++)j[le]=$[le];return j},a.sign.detached=function(v,W){for(var $=a.sign(v,W),m=new Uint8Array(Rt),j=0;j<m.length;j++)m[j]=$[j];return m},a.sign.detached.verify=function(v,W,$){if(Gt(v,W,$),W.length!==Rt)throw new Error("bad signature size");if($.length!==ze)throw new Error("bad public key size");var m=new Uint8Array(Rt+v.length),j=new Uint8Array(Rt+v.length),le;for(le=0;le<Rt;le++)m[le]=W[le];for(le=0;le<v.length;le++)m[le+Rt]=v[le];return Ce(j,m,m.length,$)>=0},a.sign.keyPair=function(){var v=new Uint8Array(ze),W=new Uint8Array(Ut);return D(v,W),{publicKey:v,secretKey:W}},a.sign.keyPair.fromSecretKey=function(v){if(Gt(v),v.length!==Ut)throw new Error("bad secret key size");for(var W=new Uint8Array(ze),$=0;$<W.length;$++)W[$]=v[32+$];return{publicKey:W,secretKey:new Uint8Array(v)}},a.sign.keyPair.fromSeed=function(v){if(Gt(v),v.length!==kt)throw new Error("bad seed size");for(var W=new Uint8Array(ze),$=new Uint8Array(Ut),m=0;m<32;m++)$[m]=v[m];return D(W,$,!0),{publicKey:W,secretKey:$}},a.sign.publicKeyLength=ze,a.sign.secretKeyLength=Ut,a.sign.seedLength=kt,a.sign.signatureLength=Rt,a.hash=function(v){Gt(v);var W=new Uint8Array(nn);return Qe(W,v,v.length),W},a.hash.hashLength=nn,a.verify=function(v,W){return Gt(v,W),v.length===0||W.length===0||v.length!==W.length?!1:f(v,0,W,0,v.length)===0},a.setPRNG=function(v){k=v},function(){var v=typeof self<"u"?self.crypto||self.msCrypto:null;if(v&&v.getRandomValues){var W=65536;a.setPRNG(function($,m){var j,le=new Uint8Array(m);for(j=0;j<m;j+=W)v.getRandomValues(le.subarray(j,j+Math.min(m-j,W)));for(j=0;j<m;j++)$[j]=le[j];mr(le)})}else typeof gu<"u"&&(v=si,v&&v.randomBytes&&a.setPRNG(function($,m){var j,le=v.randomBytes(m);for(j=0;j<m;j++)$[j]=le[j];mr(le)}))}()})(s.exports?s.exports:self.nacl=self.nacl||{})})(Tu);const Su="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",Nn=Su;function mu(s){if(!s||typeof s!="string")throw new Error(`Expected base58 string but got ${s}`);if(s.match(/[IOl0]/gmu))throw new Error(`Invalid base58 character ${s.match(/[IOl0]/gmu)}`);const a=s.match(/^1+/gmu),E=a?a[0].length:0,k=(s.length-E)*(Math.log(58)/Math.log(256))+1>>>0;return new Uint8Array([...new Uint8Array(E),...s.match(/.{1}/gmu).map(V=>Nn.indexOf(V)).reduce((V,n)=>(V=V.map(I=>{const e=I*58+n;return n=e>>8,e}),V),new Uint8Array(k)).reverse().filter((V=>n=>V=V||n)(!1))])}const Iu=()=>{const s=Array(256).fill(-1);for(let a=0;a<Nn.length;++a)s[Nn.charCodeAt(a)]=a;return s},Ru=Iu,Au=Ru();function ls(s){const a=[];for(const E of s){let k=E;for(let V=0;V<a.length;++V){const n=(Au[a[V]]<<8)+k;a[V]=Nn.charCodeAt(n%58),k=n/58|0}for(;k;)a.push(Nn.charCodeAt(k%58)),k=k/58|0}for(const E of s){if(E)break;a.push("1".charCodeAt(0))}return a.reverse(),String.fromCharCode(...a)}const Cu=(s,a)=>{const E=mu(a),k=Bn.sign.keyPair.fromSeed(E),V=hr(s),n=Bn.sign(V,k.secretKey);return{msg:ls(V),sign:ls(n.slice(0,64))}};function Ln(s){if(s!==""&&s!==void 0){const a=JSON.parse(window.atob(s.split(".")[1]));return!(Date.now()>a.exp*1e3)}else return!1}function Ou(s){return!1}const an=(s,a,E)=>{zt.error(`${E} ${a.reason} ${a.message}`),console.log(a)};let Nu=s=>{s.on("@init",a=>(Ct.SolclientFactory.init({profile:Ct.SolclientFactoryProfiles.version10_5,logLevel:Ct.LogLevel.WARN,logger:{trace:(...E)=>console.log("trace",E),debug:(...E)=>console.log("debug",E),info:(...E)=>console.log("info",E),warn:(...E)=>console.log("warn",E),error:(...E)=>console.log("error",E),fatal:(...E)=>console.log("fatal",E)}}),{authed:!1,person_id:"",token:"",connStatus:"offline",pfxB64:{},pfxPassword:{},rememberPfxPassword:!1,hasActivatedCa:!1,simulation:!1,activatedCa:{},activeTab:"WatchList",snapshots:{},activeWatchList:[],watchSnapshots:[],activeContract:void 0,subscribed:[],accounts:[],activeStockAccount:void 0,activeFutureAccount:void 0,activeHAccount:void 0,trades:[],showTrades:[],showTradesFilter:"ACTIVE",queueSOrder:[],queueSDeal:[],streamBidAsk:{},activeBidAsk:fu})),s.on("setStatus",(a,E)=>({...s.get(),connStatus:E})),s.on("setAuth",(a,E)=>({...s.get(),authed:E})),s.on("setToken",(a,E)=>(Ln(E)?s.dispatch("setAuth",!0):s.dispatch("setAuth",!1),{...s.get(),token:E})),s.on("setClientName",(a,E)=>({...s.get(),clientName:E})),s.on("setSite",(a,E)=>({...a,site:E})),s.on("setIDCToken",(a,E)=>({...a,idcToken:E})),s.on("setBCToken",(a,E)=>({...a,bcToken:E})),s.on("setPersonID",(a,E)=>((E.length===10||E.length===44)&&a.connStatus!=="online"&&s.dispatch("connect"),{...s.get(),person_id:E})),s.on("setActiveTab",(a,E)=>({...s.get(),activeTab:E})),s.on("setPfxB64",(a,E)=>({...s.get(),pfxB64:{...s.get().pfxB64,[E.filename]:E.b64}})),s.on("setPfxPassword",(a,E)=>({...s.get(),pfxPassword:{...s.get().pfxPassword,[E.filename]:E.password}})),s.on("setRememberPfxPassword",(a,E)=>({...s.get(),rememberPfxPassword:E})),s.on("setSimulation",(a,E)=>({...s.get(),simulation:E})),s.on("addActivatedCa",(a,E)=>({...a,activatedCa:{...a.activatedCa,...E},hasActivatedCa:!0})),s.on("selectCa",(a,E)=>({...a,selectedCa:a.activatedCa[E]})),s.on("cleanCa",()=>({...s.get(),pfxB64:{},pfxPassword:{},selectedCa:void 0,hasActivatedCa:!1,activatedCa:{}})),s.on("addAccount",(a,E)=>{if(console.log(E),a.accounts.filter(k=>k.account_type===E.account_type&&k.person_id===E.person_id&&k.broker_id===E.broker_id&&k.account_id===E.account_id).length===0)return{...s.get(),accounts:[...s.get().accounts,E]};if(a.accounts.filter(k=>k.account_type===E.account_type&&k.person_id===E.person_id&&k.broker_id===E.broker_id&&k.account_id===E.account_id&&k.signed===!1).length===1&&E.signed===!0)return{...s.get(),accounts:[...s.get().accounts.filter(k=>!(k.account_type===E.account_type&&k.person_id===E.person_id&&k.broker_id===E.broker_id&&k.account_id===E.account_id&&k.signed===!1)),E]};console.log(`skip ${E}`)}),s.on("setActiveAccount",(a,E)=>{if(E.account_type==="S")return{...s.get(),activeStockAccount:E};if(E.account_type==="F")return{...s.get(),activeFutureAccount:E};if(E.account_type==="H")return{...s.get(),activeHAccount:E}}),s.on("addTrade",(a,E)=>s.get().trades.filter(k=>k.order.seqno===E.order.seqno).length===0?{...s.get(),trades:[E,...On(s.get().trades)]}:{...s.get(),trades:s.get().trades.map(k=>E.order.seqno===k.order.seqno?On({...k,...E}):k)}),s.on("addSOrder",(a,E)=>({...s.get(),queueSOrder:[...s.get().queueSOrder,E]})),s.on("delSOrder",(a,E)=>({...s.get(),queueSOrder:s.get().queueSOrder.filter(k=>k.order.seqno!==E.order.seqno)})),s.on("addSDeal",(a,E)=>({...s.get(),queueSDeal:[...s.get().queueSDeal,E]})),s.on("delSDeal",(a,E)=>({...s.get(),queueSDeal:s.get().queueSDeal.filter(k=>!(k.trade_id===E.trade_id&&k.exchange_seq===E.exchange_seq))})),s.on("updateTrades",(a,E)=>({...s.get(),trades:E})),s.on("updateShowTrades",a=>{if(a.showTradesFilter==="ACTIVE")return{...s.get(),showTrades:s.get().trades.filter(Yn)};if(a.showTradesFilter==="FILL")return{...s.get(),showTrades:s.get().trades.filter(Ir)};if(a.showTradesFilter==="CANCEL")return{...s.get(),showTrades:s.get().trades.filter(Rr)};if(a.showTradesFilter==="DONE")return{...s.get(),showTrades:s.get().trades.filter(Ar)};if(a.showTradesFilter==="FILLED")return{...s.get(),showTrades:s.get().trades.filter(Cr)};if(a.showTradesFilter==="SUBMIT")return{...s.get(),showTrades:s.get().trades.filter(Or)};if(a.showTradesFilter==="ALL")return console.log(s.get().trades),{...s.get(),showTrades:s.get().trades}}),s.on("setTradeFilter",(a,E)=>{if(E==="ACTIVE")return console.log(s.get().trades),console.log(s.get().trades.map(Yn)),{...s.get(),showTrades:s.get().trades.filter(Yn),showTradesFilter:E};if(E==="FILL")return{...s.get(),showTrades:s.get().trades.filter(Ir),showTradesFilter:E};if(E==="CANCEL")return{...s.get(),showTrades:s.get().trades.filter(Rr),showTradesFilter:E};if(E==="DONE")return{...s.get(),showTrades:s.get().trades.filter(Ar),showTradesFilter:E};if(E==="FILLED")return{...s.get(),showTrades:s.get().trades.filter(Cr),showTradesFilter:E};if(E==="SUBMIT")return{...s.get(),showTrades:s.get().trades.filter(Or),showTradesFilter:E};if(E==="ALL")return console.log(s.get().trades),{...s.get(),showTrades:s.get().trades,showTradesFilter:E}}),s.on("setWatchList",(a,E)=>({...a,activeWatchList:E})),s.on("setWatchListSnapshots",(a,E)=>({...a,watchSnapshots:E})),s.on("setSnapshots",(a,E)=>({...a,snapshots:{...a.snapshots,...E}})),s.on("setActiveKbars",(a,E)=>({...a,activeKbars:E})),s.on("setActiveContract",(a,E)=>({...a,activeContract:E})),s.on("setActiveBidAsk",(a,E)=>({...s.get(),activeBidAsk:E})),s.on("setStreamBidAsk",(a,E)=>({...s.get(),streamBidAsk:{...s.get().streamBidAsk,...E}})),s.on("checkTokenExpire",a=>{if(a.token!==""){let E;if(a.site=="idc"?E=a.idcToken:a.site=="bc"?E=a.bcToken:E=a.token,Ln(E))console.log("TokenValid");else return s.dispatch("setToken",""),s.get()}}),s.on("checkCaExpire",a=>(Ou(a.selectedCa),a)),s.on("connect",a=>{if(s.get().connStatus==="offline"&&a.session===void 0){s.dispatch("setStatus","connecting");const E=new Ct.SessionProperties({url:"wss://mr.sinotrade.com.tw/smf",vpnName:"sinopac",userName:"shioaji",password:"sahjiio111",clientName:a.clientName===void 0?`PYAPI/${a.person_id!==""?a.person_id:"UNKNOWN"}/${Kt().format("MMDD/HHmmss/SSSSSS")}/LOGGING`:a.clientName,generateSequenceNumber:!0,generateReceiveTimestamps:!0,generateSendTimestamps:!0,reapplySubscriptions:!0,connectTimeoutInMsecs:3e3,reconnectRetries:3,keepAliveIntervalInMsecs:3e3,keepAliveIntervalsLimit:5});let k=Ct.SolclientFactory.createSession(E);return k.on(Ct.SessionEventCode.UP_NOTICE,V=>{console.log(`${V}`),s.dispatch("setStatus","online");const n=k.getSessionProperties().virtualRouterName==="v:idcsolace01"?"idc":"bc";if(s.dispatch("setSite",n),n==="idc"){const I=s.get().idcToken;Ln(I)&&s.dispatch("setToken",I)}else if(n==="bc"){const I=s.get().bcToken;Ln(I)&&s.dispatch("setToken",I)}}),k.on(Ct.SessionEventCode.DOWN_ERROR,V=>{console.log(`${V}`),s.dispatch("setStatus","offline")}),k.on(Ct.SessionEventCode.RECONNECTING_NOTICE,V=>{console.log(`${V}`),s.dispatch("setStatus","connecting")}),k.on(Ct.SessionEventCode.RECONNECTED_NOTICE,V=>{console.log(`${V}`),s.dispatch("setStatus","online")}),k.on(Ct.SessionEventCode.SUBSCRIPTION_OK,V=>{console.log(`SUBSCRIPTION_OK: ${V.correlationKey}`)}),k.on(Ct.SessionEventCode.SUBSCRIPTION_ERROR,V=>{console.log(`${V}`),V.correlationKey&&s.dispatch("delSubscribe",String(V.correlationKey))}),k.on(Ct.SessionEventCode.UNSUBSCRIBE_TE_TOPIC_OK,V=>{console.log(V)}),k.on(Ct.SessionEventCode.UNSUBSCRIBE_TE_TOPIC_ERROR,V=>{console.log(V)}),k.on(Ct.SessionEventCode.MESSAGE,V=>{const n=V.getDestination()?.getName();if(n){const I=n.split("/"),e=I[2],r=I[4];if(n.startsWith("TIC")){if(e==="STK"){const i=du(Yt(V));`${r}${i.code}`,s.dispatch("setWatchListSnapshots",s.get().watchSnapshots.map(t=>({...t,...t.code===i.code&&t.exchange===r?cs(i):{}})))}else if(e==="FOP"){const i=pu(Yt(V));`${r}${i.code}`,s.dispatch("setWatchListSnapshots",s.get().watchSnapshots.map(t=>({...t,...t.code===i.code?cs(i):{}})))}}else if(n.startsWith("QUO"))if(e==="STK"){const i=lu(Yt(V));`${r}${i.code}`,i.code===a.activeContract?.code&&r==a.activeContract.exchange&&s.dispatch("setActiveBidAsk",i),s.dispatch("setWatchListSnapshots",s.get().watchSnapshots.map(t=>({...t,...t.code===i.code?as(i):{}})))}else if(e==="FOP"){const i=hu(Yt(V));`${r}${i.code}`,i.code===a.activeContract?.code&&s.dispatch("setActiveBidAsk",i),s.dispatch("setWatchListSnapshots",s.get().watchSnapshots.map(t=>({...t,...t.code===i.code?as(i):{}})))}else console.log(`${e} not support yet`);else if(n.startsWith("#P2P"))if(n.endsWith("SORDER")){const i=Yt(V);console.log(i);const t=s.get().trades.filter(l=>l.order.seqno===i.order.seqno);let c=t.length>0?t[0]:void 0;try{c=_u(i,c),s.dispatch("addTrade",c),s.dispatch("updateShowTrades")}catch(l){console.log(l)}i.operation.op_code==="00"?zt.success(`${i.contract.code} ${i.order.price} ${i.status.order_quantity}`):zt.error(`${i.contract.code} ${i.operation.op_msg} ${i.order.price} ${i.status.order_quantity}`)}else if(n.endsWith("SDEAL")){const i=Yt(V),t=s.get().trades.filter(l=>l.order.id===i.trade_id);console.log(t);let c=t.length>0?t[0]:void 0;console.log(c),c&&(c=Eu(i,c),console.log(c),s.dispatch("addTrade",c),s.dispatch("updateShowTrades")),zt.success(`Deal ${i.code} ${i.price} ${i.quantity}`)}else console.log(n);else console.log(n)}}),k.connect(),console.log(k),{...s.get(),session:k}}else s.get().connStatus==="offline"&&a.session&&(s.dispatch("setStatus","connecting"),a.session.connect(),console.log(a.session));return a}),s.on("login",(a,E)=>{if(a.session&&a.connStatus=="online"){const k=E.person_id.length===44,V=k?"api/v1/auth/token_login":"api/v1/auth/login";s.dispatch("setSimulation",E.simulation),a.session.sendRequest(on(V,k?Cu({key:E.person_id,simulation:E.simulation,version:"1.0.0",source:"scone",subscribe_trade:!0,receive_window:5e3,ts:Kt().unix()},E.password):{...E,version:"1.0.0",source:"scone"}),5e3,(n,I)=>{const e=Yt(I);if(console.log(e),e)if(e.status.status_code===200){s.dispatch("setToken",e.response.token),s.get().site==="idc"?s.dispatch("setIDCToken",e.response.token):s.get().site==="bc"&&s.dispatch("setBCToken",e.response.token),V==="api/v1/auth/token_login"&&s.dispatch("setPersonID",e.response.person_id),console.log(e.response.client_name),s.dispatch("setClientName",e.response.client_name),n.updateProperty(Ct.MutableSessionProperty.CLIENT_NAME,e.response.client_name,3e5,null);for(let r of e.response.accounts)s.dispatch("addAccount",r),(s.get().activeStockAccount===void 0&&r.account_type==="S"||s.get().activeFutureAccount===void 0&&r.account_type==="F"||s.get().activeHAccount===void 0&&r.account_type==="H")&&s.dispatch("setActiveAccount",r)}else zt.error(e.response.detail,vn)},(n,I)=>{an(n,I,"login"),s.dispatch("setAuth",!1)})}return s.get()}),s.on("logout",a=>{a.session&&a.session.sendRequest(on("api/v1/auth/logout",{token:a.token}),1e4,(E,k)=>{a.site==="idc"?s.dispatch("setIDCToken",""):a.site==="bc"&&s.dispatch("setBCToken",""),s.dispatch("setToken","")},(E,k)=>{an(E,k,"logout")}),s.dispatch("setToken","")}),s.on("addSubscribe",(a,E)=>{if(a.subscribed.indexOf(E)===-1)return{...s.get(),subscribed:[...s.get().subscribed,E]}}),s.on("delSubscribe",(a,E)=>{if(a.subscribed.indexOf(E)===-1)return{...s.get(),subscribed:[...s.get().subscribed.filter(k=>k!=E)]}}),s.on("subscribe",(a,E)=>{if(a.session&&a.connStatus==="online"){let k;const V=E.contract;if(E.quote_type==="Tick"&&V.security_type==="STK"?k=Ct.SolclientFactory.createTopicDestination(`TIC/v1/STK/*/${V.exchange}/${V.code}`):E.quote_type==="BidAsk"&&V.security_type==="STK"?k=Ct.SolclientFactory.createTopicDestination(`QUO/v1/STK/*/${V.exchange}/${V.code}`):E.quote_type==="Tick"&&V.exchange==="TAIFEX"?k=Ct.SolclientFactory.createTopicDestination(`TIC/v1/FOP/*/${V.security_type==="FUT"?"TFE":"OPT"}/${V.code}`):E.quote_type==="BidAsk"&&V.exchange==="TAIFEX"&&(k=Ct.SolclientFactory.createTopicDestination(`QUO/v1/FOP/*/${V.security_type==="FUT"?"TFE":"OPT"}/${V.code}`)),k){const n=JSON.stringify(E);if(s.get().subscribed.indexOf(n)===-1)return a.session.subscribe(k,!0,n,5e3),{...s.get(),subscribed:[...s.get().subscribed,n]}}}}),s.on("fetchSnapshots",(a,E)=>{if(console.log("fetchSnapshots"),a.session&&a.connStatus=="online"){const k=E.map(V=>`${V.exchange}/${V.code}`);E.length>0&&a.session.sendRequest(on("api/v1/data/snapshots",{contracts:E,token:a.token}),5e3,(V,n)=>{const I=Yt(n);if(console.log(I),I)if(I.status.status_code==200){const e=I.response,r=Object.fromEntries(e.snapshot.map((i,t)=>[k[t],{...i,ts:Kt(Number(i.ts/1000000n)),total_amount:i.total_amount.toString(),security_type:E[t].security_type}]));s.dispatch("setSnapshots",r),s.dispatch("setWatchListSnapshots",s.get().activeWatchList.map(i=>({...r[`${i.exchange}/${i.code}`],security_type:i.security_type})))}else{const e=I.response;mn(e,I.status,s.dispatch)}},(V,n)=>{an(V,n,"snapshots")})}}),s.on("prepareWatchList",(a,E)=>{s.dispatch("setWatchList",E),s.dispatch("fetchSnapshots",E);for(let k of E)s.dispatch("subscribe",{quote_type:"BidAsk",contract:k}),s.dispatch("subscribe",{quote_type:"Tick",contract:k})}),s.on("fetchKbars",(a,E)=>{console.log("fetchKbars"),a.session&&a.connStatus=="online"&&E&&a.session.sendRequest(on("api/v1/data/kbars",{contract:E,start:Kt().utc().format("YYYY-MM-DD"),end:Kt().utc().format("YYYY-MM-DD"),token:a.token}),3e4,(k,V)=>{const n=Yt(V);if(n.status.status_code===200){const I=n.response;try{const e=I.ts.map((r,i)=>({time:Number(r/1000000n)/1e3,open:I.Open[i],high:I.High[i],low:I.Low[i],close:I.Close[i],volume:I.Volume[i]}));s.dispatch("setActiveKbars",e)}catch(e){console.log(e)}}else{const I=n.response;mn(I,n.status,s.dispatch)}},(k,V)=>{an(k,V,"kbars")})}),s.on("placeOrder",(a,E)=>{if(a.session&&a.connStatus=="online"){console.log("place order"),console.log(E);const k=a.simulation?"api/v1/paper/place_order":"api/v1/order/place_order";a.session.sendRequest(on(k,{...E,token:a.token}),1e4,(V,n)=>{const I=Yt(n);if(console.log(I),I.status.status_code===200){let e=I.response;try{console.log("response trade"),console.log(e),s.get().trades.filter(r=>r.order.id===e.order.id).length===0&&(s.dispatch("addTrade",e),s.dispatch("updateShowTrades"))}catch(r){console.log(r)}}else mn(I.response,I.status,s.dispatch)},(V,n)=>{an(V,n,"place_order")})}else zt.error("Session Not Ready",vn)}),s.on("cancelOrder",(a,E)=>{if(a.session&&a.connStatus=="online"){const k=a.simulation?"api/v1/paper/cancel_order":"api/v1/order/cancel_order";console.log("cancel order"),console.log(E),a.session.sendRequest(on(k,{contract:E.contract,order:E.order,token:a.token}),1e4,(V,n)=>{const I=Yt(n);console.log(I),I.status.status_code===200?I.response:mn(I.response,I.status,s.dispatch)},(V,n)=>{an(V,n,"place_order")})}else zt.error("Session Not Ready",vn)}),s.on("updateStatus",(a,E)=>{if(a.session&&a.connStatus=="online"){const k=a.simulation?"api/v1/paper/update_status":"api/v1/order/update_status";a.session.sendRequest(on(k,{...E,token:a.token}),1e4,(V,n)=>{const I=Yt(n);if(console.log(I),I.status.status_code===200){let e=I.response;e=e.sort((r,i)=>i.status.order_ts-r.status.order_ts);try{s.dispatch("updateTrades",e),s.dispatch("setTradeFilter",a.showTradesFilter)}catch(r){console.log(r)}}else mn(I.response,I.status,s.dispatch)},(V,n)=>{an(V,n,"update_status")})}else zt.error("Session Not Ready",vn)})},hs=(s,a)=>{if(a=a||{},s=s||[],typeof window>"u")return;let E=a.key||"storeon",k=a.storage||localStorage,V=a.serializer||JSON.stringify,n=a.deserializer||JSON.parse,I=r=>{s.length&&(r=yu(r,s));let i;try{i=V(r)}catch(t){a.debug&&console.error(t);return}k.setItem(E,i)},e=Symbol("persistState");return r=>{r.on(e,(i,t)=>{try{return n(t)}catch(c){a.debug&&console.error(c)}}),r.on("@init",()=>{r.on("@changed",I);let i=k.getItem(E);if(i)if(typeof i.then=="function")i.then(t=>r.dispatch(e,t));else try{return n(i)}catch(t){a.debug&&console.error(t)}})}},yu=(s,a)=>{let E={};for(let k in s)for(let V of a)(V.test&&V.test(k)||V===k)&&(E[k]=s[k]);return E};const bu=s=>Array.from(s).map(a=>String.fromCharCode(a)).join(""),Pu=s=>new Uint8Array(Array.from(s).map(a=>a.charCodeAt(0))),Xs=s=>bu(hr(s)),zs=s=>Cs(Pu(s));/*! Capacitor: https://capacitorjs.com/ - MIT License */const wu=s=>{const a=new Map;a.set("web",{name:"web"});const E=s.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:a},k=(n,I)=>{E.platforms.set(n,I)},V=n=>{E.platforms.has(n)&&(E.currentPlatform=E.platforms.get(n))};return E.addPlatform=k,E.setPlatform=V,E},Du=s=>s.CapacitorPlatforms=wu(s),Zs=Du(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Zs.addPlatform;Zs.setPlatform;var _n;(function(s){s.Unimplemented="UNIMPLEMENTED",s.Unavailable="UNAVAILABLE"})(_n||(_n={}));class Xn extends Error{constructor(a,E,k){super(a),this.message=a,this.code=E,this.data=k}}const vu=s=>{var a,E;return s?.androidBridge?"android":!((E=(a=s?.webkit)===null||a===void 0?void 0:a.messageHandlers)===null||E===void 0)&&E.bridge?"ios":"web"},Mu=s=>{var a,E,k,V,n;const I=s.CapacitorCustomPlatform||null,e=s.Capacitor||{},r=e.Plugins=e.Plugins||{},i=s.CapacitorPlatforms,t=()=>I!==null?I.name:vu(s),c=((a=i?.currentPlatform)===null||a===void 0?void 0:a.getPlatform)||t,l=()=>c()!=="web",u=((E=i?.currentPlatform)===null||E===void 0?void 0:E.isNativePlatform)||l,o=N=>{const w=C.get(N);return!!(w?.platforms.has(c())||h(N))},f=((k=i?.currentPlatform)===null||k===void 0?void 0:k.isPluginAvailable)||o,g=N=>{var w;return(w=e.PluginHeaders)===null||w===void 0?void 0:w.find(y=>y.name===N)},h=((V=i?.currentPlatform)===null||V===void 0?void 0:V.getPluginHeader)||g,T=N=>s.console.error(N),S=(N,w,y)=>Promise.reject(`${y} does not have an implementation of "${w}".`),C=new Map,p=(N,w={})=>{const y=C.get(N);if(y)return console.warn(`Capacitor plugin "${N}" already registered. Cannot register plugins twice.`),y.proxy;const P=c(),x=h(N);let B;const H=async()=>(!B&&P in w?B=typeof w[P]=="function"?B=await w[P]():B=w[P]:I!==null&&!B&&"web"in w&&(B=typeof w.web=="function"?B=await w.web():B=w.web),B),L=(_,U)=>{var A,z;if(x){const J=x?.methods.find(se=>U===se.name);if(J)return J.rtype==="promise"?se=>e.nativePromise(N,U.toString(),se):(se,Te)=>e.nativeCallback(N,U.toString(),se,Te);if(_)return(A=_[U])===null||A===void 0?void 0:A.bind(_)}else{if(_)return(z=_[U])===null||z===void 0?void 0:z.bind(_);throw new Xn(`"${N}" plugin is not implemented on ${P}`,_n.Unimplemented)}},M=_=>{let U;const A=(...z)=>{const J=H().then(se=>{const Te=L(se,_);if(Te){const pe=Te(...z);return U=pe?.remove,pe}else throw new Xn(`"${N}.${_}()" is not implemented on ${P}`,_n.Unimplemented)});return _==="addListener"&&(J.remove=async()=>U()),J};return A.toString=()=>`${_.toString()}() { [capacitor code] }`,Object.defineProperty(A,"name",{value:_,writable:!1,configurable:!1}),A},G=M("addListener"),K=M("removeListener"),F=(_,U)=>{const A=G({eventName:_},U),z=async()=>{const se=await A;K({eventName:_,callbackId:se},U)},J=new Promise(se=>A.then(()=>se({remove:z})));return J.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await z()},J},Y=new Proxy({},{get(_,U){switch(U){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return x?F:G;case"removeListener":return K;default:return M(U)}}});return r[N]=Y,C.set(N,{name:N,proxy:Y,platforms:new Set([...Object.keys(w),...x?[P]:[]])}),Y},R=((n=i?.currentPlatform)===null||n===void 0?void 0:n.registerPlugin)||p;return e.convertFileSrc||(e.convertFileSrc=N=>N),e.getPlatform=c,e.handleError=T,e.isNativePlatform=u,e.isPluginAvailable=f,e.pluginMethodNoop=S,e.registerPlugin=R,e.Exception=Xn,e.DEBUG=!!e.DEBUG,e.isLoggingEnabled=!!e.isLoggingEnabled,e.platform=e.getPlatform(),e.isNative=e.isNativePlatform(),e},xu=s=>s.Capacitor=Mu(s),kn=xu(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),Sr=kn.registerPlugin;kn.Plugins;class Js{constructor(a){this.listeners={},this.windowListeners={},a&&(console.warn(`Capacitor WebPlugin "${a.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=a)}addListener(a,E){this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(E);const V=this.windowListeners[a];V&&!V.registered&&this.addWindowListener(V);const n=async()=>this.removeListener(a,E),I=Promise.resolve({remove:n});return Object.defineProperty(I,"remove",{value:async()=>{console.warn("Using addListener() without 'await' is deprecated."),await n()}}),I}async removeAllListeners(){this.listeners={};for(const a in this.windowListeners)this.removeWindowListener(this.windowListeners[a]);this.windowListeners={}}notifyListeners(a,E){const k=this.listeners[a];k&&k.forEach(V=>V(E))}hasListeners(a){return!!this.listeners[a].length}registerWindowListener(a,E){this.windowListeners[E]={registered:!1,windowEventName:a,pluginEventName:E,handler:k=>{this.notifyListeners(E,k)}}}unimplemented(a="not implemented"){return new kn.Exception(a,_n.Unimplemented)}unavailable(a="not available"){return new kn.Exception(a,_n.Unavailable)}async removeListener(a,E){const k=this.listeners[a];if(!k)return;const V=k.indexOf(E);this.listeners[a].splice(V,1),this.listeners[a].length||this.removeWindowListener(this.windowListeners[a])}addWindowListener(a){window.addEventListener(a.windowEventName,a.handler),a.registered=!0}removeWindowListener(a){a&&(window.removeEventListener(a.windowEventName,a.handler),a.registered=!1)}}const ds=s=>encodeURIComponent(s).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),ps=s=>s.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class Lu extends Js{async getCookies(){const a=document.cookie,E={};return a.split(";").forEach(k=>{if(k.length<=0)return;let[V,n]=k.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");V=ps(V).trim(),n=ps(n).trim(),E[V]=n}),E}async setCookie(a){try{const E=ds(a.key),k=ds(a.value),V=`; expires=${(a.expires||"").replace("expires=","")}`,n=(a.path||"/").replace("path=",""),I=a.url!=null&&a.url.length>0?`domain=${a.url}`:"";document.cookie=`${E}=${k||""}${V}; path=${n}; ${I};`}catch(E){return Promise.reject(E)}}async deleteCookie(a){try{document.cookie=`${a.key}=; Max-Age=0`}catch(E){return Promise.reject(E)}}async clearCookies(){try{const a=document.cookie.split(";")||[];for(const E of a)document.cookie=E.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(a){return Promise.reject(a)}}async clearAllCookies(){try{await this.clearCookies()}catch(a){return Promise.reject(a)}}}Sr("CapacitorCookies",{web:()=>new Lu});const Uu=async s=>new Promise((a,E)=>{const k=new FileReader;k.onload=()=>{const V=k.result;a(V.indexOf(",")>=0?V.split(",")[1]:V)},k.onerror=V=>E(V),k.readAsDataURL(s)}),Fu=(s={})=>{const a=Object.keys(s);return Object.keys(s).map(V=>V.toLocaleLowerCase()).reduce((V,n,I)=>(V[n]=s[a[I]],V),{})},Bu=(s,a=!0)=>s?Object.entries(s).reduce((k,V)=>{const[n,I]=V;let e,r;return Array.isArray(I)?(r="",I.forEach(i=>{e=a?encodeURIComponent(i):i,r+=`${n}=${e}&`}),r.slice(0,-1)):(e=a?encodeURIComponent(I):I,r=`${n}=${e}`),`${k}&${r}`},"").substr(1):null,ku=(s,a={})=>{const E=Object.assign({method:s.method||"GET",headers:s.headers},a),V=Fu(s.headers)["content-type"]||"";if(typeof s.data=="string")E.body=s.data;else if(V.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[I,e]of Object.entries(s.data||{}))n.set(I,e);E.body=n.toString()}else if(V.includes("multipart/form-data")){const n=new FormData;if(s.data instanceof FormData)s.data.forEach((e,r)=>{n.append(r,e)});else for(const e of Object.keys(s.data))n.append(e,s.data[e]);E.body=n;const I=new Headers(E.headers);I.delete("content-type"),E.headers=I}else(V.includes("application/json")||typeof s.data=="object")&&(E.body=JSON.stringify(s.data));return E};class Gu extends Js{async request(a){const E=ku(a,a.webFetchExtra),k=Bu(a.params,a.shouldEncodeUrlParams),V=k?`${a.url}?${k}`:a.url,n=await fetch(V,E),I=n.headers.get("content-type")||"";let{responseType:e="text"}=n.ok?a:{};I.includes("application/json")&&(e="json");let r,i;switch(e){case"arraybuffer":case"blob":i=await n.blob(),r=await Uu(i);break;case"json":r=await n.json();break;case"document":case"text":default:r=await n.text()}const t={};return n.headers.forEach((c,l)=>{t[l]=c}),{data:r,headers:t,status:n.status,url:n.url}}async get(a){return this.request(Object.assign(Object.assign({},a),{method:"GET"}))}async post(a){return this.request(Object.assign(Object.assign({},a),{method:"POST"}))}async put(a){return this.request(Object.assign(Object.assign({},a),{method:"PUT"}))}async patch(a){return this.request(Object.assign(Object.assign({},a),{method:"PATCH"}))}async delete(a){return this.request(Object.assign(Object.assign({},a),{method:"DELETE"}))}}Sr("CapacitorHttp",{web:()=>new Gu});const $u="@aparajita/capacitor-secure-storage",Wu="2.1.0",fs={name:$u,version:Wu};var or;(function(s){s[s.sessionStorage=0]="sessionStorage",s[s.localStorage=1]="localStorage"})(or||(or={}));var _s;(function(s){s[s.encryptionKeyNotSet=0]="encryptionKeyNotSet",s[s.notFound=1]="notFound",s[s.missingKey=2]="missingKey",s[s.invalidData=3]="invalidData",s[s.osError=4]="osError",s[s.unknownError=5]="unknownError"})(_s||(_s={}));console.log(`loaded ${fs.name} v${fs.version}`);const yn=Sr("SecureStorage",{web:async()=>Hn(()=>import("./web-1be5db9d.js"),["assets/web-1be5db9d.js","assets/base-6440fea0.js","assets/index-f6dc58d3.js","assets/index-888c40c2.css","assets/___vite-browser-external_commonjs-proxy-0e49e858.js","assets/trade-558ff608.js","assets/toast-c468639c.js","assets/toast-69cb867a.js","assets/isObject-9a74e966.js"]).then(s=>new s.SecureStorageWeb),ios:async()=>Hn(()=>import("./native-e72a4dbe.js"),["assets/native-e72a4dbe.js","assets/base-6440fea0.js","assets/index-f6dc58d3.js","assets/index-888c40c2.css","assets/___vite-browser-external_commonjs-proxy-0e49e858.js","assets/trade-558ff608.js","assets/toast-c468639c.js","assets/toast-69cb867a.js","assets/isObject-9a74e966.js"]).then(s=>new s.SecureStorageNative(yn)),android:async()=>Hn(()=>import("./native-e72a4dbe.js"),["assets/native-e72a4dbe.js","assets/base-6440fea0.js","assets/index-f6dc58d3.js","assets/index-888c40c2.css","assets/___vite-browser-external_commonjs-proxy-0e49e858.js","assets/trade-558ff608.js","assets/toast-c468639c.js","assets/toast-69cb867a.js","assets/isObject-9a74e966.js"]).then(s=>new s.SecureStorageNative(yn))}),[qu,Vu]=ei({activatedCa:{},selectedCa:"",loginSecret:{person_id:"",password:""},authed:!1,solaceConnStatus:"offline"});yn.setStorageType(or.localStorage);if(ti.getPlatform()==="web"){let s="BuH7dwJNdhqPTh84itVvQETEdrtmakjP";await yn.setEncryptionKey(s)}const Hu={key:"storeonsProd",storage:yn,serializer:Xs,deserializer:zs},Yu={key:"storeonProd",serializer:Xs,deserializer:zs},ju=oi([Nu,hs(["authed","activeTab","activeContract","rememberPfxPassword","simulation"],Yu),hs(["person_id","token","clientName","idcToken","bcToken","pfxB64","pfxPassword","accounts","activeStockAccount","activeFutureAccount","activeHAccount"],Hu),!1]),el=Object.freeze(Object.defineProperty({__proto__:null,setStore:Vu,solStore:ju,store:qu},Symbol.toStringTag,{value:"Module"}));export{kn as C,or as S,Js as W,_s as a,el as i};
